/* 
This file contains a customized selection of TiddlyWiki plugin modules
for external plugin enabled wikis.
*/
window.$tw = (function ($tw) {
    "use strict";
    $tw = $tw || Object.create(null);
    $tw.preloadTiddlers = $tw.preloadTiddlers || [];
    $tw.preloadTiddlers = $tw.preloadTiddlers.concat(
[
  {
    "created": "20240728233211409",
    "creator": "theophile.dev",
    "title": "$:/config/ExternalJS/Exports",
    "text": "$:/plugins/cdr/external-js $:/plugins/flibbles/relink $:/plugins/flibbles/relink-titles $:/plugins/sq/editor-autolist $:/plugins/sq/streams $:/themes/tiddlywiki/snowwhite $:/themes/tiddlywiki/vanilla",
    "modified": "20240728233211409",
    "modifier": "theophile.dev"
  },
  {
    "title": "$:/plugins/cdr/external-js",
    "name": "External JS",
    "description": "Ability to externalize core and plugins",
    "author": "cdruan",
    "version": "0.2.0",
    "core-version": ">=5.1.23",
    "list": "readme usage tiddlywiki.info FAQ",
    "plugin-type": "plugin",
    "dependents": "",
    "type": "application/json",
    "text": "{\"tiddlers\":{\"$:/config/ExternalJS/EnableExternalPlugins\":{\"title\":\"$:/config/ExternalJS/EnableExternalPlugins\",\"text\":\"no\"},\"$:/config/ExternalJS/Prefix/Core\":{\"title\":\"$:/config/ExternalJS/Prefix/Core\",\"text\":\"tiddlywikicore\"},\"$:/config/ExternalJS/Prefix/Plugins\":{\"title\":\"$:/config/ExternalJS/Prefix/Plugins\",\"text\":\"myplugins\"},\"$:/plugins/cdr/external-js/FAQ\":{\"title\":\"$:/plugins/cdr/external-js/FAQ\",\"text\":\"''How do I make changes to my collection of external plugins?''\\n\\nJust select or de-select any plugins. Confirm the changes and re-download the <$text text=\\\"JavaScript\\\"/> file. Reload your wiki.\\n\\n''How do I export plugins from multiple wikis into one collection?''\\n\\nAssuming you have already converted one wiki and exported out the desired plugins from that wiki, alter the conversion steps slightly for each of the remaining wikis:\\n\\n* Import this plugin.\\n* Check the \\\"Externalize plugins and themes\\\" option but skip the rest of step #3; i.e. leave all items unchecked and do not download the external plugins at this point. \\n* Proceed to step #4 and finish all of the remaining steps.\\n* Once you reload the converted wiki, plugins that have already been externalized from the earlier wikis will appear in this wiki.\\n* Now is the time to add additional plugins to the collection; just remember to:\\n\\t** confirm the changes\\n\\t** re-create the JS file by downloading the JS file to the local disk\\n\\t** save the wiki.\\n\\nTIP: You might want to externalize all official plugins to make upgrading multiple wikis easier in the future.\\n\\n''Can I configure the paths to the libraries?''\\n\\nYes. To change the path to the core library, edit the $:/config/ExternalJS/Prefix/Core tiddler. For example, if the URL of your core library is `https://example.com/lib/tiddlywikicore-5.2.3.js`, then set the value of the tiddler to:\\n\\n```\\nhttps://example.com/lib/tiddlywikicore\\n```\\n\\nOmit the version number and the file extension.\\n\\nSimilarly, to change the path to the plugins library (or rename the <$text text=\\\"JavaScript\\\"/> file), edit the $:/config/ExternalJS/Prefix/Plugins tiddler.\\n\\nMake the changes before you convert the wiki, and make sure that the libraries can be found at the specified locations.\"},\"$:/plugins/cdr/external-js/filenames\":{\"title\":\"$:/plugins/cdr/external-js/filenames\",\"text\":\"\\\\define coreURL() [{$:/config/ExternalJS/Prefix/Core}addsuffix[-]addsuffix<version>addsuffix[.js]]\\n\\\\define pluginsURL() [{$:/config/ExternalJS/Prefix/Plugins}addsuffix[-]addsuffix<version>addsuffix[.js]]\"},\"$:/plugins/cdr/external-js/images/file-download\":{\"title\":\"$:/plugins/cdr/external-js/images/file-download\",\"tags\":\"$:/tags/Image\",\"text\":\"<svg width=\\\"22pt\\\" height=\\\"22pt\\\" class=\\\"tc-image-file-download tc-image-button\\\" viewBox=\\\"0 0 16 16\\\">\\n  <path d=\\\"M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z\\\"/>\\n  <path d=\\\"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z\\\"/>\\n</svg>\"},\"$:/plugins/cdr/external-js/readme\":{\"title\":\"$:/plugins/cdr/external-js/readme\",\"text\":\"\\\\import [[$:/plugins/cdr/external-js/filenames]]\\n\\nThis plugin can externalize plugins as well as the <$text text=\\\"TiddlyWiki\\\"/> core code by extending the default \\\"external-js\\\" template. Although such configuration requires additional supporting <$text text=\\\"JavaScript\\\"/>(s) for your wikis to load successfully, it allows you to share libraries and drastically reduce disk usage. This plugin is intended for the advanced users only.\\n\\n! Installation\\n\\nDrag and drop the [[External JS Plugin|$:/plugins/cdr/external-js]] into your wiki, save and reload. Then visit the usage tab of the plugin for further details.\"},\"$:/plugins/cdr/external-js/saver.js\":{\"title\":\"$:/plugins/cdr/external-js/saver.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/cdr/external-js/saver.js\\ntype: application/javascript\\nmodule-type: saver\\n\\nDownload saver for external-js enabled wiki\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar ExternalJSSaver = function(wiki) {\\n};\\n\\nExternalJSSaver.prototype.titleDownloadInstruction = \\\"$:/plugins/cdr/external-js/ui/download-wiki\\\";\\nExternalJSSaver.prototype.titleSaveTemplate = \\\"$:/core/save/offline-external-js\\\";\\n\\nExternalJSSaver.prototype.save = function(text,method,callback,options) {\\n\\tvar template = $tw.wiki.getTiddlerText(\\\"$:/config/SaveWikiButton/Template\\\").trim();\\n\\tif (template !== this.titleSaveTemplate) {\\n\\t\\treturn false;\\n\\t}\\n\\n\\toptions = options || {};\\n\\t// Get the current filename\\n\\tvar filename = options.variables.filename;\\n\\tif(!filename) {\\n\\t\\tvar p = document.location.pathname.lastIndexOf(\\\"/\\\");\\n\\t\\tif(p !== -1) {\\n\\t\\t\\t// We decode the pathname because document.location is URL encoded by the browser\\n\\t\\t\\tfilename = document.location.pathname.substring(p+1);\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tfilename = decodeURIComponent(filename);\\n\\t\\t\\t} catch(e) {}\\n\\t\\t}\\n\\t}\\n\\tif(!filename) {\\n\\t\\tfilename = \\\"tiddlywiki.html\\\";\\n\\t}\\n\\t// Set up the url\\n\\tvar url = undefined;\\n\\tif(Blob !== undefined) {\\n\\t\\tvar blob = new Blob([text], {type: \\\"text/html\\\"});\\n\\t\\turl = URL.createObjectURL(blob);\\n\\t} else {\\n\\t\\turl = \\\"data:text/html,\\\" + encodeURIComponent(text);\\n\\t}\\n\\n\\t$tw.modal.display(this.titleDownloadInstruction,{\\n\\t\\tvariables: {\\n\\t\\t\\tdataURL: url,\\n\\t\\t\\tfilename: filename\\n\\t\\t},\\n\\t\\tevent: {}\\n\\t});\\n\\n\\t// Callback that we succeeded\\n\\tif(callback) {\\n\\t\\tcallback(null);\\n\\t}\\n\\treturn true;\\n};\\n\\n/*\\nInformation about this saver\\n*/\\nExternalJSSaver.prototype.info = {\\n\\tname: \\\"external-js\\\",\\n\\tpriority: 105\\n};\\n\\nObject.defineProperty(ExternalJSSaver.prototype.info, \\\"capabilities\\\", {\\n\\tget: function() {\\n\\t\\tvar capabilities = [\\\"save\\\"];\\n\\t\\tif(($tw.wiki.getTextReference(\\\"$:/config/DownloadSaver/AutoSave\\\") || \\\"\\\").toLowerCase() === \\\"yes\\\") {\\n\\t\\t\\tcapabilities.push(\\\"autosave\\\");\\n\\t\\t}\\n\\t\\treturn capabilities;\\n\\t}\\n});\\n\\n/*\\nStatic method that returns true if this saver is capable of working\\n*/\\nexports.canSave = function(wiki) {\\n\\treturn document.createElement(\\\"a\\\").download !== undefined;\\n};\\n\\n/*\\nCreate an instance of this saver\\n*/\\nexports.create = function(wiki) {\\n\\treturn new ExternalJSSaver(wiki);\\n};\\n\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"saver\"},\"$:/plugins/cdr/external-js/startup.js\":{\"title\":\"$:/plugins/cdr/external-js/startup.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/cdr/external-js/startup.js\\ntype: application/javascript\\nmodule-type: startup\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n// Export name and synchronous status\\nexports.name = \\\"external-js\\\";\\nexports.platforms = [\\\"browser\\\"];\\nexports.after = [\\\"rootwidget\\\"];\\nexports.before = [\\\"story\\\"];\\nexports.synchronous = true;\\n\\nfunction downloadExternalJSWiki(saver,filename) {\\n\\tvar text = $tw.wiki.renderTiddler(\\\"text/plain\\\",saver.titleSaveTemplate,null /*options*/);\\n\\n\\tsaver.save(text,\\\"save\\\",null,{variables: { filename: filename }});\\n}\\n\\nexports.startup = function() {\\n\\tfor(var t=$tw.saverHandler.savers.length-1; t>=0; t--) {\\n\\t\\tvar saver = $tw.saverHandler.savers[t];\\n\\t\\tif(saver.info.name === \\\"external-js\\\") {\\n\\t\\t\\t$tw.rootWidget.addEventListener(\\\"tm-download-external-js-wiki\\\",function(event) {\\n\\t\\t\\t\\tdownloadExternalJSWiki(saver, event.param);\\n\\t\\t\\t});\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t}\\n\\n\\tvar plugins = {};\\n\\t$tw.utils.each(\\n\\t\\t$tw.wiki.filterTiddlers(\\\"[enlist{$:/config/ExternalJS/Exports}]\\\"),\\n\\t\\tfunction(title) {\\n\\t\\t\\tplugins[title] = \\\"yes\\\";\\n\\t\\t}\\n\\t);\\n\\n\\tvar fields = {\\n\\t\\toriginal: \\\"yes\\\",\\n\\t\\tlist: $tw.wiki.getTiddlerText(\\\"$:/config/ExternalJS/Exports\\\")\\n\\t}\\n\\t$tw.wiki.setTiddlerData(\\\"$:/temp/external-js/exports\\\",plugins,fields);\\n}\\n})();\",\"type\":\"application/javascript\",\"module-type\":\"startup\"},\"$:/plugins/cdr/external-js/templates/plugins-all.js\":{\"title\":\"$:/plugins/cdr/external-js/templates/plugins-all.js\",\"text\":\"`/* \\nThis file contains all of the plugins and themes to be included in the wiki.\\n*/\\nwindow.$tw = (function ($tw) {\\n    \\\"use strict\\\";\\n    $tw = $tw || Object.create(null);\\n    $tw.preloadTiddlers = $tw.preloadTiddlers || [];\\n    $tw.preloadTiddlers = $tw.preloadTiddlers.concat(`\\n<$text text=<<jsontiddlers \\\"[plugin-type[plugin]] [plugin-type[theme]] -[[$:/core]]\\\" \\\"2\\\">>/>`);\\n    return $tw;\\n})(window.$tw);\\n`\\n\"},\"$:/plugins/cdr/external-js/templates/plugins.js\":{\"title\":\"$:/plugins/cdr/external-js/templates/plugins.js\",\"text\":\"`/* \\nThis file contains a customized selection of TiddlyWiki plugin modules\\nfor external plugin enabled wikis.\\n*/\\nwindow.$tw = (function ($tw) {\\n    \\\"use strict\\\";\\n    $tw = $tw || Object.create(null);\\n    $tw.preloadTiddlers = $tw.preloadTiddlers || [];\\n    $tw.preloadTiddlers = $tw.preloadTiddlers.concat(`\\n<$text text=<<jsontiddlers \\\"[[$:/config/ExternalJS/Exports]] [enlist{$:/config/ExternalJS/Exports}]\\\" \\\"2\\\">>/>`);\\n    return $tw;\\n})(window.$tw);\\n`\\n\"},\"$:/core/save/all-external-js\":{\"title\":\"$:/core/save/all-external-js\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]]\\n\\\\define saveTiddlerFilter()\\n[is[tiddler]] -[prefix[$:/state/popup/]] -[prefix[$:/temp/]] -[prefix[$:/HistoryList]] -[status[pending]plugin-type[import]] -[[$:/core]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] -[plugin-type[plugin]] -[plugin-type[theme]] +[sort[title]] $(publishFilter)$\\n\\\\end\\n\\\\define saveOffline() no\\n\\\\define coreURL() [[%24%3A%2Fcore%2Ftemplates%2Ftiddlywiki5.js]]\\n\\\\define pluginsURL() [[%24%3A%2Fplugins%2Fcdr%2Fexternal-js%2Ftemplates%2Fplugins-all.js]]\\n{{$:/core/templates/tiddlywiki5-external-js.html}}\"},\"$:/core/save/offline-external-js\":{\"title\":\"$:/core/save/offline-external-js\",\"text\":\"\\\\import [[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]] [[$:/plugins/cdr/external-js/filenames]]\\n\\\\define onlyIfExterned() [{$:/config/ExternalJS/EnableExternalPlugins}match[yes]]\\n\\\\define saveTiddlerFilter()\\n[is[tiddler]] -[prefix[$:/state/popup/]] -[prefix[$:/temp/]] -[prefix[$:/HistoryList]] -[status[pending]plugin-type[import]] -[[$:/core]] -[[$:/plugins/tiddlywiki/filesystem]] -[[$:/plugins/tiddlywiki/tiddlyweb]] -[[$:/status/IsLoggedIn]] -[[$:/boot/boot.css]] -[type[application/javascript]library[yes]] -[[$:/boot/boot.js]] -[[$:/boot/bootprefix.js]] +[sort[title]] -[[$:/config/ExternalJS/Exports]] :except[enlist{$:/config/ExternalJS/Exports}filter<onlyIfExterned>] -[<version>compare:version:lt[5.2.0]then[$:/core/save/all]] $(publishFilter)$\\n\\\\end\\n\\\\define saveOffline() yes\\n{{$:/core/templates/tiddlywiki5-external-js.html}}\"},\"$:/plugins/cdr/external-js/templates/tiddlywiki.js/load-tiddler\":{\"title\":\"$:/plugins/cdr/external-js/templates/tiddlywiki.js/load-tiddler\",\"text\":\"_load(window,<$macrocall $name=\\\"jsontiddler\\\" $output=\\\"text/raw\\\"/>);\"},\"$:/core/templates/tiddlywiki5.js\":{\"title\":\"$:/core/templates/tiddlywiki5.js\",\"text\":\"\\\\rules only filteredtranscludeinline transcludeinline codeinline\\n\\n`/*\\n`{{ $:/core/copyright.txt ||$:/core/templates/plain-text-tiddler}}`\\n*/\\n\\n$tw = $tw || Object.create(null);\\n$tw.preloadTiddlers = $tw.preloadTiddlers || [];\\n\\n_load = function(window,tiddler) {\\n\\t\\\"use strict\\\";\\n\\tvar f;\\n\\t$tw.preloadTiddlers.push(tiddler);\\n\\tif(tiddler.library === \\\"yes\\\") {\\n\\t\\tvar module = { exports:{} };\\n\\t\\tvar moduleName = function moduleName(path) {\\n\\t\\t\\tvar word = path.split(\\\"/\\\").pop();\\n\\t\\t\\tword = word.substring(0,word.indexOf(\\\".\\\")) || word;\\n\\t\\t\\treturn word;\\n\\t\\t}\\n\\t\\tf = new Function(\\\"module\\\",tiddler.text);\\n\\t\\tf(module);\\n\\t\\twindow[moduleName(tiddler.title)] = module.exports;\\n\\t} else {\\n\\t\\tf = new Function(\\\"window\\\",tiddler.text);\\n\\t\\tf(window);\\n\\t}\\n}\\n\\n/* ~~ Library modules ~~ */\\n\\n`{{{ [is[system]type[application/javascript]library[yes]] ||$:/plugins/cdr/external-js/templates/tiddlywiki.js/load-tiddler}}}`\\n\\n/* ~~ Boot kernel prologue ~~ */\\n\\n`{{ $:/boot/bootprefix.js ||$:/plugins/cdr/external-js/templates/tiddlywiki.js/load-tiddler}}`\\n\\n/* ~~ Core tiddlers ~~ */\\n\\n`{{$:/core/templates/tiddlywiki5.js/tiddlers}}`\\n\\n/* ~~ Boot kernel ~~ */\\n\\n`{{ $:/boot/boot.js ||$:/plugins/cdr/external-js/templates/tiddlywiki.js/load-tiddler}}`\\n\"},\"$:/core/templates/tiddlywiki5.js/tiddlers\":{\"title\":\"$:/core/templates/tiddlywiki5.js/tiddlers\",\"text\":\"`$tw.preloadTiddlerArray(`<$text text=<<jsontiddlers \\\"[[$:/core]]\\\">>/>`);\\n$tw.preloadTiddler({\\n\\ttitle: \\\"$:/config/SaveWikiButton/Template\\\",\\n\\ttext: \\\"$:/core/save/offline-external-js\\\"\\n});\\n`<$list filter=\\\"[<version>compare:version:lt[5.2.0]]\\\">`$tw.preloadTiddler({\\n\\ttitle: \\\"$:/core/save/all\\\",\\n\\ttext: \\\"{{$:/core/save/offline-external-js}}\\\"\\n});\\n`</$list>\"},\"$:/core/templates/tiddlywiki5-external-js.html\":{\"title\":\"$:/core/templates/tiddlywiki5-external-js.html\",\"text\":\"\\\\whitespace trim\\n<$set name=\\\"saveTiddlerAndShadowsFilter\\\" filter=\\\"[subfilter<saveTiddlerFilter>] [subfilter<saveTiddlerFilter>plugintiddlers[]]\\\">\\n`<!doctype html>\\n`{{$:/core/templates/MOTW.html}}`<html lang=\\\"`<$text text={{{ [{$:/language}get[name]] }}}/>`\\\">\\n<head>\\n<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html;charset=utf-8\\\" />\\n<!--~~ Raw markup for the top of the head section ~~-->\\n`{{{ [enlist<saveTiddlerAndShadowsFilter>tag[$:/tags/RawMarkupWikified/TopHead]] ||$:/core/templates/raw-static-tiddler}}}`\\n<meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/>\\n<meta name=\\\"application-name\\\" content=\\\"TiddlyWiki\\\" />\\n<meta name=\\\"generator\\\" content=\\\"TiddlyWiki\\\" />\\n<meta name=\\\"tiddlywiki-version\\\" content=\\\"`{{$:/core/templates/version}}`\\\" />\\n<meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\" />\\n<meta name=\\\"apple-mobile-web-app-capable\\\" content=\\\"yes\\\" />\\n<meta name=\\\"apple-mobile-web-app-status-bar-style\\\" content=\\\"black-translucent\\\" />\\n<meta name=\\\"mobile-web-app-capable\\\" content=\\\"yes\\\"/>\\n<meta name=\\\"format-detection\\\" content=\\\"telephone=no\\\" />\\n<meta name=\\\"copyright\\\" content=\\\"`{{$:/core/copyright.txt}}`\\\" />\\n<link id=\\\"faviconLink\\\" rel=\\\"shortcut icon\\\" href=\\\"favicon.ico\\\">\\n<title>`{{$:/core/wiki/title}}`</title>\\n<!--~~ This is a Tiddlywiki file. The points of interest in the file are marked with this pattern ~~-->\\n\\n<!--~~ Raw markup ~~-->\\n`{{{ [enlist<saveTiddlerAndShadowsFilter>tag[$:/core/wiki/rawmarkup]] ||$:/core/templates/plain-text-tiddler}}}`\\n`{{{ [enlist<saveTiddlerAndShadowsFilter>tag[$:/tags/RawMarkup]] ||$:/core/templates/plain-text-tiddler}}}`\\n`{{{ [enlist<saveTiddlerAndShadowsFilter>tag[$:/tags/RawMarkupWikified]] ||$:/core/templates/raw-static-tiddler}}}`\\n</head>\\n<body class=\\\"tc-body\\\">\\n<!--~~ Raw markup for the top of the body section ~~-->\\n`{{{ [enlist<saveTiddlerAndShadowsFilter>tag[$:/tags/RawMarkupWikified/TopBody]] ||$:/core/templates/raw-static-tiddler}}}`\\n<!--~~ Static styles ~~-->\\n<div id=\\\"styleArea\\\">\\n`{{$:/boot/boot.css||$:/core/templates/css-tiddler}}`\\n</div>\\n<!--~~ Static content for Google and browsers without JavaScript ~~-->\\n<noscript>\\n<div id=\\\"splashArea\\\">\\n`{{$:/core/templates/static.area}}`\\n</div>\\n</noscript>\\n<!--~~ Ordinary tiddlers ~~-->\\n`{{$:/core/templates/store.area.template.html}}`\\n<!--~~ Raw markup for the bottom of the body section ~~-->\\n`{{{ [enlist<saveTiddlerAndShadowsFilter>tag[$:/tags/RawMarkupWikified/BottomBody]] ||$:/core/templates/raw-static-tiddler}}}`\\n<!--~~ Load external JavaScripts ~~-->`\\n<$list filter=\\\"[{$:/info/node}match[yes]] ~[{$:/config/ExternalJS/EnableExternalPlugins}match[yes]]\\\">\\n`\\n<script src=\\\"`{{{ [subfilter<pluginsURL>] }}}`\\\" onerror=\\\"alert('Error: Cannot load `{{{ [subfilter<pluginsURL>] }}}`');\\\"></script>\\n`\\n</$list>\\n`<script src=\\\"`{{{ [subfilter<coreURL>] }}}`\\\" onerror=\\\"alert('Error: Cannot load `{{{ [subfilter<coreURL>] }}}`');\\\"></script>\\n</body>\\n</html>`\\n</$set>\"},\"$:/plugins/cdr/external-js/tiddlywiki.info\":{\"title\":\"$:/plugins/cdr/external-js/tiddlywiki.info\",\"text\":\"\\\\import [[$:/plugins/cdr/external-js/filenames]]\\n\\n<$set name=coreFilenamePrefix filter=\\\"[subfilter<coreURL>split[/]last[]splitbefore[-]]\\\">\\n<$set name=pluginsFilenamePrefix filter=\\\"[subfilter<pluginsURL>split[/]last[]splitbefore[-]]\\\">\\nHere is a sample tiddlywiki.inifo that provides external-js related build targets.\\n<pre>{\\n  \\\"description\\\":\\n    \\\"external-js client/server edition\\\",\\n  \\\"plugins\\\": [\\n    \\\"tiddlywiki/tiddlyweb\\\",\\n    \\\"tiddlywiki/filesystem\\\",\\n    \\\"tiddlywiki/highlight\\\",\\n    \\\"cdr/external-js\\\"\\n  ],\\n  \\\"themes\\\": [\\n    \\\"tiddlywiki/vanilla\\\",\\n    \\\"tiddlywiki/snowwhite\\\"\\n  ],\\n  \\\"build\\\": {\\n    \\\"listen\\\": [\\n      \\\"&#45;&#45;listen\\\",\\n      \\\"port=8080\\\",\\n      \\\"root-tiddler=<$text text=\\\"\\\"\\\"$:/core/save/all-external-js\\\"\\\"\\\"/>\\\",\\n      \\\"use-browser-cache=yes\\\"],\\n    \\\"index\\\": [\\n      \\\"&#45;&#45;rendertiddler\\\",\\n      \\\"<$text text=\\\"\\\"\\\"$:/core/save/offline-external-js\\\"\\\"\\\"/>\\\",\\n      \\\"index.html\\\",\\n      \\\"text/plain\\\",\\n      \\\"&#45;&#45;render\\\",\\n      \\\"<$text text=\\\"\\\"\\\"$:/core/templates/tiddlywiki5.js\\\"\\\"\\\"/>\\\",\\n      \\\"&#91;&#91;<<coreFilenamePrefix>>]addsuffix&lt;version>addsuffix[.js]]\\\",\\n      \\\"text/plain\\\",\\n      \\\"&#45;&#45;render\\\",\\n      \\\"<$text text=\\\"\\\"\\\"$:/plugins/cdr/external-js/templates/plugins.js\\\"\\\"\\\"/>\\\",\\n      \\\"&#91;&#91;<<pluginsFilenamePrefix>>]addsuffix&lt;version>addsuffix[.js]]\\\",\\n      \\\"text/plain\\\"],\\n    \\\"core\\\": [\\n      \\\"&#45;&#45;render\\\",\\n      \\\"<$text text=\\\"\\\"\\\"$:/core/templates/tiddlywiki5.js\\\"\\\"\\\"/>\\\",\\n      &#91;&#91;<<coreFilenamePrefix>>]addsuffix&lt;version>addsuffix[.js]]\\\",\\n      \\\"text/plain\\\"],\\n    \\\"myplugins\\\": [\\n      \\\"&#45;&#45;render\\\",\\n      \\\"<$text text=\\\"\\\"\\\"$:/plugins/cdr/external-js/templates/plugins.js\\\"\\\"\\\"/>\\\",\\n      \\\"&#91;&#91;<<pluginsFilenamePrefix>>]addsuffix&lt;version>addsuffix[.js]]\\\",\\n      \\\"text/plain\\\"]\\n  }\\n}\\n</pre>\\n</$set></$set>\\n\\n`--build listen`<br/>\\nStart the server with external-js enabled. The server listens on port 8080. Visit http://localhost:8080 in your browser.\\n\\n`--build index`<br/>\\nBuild snapshot and <$text text=\\\"TiddlyWiki\\\"/> core code. The results are saved in the `output` subdirectory of your wiki folder.\\n\\n`--build core`<br/>\\nBuild <$text text=\\\"TiddlyWiki\\\"/> core code only.\\n\\n`--build myplugins`<br/>\\nExport externalized plugins.\"},\"$:/plugins/tiddlywiki/tiddlyweb/syncer-actions/save-snapshot\":{\"title\":\"$:/plugins/tiddlywiki/tiddlyweb/syncer-actions/save-snapshot\",\"tags\":\"$:/tags/SyncerDropdown\",\"text\":\"<$wikify name=\\\"site-title\\\" text={{$:/config/SaveWikiButton/Filename}}>\\n<$button class=\\\"tc-btn-invisible\\\">\\n<$list filter=\\\"[{$:/config/SaveWikiButton/Template}match[$:/core/save/offline-external-js]]\\\" emptyMessage=\\\"\\\"\\\"<$action-sendmessage $message=\\\"tm-download-file\\\" $param={{$:/config/SaveWikiButton/Template}} filename=<<site-title>>/>\\n\\\"\\\"\\\" >\\n<$action-sendmessage $message=\\\"tm-download-external-js-wiki\\\" param=<<site-title>>/>\\n</$list>\\n{{$:/core/images/download-button}} Save snapshot for offline use <$view tiddler=\\\"$:/plugins/tiddlywiki/tiddlyweb/syncer-actions/save-snapshot\\\" field=\\\"remark\\\" format=\\\"plainwikified\\\" mode=\\\"inline\\\"/>\\n</$button>\\n</$wikify>\\n\"},\"$:/config/PageControlButtons/Visibility/$:/plugins/cdr/external-js/ui/download-full-wiki\":{\"title\":\"$:/config/PageControlButtons/Visibility/$:/plugins/cdr/external-js/ui/download-full-wiki\",\"text\":\"hide\"},\"$:/plugins/cdr/external-js/ui/download-full-wiki\":{\"title\":\"$:/plugins/cdr/external-js/ui/download-full-wiki\",\"tags\":\"$:/tags/PageControls\",\"caption\":\"single-file wiki\",\"description\":\"{{$:/plugins/cdr/external-js/ui/download-full-wiki!!hint}}\",\"hint\":\"Download fully standalone wiki\",\"list-before\":\"$:/core/ui/Buttons/save-wiki\",\"text\":\"\\\\whitespace trim\\n\\n<$wikify name=\\\"site-title\\\" text={{$:/config/SaveWikiButton/Filename}}>\\n<$let publishFilter=\\\"\\\"\\\"-[[$:/config/SaveWikiButton/Template]] -[[$:/plugins/tiddlywiki/filesystem]] -[[$:/plugins/tiddlywiki/tiddlyweb]] -[[$:/config/ExternalJS/EnableExternalPlugins]] -[[$:/config/ExternalJS/Prefix/Core]] -[[$:/config/ExternalJS/Prefix/Plugins]] -[[$:/config/PageControlButtons/Visibility/$:/plugins/cdr/external-js/ui/download-full-wiki]]\\\"\\\"\\\">\\n<$button tooltip={{$:/plugins/cdr/external-js/ui/download-full-wiki!!hint}} aria-label={{$:/plugins/cdr/external-js/ui/download-full-wiki!!caption}} class=<<tv-config-toolbar-class>>>\\n<$action-sendmessage $message=\\\"tm-download-file\\\" $param=\\\"$:/core/save/all\\\" publishFilter=<<publishFilter>> filename=<<site-title>>/>\\n<$list filter=\\\"[<tv-config-toolbar-icons>match[yes]]\\\">\\n{{$:/plugins/cdr/external-js/images/file-download}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>match[yes]]\\\"><span class=\\\"tc-btn-text\\\"><$text text={{$:/plugins/cdr/external-js/ui/download-full-wiki!!caption}}/></span>\\n</$list>\\n</$button>\\n</$let>\\n</$wikify>\"},\"$:/plugins/cdr/external-js/ui/download-wiki\":{\"title\":\"$:/plugins/cdr/external-js/ui/download-wiki\",\"footer\":\"<$button message=\\\"tm-close-tiddler\\\">Close</$button>\",\"subtitle\":\"Download Wiki\",\"text\":\"\\\\import $:/plugins/cdr/external-js/filenames\\n\\nYou are downloading a wiki with its <$text text=\\\"TiddllyWiki\\\"/> core externalized. Make sure you have the following supporting file(s). Save them in the same location as the downloaded wiki.\\n\\n{{$:/plugins/cdr/external-js/ui/get-tiddlywiki-core}}\\n\\n<$reveal type=\\\"match\\\" state=\\\"$:/config/ExternalJS/EnableExternalPlugins\\\" text=\\\"yes\\\">\\n{{$:/plugins/cdr/external-js/ui/get-external-plugins}}\\n</$reveal>\\n\\n<div style=\\\"font-size:1.3em;margin-top:1.5em;\\\">\\nDownload <a class=\\\"tc-tiddlylink\\\" href=<<dataURL>> download=<<filename>>>this wiki</a>.\\n</div>\"},\"$:/plugins/cdr/external-js/ui/get-external-plugins\":{\"title\":\"$:/plugins/cdr/external-js/ui/get-external-plugins\",\"text\":\"<$set name=\\\"filename\\\" value={{{[subfilter<pluginsURL>split[/]last[]]}}}>\\n<$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">\\n<$action-sendmessage $message=\\\"tm-download-file\\\" $param=\\\"$:/plugins/cdr/external-js/templates/plugins.js\\\" filename=<<filename>>/>\\n{{$:/core/images/download-button}} <<filename>>\\n</$button>\\n</$set>\"},\"$:/plugins/cdr/external-js/ui/get-tiddlywiki-core\":{\"title\":\"$:/plugins/cdr/external-js/ui/get-tiddlywiki-core\",\"text\":\"<$set name=\\\"filename\\\" value={{{[subfilter<coreURL>split[/]last[]]}}}>\\n<$list filter=\\\"[[$:/boot/boot.js]!is[missing]]\\\">\\n\\t<$button class=\\\"tc-btn-invisible tc-tiddlylink\\\">\\n\\t<$action-sendmessage $message=\\\"tm-download-file\\\" $param=\\\"$:/core/templates/tiddlywiki5.js\\\" filename=<<filename>>/>\\n\\t{{$:/core/images/download-button}} <<filename>>\\n\\t</$button>\\n</$list>\\n<$list filter=\\\"[[$:/boot/boot.js]is[missing]]\\\">\\n\\t<$list filter=\\\"[[$:/plugins/tiddlywiki/tiddlyweb]!is[missing]]\\\">\\n\\t<button class=\\\"tc-btn-invisible\\\">\\n\\t<a class=\\\"tc-tiddlylink\\\" href=\\\"%24%3A%2Fcore%2Ftemplates%2Ftiddlywiki5.js\\\" download=<<filename>>>{{$:/core/images/download-button}} <<filename>></a>\\n\\t</button>\\n\\t</$list>\\n\\t<$list filter=\\\"[[$:/plugins/tiddlywiki/tiddlyweb]is[missing]]\\\">\\n\\t<button class=\\\"tc-btn-invisible\\\">\\n\\t<a class=\\\"tc-tiddlylink\\\" href=<<filename>> download={{{ [subfilter<coreURL>] }}} target=\\\"_blank\\\">{{$:/core/images/download-button}} <<filename>></a>&nbsp;&nbsp;//You may need to right-click the link and save it that way.//\\n\\t</button>\\n\\t</$list>\\n</$list>\\n</$set>\"},\"$:/plugins/cdr/external-js/ui/select-external-plugins\":{\"title\":\"$:/plugins/cdr/external-js/ui/select-external-plugins\",\"text\":\"\\\\import [[$:/plugins/cdr/external-js/filenames]]\\n\\n\\\\define addToExport()\\n<$action-listops $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"list\\\" $subfilter=\\\"\\\"\\\"[[$(currentTiddler)$]]\\\"\\\"\\\" />\\n<$action-setfield $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"original\\\" $value=\\\"no\\\"/>\\n\\\\end\\n\\n\\\\define removeFromExport()\\n<$action-listops $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"list\\\" $subfilter=\\\"\\\"\\\"-[[$(currentTiddler)$]]\\\"\\\"\\\" />\\n<$action-setfield $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"original\\\" $value=\\\"no\\\"/>\\n\\\\end\\n\\n\\\\define displayPluginName()\\n<$text text={{{ [<currentTiddler>get[name]] ~[<currentTiddler>split[/]last[]] }}}/>\\n\\\\end\\n\\n<div>\\n<p>\\n<$button>\\n<$list filter=\\\"\\\"\\\"[!has[draft.of]plugin-type[plugin]] -[[$:/core]] -[[$:/plugins/tiddlywiki/tiddlyweb]] -[[$:/plugins/tiddlywiki/filesystem]] [!has[draft.of]plugin-type[theme]]\\\"\\\"\\\">\\n<$action-setfield $tiddler=\\\"$:/temp/external-js/exports\\\" $index=<<currentTiddler>> $value=\\\"yes\\\"/>\\n<$action-listops $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"list\\\" $subfilter=\\\"\\\"\\\"[<currentTiddler>]\\\"\\\"\\\" />\\n</$list>\\n<$action-setfield $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"original\\\" $value=\\\"no\\\"/>\\nSelect All\\n</$button>\\n</p>\\n<$list filter=\\\"\\\"\\\"[!has[draft.of]plugin-type[plugin]sort[name]] -[[$:/core]] -[[$:/plugins/tiddlywiki/tiddlyweb]] -[[$:/plugins/tiddlywiki/filesystem]]\\\"\\\"\\\">\\n<$checkbox tiddler=\\\"$:/temp/external-js/exports\\\" index=<<currentTiddler>> checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\" checkactions=<<addToExport>> uncheckactions=<<removeFromExport>> > <<displayPluginName>></$checkbox><br/>\\n</$list>\\n<$list filter=\\\"\\\"\\\"[!has[draft.of]plugin-type[theme]sort[name]]\\\"\\\"\\\">\\n<$checkbox tiddler=\\\"$:/temp/external-js/exports\\\" index=<<currentTiddler>> checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\" checkactions=<<addToExport>> uncheckactions=<<removeFromExport>> > <<displayPluginName>> (theme)</$checkbox><br/>\\n</$list>\\n<p>\\n<$button class=\\\"tc-btn-download\\\" disabled={{{[{$:/temp/external-js/exports!!original}match[no]] ~[[yes]]}}}>\\n<$action-listops $tiddler=\\\"$:/config/ExternalJS/Exports\\\" $field=\\\"text\\\" $filter=\\\"\\\"\\\"[enlist{$:/temp/external-js/exports!!list}!is[missing]]\\\"\\\"\\\"/>\\n<$action-setfield $tiddler=\\\"$:/temp/external-js/exports\\\" $field=\\\"original\\\" $value=\\\"yes\\\"/>\\nConfirm Changes\\n</$button>\\n</p>\\n<p>Make sure the following list agrees with your selections above. (Have you forgotten to press \\\"Confirm Changes\\\"?)</p>\\n<p>\\nModules to be removed from your .html file:\\n<ul>\\n<$list filter=\\\"[enlist{$:/config/ExternalJS/Exports}plugin-type[plugin]sort[name]] [enlist{$:/config/ExternalJS/Exports}plugin-type[theme]sort[name]]\\\" emptyMessage=\\\"<li>(none)</li>\\\">\\n<li><<displayPluginName>></li>\\n</$list>\\n</ul>\\n</p>\\n<p>Download your plugins library. You need to re-download whenever the content of the library has changed.</p>\\n<p>\\n{{$:/plugins/cdr/external-js/ui/get-external-plugins}}\\n</p>\\nSave this file in the same location as your wiki.\\n</div>\"},\"$:/plugins/cdr/external-js/ui/setup-external-plugins\":{\"title\":\"$:/plugins/cdr/external-js/ui/setup-external-plugins\",\"text\":\"\\\\define clearExportList()\\n<$action-setfield $tiddler=\\\"$:/config/ExternalJS/Exports\\\" $field=\\\"text\\\" $value=\\\"\\\"/>\\n<$list filter=\\\"[[$:/temp/external-js/exports]indexes[]]\\\">\\n<$action-setfield $tiddler=\\\"$:/temp/external-js/exports\\\" $index=<<currentTiddler>> $value=\\\"no\\\"/>\\n</$list>\\n\\\\end\\n\\n\\\\define restoreExportList()\\n\\n<$checkbox tiddler=\\\"$:/config/ExternalJS/EnableExternalPlugins\\\" field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\" uncheckactions=<<clearExportList>> checkactions=<<restoreExportList>> >\\nExternalize plugins and themes\\n</$checkbox>\\n<p>\\n<$reveal type=\\\"match\\\" state=\\\"$:/config/ExternalJS/EnableExternalPlugins\\\" text=\\\"yes\\\">\\nSelect modules you'd like to load externally:\\n\\n{{$:/plugins/cdr/external-js/ui/select-external-plugins}}\\n</$reveal>\\n</p>\"},\"$:/plugins/cdr/external-js/ui/setup-savewiki\":{\"title\":\"$:/plugins/cdr/external-js/ui/setup-savewiki\",\"text\":\"\\\\whitespace trim\\n\\n<$button>\\n<$action-setfield $tiddler=\\\"$:/config/SaveWikiButton/Template\\\" text=\\\"$:/core/save/offline-external-js\\\"/>\\nexternal-js\\n</$button>\"},\"$:/plugins/cdr/external-js/usage\":{\"title\":\"$:/plugins/cdr/external-js/usage\",\"text\":\"\\\\import [[$:/plugins/cdr/external-js/filenames]]\\n\\n! <a id=\\\"#use-external-js\\\">Using external-js for standalone wikis</a>\\n\\nTo move <$text text=\\\"TiddlyWiki\\\"/> core and any plugins out of your standalone wiki:\\n\\n<ol>\\n<li style=\\\"margin-bottom:0.5em\\\">Make a backup copy of your wiki in case something goes wrong.</li>\\n\\n<li>If you don't have <code><$text text={{{[subfilter<coreURL>split[/]last[]]}}}/></code>, click on the following link to get a copy. Save it in the same location as your .html file. <p>{{$:/plugins/cdr/external-js/ui/get-tiddlywiki-core}}</p></li>\\n\\n<li>{{$:/plugins/cdr/external-js/ui/setup-external-plugins}}</li>\\n\\n<li>\\nPress {{$:/plugins/cdr/external-js/ui/setup-savewiki}} to switch to the external-js saving template.\\n<p>Verify the displayed value of $:/config/SaveWikiButton/Template is<br>`$:/core/save/offline-external-js`:\\n<pre style=\\\"margin-top:0.5px\\\"><$view tiddler=\\\"$:/config/SaveWikiButton/Template\\\" format=\\\"text\\\"/></pre></p>\\n</li>\\n\\n<li>Save your wiki.</li>\\n</ol>\\n\\n! Converting back to full wiki\\n\\nClick the following button to download the fully standalone version of this wiki:\\n<ul style=\\\"list-style:none\\\">\\n<li>\\n<$let tid=\\\"$:/plugins/cdr/external-js/ui/download-full-wiki\\\" tv-config-toolbar-icons=\\\"yes\\\" tv-config-toolbar-text=\\\"yes\\\" tv-config-toolbar-class=\\\"\\\">\\n<div class={{{ [<tid>encodeuricomponent[]addprefix[tc-btn-]] }}}>\\n<$transclude tiddler=<<tid>>/>&nbsp;&nbsp;<i><$transclude tiddler=<<tid>> field=\\\"description\\\"/></i>\\n</div>\\n</$let>\\n</li></ul>\\n\\nYou can also find this button on the ''Tools'' tab in the sidebar.\\n\\n! Upgrading your external-js wiki\\n\\n<ol>\\n<li>Convert your wiki back to the fully standalone version first (see above).</li>\\n<li>Then, proceed with the [[standalone wiki upgrade|https://tiddlywiki.com/#Upgrading]] process.</li>\\n<li>Repeat the <a class=\\\"tc-tiddlylink\\\" href=\\\"##use-external-js\\\"><strong>external-js conversion</strong></a> steps.</li>\\n<li>You can upgrade any remaining wikis that load the same libraries by manually editing all instances of the version string in the HTML files&mdash;provided that these wikis do not internally store any //official// plugins and themes. At the minimum, replace version numbers in the `<meta name=\\\"tiddlywiki-version\\\">` tag and in the `<script>` tags at the end of the file.</li>\\n</ol>\\n\\n! <$text text=\\\"TiddlyWiki\\\"/> on Node.js\\n\\nIf you are running <$text text=\\\"TiddlyWiki\\\"/> on Node.js and the content of the tiddler $:/config/SaveWikiButton/Template is set to `$:/core/save/offline-external-js`, then the snapshots you save for offline use will utilize the external-js template.\"}}}"
  },
  {
    "name": "Relink",
    "title": "$:/plugins/flibbles/relink",
    "description": "Flexibility when relinking renamed tiddlers",
    "author": "Flibbles",
    "version": "2.4.3",
    "core-version": ">=5.1.22",
    "source": "https://github.com/flibbles/tw5-relink",
    "demo": "http://flibbles.github.io/tw5-relink/",
    "list": "readme configuration license",
    "dependents": "",
    "plugin-type": "plugin",
    "type": "application/json",
    "text": "{\n    \"tiddlers\": {\n        \"$:/plugins/flibbles/relink/js/bulkops.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: startup\\n\\nReplaces the relinkTiddler defined in $:/core/modules/wiki-bulkops.js\\n\\nThis is a startup instead of a wikimethods module-type because it's the only\\nway to ensure this runs after the old relinkTiddler method is applied.\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar language = require('$:/plugins/flibbles/relink/js/language.js');\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils.js\\\");\\n\\nexports.name = \\\"redefine-relinkTiddler\\\";\\nexports.synchronous = true;\\n// load-modules is when wikimethods are applied in\\n// ``$:/core/modules/startup/load-modules.js``\\nexports.after = ['load-modules'];\\n// We come before commands because they may do renaming, or jasmine testing\\nexports.before = ['commands'];\\n\\nexports.startup = function() {\\n\\t$tw.Wiki.prototype.relinkTiddler = relinkTiddler;\\n};\\n\\n/** Walks through all relinkable tiddlers and relinks them.\\n *  This replaces the existing function in core Tiddlywiki.\\n */\\nfunction relinkTiddler(fromTitle, toTitle, options) {\\n\\toptions = options || {};\\n\\tvar failures = [];\\n\\tvar indexer = utils.getIndexer(this);\\n\\tvar records = indexer.relinkLookup(fromTitle, toTitle, options);\\n\\tvar changedTitles = Object.create(null);\\n\\tfor (var title in records) {\\n\\t\\tvar entries = records[title],\\n\\t\\t\\tchanges = Object.create(null),\\n\\t\\t\\tupdate = false,\\n\\t\\t\\tfails = false;\\n\\t\\tfor (var field in entries) {\\n\\t\\t\\tvar entry = entries[field];\\n\\t\\t\\tfails = fails || entry.impossible;\\n\\t\\t\\tif (entry.output !== undefined) {\\n\\t\\t\\t\\tchanges[field] = entry.output;\\n\\t\\t\\t\\tupdate = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (fails) {\\n\\t\\t\\tfailures.push(title);\\n\\t\\t}\\n\\t\\t// If any fields changed, update tiddler\\n\\t\\tif (update) {\\n\\t\\t\\tconsole.log(\\\"Renaming '\\\"+fromTitle+\\\"' to '\\\"+toTitle+\\\"' in '\\\" + title + \\\"'\\\");\\n\\n\\t\\t\\tvar tiddler = this.getTiddler(title);\\n\\t\\t\\tvar modifyField = utils.touchModifyField(this) ? this.getModificationFields() : undefined;\\n\\t\\t\\tvar newTiddler = new $tw.Tiddler(tiddler,changes,modifyField)\\n\\t\\t\\tnewTiddler = $tw.hooks.invokeHook(\\\"th-relinking-tiddler\\\",newTiddler,tiddler);\\n\\t\\t\\tthis.addTiddler(newTiddler);\\n\\t\\t\\t// If the title changed, we need to perform a nested rename\\n\\t\\t\\tif (newTiddler.fields.title !== title) {\\n\\t\\t\\t\\tchangedTitles[title] = newTiddler.fields.title;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t};\\n\\t// Now that the rename is complete, we must now rename any tiddlers that\\n\\t// changed their titles, and thus repeat the process.\\n\\tfor (var title in changedTitles) {\\n\\t\\tthis.deleteTiddler(title);\\n\\t\\tthis.relinkTiddler(title, changedTitles[title], options);\\n\\t}\\n\\tif (failures.length > 0) {\\n\\t\\tvar options = $tw.utils.extend(\\n\\t\\t\\t{ variables: {to: toTitle, from: fromTitle},\\n\\t\\t\\t  wiki: this},\\n\\t\\t\\toptions );\\n\\t\\tlanguage.reportFailures(failures, options);\\n\\t}\\n};\\n\\n})();\\n\",\n            \"module-type\": \"startup\",\n            \"title\": \"$:/plugins/flibbles/relink/js/bulkops.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/indexer.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: indexer\\n\\nIndexes results from tiddler reference reports so we don't have to call them\\nso much.\\n\\n\\\\*/\\n\\n\\\"use strict\\\";\\n\\nvar utils = require(\\\"./utils.js\\\");\\nvar TiddlerContext = utils.getContext('tiddler');\\n\\nfunction Indexer(wiki) {\\n\\tthis.wiki = wiki;\\n};\\n\\nIndexer.prototype.init = function() {\\n\\tthis.rebuild();\\n};\\n\\nIndexer.prototype.rebuild = function() {\\n\\tthis.index = null;\\n\\tthis.backIndex = null;\\n\\tthis.contexts = Object.create(null);\\n\\tthis.changedTiddlers = undefined;\\n\\tthis.lastRelinks = Object.create(null);\\n};\\n\\nIndexer.prototype.update = function(updateDescriptor) {\\n\\tif (!this.index) {\\n\\t\\treturn;\\n\\t}\\n\\tvar title;\\n\\tif (!this.changedTiddlers) {\\n\\t\\tthis.changedTiddlers = Object.create(null);\\n\\t}\\n\\tif (updateDescriptor.old.exists) {\\n\\t\\ttitle = updateDescriptor.old.tiddler.fields.title;\\n\\t\\tthis.changedTiddlers[title] = {deleted: true};\\n\\t\\tthis._purge(title);\\n\\t}\\n\\tif (updateDescriptor['new'].exists) {\\n\\t\\t// If its the same tiddler as old, this overrides the 'deleted' entry\\n\\t\\ttitle = updateDescriptor['new'].tiddler.fields.title;\\n\\t\\tthis.changedTiddlers[title] = {modified: true};\\n\\t}\\n};\\n\\nIndexer.prototype.lookup = function(title) {\\n\\tthis._upkeep();\\n\\treturn this.index[title];\\n};\\n\\nIndexer.prototype.reverseLookup = function(title) {\\n\\tthis._upkeep();\\n\\treturn this.backIndex[title] || Object.create(null);\\n};\\n\\nIndexer.prototype.relinkLookup = function(fromTitle, toTitle, options) {\\n\\tthis._upkeep();\\n\\tvar shortlist = undefined;\\n\\tvar lastRelink = this.lastRelinks[fromTitle];\\n\\tif (lastRelink) {\\n\\t\\tif (lastRelink.to === toTitle) {\\n\\t\\t\\t// We need to reintroduce the relink cache, where temporary info\\n\\t\\t\\t// was stored.\\n\\t\\t\\toptions.cache = lastRelink.cache;\\n\\t\\t\\treturn lastRelink.results;\\n\\t\\t}\\n\\t\\tshortlist = buildShortlist(lastRelink);\\n\\t}\\n\\tvar results = utils.getRelinkResults(this.wiki, fromTitle, toTitle, this.context, shortlist, options);\\n\\tif (Object.keys(this.lastRelinks).length > 3) {\\n\\t\\t// The cache got a little large. wipe it clean.\\n\\t\\tthis.lastRelinks = Object.create(null);\\n\\t}\\n\\tthis.lastRelinks[fromTitle] = {\\n\\t\\tfrom: fromTitle,\\n\\t\\tresults: results,\\n\\t\\tto: toTitle,\\n\\t\\tcache: options.cache,\\n\\t\\tmaybeRelevant: Object.create(null)};\\n\\treturn results;\\n};\\n\\n// Returns all tiddlers that don't have anything referencing it.\\nIndexer.prototype.orphans = function(options) {\\n\\tthis._upkeep();\\n\\tvar results = [];\\n\\tvar ignoreList = (options && options.ignore) || [];\\n\\tvar ignoreMap = Object.create(null);\\n\\tfor (var i = 0; i < ignoreList.length; i++) {\\n\\t\\tignoreMap[ignoreList[i]] = true;\\n\\t}\\n\\tfor (var title in this.index) {\\n\\t\\tvar index = this.backIndex[title];\\n\\t\\tvar owned = false;\\n\\t\\tif (index) {\\n\\t\\t\\tfor (var key in index) {\\n\\t\\t\\t\\tif (!ignoreMap[key]) {\\n\\t\\t\\t\\t\\towned = true;\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (!owned) {\\n\\t\\t\\tresults.push(title);\\n\\t\\t}\\n\\t}\\n\\treturn results;\\n};\\n\\nIndexer.prototype._upkeep = function() {\\n\\tvar title;\\n\\tif (this.changedTiddlers && (this.context.changed(this.changedTiddlers) || this.context.parent.changed(this.changedTiddlers))) {\\n\\t\\t// If global macro context or whitelist context changed, wipe all\\n\\t\\tthis.rebuild();\\n\\t}\\n\\tif (!this.index) {\\n\\t\\tthis.index = Object.create(null);\\n\\t\\tthis.backIndex = Object.create(null);\\n\\t\\tthis.context = utils.getWikiContext(this.wiki);\\n\\t\\tvar titles = this.wiki.getRelinkableTitles();\\n\\t\\tfor (var i = 0; i < titles.length; i++) {\\n\\t\\t\\tthis._populate(titles[i]);\\n\\t\\t};\\n\\t} else if (this.changedTiddlers) {\\n\\t\\t// If there are cached changes, we apply them now.\\n\\t\\tfor (title in this.contexts) {\\n\\t\\t\\tvar tiddlerContext = this.contexts[title];\\n\\t\\t\\tif (tiddlerContext.changed(this.changedTiddlers)) {\\n\\t\\t\\t\\tthis._purge(title);\\n\\t\\t\\t\\tthis._populate(title);\\n\\t\\t\\t\\tthis._decacheRelink(title);\\n\\t\\t\\t\\t// Wipe this change, so we don't risk updating it twice.\\n\\t\\t\\t\\tthis.changedTiddlers[title] = undefined;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tfor (title in this.changedTiddlers) {\\n\\t\\t\\tvar change = this.changedTiddlers[title];\\n\\t\\t\\tif (change && change.modified) {\\n\\t\\t\\t\\tthis._purge(title);\\n\\t\\t\\t\\tthis._populate(title);\\n\\t\\t\\t\\tthis._decacheRelink(title);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tthis.changedTiddlers = undefined;\\n\\t}\\n};\\n\\nIndexer.prototype._purge = function(title) {\\n\\tfor (var entry in this.index[title]) {\\n\\t\\tdelete this.backIndex[entry][title];\\n\\t}\\n\\tdelete this.contexts[title];\\n\\tdelete this.index[title];\\n};\\n\\n// This drops the cached relink results if unsanctioned tiddlers were changed\\nIndexer.prototype._decacheRelink = function(title) {\\n\\tvar tiddler = this.wiki.getTiddler(title);\\n\\tfor (var from in this.lastRelinks) {\\n\\t\\tvar lastRelink = this.lastRelinks[from];\\n\\t\\tif (title !== from\\n\\t\\t&& title !== lastRelink.to\\n\\t\\t&& (!tiddler\\n\\t\\t|| !$tw.utils.hop(tiddler.fields, 'draft.of') // is a draft\\n\\t\\t|| tiddler.fields['draft.of'] !== from// draft of target\\n\\t\\t|| references(this.index[title], from))) { // draft references target\\n\\t\\t\\t// This is not the draft of the last relinked title,\\n\\t\\t\\t// so our cached results should be wiped.\\n\\t\\t\\tlastRelink.maybeRelevant[title] = true;\\n\\t\\t\\t// Force this cached relink to partially refresh when it comes time\\n\\t\\t\\tlastRelink.to = undefined;\\n\\t\\t}\\n\\t}\\n};\\n\\nfunction references(list, item) {\\n\\treturn list !== undefined && list[item];\\n};\\n\\n// Compiles a short list of tiddlers we need to check for a rename.\\n// This list will be much faster to relink again.\\nfunction buildShortlist(lastRelink) {\\n\\tvar shortlist = Object.keys(lastRelink.results);\\n\\tfor (var title in lastRelink.maybeRelevant) {\\n\\t\\tif (lastRelink.results[title] === undefined) {\\n\\t\\t\\tshortlist.push(title);\\n\\t\\t}\\n\\t}\\n\\treturn shortlist;\\n};\\n\\nIndexer.prototype._populate = function(title) {\\n\\t// Fetch the report for a title, and populate the indexes with result\\n\\tvar tiddlerContext = new TiddlerContext(this.wiki, this.context, title);\\n\\tvar references = utils.getTiddlerRelinkReferences(this.wiki, title, tiddlerContext);\\n\\tthis.index[title] = references;\\n\\tif (tiddlerContext.hasImports()) {\\n\\t\\tthis.contexts[title] = tiddlerContext;\\n\\t}\\n\\tfor (var ref in references) {\\n\\t\\tthis.backIndex[ref] = this.backIndex[ref] || Object.create(null);\\n\\t\\tthis.backIndex[ref][title] = references[ref];\\n\\t}\\n};\\n\\nexports.RelinkIndexer = Indexer;\\n\",\n            \"module-type\": \"indexer\",\n            \"title\": \"$:/plugins/flibbles/relink/js/indexer.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/language.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: library\\n\\nThis handles all logging and alerts Relink emits.\\n\\n\\\\*/\\n\\nexports.getString = function(outputType, title, options) {\\n\\ttitle = \\\"$:/plugins/flibbles/relink/language/\\\" + title;\\n\\treturn options.wiki.renderTiddler(outputType, title, options);\\n};\\n\\nvar logger;\\n\\nexports.warn = function(string, options) {\\n\\tif (!logger) {\\n\\t\\tlogger = new $tw.utils.Logger(\\\"Relinker\\\");\\n\\t}\\n\\tlogger.alert(string);\\n};\\n\\nexports.reportFailures = function(failureList, options) {\\n\\tvar alertString = this.getString(\\\"text/html\\\", \\\"Error/ReportFailedRelinks\\\", options)\\n\\tvar alreadyReported = Object.create(null);\\n\\tvar reportList = [];\\n\\t$tw.utils.each(failureList, function(f) {\\n\\t\\tif (!alreadyReported[f]) {\\n\\t\\t\\tif ($tw.browser) {\\n\\t\\t\\t\\t// This might not make the link if the title is complicated.\\n\\t\\t\\t\\t// Whatever.\\n\\t\\t\\t\\treportList.push(\\\"\\\\n* [[\\\" + f + \\\"]]\\\");\\n\\t\\t\\t} else {\\n\\t\\t\\t\\treportList.push(\\\"\\\\n* \\\" + f);\\n\\t\\t\\t}\\n\\t\\t\\talreadyReported[f] = true;\\n\\t\\t}\\n\\t});\\n\\tthis.warn(alertString + \\\"\\\\n\\\" + reportList.join(\\\"\\\"));\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/language.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/mangler.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: widget\\n\\nCreates a mangler widget for field validation. This isn't meant to be used\\nby the user. It's only used in Relink configuration.\\n\\n\\\\*/\\n\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\nvar language = require('$:/plugins/flibbles/relink/js/language.js');\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nvar RelinkManglerWidget = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n\\tthis.addEventListeners([\\n\\t\\t{type: \\\"relink-add-field\\\", handler: \\\"handleAddFieldEvent\\\"},\\n\\t\\t{type: \\\"relink-add-operator\\\", handler: \\\"handleAddOperatorEvent\\\"},\\n\\t\\t{type: \\\"relink-add-parameter\\\", handler: \\\"handleAddParameterEvent\\\"},\\n\\t\\t{type: \\\"relink-add-attribute\\\", handler: \\\"handleAddAttributeEvent\\\"}\\n\\t]);\\n};\\n\\nexports.relinkmangler = RelinkManglerWidget;\\n\\nRelinkManglerWidget.prototype = new Widget();\\n\\n// This wraps alert so it can be monkeypatched during testing.\\nRelinkManglerWidget.prototype.alert = function(message) {\\n\\talert(message);\\n};\\n\\nRelinkManglerWidget.prototype.handleAddFieldEvent = function(event) {\\n\\tvar param = event.paramObject;\\n\\tif (typeof param !== \\\"object\\\" || !param.field) {\\n\\t\\t// Can't handle it.\\n\\t\\treturn true;\\n\\t}\\n\\tvar trimmedName = param.field.trim();\\n\\tif (!trimmedName) {\\n\\t\\t// Still can't handle it, but don't warn.\\n\\t\\treturn true;\\n\\t}\\n\\tif(!$tw.utils.isValidFieldName(trimmedName)) {\\n\\t\\tthis.alert($tw.language.getString(\\n\\t\\t\\t\\\"InvalidFieldName\\\",\\n\\t\\t\\t{variables:\\n\\t\\t\\t\\t{fieldName: trimmedName}\\n\\t\\t\\t}\\n\\t\\t));\\n\\t} else {\\n\\t\\tadd(this.wiki, \\\"fields\\\", trimmedName);\\n\\t}\\n\\treturn true;\\n};\\n\\n/**Not much validation, even though there are definitely illegal\\n * operator names. If you input on, Relink won't relink it, but it\\n * won't choke on it either. Tiddlywiki will...\\n */\\nRelinkManglerWidget.prototype.handleAddOperatorEvent = function(event) {\\n\\tvar param = event.paramObject;\\n\\tif (param) {\\n\\t\\tadd(this.wiki, \\\"operators\\\", param.operator);\\n\\t}\\n\\treturn true;\\n};\\n\\nRelinkManglerWidget.prototype.handleAddParameterEvent = function(event) {\\n\\tvar param = event.paramObject;\\n\\tif (param && param.macro && param.parameter) {\\n\\t\\tif (/\\\\s/.test(param.macro.trim())) {\\n\\t\\t\\tthis.alert(language.getString(\\n\\t\\t\\t\\t\\\"text/plain\\\",\\n\\t\\t\\t\\t\\\"Error/InvalidMacroName\\\",\\n\\t\\t\\t\\t{ variables: {macroName: param.macro},\\n\\t\\t\\t\\t  wiki: this.wiki\\n\\t\\t\\t\\t}\\n\\t\\t\\t));\\n\\t\\t} else if (/[ \\\\/]/.test(param.parameter.trim())) {\\n\\t\\t\\tthis.alert(language.getString(\\n\\t\\t\\t\\t\\\"text/plain\\\",\\n\\t\\t\\t\\t\\\"Error/InvalidParameterName\\\",\\n\\t\\t\\t\\t{ variables: {parameterName: param.parameter},\\n\\t\\t\\t\\t  wiki: this.wiki\\n\\t\\t\\t\\t}\\n\\t\\t\\t));\\n\\t\\t} else {\\n\\t\\t\\tadd(this.wiki, \\\"macros\\\", param.macro, param.parameter);\\n\\t\\t}\\n\\t}\\n\\treturn true;\\n};\\n\\nRelinkManglerWidget.prototype.handleAddAttributeEvent = function(event) {\\n\\tvar param = event.paramObject;\\n\\tif (param && param.element && param.attribute) {\\n\\t\\tif (/[ \\\\/]/.test(param.element.trim())) {\\n\\t\\t\\tthis.alert(language.getString(\\n\\t\\t\\t\\t\\\"text/plain\\\",\\n\\t\\t\\t\\t\\\"Error/InvalidElementName\\\",\\n\\t\\t\\t\\t{ variables: {elementName: param.element},\\n\\t\\t\\t\\t  wiki: this.wiki\\n\\t\\t\\t\\t}\\n\\t\\t\\t));\\n\\t\\t} else if (/[ \\\\/]/.test(param.attribute.trim())) {\\n\\t\\t\\tthis.alert(language.getString(\\n\\t\\t\\t\\t\\\"text/plain\\\",\\n\\t\\t\\t\\t\\\"Error/InvalidAttributeName\\\",\\n\\t\\t\\t\\t{ variables: {attributeName: param.attribute},\\n\\t\\t\\t\\t  wiki: this.wiki\\n\\t\\t\\t\\t}\\n\\t\\t\\t));\\n\\t\\t} else {\\n\\t\\t\\tadd(this.wiki, \\\"attributes\\\", param.element, param.attribute);\\n\\t\\t}\\n\\t}\\n\\treturn true;\\n};\\n\\nfunction add(wiki, category/*, path parts*/) {\\n\\tvar path = \\\"$:/config/flibbles/relink/\\\" + category;\\n\\tfor (var x = 2; x < arguments.length; x++) {\\n\\t\\tvar part = arguments[x];\\n\\t\\t// Abort if it's falsy, or only whitespace. Also, trim spaces\\n\\t\\tif (!part || !(part = part.trim())) {\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tpath = path + \\\"/\\\" + part;\\n\\t}\\n\\tvar def = utils.getDefaultType(wiki);\\n\\twiki.addTiddler({title: path, text: def});\\n};\\n\",\n            \"module-type\": \"widget\",\n            \"title\": \"$:/plugins/flibbles/relink/js/mangler.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: library\\n\\nThis handles the fetching and distribution of relink settings.\\n\\n\\\\*/\\n\\nvar utils = require('./utils');\\n\\n///// Legacy. You used to be able to access the type from utils.\\nexports.getType = utils.getType;\\n/////\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: library\\n\\nUtility methods for relink.\\n\\n\\\\*/\\n\\nvar macroFilter =  \\\"[[$:/core/ui/PageMacros]] [all[shadows+tiddlers]tag[$:/tags/Macro]!has[draft.of]] [all[shadows+tiddlers]tag[$:/tags/Global]!has[draft.of]]\\\";\\n\\n/**This works nearly identically to $tw.modules.getModulesByTypeAsHashmap\\n * except that this also takes care of migrating V1 relink modules.\\n */\\nexports.getModulesByTypeAsHashmap = function(moduleType, nameField) {\\n\\tvar results = Object.create(null);\\n\\t$tw.modules.forEachModuleOfType(moduleType, function(title, module) {\\n\\t\\tvar key = module[nameField];\\n\\t\\tif (key !== undefined) {\\n\\t\\t\\tresults[key] = module;\\n\\t\\t} else {\\n\\t\\t\\tfor (var entry in module) {\\n\\t\\t\\t\\tresults[entry] = {\\n\\t\\t\\t\\t\\trelink: module[entry],\\n\\t\\t\\t\\t\\treport: function() {}};\\n\\t\\t\\t\\tresults[entry][nameField] = entry;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n\\t// We've got to sort these so that behavior is consistent across different\\n\\t// versions of TiddlyMap, whose module return order depends on version...\\n\\treturn sortModules(results);\\n};\\n\\nfunction sortModules(moduleMap) {\\n\\tvar keys = Object.keys(moduleMap);\\n\\tvar sortedResults = Object.create(null);\\n\\tkeys.sort();\\n\\tfor (var i = 0; i < keys.length; i++) {\\n\\t\\tvar key = keys[i];\\n\\t\\tif (moduleMap[key].after\\n\\t\\t&& moduleMap[key].after.some(function(requirement) { return !sortedResults[requirement]})) {\\n\\t\\t\\t// Not all requirements have been met yet.\\n\\t\\t\\t$tw.utils.pushTop(keys, key);\\n\\t\\t\\ti--;\\n\\t\\t} else {\\n\\t\\t\\tsortedResults[key] = moduleMap[key];\\n\\t\\t}\\n\\t}\\n\\treturn sortedResults;\\n};\\n\\nexports.getTiddlerRelinkReferences = function(wiki, title, context) {\\n\\tvar tiddler = wiki.getTiddler(title),\\n\\t\\treferences = Object.create(null),\\n\\t\\toptions = {settings: context, wiki: wiki};\\n\\tif (tiddler) {\\n\\t\\ttry {\\n\\t\\t\\tfor (var relinker in getRelinkOperators()) {\\n\\t\\t\\t\\tgetRelinkOperators()[relinker].report(tiddler, function(title, blurb, style) {\\n\\t\\t\\t\\t\\treferences[title] = references[title] || [];\\n\\t\\t\\t\\t\\treferences[title].push($tw.utils.extend({blurb: blurb || ''}, style));\\n\\t\\t\\t\\t}, options);\\n\\t\\t\\t}\\n\\t\\t} catch (e) {\\n\\t\\t\\tif (e.message) {\\n\\t\\t\\t\\te.message = e.message + \\\"\\\\nWhen reporting '\\\" + title + \\\"' Relink references\\\";\\n\\t\\t\\t}\\n\\t\\t\\tthrow e;\\n\\t\\t}\\n\\t}\\n\\treturn references;\\n};\\n\\n/** Returns a pair like this,\\n *  { title: {field: entry, ... }, ... }\\n */\\nexports.getRelinkResults = function(wiki, fromTitle, toTitle, context, tiddlerList, options) {\\n\\toptions = options || {};\\n\\toptions.wiki = options.wiki || wiki;\\n\\tfromTitle = (fromTitle || \\\"\\\").trim();\\n\\ttoTitle = (toTitle || \\\"\\\").trim();\\n\\tvar changeList = Object.create(null);\\n\\tif(fromTitle && toTitle !== undefined) {\\n\\t\\tif (tiddlerList === undefined) {\\n\\t\\t\\ttiddlerList = wiki.getRelinkableTitles();\\n\\t\\t}\\n\\t\\tfor (var i = 0; i < tiddlerList.length; i++) {\\n\\t\\t\\tvar title = tiddlerList[i];\\n\\t\\t\\tvar tiddler = wiki.getTiddler(title);\\n\\t\\t\\tif(tiddler) {\\n\\t\\t\\t\\ttry {\\n\\t\\t\\t\\t\\tvar entries = Object.create(null),\\n\\t\\t\\t\\t\\t\\toperators = getRelinkOperators();\\n\\t\\t\\t\\t\\toptions.settings = new Contexts.tiddler(wiki, context, title);\\n\\t\\t\\t\\t\\tfor (var operation in operators) {\\n\\t\\t\\t\\t\\t\\toperators[operation].relink(tiddler, fromTitle, toTitle, entries, options);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tfor (var field in entries) {\\n\\t\\t\\t\\t\\t\\t// So long as there is one key,\\n\\t\\t\\t\\t\\t\\t// add it to the change list.\\n\\t\\t\\t\\t\\t\\tif (tiddler.fields[\\\"plugin-type\\\"]) {\\n\\t\\t\\t\\t\\t\\t\\t// We never change plugins, even if they have links\\n\\t\\t\\t\\t\\t\\t\\tchangeList[title] = {};\\n\\t\\t\\t\\t\\t\\t\\tchangeList[title][field] = {impossible: true};\\n\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\tchangeList[title] = entries;\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t} catch (e) {\\n\\t\\t\\t\\t\\t// Should we test for instanceof Error instead?: yes\\n\\t\\t\\t\\t\\t// Does that work in the testing environment?: no\\n\\t\\t\\t\\t\\tif (e.message) {\\n\\t\\t\\t\\t\\t\\te.message = e.message + \\\"\\\\nWhen relinking '\\\" + title + \\\"'\\\";\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tthrow e;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn changeList;\\n};\\n\\nvar Contexts = $tw.modules.applyMethods('relinkcontext');\\n\\nexports.getContext = function(name) {\\n\\treturn Contexts[name];\\n};\\n\\nexports.getWikiContext = function(wiki) {\\n\\t// This gives a fresh context every time. It is up to the indexer or\\n\\t// the cache to preserve those contexts for as long as needed.\\n\\tvar whitelist = new Contexts.whitelist(wiki);\\n\\treturn new Contexts.import(wiki, whitelist, macroFilter);\\n};\\n\\n/** Returns the Relink indexer, or a dummy object which pretends to be one.\\n */\\nexports.getIndexer = function(wiki) {\\n\\tif (!wiki._relink_indexer) {\\n\\t\\twiki._relink_indexer = (wiki.getIndexer && wiki.getIndexer(\\\"RelinkIndexer\\\")) || new (require('$:/plugins/flibbles/relink/js/utils/backupIndexer.js'))(wiki);\\n\\t}\\n\\treturn wiki._relink_indexer;\\n};\\n\\n/**Relinking supports a cache that persists throughout a whole relink op.\\n * This is because the Tiddlywiki caches may get wiped multiple times\\n * throughout the course of a relink.\\n */\\nexports.getCacheForRun = function(options, cacheName, initializer) {\\n\\toptions.cache = options.cache || Object.create(null);\\n\\tif (!$tw.utils.hop(options.cache, cacheName)) {\\n\\t\\toptions.cache[cacheName] = initializer();\\n\\t}\\n\\treturn options.cache[cacheName];\\n};\\n\\n/**Returns a specific relinker.\\n * This is useful for wikitext rules which need to parse a filter or a list\\n */\\nexports.getType = function(name) {\\n\\tvar Handler = getFieldTypes()[name];\\n\\treturn Handler ? new Handler() : undefined;\\n};\\n\\nexports.getTypes = function() {\\n\\t// We don't return fieldTypes, because we don't want it modified,\\n\\t// and we need to filter out legacy names.\\n\\tvar rtn = Object.create(null);\\n\\tfor (var type in getFieldTypes()) {\\n\\t\\tvar typeObject = getFieldTypes()[type];\\n\\t\\trtn[typeObject.typeName] = typeObject;\\n\\t}\\n\\treturn rtn;\\n};\\n\\nexports.getDefaultType = function(wiki) {\\n\\tvar tiddler = wiki.getTiddler(\\\"$:/config/flibbles/relink/settings/default-type\\\");\\n\\tvar defaultType = tiddler && tiddler.fields.text;\\n\\t// make sure the default actually exists, otherwise default\\n\\treturn fieldTypes[defaultType] ? defaultType : \\\"title\\\";\\n};\\n\\nexports.abridgeString = function(string, maxLength, truncLength) {\\n\\tif (typeof string === \\\"string\\\") {\\n\\t\\tmaxLength = maxLength || 3;\\n\\t\\tif (truncLength === undefined) {\\n\\t\\t\\ttruncLength = maxLength-3;\\n\\t\\t}\\n\\t\\tstring = string.replace(/\\\\s+/g, \\\" \\\").trim();\\n\\t\\treturn (string.length > maxLength)? string.substr(0, truncLength) + \\\"...\\\" : string;\\n\\t}\\n\\treturn string;\\n};\\n\\nexports.touchModifyField = function(wiki) {\\n\\tvar tiddler = wiki.getTiddler(\\\"$:/config/flibbles/relink/touch-modify\\\");\\n\\treturn tiddler && tiddler.fields.text.trim() === \\\"yes\\\";\\n};\\n\\n/**Given some text, and a param or  attribute within that text, this returns\\n * what type of quotation that attribute is using.\\n *\\n * param: An object in the form {end:, ...}\\n */\\nexports.determineQuote = function(text, param) {\\n\\tvar pos = param.end-1;\\n\\tif (text[pos] === \\\"'\\\") {\\n\\t\\treturn \\\"'\\\";\\n\\t}\\n\\tif (text[pos] === '\\\"') {\\n\\t\\tif (text.substr(pos-2, 3) === '\\\"\\\"\\\"') {\\n\\t\\t\\treturn '\\\"\\\"\\\"';\\n\\t\\t} else {\\n\\t\\t\\treturn '\\\"';\\n\\t\\t}\\n\\t}\\n\\tif (text.substr(pos-1,2) === ']]' && text.substr((pos-param.value.length)-3, 2) === '[[') {\\n\\t\\treturn \\\"[[\\\";\\n\\t}\\n\\treturn '';\\n};\\n\\nvar fieldTypes;\\n\\nfunction getFieldTypes() {\\n\\tif (!fieldTypes) {\\n\\t\\tfieldTypes = Object.create(null);\\n\\t\\t$tw.modules.forEachModuleOfType(\\\"relinkfieldtype\\\", function(title, exports) {\\n\\t\\t\\tfunction NewType() {};\\n\\t\\t\\tNewType.prototype = exports;\\n\\t\\t\\tNewType.typeName = exports.name;\\n\\t\\t\\tfieldTypes[exports.name] = NewType;\\n\\t\\t\\t// For legacy, if the NewType doesn't have a report method, we add one\\n\\t\\t\\tif (!exports.report) {\\n\\t\\t\\t\\texports.report = function() {};\\n\\t\\t\\t}\\n\\t\\t\\t// Also for legacy, some of the field types can go by other names\\n\\t\\t\\tif (exports.aliases) {\\n\\t\\t\\t\\t$tw.utils.each(exports.aliases, function(alias) {\\n\\t\\t\\t\\t\\tfieldTypes[alias] = NewType;\\n\\t\\t\\t\\t});\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}\\n\\treturn fieldTypes;\\n}\\n\\nvar relinkOperators;\\n\\nfunction getRelinkOperators() {\\n\\tif (!relinkOperators) {\\n\\t\\trelinkOperators = exports.getModulesByTypeAsHashmap('relinkoperator', 'name');\\n\\t}\\n\\treturn relinkOperators;\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/wikimethods.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: wikimethod\\n\\nIntroduces some utility methods used by Relink.\\n\\n\\\\*/\\n\\nvar utils = require(\\\"./utils.js\\\");\\n\\nexports.getTiddlerRelinkReferences = function(title, options) {\\n\\tvar refs = utils.getIndexer(this).lookup(title);\\n\\treturn refs && blurbs(refs, options && options.hard);\\n};\\n\\nexports.getTiddlerRelinkBackreferences = function(title) {\\n\\tvar refs = utils.getIndexer(this).reverseLookup(title);\\n\\t// For now, I don't have the equivalent \\\"hard\\\" option because I'm not\\n\\t// sure it has any value. May change this later.\\n\\treturn blurbs(refs);\\n};\\n\\nexports.getRelinkableTitles = function() {\\n\\tvar toUpdate = \\\"$:/config/flibbles/relink/to-update\\\";\\n\\tvar wiki = this;\\n\\treturn this.getCacheForTiddler(toUpdate, \\\"relink-toUpdate\\\", function() {\\n\\t\\tvar tiddler = wiki.getTiddler(toUpdate);\\n\\t\\tif (tiddler) {\\n\\t\\t\\treturn wiki.compileFilter(tiddler.fields.text);\\n\\t\\t} else {\\n\\t\\t\\treturn wiki.allTitles;\\n\\t\\t}\\n\\t})();\\n};\\n\\nexports.getRelinkOrphans = function(options) {\\n\\treturn utils.getIndexer(this).orphans(options);\\n};\\n\\nfunction blurbs(refs, hardOnly) {\\n\\tvar blurbsOnly = Object.create(null);\\n\\tfor (var title in refs) {\\n\\t\\tfor (var i = 0; i < refs[title].length; i++) {\\n\\t\\t\\tvar record = refs[title][i];\\n\\t\\t\\tif (!hardOnly || !record.soft) {\\n\\t\\t\\t\\tblurbsOnly[title] = blurbsOnly[title] || [];\\n\\t\\t\\t\\tblurbsOnly[title].push(record.blurb);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn blurbsOnly;\\n};\\n\",\n            \"module-type\": \"wikimethod\",\n            \"title\": \"$:/plugins/flibbles/relink/js/wikimethods.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/all_relinkable.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: allfilteroperator\\n\\nFilter function for [all[relinkable]].\\nReturns all tiddlers subject to relinking.\\n\\n\\\\*/\\n\\n(function() {\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.relinkable = function(source,prefix,options) {\\n\\treturn options.wiki.getRelinkableTitles();\\n};\\n\\n})();\\n\",\n            \"module-type\": \"allfilteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/all_relinkable.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/orphans.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkfilteroperator\\n\\nFilter function for [relink:orphans[]].\\nReturns all tiddlers which are not referenced in any way\\n\\n\\\\*/\\n\\n(function() {\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.orphans = function(source,prefix,options) {\\n\\treturn options.wiki.getRelinkOrphans({ignore: ['$:/StoryList']});\\n};\\n\\n})();\\n\",\n            \"module-type\": \"relinkfilteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/orphans.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/references.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkfilteroperator\\n\\nGiven a title as an operand, returns all non-shadow tiddlers that have any\\nsort of updatable reference to it.\\n\\n`relink:backreferences[]]`\\n`relink:references[]]`\\n\\nReturns all tiddlers that reference `fromTiddler` somewhere inside them.\\n\\nInput is ignored. Maybe it shouldn't do this.\\n\\\\*/\\n\\nvar LinkedList = $tw.utils.LinkedList;\\n\\nif (!LinkedList) {\\n\\t/* If the linked list isn't available, make a quick crappy version. */\\n\\tLinkedList = function() {this.array=[];};\\n\\n\\tLinkedList.prototype.pushTop = function(array) {\\n\\t\\t$tw.utils.pushTop(this.array, array);\\n\\t};\\n\\n\\tLinkedList.prototype.toArray = function() {\\n\\t\\treturn this.array;\\n\\t};\\n};\\n\\nexports.backreferences = function(source,operator,options) {\\n\\tvar results = new LinkedList();\\n\\tsource(function(tiddler,title) {\\n\\t\\tresults.pushTop(Object.keys(options.wiki.getTiddlerRelinkBackreferences(title,options)));\\n\\t});\\n\\treturn results.toArray();\\n};\\n\\nexports.references = function(source,operator,options) {\\n\\tvar results = new LinkedList();\\n\\tif (operator.suffix === 'hard') {\\n\\t\\toptions = Object.create(options);\\n\\t\\toptions.hard = true;\\n\\t}\\n\\tsource(function(tiddler,title) {\\n\\t\\tvar refs = options.wiki.getTiddlerRelinkReferences(title,options);\\n\\t\\tif (refs) {\\n\\t\\t\\tresults.pushTop(Object.keys(refs));\\n\\t\\t}\\n\\t});\\n\\treturn results.toArray();\\n};\\n\",\n            \"module-type\": \"relinkfilteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/references.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/relink.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: filteroperator\\n\\nThis filter acts as a namespace for several small, simple filters, such as\\n\\n`[relink:impossible[]]`\\n\\n\\\\*/\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar language = require('$:/plugins/flibbles/relink/js/language.js');\\n\\nvar relinkFilterOperators;\\n\\nfunction getRelinkFilterOperators() {\\n\\tif(!relinkFilterOperators) {\\n\\t\\trelinkFilterOperators = {};\\n\\t\\t$tw.modules.applyMethods(\\\"relinkfilteroperator\\\",\\n\\t\\t                         relinkFilterOperators);\\n\\t}\\n\\treturn relinkFilterOperators;\\n}\\n\\nexports.relink = function(source,operator,options) {\\n\\tvar suffixPair = parseSuffix(operator.suffix);\\n\\tvar relinkFilterOperator = getRelinkFilterOperators()[suffixPair[0]];\\n\\tif (relinkFilterOperator) {\\n\\t\\tvar newOperator = $tw.utils.extend({}, operator);\\n\\t\\tnewOperator.suffix = suffixPair[1];\\n\\t\\treturn relinkFilterOperator(source, newOperator, options);\\n\\t} else {\\n\\t\\treturn [language.getString(\\\"text/plain\\\", \\\"Error/RelinkFilterOperator\\\", options)];\\n\\t}\\n};\\n\\nfunction parseSuffix(suffix) {\\n\\tvar index = suffix? suffix.indexOf(\\\":\\\"): -1;\\n\\tif (index >= 0) {\\n\\t\\treturn [suffix.substr(0, index), suffix.substr(index+1)];\\n\\t} else {\\n\\t\\treturn [suffix];\\n\\t}\\n}\\n\",\n            \"module-type\": \"filteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/relink.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/report.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkfilteroperator\\n\\nGiven a title as an operand, returns a string for each occurrence of that title\\nwithin each input title.\\n\\n[[title]] +[relink:report[fromTiddler]]`\\n\\nReturns string representation of fromTiddler occurrences in title.\\n\\\\*/\\n\\nexports.report = function(source,operator,options) {\\n\\tvar fromTitle = operator.operand,\\n\\t\\tresults = [];\\n\\tif (fromTitle) {\\n\\t\\tvar blurbs = options.wiki.getTiddlerRelinkBackreferences(fromTitle);\\n\\t\\tsource(function(tiddler, title) {\\n\\t\\t\\tif (blurbs[title]) {\\n\\t\\t\\t\\tresults = results.concat(blurbs[title]);\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}\\n\\treturn results;\\n};\\n\",\n            \"module-type\": \"relinkfilteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/report.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/signatures.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkfilteroperator\\n\\nThis filter returns all input tiddlers which are a source of\\nrelink configuration.\\n\\n`[all[tiddlers+system]relink:source[macros]]`\\n\\n\\\\*/\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nexports.signatures = function(source,operator,options) {\\n\\tvar plugin = operator.operand || null;\\n\\tvar set = getSet(options);\\n\\tif (plugin === \\\"$:/core\\\") {\\n\\t\\t// Core doesn't actually have any settings. We mean Relink\\n\\t\\tplugin = \\\"$:/plugins/flibbles/relink\\\";\\n\\t}\\n\\tvar signatures = [];\\n\\tfor (var signature in set) {\\n\\t\\tvar source = set[signature].source;\\n\\t\\tif (options.wiki.getShadowSource(source) === plugin) {\\n\\t\\t\\tsignatures.push(signature);\\n\\t\\t}\\n\\t}\\n\\treturn signatures;\\n};\\n\\nexports.type = function(source,operator,options) {\\n\\tvar results = [];\\n\\tvar set = getSet(options);\\n\\tsource(function(tiddler, signature) {\\n\\t\\tif (set[signature]) {\\n\\t\\t\\tresults.push(set[signature].name);\\n\\t\\t}\\n\\t});\\n\\treturn results;\\n};\\n\\nexports.types = function(source,operator,options) {\\n\\tvar def = utils.getDefaultType(options.wiki);\\n\\tvar types = Object.keys(utils.getTypes());\\n\\ttypes.sort();\\n\\t// move default to front\\n\\ttypes.sort(function(x,y) { return x === def ? -1 : y === def ? 1 : 0; });\\n\\treturn types;\\n};\\n\\nexports.source = function(source,operator,options) {\\n\\tvar results = [];\\n\\tvar category = operator.suffix;\\n\\tvar set = getSet(options);\\n\\tsource(function(tiddler, signature) {\\n\\t\\tif (set[signature]) {\\n\\t\\t\\tresults.push(set[signature].source);\\n\\t\\t}\\n\\t});\\n\\treturn results;\\n};\\n\\nfunction getSet(options) {\\n\\treturn options.wiki.getGlobalCache(\\\"relink-signatures\\\", function() {\\n\\t\\tvar config = utils.getWikiContext(options.wiki);\\n\\t\\tvar set = Object.create(null);\\n\\t\\tvar categories = {\\n\\t\\t\\tattributes: config.getAttributes(),\\n\\t\\t\\tfields: config.getFields(),\\n\\t\\t\\tmacros: config.getMacros(),\\n\\t\\t\\toperators: config.getOperators()};\\n\\t\\t$tw.utils.each(categories, function(list, category) {\\n\\t\\t\\t$tw.utils.each(list, function(item, key) {\\n\\t\\t\\t\\tset[category + \\\"/\\\" + key] = item;\\n\\t\\t\\t});\\n\\t\\t});\\n\\t\\treturn set;\\n\\t});\\n};\\n\",\n            \"module-type\": \"relinkfilteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/signatures.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/splitafter.js\": {\n            \"text\": \"/*\\\\\\ntitle: $:/core/modules/filters/splitbefore.js\\ntype: application/javascript\\nmodule-type: relinkfilteroperator\\n\\nFilter operator that splits each result on the last occurance of the specified separator and returns the last bit.\\n\\nWhat does this have to do with relink? Nothing. I need this so I can render\\nthe configuration menu. I //could// use [splitregexp[]], but then I'd be\\nlimited to Tiddlywiki v5.1.20 or later.\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n/*\\nExport our filter function\\n*/\\nexports.splitafter = function(source,operator,options) {\\n\\tvar results = [];\\n\\tsource(function(tiddler,title) {\\n\\t\\tvar index = title.lastIndexOf(operator.operand);\\n\\t\\tif(index < 0) {\\n\\t\\t\\t$tw.utils.pushTop(results,title);\\n\\t\\t} else {\\n\\t\\t\\t$tw.utils.pushTop(results,title.substr(index+1));\\n\\t\\t}\\n\\t});\\n\\treturn results;\\n};\\n\\n})();\\n\\n\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/splitafter.js\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"relinkfilteroperator\"\n        },\n        \"$:/plugins/flibbles/relink/js/filteroperators/wouldchange.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkfilteroperator\\n\\nwouldchange: Generator.\\n\\nGiven each input title, it returns all the tiddlers that would be changed if the currentTiddler were to be renamed to the operand.\\n\\nimpossible: filters all source titles for ones that encounter errors on failure.\\n\\nTHESE ARE INTERNAL FILTER OPERATOR AND ARE NOT INTENDED TO BE USED BY USERS.\\n\\n\\\\*/\\n\\nvar language = require(\\\"$:/plugins/flibbles/relink/js/language.js\\\");\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils.js\\\");\\n\\nexports.wouldchange = function(source,operator,options) {\\n\\tvar from = options.widget && options.widget.getVariable(\\\"currentTiddler\\\"),\\n\\t\\tto = operator.operand,\\n\\t\\tindexer = utils.getIndexer(options.wiki);\\n\\tif (from !== to) {\\n\\t\\tvar records = indexer.relinkLookup(from, to, options);\\n\\t\\treturn Object.keys(records);\\n\\t} else {\\n\\t\\treturn [];\\n\\t}\\n};\\n\\nexports.impossible = function(source,operator,options) {\\n\\tvar from = options.widget && options.widget.getVariable(\\\"currentTiddler\\\"),\\n\\t\\tto = operator.operand,\\n\\t\\tresults = [];\\n\\tif (to && from !== to) {\\n\\t\\tvar indexer = utils.getIndexer(options.wiki),\\n\\t\\t\\trecords = indexer.relinkLookup(from, to, options);\\n\\t\\tsource(function(tiddler, title) {\\n\\t\\t\\tvar fields = records[title];\\n\\t\\t\\tif (fields) {\\n\\t\\t\\t\\tfor (var field in fields) {\\n\\t\\t\\t\\t\\tif (fields[field].impossible) {\\n\\t\\t\\t\\t\\t\\tresults.push(title);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t});\\n\\t}\\n\\treturn results;\\n};\\n\",\n            \"module-type\": \"relinkfilteroperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/filteroperators/wouldchange.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/attributes.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for creating the attributes whitelist cache.\\n\\n\\\\*/\\n\\nvar utils = require('../utils');\\n\\nexports.name = \\\"attributes\\\";\\n\\nexports.generate = function(attributes, tiddler, key) {\\n\\tvar data = utils.getType(tiddler.fields.text.trim());\\n\\tif (data) {\\n\\t\\tdata.source = tiddler.fields.title;\\n\\t\\tvar elem = root(key);\\n\\t\\tvar attr = key.substr(elem.length+1);\\n\\t\\tattributes[elem] = attributes[elem] || Object.create(null);\\n\\t\\tattributes[elem][attr] = data;\\n\\t}\\n};\\n\\n/* Returns first bit of a path. path/to/tiddler -> path\\n */\\nfunction root(string) {\\n\\tvar index = string.indexOf('/');\\n\\tif (index >= 0) {\\n\\t\\treturn string.substr(0, index);\\n\\t}\\n};\\n\\n\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/attributes.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/exceptions.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for specifying system tiddlers which should not be treated\\nas text/vnd.tiddlywiki types, but for whatever reason, they don't specify\\nthe type they really are. Sort of like how $:/DefaultTiddlers is actually\\na filter.\\n\\n\\\\*/\\n\\nexports.name = \\\"exceptions\\\";\\n\\nexports.generate = function(exceptions, tiddler, title) {\\n\\tvar tiddlerType = tiddler.fields.text.trim();\\n\\tif (tiddlerType) {\\n\\t\\texceptions[title] = tiddlerType;\\n\\t}\\n};\\n\",\n            \"the type they really are. Sort of like how $\": \"/DefaultTiddlers is actually\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/exceptions.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/fields.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for creating the fields whitelist cache.\\n\\n\\\\*/\\n\\nvar utils = require('../utils');\\n\\nexports.name = \\\"fields\\\";\\n\\nexports.generate = function(fields, tiddler, name) {\\n\\tvar data = utils.getType(tiddler.fields.text.trim());\\n\\tif (data) {\\n\\t\\tdata.source = tiddler.fields.title;\\n\\t\\tfields[name] = data;\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/fields.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/fieldwidgets.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for creating the fieldattributes regexp cache.\\n\\n\\\\*/\\n\\nexports.name = \\\"fieldattributes\\\";\\n\\nexports.generate = function(fieldattributes, tiddler, key) {\\n\\tfieldattributes[key] = new RegExp(tiddler.fields.text.trim());\\n};\\n\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/fieldwidgets.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/macros.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for creating the macros whitelist cache.\\n\\n\\\\*/\\n\\nvar utils = require('../utils');\\n\\nexports.name = \\\"macros\\\";\\n\\nexports.generate = function(macros, tiddler, key) {\\n\\tvar data = utils.getType(tiddler.fields.text.trim());\\n\\tif (data) {\\n\\t\\tdata.source = tiddler.fields.title;\\n\\t\\t// We take the last index, not the first, because macro\\n\\t\\t// parameters can't have slashes, but macroNames can.\\n\\t\\tvar name = dir(key);\\n\\t\\tvar arg = key.substr(name.length+1);\\n\\t\\tmacros[name] = macros[name] || Object.create(null);\\n\\t\\tmacros[name][arg] = data;\\n\\t}\\n};\\n\\n/* Returns all but the last bit of a path. path/to/tiddler -> path/to\\n */\\nfunction dir(string) {\\n\\tvar index = string.lastIndexOf('/');\\n\\tif (index >= 0) {\\n\\t\\treturn string.substr(0, index);\\n\\t}\\n}\\n\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/macros.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/messages.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for creating the message regexp cache.\\n\\n\\\\*/\\n\\nexports.name = \\\"messages\\\";\\n\\nexports.generate = function(messages, tiddler, key) {\\n\\tmessages[key] = new RegExp(tiddler.fields.text.trim());\\n};\\n\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/messages.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/settings/operators.js\": {\n            \"text\": \"/*\\\\\\n\\nFactory method for creating the operators whitelist cache.\\n\\n\\\\*/\\n\\nvar utils = require('../utils');\\n\\nexports.name = \\\"operators\\\";\\n\\nexports.generate = function(operators, tiddler, key) {\\n\\tvar data = utils.getType(tiddler.fields.text.trim());\\n\\tif (data) {\\n\\t\\tdata.source = tiddler.fields.title;\\n\\t\\tvar pair = key.split('/');\\n\\t\\tvar name = pair[0];\\n\\t\\tdata.key = key;\\n\\t\\toperators[name] = operators[name] || Object.create(null);\\n\\t\\toperators[name][pair[1] || 1] = data;\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinksetting\",\n            \"title\": \"$:/plugins/flibbles/relink/js/settings/operators.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/filter.js\": {\n            \"text\": \"/*\\\\\\n\\nThis specifies logic for updating filters to reflect title changes.\\n\\n\\\\*/\\n\\nvar refHandler = require(\\\"$:/plugins/flibbles/relink/js/fieldtypes/reference\\\");\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar filterRelinkers = utils.getModulesByTypeAsHashmap('relinkfilter', 'name');\\n\\nexports.name = \\\"filter\\\";\\n\\nexports.report = function(filter, callback, options) {\\n\\tif (filter) {\\n\\t\\ttry {\\n\\t\\t\\tvar parseTree = options.wiki.parseFilter(filter);\\n\\t\\t} catch (e) {\\n\\t\\t\\t// It must have been malformed. Return without doing anything.\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tfor (var module in filterRelinkers) {\\n\\t\\t\\tfilterRelinkers[module].report(parseTree, callback, options);\\n\\t\\t}\\n\\t}\\n};\\n\\n/**Returns undefined if no change was made.\\n */\\nexports.relink = function(filter, fromTitle, toTitle, options) {\\n\\tvar changed = false;\\n\\tvar results = {};\\n\\tvar parseTree;\\n\\tif (filter) {\\n\\t\\ttry {\\n\\t\\t\\tparseTree = options.wiki.parseFilter(filter);\\n\\t\\t} catch (e) {\\n\\t\\t\\t// It must have been malformed. Return without doing anything.\\n\\t\\t\\treturn;\\n\\t\\t}\\n\\t\\tfor (var module in filterRelinkers) {\\n\\t\\t\\tvar entry = filterRelinkers[module].relink(parseTree, fromTitle, toTitle, options);\\n\\t\\t\\tif (entry) {\\n\\t\\t\\t\\tif (entry.changed) {\\n\\t\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (entry.impossible) {\\n\\t\\t\\t\\t\\tresults.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\tif (changed) {\\n\\t\\tvar builder = assembleFilterString(parseTree, filter, options);\\n\\t\\tresults.output = builder.results();\\n\\t\\tresults.impossible = results.impossible || builder.impossible;\\n\\t\\treturn results;\\n\\t}\\n\\tif (results.impossible) {\\n\\t\\treturn results;\\n\\t}\\n\\treturn undefined\\n};\\n\\nfunction assembleFilterString(parseTree, oldFilter, options) {\\n\\tvar relinker = new Rebuilder(oldFilter),\\n\\t\\twordBarrierRequired = false,\\n\\t\\tp = 0;\\n\\tfor (var i = 0; i < parseTree.length; i++) {\\n\\t\\tvar start = $tw.utils.skipWhiteSpace(oldFilter, p);\\n\\t\\tif (start !== p) {\\n\\t\\t\\t// There's some breathing room between this run and the last.\\n\\t\\t\\t// We'll never need to insert space.\\n\\t\\t\\twordBarrierRequired = false;\\n\\t\\t\\tp = start;\\n\\t\\t}\\n\\t\\tvar run = parseTree[i];\\n\\t\\tif (run.prefix) {\\n\\t\\t\\tif (wordBarrierRequired) {\\n\\t\\t\\t\\trelinker.add(' ', p, p);\\n\\t\\t\\t\\twordBarrierRequired = false;\\n\\t\\t\\t}\\n\\t\\t\\tp += run.prefix.length;\\n\\t\\t}\\n\\t\\tif (oldFilter[p] !== '['\\n\\t\\t|| (oldFilter[p+1] === '[' && run.operators.length === 1)) {\\n\\t\\t\\t// It's a string title\\n\\t\\t\\tvar text = run.operators[0].operands[0].text,\\n\\t\\t\\t\\tend,\\n\\t\\t\\t\\told;\\n\\t\\t\\tswitch (oldFilter[p]) {\\n\\t\\t\\tcase \\\"'\\\":\\n\\t\\t\\tcase '\\\"':\\n\\t\\t\\t\\t// p + 1 to skip the first quote\\n\\t\\t\\t\\t// indexOf() + 1 to skip the last\\n\\t\\t\\t\\tend = oldFilter.indexOf(oldFilter[p], p+1) + 1;\\n\\t\\t\\t\\told = oldFilter.substring(p+1, end-1);\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\tcase '[':\\n\\t\\t\\t\\tend = oldFilter.indexOf(']', p);\\n\\t\\t\\t\\told = oldFilter.substring(p+2, end);\\n\\t\\t\\t\\t// +2 to get past the ']]'\\n\\t\\t\\t\\tend += 2;\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\tdefault:\\n\\t\\t\\t\\tend = skipWord(oldFilter, p);\\n\\t\\t\\t\\told = oldFilter.substring(p, end);\\n\\t\\t\\t}\\n\\t\\t\\tif (old !== text) {\\n\\t\\t\\t\\tvar wrapped = wrapTitle(text, oldFilter[p] !== \\\"[\\\" ? oldFilter[p] : '', options);\\n\\t\\t\\t\\tif (wrapped !== undefined) {\\n\\t\\t\\t\\t\\t// This is a no-quote title. If breathing room is required,\\n\\t\\t\\t\\t\\t// add it. Also, we may need breathing room after it.\\n\\t\\t\\t\\t\\tif (wordBarrierRequired && wrapped[0] !== \\\"[\\\") {\\n\\t\\t\\t\\t\\t\\trelinker.add(' ', p, p);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\trelinker.add(wrapped, p, end);\\n\\t\\t\\t\\t\\twordBarrierRequired = wrapped === text;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\trelinker.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tif (wordBarrierRequired && oldFilter[p] !== \\\"[\\\") {\\n\\t\\t\\t\\t\\trelinker.add(' ', p, p);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\twordBarrierRequired = oldFilter.indexOf(text) === p;\\n\\t\\t\\t}\\n\\t\\t\\tp = end;\\n\\t\\t} else {\\n\\t\\t\\twordBarrierRequired = false;\\n\\t\\t\\tp++;\\n\\t\\t\\tfor (var j = 0; j < run.operators.length; j++) {\\n\\t\\t\\t\\tvar operator = run.operators[j];\\n\\t\\t\\t\\tvar start = p;\\n\\t\\t\\t\\tfor (var index = 0; index < operator.operands.length; index++) {\\n\\t\\t\\t\\t\\tvar operand = operator.operands[index],\\n\\t\\t\\t\\t\\t\\tskip = false;\\n\\t\\t\\t\\t\\t\\tend,\\n\\t\\t\\t\\t\\t\\twrapped;\\n\\t\\t\\t\\t\\tif (operand.indirect) {\\n\\t\\t\\t\\t\\t\\tp = oldFilter.indexOf('{', p);\\n\\t\\t\\t\\t\\t\\tend = oldFilter.indexOf('}', p+1);\\n\\t\\t\\t\\t\\t\\twrapped = '{' + operand.text + '}';\\n\\t\\t\\t\\t\\t} else if (operand.variable) {\\n\\t\\t\\t\\t\\t\\tp = oldFilter.indexOf('<', p);\\n\\t\\t\\t\\t\\t\\tend = oldFilter.indexOf('>', p+1);\\n\\t\\t\\t\\t\\t\\twrapped = '<' + operand.text + '>';\\n\\t\\t\\t\\t\\t} else if (operator.regexp) {\\n\\t\\t\\t\\t\\t\\tp = oldFilter.indexOf('/', p);\\n\\t\\t\\t\\t\\t\\tend = oldFilter.indexOf('/', p+1);\\n\\t\\t\\t\\t\\t\\tskip = true;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tp = oldFilter.indexOf('[', p);\\n\\t\\t\\t\\t\\t\\tend = oldFilter.indexOf(']', p+1);\\n\\t\\t\\t\\t\\t\\tif (!canBePrettyOperand(operand.text) || (options.inBraces && operand.text.indexOf('}}}') >= 0)) {\\n\\t\\t\\t\\t\\t\\t\\tskip = true;\\n\\t\\t\\t\\t\\t\\t\\trelinker.impossible = true;\\n\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\twrapped = '[' + operand.text + ']';\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tend++; // skip the closing brace\\n\\t\\t\\t\\t\\tif (index === 0) {\\n\\t\\t\\t\\t\\t\\t// If this is the first operand, let's first recreate the operator signature in case it was changed at all.\\n\\t\\t\\t\\t\\t\\trelinker.add(operatorSignature(operator, oldFilter, start), start, p);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tif (!skip) {\\n\\t\\t\\t\\t\\t\\trelinker.add(wrapped, p, end);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tp = end;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tp++; // Skip the closing brace;\\n\\t\\t}\\n\\t}\\n\\treturn relinker;\\n};\\n\\nfunction operatorSignature(operator, oldText, start) {\\n\\t// If it's a title operand, try to determine if it was a shorthand.\\n\\tvar prefix = operator.prefix || '';\\n\\tvar signature = prefix + ((operator.operator === 'title' && oldText[start + prefix.length] !== 't')? '': operator.operator);\\n\\tif (operator.suffix) {\\n\\t\\tsignature += ':' + operator.suffix;\\n\\t}\\n\\treturn signature;\\n}\\n\\nfunction skipWord(source,pos) {\\n\\tvar c;\\n\\twhile(true) {\\n\\t\\tc = source.charAt(pos);\\n\\t\\tif((c !== \\\"\\\") && (c !== \\\" \\\") && (c !== \\\"\\\\f\\\") && (c !== \\\"\\\\n\\\")\\n\\t\\t&& (c !== \\\"\\\\r\\\") && (c !== \\\"\\\\t\\\")\\n\\t\\t&& (c !== \\\"\\\\v\\\")&& (c !== \\\"\\\\u00a0\\\") // Ignores obscure unicode spaces\\n\\t\\t&& (c !== \\\"[\\\") && (c !== \\\"]\\\")) { // Ignore brackets\\n\\t\\t\\tpos++;\\n\\t\\t} else {\\n\\t\\t\\treturn pos;\\n\\t\\t}\\n\\t}\\n};\\n\\n/* Same as this.relink, except this has the added constraint that the return\\n * value must be able to be wrapped in curly braces. (i.e. '{{{...}}}')\\n */\\nexports.relinkInBraces = function(filter, fromTitle, toTitle, options) {\\n\\tvar braceOptions = $tw.utils.extend({inBraces: true}, options);\\n\\tvar entry = this.relink(filter, fromTitle, toTitle, braceOptions);\\n\\tif (entry && entry.output && !canBeInBraces(entry.output)) {\\n\\t\\t// It was possible, but it won't fit in braces, so we must give up\\n\\t\\tdelete entry.output;\\n\\t\\tentry.impossible = true;\\n\\t}\\n\\treturn entry;\\n};\\n\\nfunction wrapTitle(value, preference, options) {\\n\\tvar choices = {\\n\\t\\t\\\"\\\": function(v) {return /^[^\\\\s\\\\[\\\\]\\\\}\\\\+\\\\-\\\\~\\\\=\\\\:][^\\\\s\\\\[\\\\]]*[^\\\\s\\\\[\\\\]\\\\}]$/.test(v); },\\n\\t\\t\\\"[\\\": canBePrettyOperand,\\n\\t\\t\\\"'\\\": function(v) {return v.indexOf(\\\"'\\\") < 0; },\\n\\t\\t'\\\"': function(v) {return v.indexOf('\\\"') < 0; }\\n\\t};\\n\\tvar wrappers = {\\n\\t\\t\\\"\\\": function(v) {return v; },\\n\\t\\t\\\"[\\\": function(v) {return \\\"[[\\\"+v+\\\"]]\\\"; },\\n\\t\\t\\\"'\\\": function(v) {return \\\"'\\\"+v+\\\"'\\\"; },\\n\\t\\t'\\\"': function(v) {return '\\\"'+v+'\\\"'; }\\n\\t};\\n\\tif (options.inBraces && value.indexOf('}}}') >= 0) {\\n\\t\\t// In this particular case, it can't be wrapped in this filter,\\n\\t\\t// even if it would have worked within the context of the filter itself\\n\\t\\treturn undefined;\\n\\t}\\n\\tif (!choices[preference]) {\\n\\t\\tpreference = '';\\n\\t}\\n\\tif (choices[preference](value)) {\\n\\t\\treturn wrappers[preference](value);\\n\\t}\\n\\tfor (var quote in choices) {\\n\\t\\tif (choices[quote](value)) {\\n\\t\\t\\treturn wrappers[quote](value);\\n\\t\\t}\\n\\t}\\n\\t// No quotes will work on this\\n\\treturn undefined;\\n}\\n\\nfunction canBePrettyOperand(value) {\\n\\treturn value.indexOf(']') < 0;\\n};\\n\\nfunction canBeInBraces(value) {\\n\\treturn value.indexOf(\\\"}}}\\\") < 0 && value.substr(value.length-2) !== '}}';\\n};\\n\",\n            \"module-type\": \"relinkfieldtype\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/filter.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/list.js\": {\n            \"text\": \"/*\\\\\\nThis manages replacing titles that occur within stringLists, like,\\n\\nTiddlerA [[Tiddler with spaces]] [[Another Title]]\\n\\\\*/\\n\\nvar titleRelinker = require('./title.js');\\n\\nexports.name = \\\"list\\\";\\n\\nexports.report = function(value, callback, options) {\\n\\tvar list = $tw.utils.parseStringArray(value);\\n\\tfor (var i = 0; i < list.length; i++) {\\n\\t\\ttitleRelinker.report(list[i], callback, options);\\n\\t}\\n};\\n\\n/**Returns undefined if no change was made.\\n * Parameter: value can literally be a list. This can happen for builtin\\n *            types 'list' and 'tag'. In those cases, we also return list.\\n */\\nexports.relink = function(value, fromTitle, toTitle, options) {\\n\\tvar isModified = false,\\n\\t\\timpossible = false,\\n\\t\\tactualList = false,\\n\\t\\tentry,\\n\\t\\tlist;\\n\\tif (typeof value !== \\\"string\\\") {\\n\\t\\t// Not a string. Must be a list.\\n\\t\\t// clone it, since we may make changes to this possibly\\n\\t\\t// frozen list.\\n\\t\\tlist = (value || []).slice(0);\\n\\t\\tactualList = true;\\n\\t} else {\\n\\t\\tlist = $tw.utils.parseStringArray(value || \\\"\\\");\\n\\t}\\n\\t$tw.utils.each(list,function (title,index) {\\n\\t\\tvar titleEntry = titleRelinker.relink(title, fromTitle, toTitle, options);\\n\\t\\tif (titleEntry) {\\n\\t\\t\\tif (titleEntry.output) {\\n\\t\\t\\t\\tlist[index] = titleEntry.output;\\n\\t\\t\\t\\tisModified = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (titleEntry.impossible) {\\n\\t\\t\\t\\timpossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n\\tif (isModified || impossible) {\\n\\t\\tentry = {name: \\\"list\\\", impossible: impossible};\\n\\t\\t// It doesn't parse correctly alone, it won't\\n\\t\\t// parse correctly in any list.\\n\\t\\tif (!canBeListItem(toTitle)) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t} else if (actualList) {\\n\\t\\t\\tentry.output = list;\\n\\t\\t} else if (isModified) {\\n\\t\\t\\tentry.output = $tw.utils.stringifyList(list);\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\nfunction canBeListItem(value) {\\n\\tvar regexp = /\\\\]\\\\][^\\\\S\\\\xA0]/m;\\n\\treturn !regexp.test(value);\\n};\\n\",\n            \"module-type\": \"relinkfieldtype\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/list.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/reference.js\": {\n            \"text\": \"/*\\\\\\nThis manages replacing titles that occur inside text references,\\n\\ntiddlerTitle\\ntiddlerTitle!!field\\n!!field\\ntiddlerTitle##propertyIndex\\n\\\\*/\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar referenceOperators = utils.getModulesByTypeAsHashmap('relinkreference', 'name');\\n\\nexports.name = \\\"reference\\\";\\n\\nexports.report = function(value, callback, options) {\\n\\tif (value) {\\n\\t\\tvar reference = $tw.utils.parseTextReference(value);\\n\\t\\tfor (var operator in referenceOperators) {\\n\\t\\t\\treferenceOperators[operator].report(reference, callback, options);\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.relink = function(value, fromTitle, toTitle, options) {\\n\\tvar entry;\\n\\tif (value) {\\n\\t\\tvar impossible = false;\\n\\t\\tvar modified = false;\\n\\t\\tvar reference = $tw.utils.parseTextReference(value);\\n\\t\\tfor (var operator in referenceOperators) {\\n\\t\\t\\tvar result = referenceOperators[operator].relink(reference, fromTitle, toTitle, options);\\n\\t\\t\\tif (result) {\\n\\t\\t\\t\\tif (result.impossible) {\\n\\t\\t\\t\\t\\timpossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (result.output) {\\n\\t\\t\\t\\t\\tmodified = true;\\n\\t\\t\\t\\t\\treference = result.output;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (modified) {\\n\\t\\t\\tif (exports.canBePretty(reference.title)) {\\n\\t\\t\\t\\tentry = {output: exports.toString(reference)};\\n\\t\\t\\t} else {\\n\\t\\t\\t\\timpossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (impossible) {\\n\\t\\t\\tentry = entry || {};\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\n/* Same as this.relink, except this has the added constraint that the return\\n * value must be able to be wrapped in curly braces.\\n */\\nexports.relinkInBraces = function(value, fromTitle, toTitle, options) {\\n\\tvar log = this.relink(value, fromTitle, toTitle, options);\\n\\tif (log && log.output && log.output.indexOf(\\\"}\\\") >= 0) {\\n\\t\\tdelete log.output;\\n\\t\\tlog.impossible = true;\\n\\t}\\n\\treturn log;\\n};\\n\\nexports.toString = function(textReference) {\\n\\tvar title = textReference.title || '';\\n\\tif (textReference.field) {\\n\\t\\treturn title + \\\"!!\\\" + textReference.field;\\n\\t} else if (textReference.index) {\\n\\t\\treturn title + \\\"##\\\" + textReference.index;\\n\\t}\\n\\treturn title;\\n};\\n\\nexports.canBePretty = function(title)  {\\n\\treturn !title || (title.indexOf(\\\"!!\\\") < 0 && title.indexOf(\\\"##\\\") < 0);\\n};\\n\",\n            \"module-type\": \"relinkfieldtype\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/reference.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/title.js\": {\n            \"text\": \"/*\\\\\\nThis specifies logic for replacing a single-tiddler field. This is the\\nsimplest kind of field type. One title swaps out for the other.\\n\\\\*/\\n\\n// NOTE TO MODDERS: If you're making your own field types, the name must be\\n//                  alpha characters only.\\nexports.name = 'title';\\n\\nexports.report = function(value, callback, options) {\\n\\tif (value && !containsPlaceholder(value, options)) {\\n\\t\\tcallback(value);\\n\\t}\\n};\\n\\n/**Returns undefined if no change was made.\\n */\\nexports.relink = function(value, fromTitle, toTitle, options) {\\n\\tif (value !== fromTitle || containsPlaceholder(value, options)) {\\n\\t\\treturn undefined;\\n\\t} else if (containsPlaceholder(toTitle, options)) {\\n\\t\\treturn {impossible: true};\\n\\t} else {\\n\\t\\treturn {output: toTitle};\\n\\t}\\n};\\n\\nfunction containsPlaceholder(value, options) {\\n\\tvar dollar = value.indexOf('$');\\n\\t// Quick test. If no dollar signs. No placeholders.\\n\\tif (dollar >= 0 && value.indexOf('$', dollar+1)) {\\n\\t\\t// We potentially have a placeholder\\n\\t\\tvar placeholders = options.settings.getPlaceholderList();\\n\\t\\tif (placeholders) {\\n\\t\\t\\tif (value.search(/\\\\$\\\\([^$\\\\)]+\\\\)\\\\$/) >= 0) {\\n\\t\\t\\t\\t// A global placeholder exists\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\t\\t\\tfor (var name in placeholders) {\\n\\t\\t\\t\\tif (value.indexOf('$' + name + '$') >= 0) {\\n\\t\\t\\t\\t\\t// Oops. This contains a placeholder.\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn false;\\n};\\n\\n// This is legacy support for when 'title' was known as 'field'\\nexports.aliases = ['field', 'yes'];\\n\",\n            \"module-type\": \"relinkfieldtype\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/title.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/wikitext.js\": {\n            \"text\": \"/*\\\\\\nThis specifies logic for updating filters to reflect title changes.\\n\\\\*/\\n\\nexports.name = \\\"wikitext\\\";\\n\\nvar type = 'text/vnd.tiddlywiki';\\n\\nvar WikiParser = require(\\\"$:/core/modules/parsers/wikiparser/wikiparser.js\\\")[type];\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder.js\\\");\\nvar utils = require('$:/plugins/flibbles/relink/js/utils');\\nvar WikitextContext = utils.getContext('wikitext');\\n\\nfunction collectRules() {\\n\\tvar rules = Object.create(null);\\n\\t$tw.modules.forEachModuleOfType(\\\"relinkwikitextrule\\\", function(title, exports) {\\n\\t\\tvar names = exports.name;\\n\\t\\tif (typeof names === \\\"string\\\") {\\n\\t\\t\\tnames = [names];\\n\\t\\t}\\n\\t\\tif (names !== undefined) {\\n\\t\\t\\tfor (var i = 0; i < names.length; i++) {\\n\\t\\t\\t\\trules[names[i]] = exports;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n\\treturn rules;\\n}\\n\\nfunction WikiWalker(type, text, options) {\\n\\tthis.options = options;\\n\\tif (!this.relinkMethodsInjected) {\\n\\t\\tvar rules = collectRules();\\n\\t\\t$tw.utils.each([this.pragmaRuleClasses, this.blockRuleClasses, this.inlineRuleClasses], function(classList) {\\n\\t\\t\\tfor (var name in classList) {\\n\\t\\t\\t\\tif (rules[name]) {\\n\\t\\t\\t\\t\\tdelete rules[name].name;\\n\\t\\t\\t\\t\\t$tw.utils.extend(classList[name].prototype, rules[name]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t});\\n\\t\\tWikiWalker.prototype.relinkMethodsInjected = true;\\n\\t}\\n\\tthis.context = new WikitextContext(options.settings);\\n\\tWikiParser.call(this, type, text, options);\\n};\\n\\nWikiWalker.prototype = Object.create(WikiParser.prototype);\\n\\nWikiWalker.prototype.parsePragmas = function() {\\n\\tvar entries = this.tree;\\n\\twhile (true) {\\n\\t\\tthis.skipWhitespace();\\n\\t\\tif (this.pos >= this.sourceLength) {\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tvar nextMatch = this.findNextMatch(this.pragmaRules, this.pos);\\n\\t\\tif (!nextMatch || nextMatch.matchIndex !== this.pos) {\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tentries.push.apply(entries, this.handleRule(nextMatch));\\n\\t}\\n\\treturn entries;\\n};\\n\\nWikiWalker.prototype.parseInlineRunUnterminated = function(options) {\\n\\tvar entries = [];\\n\\tvar nextMatch = this.findNextMatch(this.inlineRules, this.pos);\\n\\twhile (this.pos < this.sourceLength && nextMatch) {\\n\\t\\tif (nextMatch.matchIndex > this.pos) {\\n\\t\\t\\tthis.pos = nextMatch.matchIndex;\\n\\t\\t}\\n\\t\\tentries.push.apply(entries, this.handleRule(nextMatch));\\n\\t\\tnextMatch = this.findNextMatch(this.inlineRules, this.pos);\\n\\t}\\n\\tthis.pos = this.sourceLength;\\n\\treturn entries;\\n};\\n\\nWikiWalker.prototype.parseInlineRunTerminated = function(terminatorRegExp,options) {\\n    return this.parseInlineRunTerminatedExtended(terminatorRegExp,options).tree;\\n};\\n\\nWikiWalker.prototype.parseInlineRunTerminatedExtended = function(terminatorRegExp,options) {\\n\\tvar entries = [];\\n\\toptions = options || {};\\n\\tterminatorRegExp.lastIndex = this.pos;\\n\\tvar terminatorMatch = terminatorRegExp.exec(this.source);\\n\\tvar inlineRuleMatch = this.findNextMatch(this.inlineRules,this.pos);\\n\\twhile(this.pos < this.sourceLength && (terminatorMatch || inlineRuleMatch)) {\\n\\t\\tif (terminatorMatch) {\\n\\t\\t\\tif (!inlineRuleMatch || inlineRuleMatch.matchIndex >= terminatorMatch.index) {\\n\\t\\t\\t\\tthis.pos = terminatorMatch.index;\\n\\t\\t\\t\\tif (options.eatTerminator) {\\n\\t\\t\\t\\t\\tthis.pos += terminatorMatch[0].length;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\treturn {\\n\\t\\t\\t\\t\\tmatch: terminatorMatch,\\n\\t\\t\\t\\t\\ttree: entries\\n\\t\\t\\t\\t};\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (inlineRuleMatch) {\\n\\t\\t\\tif (inlineRuleMatch.matchIndex > this.pos) {\\n\\t\\t\\t\\tthis.pos = inlineRuleMatch.matchIndex;\\n\\t\\t\\t}\\n\\t\\t\\tentries.push.apply(entries, this.handleRule(inlineRuleMatch));\\n\\t\\t\\tinlineRuleMatch = this.findNextMatch(this.inlineRules, this.pos);\\n\\t\\t\\tterminatorRegExp.lastIndex = this.pos;\\n\\t\\t\\tterminatorMatch = terminatorRegExp.exec(this.source);\\n\\t\\t}\\n\\t}\\n\\tthis.pos = this.sourceLength;\\n\\treturn {tree: entries};\\n\\n};\\n\\nWikiWalker.prototype.parseBlock = function(terminatorRegExpString) {\\n\\tvar terminatorRegExp = terminatorRegExpString ? new RegExp(\\\"(\\\" + terminatorRegExpString + \\\"|\\\\\\\\r?\\\\\\\\n\\\\\\\\r?\\\\\\\\n)\\\",\\\"mg\\\") : /(\\\\r?\\\\n\\\\r?\\\\n)/mg;\\n\\tthis.skipWhitespace();\\n\\tif (this.pos >= this.sourceLength) {\\n\\t\\treturn [];\\n\\t}\\n\\tvar nextMatch = this.findNextMatch(this.blockRules, this.pos);\\n\\tif(nextMatch && nextMatch.matchIndex === this.pos) {\\n\\t\\treturn this.handleRule(nextMatch);\\n\\t}\\n\\treturn this.parseInlineRun(terminatorRegExp);\\n};\\n\\nWikiWalker.prototype.amendRules = function(type, names) {\\n\\tvar only;\\n\\tWikiParser.prototype.amendRules.call(this, type, names);\\n\\tif (type === \\\"only\\\") {\\n\\t\\tonly = true;\\n\\t} else if (type === \\\"except\\\") {\\n\\t\\tonly = false;\\n\\t} else {\\n\\t\\treturn;\\n\\t}\\n\\tif (only !== (names.indexOf(\\\"html\\\") >= 0)) {\\n\\t\\tthis.context.allowWidgets = disabled;\\n\\t}\\n\\tif (only !== (names.indexOf(\\\"prettylink\\\") >= 0)) {\\n\\t\\tthis.context.allowPrettylinks = disabled;\\n\\t}\\n};\\n\\nfunction disabled() { return false; };\\n\\n/// Reporter\\n\\nfunction WikiReporter(type, text, callback, options) {\\n\\tthis.callback = callback;\\n\\tWikiWalker.call(this, type, text, options);\\n};\\n\\nWikiReporter.prototype = Object.create(WikiWalker.prototype);\\n\\nWikiReporter.prototype.handleRule = function(ruleInfo) {\\n\\tif (ruleInfo.rule.report) {\\n\\t\\truleInfo.rule.report(this.source, this.callback, this.options);\\n\\t} else {\\n\\t\\tif (ruleInfo.rule.matchRegExp !== undefined) {\\n\\t\\t\\tthis.pos = ruleInfo.rule.matchRegExp.lastIndex;\\n\\t\\t} else {\\n\\t\\t\\t// We can't easily determine the end of this\\n\\t\\t\\t// rule match. We'll \\\"parse\\\" it so that\\n\\t\\t\\t// parser.pos gets updated, but we throw away\\n\\t\\t\\t// the results.\\n\\t\\t\\truleInfo.rule.parse();\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.report = function(wikitext, callback, options) {\\n\\t// Unfortunately it's the side-effect of creating this that reports.\\n\\tnew WikiReporter(options.type, wikitext, callback, options);\\n};\\n\\n/// Relinker\\n\\nfunction WikiRelinker(type, text, fromTitle, toTitle, options) {\\n\\tthis.fromTitle = fromTitle;\\n\\tthis.toTitle = toTitle;\\n\\tWikiWalker.call(this, type, text, options);\\n};\\n\\nWikiRelinker.prototype = Object.create(WikiWalker.prototype);\\n\\nWikiRelinker.prototype.handleRule = function(ruleInfo) {\\n\\tif (ruleInfo.rule.relink) {\\n\\t\\tvar start = ruleInfo.matchIndex;\\n\\t\\tvar newEntry = ruleInfo.rule.relink(this.source, this.fromTitle, this.toTitle, this.options);\\n\\t\\tif (newEntry !== undefined) {\\n\\t\\t\\tif (newEntry.output) {\\n\\t\\t\\t\\tnewEntry.start = start;\\n\\t\\t\\t\\tnewEntry.end = this.pos;\\n\\t\\t\\t}\\n\\t\\t\\treturn [newEntry];\\n\\t\\t}\\n\\t} else {\\n\\t\\tif (ruleInfo.rule.matchRegExp !== undefined) {\\n\\t\\t\\tthis.pos = ruleInfo.rule.matchRegExp.lastIndex;\\n\\t\\t} else {\\n\\t\\t\\t// We can't easily determine the end of this\\n\\t\\t\\t// rule match. We'll \\\"parse\\\" it so that\\n\\t\\t\\t// parser.pos gets updated, but we throw away\\n\\t\\t\\t// the results.\\n\\t\\t\\truleInfo.rule.parse();\\n\\t\\t}\\n\\t}\\n\\treturn [];\\n};\\n\\nexports.relink = function(wikitext, fromTitle, toTitle, options) {\\n\\tvar parser = new WikiRelinker(options.type, wikitext, fromTitle, toTitle, options),\\n\\t\\twikiEntry = undefined;\\n\\t// Now that we have an array of entries, let's produce the wikiText entry\\n\\t// containing them all.\\n\\tif (parser.tree.length > 0) {\\n\\t\\tvar builder = new Rebuilder(wikitext);\\n\\t\\twikiEntry = {};\\n\\t\\tfor (var i = 0; i < parser.tree.length; i++) {\\n\\t\\t\\tvar entry = parser.tree[i];\\n\\t\\t\\tif (entry.impossible) {\\n\\t\\t\\t\\twikiEntry.impossible = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (entry.output) {\\n\\t\\t\\t\\tbuilder.add(entry.output, entry.start, entry.end);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\twikiEntry.output = builder.results();\\n\\t}\\n\\treturn wikiEntry;\\n};\\n\",\n            \"module-type\": \"relinkfieldtype\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/wikitext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/filter/function.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles reporting of [function[]] operators.\\n\\n\\\\*/\\n\\nexports.name = \\\"function\\\";\\n\\nexports.report = function(filterParseTree, callback, options) {\\n\\tforEachOperand(filterParseTree, options, function(name, operand, handler, index) {\\n\\t\\thandler.report(operand.text, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '[function[' + name + ']' + ','.repeat(index) + '[' + (blurb || '') + ']]', style);\\n\\t\\t}, options);\\n\\t});\\n};\\n\\nexports.relink = function(filterParseTree, fromTitle, toTitle, options) {\\n\\tvar output = {};\\n\\tforEachOperand(filterParseTree, options, function(name, operand, handler, index) {\\n\\t\\tvar entry = handler.relink(operand.text, fromTitle, toTitle, options);\\n\\t\\tif (entry) {\\n\\t\\t\\tif (entry.output) {\\n\\t\\t\\t\\toutput.changed = true;\\n\\t\\t\\t\\toperand.text = entry.output;\\n\\t\\t\\t}\\n\\t\\t\\tif (entry.impossible) {\\n\\t\\t\\t\\toutput.impossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n\\treturn output;\\n};\\n\\n// Calls the callback for every applicable operand of a function operator\\nfunction forEachOperand(filterParseTree, options, callback) {\\n\\tfor (var i = 0; i < filterParseTree.length; i++) {\\n\\t\\tvar run = filterParseTree[i];\\n\\t\\tfor (var j = 0; j < run.operators.length; j++) {\\n\\t\\t\\tvar operator = run.operators[j];\\n\\t\\t\\tvar titleOp = operator.operands[0];\\n\\t\\t\\tif (operator.operator === \\\"function\\\"\\n\\t\\t\\t&& !titleOp.variable && !titleOp.indirect\\n\\t\\t\\t&& titleOp.text) {\\n\\t\\t\\t\\tvar funcName = titleOp.text;\\n\\t\\t\\t\\tvar managedMacro = options.settings.getMacro(funcName);\\n\\t\\t\\t\\tif (managedMacro) {\\n\\t\\t\\t\\t\\tvar def = options.settings.getMacroDefinition(funcName);\\n\\t\\t\\t\\t\\tif (def && def.isFunctionDefinition) {\\n\\t\\t\\t\\t\\t\\tfor (var index = 1; index < operator.operands.length; index++) {\\n\\t\\t\\t\\t\\t\\t\\tvar operand = operator.operands[index];\\n\\t\\t\\t\\t\\t\\t\\tif (!operand.variable && !operand.indirect\\n\\t\\t\\t\\t\\t\\t\\t&& def.params.length >= index) {\\n\\t\\t\\t\\t\\t\\t\\t\\tvar paramName = def.params[index-1].name;\\n\\t\\t\\t\\t\\t\\t\\t\\tvar handler = managedMacro[paramName];\\n\\t\\t\\t\\t\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tcallback(funcName, operand, handler, index);\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkfilter\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/filter/function.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/filter/operators.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles reporting of filter operators.\\n\\n\\\\*/\\n\\nvar refHandler = require(\\\"$:/plugins/flibbles/relink/js/fieldtypes/reference\\\");\\nvar titleHandler = require(\\\"$:/plugins/flibbles/relink/js/fieldtypes/title\\\");\\nvar macrocall = require(\\\"$:/plugins/flibbles/relink/js/utils/macrocall.js\\\");\\n\\nexports.name = \\\"operators\\\";\\n\\nexports.report = function(filterParseTree, callback, options) {\\n\\tfor (var i = 0; i < filterParseTree.length; i++) {\\n\\t\\tvar run = filterParseTree[i];\\n\\t\\tfor (var j = 0; j < run.operators.length; j++) {\\n\\t\\t\\tvar operator = run.operators[j];\\n\\t\\t\\tfor (var index = 1; index <= operator.operands.length; index++) {\\n\\t\\t\\t\\tvar operand = operator.operands[index-1];\\n\\t\\t\\t\\tvar display = makeDisplay(operator);\\n\\t\\t\\t\\t// Now add any commas if this is a later operand\\n\\t\\t\\t\\tfor (var x = 1; x < index; x++) {\\n\\t\\t\\t\\t\\tdisplay += ',';\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (operand.indirect) {\\n\\t\\t\\t\\t\\trefHandler.report(operand.text, function(title, blurb, style) {\\n\\t\\t\\t\\t\\t\\tcallback(title, (run.prefix || '') + '[' + display + '{' + (blurb || '') + '}]', style);\\n\\t\\t\\t\\t\\t}, options);\\n\\t\\t\\t\\t} else if (operand.variable) {\\n\\t\\t\\t\\t\\tvar macro = $tw.utils.parseMacroInvocation(\\\"<<\\\"+operand.text+\\\">>\\\", 0);\\n\\t\\t\\t\\t\\tif (macro) {\\n\\t\\t\\t\\t\\t\\tmacrocall.report(options.settings, macro, function(title, blurb, style) {\\n\\t\\t\\t\\t\\t\\t\\tcallback(title, (run.prefix || '') + '[' + display + '<' + blurb + '>]', style);\\n\\t\\t\\t\\t\\t\\t}, options);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tcontinue;\\n\\t\\t\\t\\t} else if (operand.text) {\\n\\t\\t\\t\\t\\tvar handler = fieldType(options.settings, operator, index, options)\\n\\t\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\t\\thandler.report(operand.text, function(title, blurb, style) {\\n\\t\\t\\t\\t\\t\\t\\tif (!isTitleRun(operator) || blurb) {\\n\\t\\t\\t\\t\\t\\t\\t\\tcallback(title, (run.prefix || '') + '[' + display + '[' + (blurb || '') + ']]', style);\\n\\t\\t\\t\\t\\t\\t\\t} else if (j === run.operators.length-1) {\\n\\t\\t\\t\\t\\t\\t\\t\\t// index will always be 1, meaning single operator run,\\n\\t\\t\\t\\t\\t\\t\\t\\t// unless the user is weird. [title[]] ignores\\n\\t\\t\\t\\t\\t\\t\\t\\t// input, so why would it ever not be 1?\\n\\t\\t\\t\\t\\t\\t\\t\\tcallback(title, run.prefix, style);\\n\\t\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\t\\t// Special case: It's a title operator that's\\n\\t\\t\\t\\t\\t\\t\\t\\t// leading a run\\n\\t\\t\\t\\t\\t\\t\\t\\tcallback(title, (run.prefix || '') + '[[]' + makeDisplay(run.operators[j+1]) + '...]', style);\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t}, options);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.relink = function(filterParseTree, fromTitle, toTitle, options) {\\n\\tvar output = {};\\n\\tfor (var i = 0; i < filterParseTree.length; i++) {\\n\\t\\tvar run = filterParseTree[i];\\n\\t\\tfor (var j = 0; j < run.operators.length; j++) {\\n\\t\\t\\tvar operator = run.operators[j];\\n\\t\\t\\tfor (var index = 1; index <= operator.operands.length; index++) {\\n\\t\\t\\t\\tvar operand = operator.operands[index-1],\\n\\t\\t\\t\\t\\tentry = undefined;\\n\\t\\t\\t\\tif (operand.indirect) {\\n\\t\\t\\t\\t\\tentry = refHandler.relinkInBraces(operand.text, fromTitle, toTitle, options);\\n\\t\\t\\t\\t} else if (operand.variable) {\\n\\t\\t\\t\\t\\tentry = relinkMacro(options.settings, operand.text, fromTitle, toTitle, options);\\n\\t\\t\\t\\t} else if (operand.text) {\\n\\t\\t\\t\\t\\tvar handler = fieldType(options.settings, operator, index, options)\\n\\t\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\t\\tentry = handler.relink(operand.text, fromTitle, toTitle, options);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (entry) {\\n\\t\\t\\t\\t\\tif (entry.output) {\\n\\t\\t\\t\\t\\t\\toutput.changed = true;\\n\\t\\t\\t\\t\\t\\toperand.text = entry.output;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tif (entry.impossible) {\\n\\t\\t\\t\\t\\t\\toutput.impossible = true;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn output;\\n};\\n\\n// Returns the relinker needed for a given operator, or returns undefined.\\n// This method should really be broken into three modules called relinkfilteroperator\\nfunction fieldType(context, operator, index, options) {\\n\\tvar op = operator.operator,\\n\\t\\tsuffix = operator.suffix,\\n\\t\\trtn = (suffix && context.getOperator(op + ':' + suffix, index))\\n\\t\\t   || context.getOperator(op, index);\\n\\tif (!rtn && op === 'contains' && index == 1) {\\n\\t\\t// The 'contains' operator gets special handling\\n\\t\\tsuffix = suffix || 'list';\\n\\t\\tvar handler = context.getFields()[suffix];\\n\\t\\tif (handler && (handler.name === 'list' || handler.name === 'filter')) {\\n\\t\\t\\t// Contains uses the title handler, but only if it's\\n\\t\\t\\t// searching a 'list' or 'filter' field.\\n\\t\\t\\treturn titleHandler;\\n\\t\\t}\\n\\n\\t}\\n\\tif (!rtn && index == 1) {\\n\\t\\t// maybe it's a field operator?\\n\\t\\trtn = (op === 'field' && context.getFields()[suffix])\\n\\t\\t   || (!suffix && !options.wiki.getFilterOperators()[op] && context.getFields()[op]);\\n\\t}\\n\\treturn rtn;\\n};\\n\\nfunction makeDisplay(operator) {\\n\\treturn (operator.prefix || '') + (operator.operator === 'title'? '': operator.operator) + (operator.suffix? ':' + operator.suffix: '');\\n};\\n\\nfunction isTitleRun(operator) {\\n\\treturn operator.operator === 'title'\\n\\t\\t&& !operator.prefix\\n\\t\\t&& !operator.suffix;\\n};\\n\\n// Takes care of relinking a macro, as well as putting it back together.\\nfunction relinkMacro(context, text, fromTitle, toTitle, options) {\\n\\ttext = \\\"<<\\\" + text + \\\">>\\\";\\n\\tvar macro = $tw.utils.parseMacroInvocation(text, 0);\\n\\tvar entry;\\n\\tif (macro) {\\n\\t\\tentry = macrocall.relink(context, macro, text, fromTitle, toTitle, false, options);\\n\\t}\\n\\tif (entry && entry.output) {\\n\\t\\tvar string = macrocall.reassemble(entry, text, options);\\n\\t\\tif (string !== undefined) {\\n\\t\\t\\t// We remove the surrounding brackets.\\n\\t\\t\\tstring = string.substring(2, string.length-2);\\n\\t\\t\\t// And we make sure that no brackets remain\\n\\t\\t\\tif (string.indexOf(\\\">\\\") < 0) {\\n\\t\\t\\t\\tentry.output = string;\\n\\t\\t\\t\\treturn entry;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tdelete entry.output;\\n\\t\\tentry.impossible = true;\\n\\t}\\n\\treturn entry;\\n};\\n\",\n            \"module-type\": \"relinkfilter\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/filter/operators.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/fieldtypes/reference/title.js\": {\n            \"text\": \"/*\\\\\\n\\nThis handles the title inside of references.\\n\\n\\\\*/\\n\\nvar titleRelinker = require('../title.js');\\n\\nexports.name = 'title';\\n\\nexports.report = function(reference, callback, options) {\\n\\tvar title = reference.title;\\n\\ttitleRelinker.report(reference.title, function(title, blurb, style) {\\n\\t\\tif (reference.field) {\\n\\t\\t\\tcallback(title, '!!' + reference.field);\\n\\t\\t} else if (reference.index) {\\n\\t\\t\\tcallback(title, '##' + reference.index);\\n\\t\\t} else {\\n\\t\\t\\tcallback(title);\\n\\t\\t}\\n\\t}, options);\\n};\\n\\nexports.relink = function(reference, fromTitle, toTitle, options) {\\n\\tvar entry = titleRelinker.relink($tw.utils.trim(reference.title), fromTitle, toTitle, options);\\n\\tif (entry && entry.output) {\\n\\t\\t// preserve user's whitespace\\n\\t\\treference.title = reference.title.replace(fromTitle, entry.output);\\n\\t\\tentry.output = reference;\\n\\t}\\n\\treturn entry;\\n};\\n\",\n            \"module-type\": \"relinkreference\",\n            \"title\": \"$:/plugins/flibbles/relink/js/fieldtypes/reference/title.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/fields.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles all fields specified in the plugin configuration. Currently, this\\nonly supports single-value fields.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.name = 'fields';\\n\\nexports.report = function(tiddler, callback, options) {\\n\\tvar fields = options.settings.getFields();\\n\\t$tw.utils.each(fields, function(handler, field) {\\n\\t\\tvar input = tiddler.fields[field];\\n\\t\\tif (input) {\\n\\t\\t\\tif (field === 'list' && tiddler.fields['plugin-type']) {\\n\\t\\t\\t\\t// We have a built-in exception here. plugins use their list\\n\\t\\t\\t\\t// field differently. There's a whole mechanism for what\\n\\t\\t\\t\\t// they actually point to, but let's not bother with that now\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\thandler.report(input, function(title, blurb, style) {\\n\\t\\t\\t\\tif (blurb) {\\n\\t\\t\\t\\t\\tcallback(title, field + ': ' + blurb, style);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tcallback(title, field, style);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}, options);\\n\\t\\t}\\n\\t});\\n};\\n\\nexports.relink = function(tiddler, fromTitle, toTitle, changes, options) {\\n\\tvar fields = options.settings.getFields();\\n\\t$tw.utils.each(fields, function(handler, field) {\\n\\t\\tvar input = tiddler.fields[field];\\n\\t\\tif (input) {\\n\\t\\t\\tif (field === 'list' && tiddler.fields['plugin-type']) {\\n\\t\\t\\t\\t// Same deal as above. Skip.\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t\\tvar entry = handler.relink(input, fromTitle, toTitle, options);\\n\\t\\t\\tif (entry !== undefined) {\\n\\t\\t\\t\\tchanges[field] = entry;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n};\\n\",\n            \"module-type\": \"relinkoperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/fields.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text.js\": {\n            \"text\": \"/*\\\\\\n\\nDepending on the tiddler type, this will apply textOperators which may\\nrelink titles within the body.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nexports.name = 'text';\\n\\nvar textOperators = utils.getModulesByTypeAsHashmap('relinktext', 'type');\\n\\n// Set up any aliases, mostly for backward-compatibility\\n$tw.utils.each(Object.keys(textOperators), function(type) {\\n\\tvar operator = textOperators[type];\\n\\tif(operator.aliases) {\\n\\t\\tfor(var index = 0; index < operator.aliases.length; index++) {\\n\\t\\t\\ttextOperators[operator.aliases[index]] = operator;\\n\\t\\t}\\n\\t}\\n});\\n\\n// These are deprecated. Don't use them.\\nvar oldTextOperators = utils.getModulesByTypeAsHashmap('relinktextoperator', 'type');\\n\\nexports.report = function(tiddler, callback, options) {\\n\\tif (tiddler.fields.text) {\\n\\t\\tvar type = getType(tiddler, options);\\n\\t\\tif (textOperators[type]) {\\n\\t\\t\\ttextOperators[type].report(tiddler.fields.text, callback, options);\\n\\t\\t} else if (oldTextOperators[type]) {\\n\\t\\t\\t// For the deprecated text operators\\n\\t\\t\\toldTextOperators[type].report(tiddler, callback, options);\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.relink = function(tiddler, fromTitle, toTitle, changes, options) {\\n\\tif (tiddler.fields.text) {\\n\\t\\tvar type = getType(tiddler, options),\\n\\t\\t\\tentry;\\n\\t\\tif (textOperators[type]) {\\n\\t\\t\\tentry = textOperators[type].relink(tiddler.fields.text, fromTitle, toTitle, options);\\n\\t\\t} else if (oldTextOperators[type]) {\\n\\t\\t\\t// For the deprecated text operators\\n\\t\\t\\tentry = oldTextOperators[type].relink(tiddler, fromTitle, toTitle, options);\\n\\t\\t}\\n\\t\\tif (entry) {\\n\\t\\t\\tchanges.text = entry;\\n\\t\\t}\\n\\t}\\n};\\n\\n/* The type of the tiddler is determined based on:\\n * 1. Whether there's an exception specified on it.\\n * 2. The type the tiddler says it is.\\n * 3. Or the default vnd.tiddlywiki type if not specified.\\n */\\nfunction getType(tiddler, options) {\\n\\treturn options.settings.getException(tiddler.fields.title)\\n\\t\\t|| tiddler.fields.type\\n\\t\\t|| \\\"text/vnd.tiddlywiki\\\";\\n};\\n\",\n            \"module-type\": \"relinkoperator\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/filtertext.js\": {\n            \"text\": \"/*\\\\\\n\\nThis relinks tiddlers which contain filters in their body, as oppose to\\nwikitext.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar filterHandler = require(\\\"$:/plugins/flibbles/relink/js/utils\\\").getType('filter');\\n\\nexports.type = 'application/x-tiddler-filter';\\n\\nexports.aliases = ['text/x-tiddler-filter'];\\n\\nexports.report = filterHandler.report;\\nexports.relink = filterHandler.relink;\\n\",\n            \"module-type\": \"relinktext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/filtertext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/listtext.js\": {\n            \"text\": \"/*\\\\\\n\\nThis relinks tiddlers which contain a tiddler list as their body.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar listHandler = require(\\\"$:/plugins/flibbles/relink/js/utils\\\").getType('list');\\n\\nexports.type = 'application/x-tiddler-list';\\n\\nexports.aliases = ['text/x-tiddler-list'];\\n\\nexports.report = listHandler.report;\\nexports.relink = listHandler.relink;\\n\",\n            \"module-type\": \"relinktext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/listtext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/referencetext.js\": {\n            \"text\": \"/*\\\\\\n\\nThis relinks tiddlers which contain a tiddler reference as their body.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar refHandler = require(\\\"$:/plugins/flibbles/relink/js/utils\\\").getType('reference');\\n\\nexports.type = 'application/x-tiddler-reference';\\n\\nexports.aliases = ['text/x-tiddler-reference'];\\n\\nexports.report = refHandler.report;\\nexports.relink = refHandler.relink;\\n\",\n            \"module-type\": \"relinktext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/referencetext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/titletext.js\": {\n            \"text\": \"/*\\\\\\n\\nThis relinks tiddlers which contain a single title as their body.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar titleHandler = require(\\\"$:/plugins/flibbles/relink/js/utils\\\").getType('title');\\n\\nexports.type = 'application/x-tiddler-title';\\n\\nexports.aliases = ['text/x-tiddler-title'];\\n\\nexports.report = titleHandler.report;\\nexports.relink = titleHandler.relink;\\n\",\n            \"module-type\": \"relinktext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/titletext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext.js\": {\n            \"text\": \"/*\\\\\\n\\nChecks for fromTitle in text. If found, sees if it's relevant,\\nand tries to swap it out if it is.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar wikitextHandler = require('$:/plugins/flibbles/relink/js/utils.js').getType('wikitext');\\n\\nexports.type = 'text/vnd.tiddlywiki';\\n\\nexports.report = wikitextHandler.report;\\nexports.relink = wikitextHandler.relink;\\n\",\n            \"module-type\": \"relinktext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/code.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles code blocks. Or rather //doesn't// handle them, since we should\\nignore their contents.\\n\\n\\\"`` [[Renamed Title]] ``\\\" will remain unchanged.\\n\\n\\\\*/\\n\\nexports.name = [\\\"codeinline\\\", \\\"codeblock\\\"];\\n\\nexports.relink = function(text) {\\n\\tvar reEnd;\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\t// I'm lazy. This relink method works for both codeblock and codeinline\\n\\tif (this.match[0].length > 2) {\\n\\t\\t// Must be a codeblock\\n\\t\\treEnd = /\\\\r?\\\\n```$/mg;\\n\\t} else {\\n\\t\\t// Must be a codeinline\\n\\t\\treEnd = new RegExp(this.match[1], \\\"mg\\\");\\n\\t}\\n\\treEnd.lastIndex = this.parser.pos;\\n\\tvar match = reEnd.exec(text);\\n\\tif (match) {\\n\\t\\tthis.parser.pos = match.index + match[0].length;\\n\\t} else {\\n\\t\\tthis.parser.pos = this.parser.sourceLength;\\n\\t}\\n\\treturn undefined;\\n};\\n\\n// Same thing. Just skip the pos ahead.\\nexports.report = exports.relink;\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/code.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/comment.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles comment blocks. Or rather //doesn't// handle them, since we should\\nignore their contents.\\n\\n\\\"<!-- [[Renamed Title]] -->\\\" will remain unchanged.\\n\\n\\\\*/\\n\\nexports.name = [\\\"commentinline\\\", \\\"commentblock\\\"];\\n\\nexports.relink = function(text) {\\n\\tthis.parser.pos = this.endMatchRegExp.lastIndex;\\n\\treturn undefined;\\n};\\n\\nexports.report = exports.relink;\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/comment.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/conditional.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles replacement of conditionals\\n\\n<%if Tiddler %>\\n\\n<%elseif TiddlerB %>\\n\\n\\\\*/\\n\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils.js\\\");\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar filterRelinker = utils.getType('filter');\\n\\nexports.name = \\\"conditional\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\tvar match = this.match;\\n\\tvar keyword = '<%if ';\\n\\tvar reEndString = \\\"\\\\\\\\<\\\\\\\\%\\\\\\\\s*(endif)\\\\\\\\s*\\\\\\\\%\\\\\\\\>|\\\\\\\\<\\\\\\\\%\\\\\\\\s*(else)\\\\\\\\s*\\\\\\\\%\\\\\\\\>|\\\\\\\\<\\\\\\\\%\\\\\\\\s*(elseif)\\\\\\\\s+([\\\\\\\\s\\\\\\\\S]+?)\\\\\\\\%\\\\\\\\>\\\";\\n\\tthis.parser.pos = this.terminateIfMatch.index + this.terminateIfMatch[0].length;\\n\\tvar ex;\\n\\tvar filter = this.parser.source.substring(match.index + match[0].length, this.terminateIfMatch.index);\\n\\twhile (true) {\\n\\t\\tif (filter) {\\n\\t\\t\\tfilterRelinker.report(filter, function(title, blurb, style) {\\n\\t\\t\\t\\tif (blurb) {\\n\\t\\t\\t\\t\\tblurb = keyword + blurb + ' %>';\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tblurb = keyword + '%>';\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tcallback(title, blurb, style);\\n\\t\\t\\t}, options);\\n\\t\\t}\\n\\t\\tvar hasLineBreak = doubleLineBreakAtPos(this.parser);\\n\\t\\t// Parse the body looking for else or endif\\n\\t\\tif (hasLineBreak) {\\n\\t\\t\\tex = this.parser.parseBlocksTerminatedExtended(reEndString);\\n\\t\\t} else {\\n\\t\\t\\tvar reEnd = new RegExp(reEndString,\\\"mg\\\");\\n\\t\\t\\tex = this.parser.parseInlineRunTerminatedExtended(reEnd,{eatTerminator: true});\\n\\t\\t}\\n\\t\\tif (ex.match) {\\n\\t\\t\\tmatch = ex.match;\\n\\t\\t\\tif (ex.match[3] === \\\"elseif\\\") {\\n\\t\\t\\t\\tkeyword = '<%elseif ';\\n\\t\\t\\t\\tfilter = ex.match[4];\\n\\t\\t\\t\\tcontinue;\\n\\t\\t\\t} else if (ex.match[2] === \\\"else\\\") {\\n\\t\\t\\t\\treEndString = \\\"\\\\\\\\<\\\\\\\\%\\\\\\\\s*(endif)\\\\\\\\s*\\\\\\\\%\\\\\\\\>\\\";\\n\\t\\t\\t\\tfilter = null;\\n\\t\\t\\t\\tcontinue;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tbreak;\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar conditionEntry = {};\\n\\tvar builder = new Rebuilder(text, this.match.index);\\n\\tvar reEndString = \\\"\\\\\\\\<\\\\\\\\%\\\\\\\\s*(endif)\\\\\\\\s*\\\\\\\\%\\\\\\\\>|\\\\\\\\<\\\\\\\\%\\\\\\\\s*(else)\\\\\\\\s*\\\\\\\\%\\\\\\\\>|\\\\\\\\<\\\\\\\\%\\\\\\\\s*(elseif)\\\\\\\\s+([\\\\\\\\s\\\\\\\\S]+?)\\\\\\\\%\\\\\\\\>\\\";\\n\\tthis.parser.pos = this.terminateIfMatch.index + this.terminateIfMatch[0].length;\\n\\tvar ex;\\n\\tvar filter = this.parser.source.substring(this.match.index + this.match[0].length, this.terminateIfMatch.index);\\n\\tvar endOfFilter = this.terminateIfMatch.index;\\n\\twhile (true) {\\n\\t\\tif (filter) {\\n\\t\\t\\tvar entry = filterRelinker.relink(filter, fromTitle, toTitle, options);\\n\\t\\t\\tif (entry) {\\n\\t\\t\\t\\tif (entry.output) {\\n\\t\\t\\t\\t\\tif (entry.output.indexOf('%>') > 0) {\\n\\t\\t\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tbuilder.add(entry.output, endOfFilter - filter.length, endOfFilter);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (entry.impossible) {\\n\\t\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tvar hasLineBreak = doubleLineBreakAtPos(this.parser);\\n\\t\\t// Parse the body looking for else or endif\\n\\t\\tif (hasLineBreak) {\\n\\t\\t\\tex = this.parser.parseBlocksTerminatedExtended(reEndString);\\n\\t\\t} else {\\n\\t\\t\\tvar reEnd = new RegExp(reEndString,\\\"mg\\\");\\n\\t\\t\\tex = this.parser.parseInlineRunTerminatedExtended(reEnd,{eatTerminator: true});\\n\\t\\t}\\n\\t\\tfor (var i = 0; i < ex.tree.length; i++) {\\n\\t\\t\\tvar child = ex.tree[i];\\n\\t\\t\\tif (child.output) {\\n\\t\\t\\t\\tbuilder.add(child.output, child.start, child.end);\\n\\t\\t\\t}\\n\\t\\t\\tif (child.impossible) {\\n\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (ex.match) {\\n\\t\\t\\tif (ex.match[3] === \\\"elseif\\\") {\\n\\t\\t\\t\\tfilter = ex.match[4];\\n\\t\\t\\t\\tendOfFilter = ex.match.index + ex.match[0].length - 2;\\n\\t\\t\\t\\tcontinue;\\n\\t\\t\\t} else if (ex.match[2] === \\\"else\\\") {\\n\\t\\t\\t\\tfilter = null;\\n\\t\\t\\t\\treEndString = \\\"\\\\\\\\<\\\\\\\\%\\\\\\\\s*(endif)\\\\\\\\s*\\\\\\\\%\\\\\\\\>\\\";\\n\\t\\t\\t\\tcontinue;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tbreak;\\n\\t}\\n\\tif (builder.changed() || builder.impossible) {\\n\\t\\tconditionEntry = {\\n\\t\\t\\toutput: builder.results(this.parser.pos),\\n\\t\\t\\timpossible: builder.impossible };\\n\\t}\\n\\treturn conditionEntry;\\n};\\n\\nfunction doubleLineBreakAtPos(parser) {\\n\\treturn !!$tw.utils.parseTokenRegExp(parser.source, parser.pos, /([^\\\\S\\\\n\\\\r]*\\\\r?\\\\n(?:[^\\\\S\\\\n\\\\r]*\\\\r?\\\\n|$))/g);\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/conditional.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/def.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: library\\n\\nThis is a generic def rule that manages both fnprocdef and macrodef.\\n\\n\\\\*/\\n\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils\\\");\\nvar VariableContext = utils.getContext('variable');\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar defOperators = utils.getModulesByTypeAsHashmap('relinkdef', 'name');\\n\\nexports.report = function(text, callback, options) {\\n\\t// fnprocdef and macrodef have their own implementations of createDefinition\\n\\t// They create a modifiable object from the respective rule matches.\\n\\tvar definition = this.createDefinition();\\n\\tvar setParseTreeNode = this.parse();\\n\\tvar context = this.parser.context = new VariableContext(this.parser.context, setParseTreeNode[0]);\\n\\t// Parse set the pos pointer, but we don't want to skip the macro body.\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tvar endMatch = getBodyMatch(this.parser.source, this.parser.pos, definition);\\n\\tif (endMatch) {\\n\\t\\tdefinition.body = endMatch[2];\\n\\t\\toptions.settings = context\\n\\t\\tfor (var operator in defOperators) {\\n\\t\\t\\tdefOperators[operator].report(definition, callback, options);\\n\\t\\t}\\n\\t\\tthis.parser.pos = endMatch.index + endMatch[0].length;\\n\\t}\\n\\tcontext.parameterFocus = false;\\n\\tcontext.placeholderList = undefined;\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\t// fnprocdef and macrodef have their own implementations of createDefinition\\n\\t// They create a modifiable object from the respective rule matches.\\n\\tvar definition = this.createDefinition();\\n\\tvar setParseTreeNode = this.parse(),\\n\\t\\tentry,\\n\\t\\tcontext = this.parser.context = new VariableContext(this.parser.context, setParseTreeNode[0]);\\n\\t// Parse set the pos pointer, but we don't want to skip the macro body.\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tvar endMatch = getBodyMatch(this.parser.source, this.parser.pos, definition);\\n\\tif (endMatch) {\\n\\t\\tdefinition.body = endMatch[2];\\n\\t\\toptions.settings = context;\\n\\t\\tfor (var operator in defOperators) {\\n\\t\\t\\tvar result = defOperators[operator].relink(definition, fromTitle, toTitle, options);\\n\\t\\t\\tif (result) {\\n\\t\\t\\t\\tentry = entry || {};\\n\\t\\t\\t\\tif (result.output) {\\n\\t\\t\\t\\t\\tentry.output = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (result.impossible) {\\n\\t\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tthis.parser.pos = endMatch.index + endMatch[0].length;\\n\\t\\tif (entry && entry.output) {\\n\\t\\t\\tentry.output = reassembleSignature(definition, this.match[0]) + endMatch[1] + definition.body + endMatch[0];\\n\\t\\t}\\n\\t}\\n\\tcontext.parameterFocus = false;\\n\\tcontext.placeholderList = undefined;\\n\\treturn entry;\\n};\\n\\nfunction reassembleSignature(definition, text) {\\n\\t// Reconstruct the definition. Might be tricky because we need to preserve whitespace within the parameters.\\n\\tvar builder = new Rebuilder(text);\\n\\tbuilder.add(definition.type, 1, text.search(/[^\\\\w\\\\\\\\]/));\\n\\tvar pos = builder.index;\\n\\tbuilder.add(definition.name, skipWhitespace(text, pos), text.indexOf('(', pos));\\n\\tpos = builder.index;\\n\\tif (definition.parameters) {\\n\\t\\tbuilder.add(definition.parameters, skipWhitespace(text, pos+1), text.indexOf(')'));\\n\\t}\\n\\treturn builder.results();\\n};\\n\\nfunction skipWhitespace(text, pos) {\\n\\treturn text.substr(pos).search(/\\\\S/)+pos;\\n};\\n\\n// Return another match for the body, but tooled uniquely\\n// m[1] = whitespace before body\\n// m[2] = body\\n// m.index + m[0].length -> end of match\\nfunction getBodyMatch(text, pos, definition) {\\n\\tvar whitespace,\\n\\t\\tvalueRegExp;\\n\\tif (definition.multiline) {\\n\\t\\tvalueRegExp = new RegExp(\\\"\\\\\\\\r?\\\\\\\\n[^\\\\\\\\S\\\\\\\\n\\\\\\\\r]*\\\\\\\\\\\\\\\\end[^\\\\\\\\S\\\\\\\\n\\\\\\\\r]*(?:\\\" + $tw.utils.escapeRegExp(definition.name) + \\\")?(?:\\\\\\\\r?\\\\\\\\n|$)\\\", \\\"mg\\\");\\n\\t\\twhitespace = '';\\n\\t} else {\\n\\t\\tvalueRegExp = /(?:\\\\r?\\\\n|$)/mg;\\n\\t\\tvar newPos = $tw.utils.skipWhiteSpace(text, pos);\\n\\t\\twhitespace = text.substring(pos, newPos);\\n\\t\\tpos = newPos;\\n\\t}\\n\\tvalueRegExp.lastIndex = pos;\\n\\tvar match = valueRegExp.exec(text);\\n\\tif (match) {\\n\\t\\tmatch[1] = whitespace;\\n\\t\\tmatch[2] = text.substring(pos, match.index);\\n\\t}\\n\\treturn match;\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/def.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/filteredtransclude.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles replacement of filtered transclusions in wiki text like,\\n\\n{{{ [tag[docs]] }}}\\n{{{ [tag[docs]] |tooltip}}}\\n{{{ [tag[docs]] ||TemplateTitle}}}\\n{{{ [tag[docs]] |tooltip||TemplateTitle}}}\\n{{{ [tag[docs]] }}width:40;height:50;}.class.class\\n\\nThis renames both the list and the template field.\\n\\n\\\\*/\\n\\nexports.name = ['filteredtranscludeinline', 'filteredtranscludeblock'];\\n\\nvar filterHandler = require(\\\"$:/plugins/flibbles/relink/js/utils\\\").getType('filter');\\nvar utils = require(\\\"./utils.js\\\");\\n\\nexports.report = function(text, callback, options) {\\n\\tvar m = this.match,\\n\\t\\tfilter = m[1],\\n\\t\\ttemplate = $tw.utils.trim(m[3]),\\n\\t\\tappend = template ? '||' + template + '}}}' : '}}}';\\n\\tvar nestedOptions = Object.create(options);\\n\\tnestedOptions.settings = this.parser.context;\\n\\tfilterHandler.report(filter, function(title, blurb, style) {\\n\\t\\tcallback(title, '{{{' + blurb + append, style);\\n\\t}, nestedOptions);\\n\\tif (template) {\\n\\t\\tcallback(template, '{{{' + $tw.utils.trim(filter).replace(/\\\\r?\\\\n/mg, ' ') + '||}}}');\\n\\t}\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar m = this.match,\\n\\t\\tfilter = m[1],\\n\\t\\ttooltip = m[2],\\n\\t\\ttemplate = m[3],\\n\\t\\tstyle = m[4],\\n\\t\\tclasses = m[5],\\n\\t\\tparser = this.parser,\\n\\t\\tentry = {};\\n\\tparser.pos = this.matchRegExp.lastIndex;\\n\\tvar modified = false;\\n\\tvar nestedOptions = Object.create(options);\\n\\tnestedOptions.settings = this.parser.context;\\n\\tvar filterEntry = filterHandler.relink(filter, fromTitle, toTitle, nestedOptions);\\n\\tif (filterEntry !== undefined) {\\n\\t\\tif (filterEntry.output) {\\n\\t\\t\\tfilter = filterEntry.output;\\n\\t\\t\\tmodified = true;\\n\\t\\t}\\n\\t\\tif (filterEntry.impossible) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\n\\tif ($tw.utils.trim(template) === fromTitle) {\\n\\t\\t// preserves user-inputted whitespace\\n\\t\\ttemplate = template.replace(fromTitle, toTitle);\\n\\t\\tmodified = true;\\n\\t}\\n\\tif (!modified) {\\n\\t\\tif (!entry.impossible) {\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\t} else {\\n\\t\\tvar output = this.makeFilteredtransclude(this.parser, filter, tooltip, template, style, classes);\\n\\t\\tif (output === undefined) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t} else {\\n\\t\\t\\t// By copying over the ending newline of the original\\n\\t\\t\\t// text if present, thisrelink method thus works for\\n\\t\\t\\t// both the inline and block rule\\n\\t\\t\\tentry.output = output + utils.getEndingNewline(m[0]);\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\nexports.makeFilteredtransclude = function(parser, filter, tooltip, template, style, classes) {\\n\\tif (canBePretty(filter) && canBePrettyTemplate(template)) {\\n\\t\\treturn prettyList(filter, tooltip, template, style, classes);\\n\\t}\\n\\tif (classes !== undefined) {\\n\\t\\tclasses = classes.split('.').join(' ');\\n\\t}\\n\\treturn utils.makeWidget(parser, '$list', {\\n\\t\\tfilter: filter,\\n\\t\\ttooltip: tooltip,\\n\\t\\ttemplate: template,\\n\\t\\tstyle: style || undefined,\\n\\t\\titemClass: classes});\\n};\\n\\nfunction prettyList(filter, tooltip, template, style, classes) {\\n\\tif (tooltip === undefined) {\\n\\t\\ttooltip = '';\\n\\t} else {\\n\\t\\ttooltip = \\\"|\\\" + tooltip;\\n\\t}\\n\\tif (template === undefined) {\\n\\t\\ttemplate = '';\\n\\t} else {\\n\\t\\ttemplate = \\\"||\\\" + template;\\n\\t}\\n\\tif (classes === undefined) {\\n\\t\\tclasses = '';\\n\\t} else {\\n\\t\\tclasses = \\\".\\\" + classes;\\n\\t}\\n\\tstyle = style || '';\\n\\treturn \\\"{{{\\\"+filter+tooltip+template+\\\"}}\\\"+style+\\\"}\\\"+classes;\\n};\\n\\nfunction canBePretty(filter) {\\n\\treturn filter.indexOf('|') < 0 && filter.indexOf('}}') < 0;\\n};\\n\\nfunction canBePrettyTemplate(template) {\\n\\treturn !template || (\\n\\t\\ttemplate.indexOf('|') < 0\\n\\t\\t&& template.indexOf('{') < 0\\n\\t\\t&& template.indexOf('}') < 0);\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/filteredtransclude.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/fnprocdef.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles pragma function/procedure/widget definitions.\\n\\n\\\\*/\\n\\n// We inherit from DefRule\\nvar DefRule = require('./def.js');\\n$tw.utils.extend(exports, DefRule);\\n\\nexports.name = \\\"fnprocdef\\\";\\n\\nexports.createDefinition = function() {\\n\\tvar m = this.match;\\n\\treturn {\\n\\t\\ttype: m[1],\\n\\t\\tname: m[2],\\n\\t\\tparameters: m[4],\\n\\t\\tmultiline: m[5]};\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/fnprocdef.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles replacement in attributes of widgets and html elements\\nThis is configurable to select exactly which attributes of which elements\\nshould be changed.\\n\\n<$link to=\\\"TiddlerTitle\\\" />\\n\\n\\\\*/\\n\\nvar utils = require(\\\"./utils.js\\\");\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar htmlOperators = relinkUtils.getModulesByTypeAsHashmap('relinkhtml', 'name');\\n\\nexports.name = \\\"html\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\tvar element = this.nextTag.tag;\\n\\tvar nestedOptions = Object.create(options);\\n\\tnestedOptions.settings = this.parser.context;\\n\\tfor (var operator in htmlOperators) {\\n\\t\\thtmlOperators[operator].report(this.nextTag, this.parser, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '<' + blurb + ' />', style);\\n\\t\\t}, nestedOptions);\\n\\t}\\n\\tthis.parse();\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar widgetEntry = {};\\n\\twidgetEntry.attributes = Object.create(null);\\n\\twidgetEntry.element = this.nextTag.tag;\\n\\tvar elem = this.nextTag;\\n\\tvar originalTag = elem.tag;\\n\\tvar changed = false;\\n\\tvar nestedOptions = Object.create(options);\\n\\tnestedOptions.settings = this.parser.context;\\n\\tfor (var operator in htmlOperators) {\\n\\t\\tvar entry = htmlOperators[operator].relink(elem, this.parser, fromTitle, toTitle, nestedOptions);\\n\\t\\tif (entry) {\\n\\t\\t\\tif (entry.output) {\\n\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (entry.impossible) {\\n\\t\\t\\t\\twidgetEntry.impossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\t// We swap in the original tag in case it changed. We need the old tag\\n\\t// to find the proper closing tag. Parsing must come after the htmlmodules\\n\\t// because those might change the context for the inner body.\\n\\tvar newTag = elem.tag;\\n\\telem.tag = originalTag;\\n\\tvar tag = this.parse()[0];\\n\\tif (tag.children) {\\n\\t\\tfor (var i = 0; i < tag.children.length; i++) {\\n\\t\\t\\tvar child = tag.children[i];\\n\\t\\t\\tif (child.output) {\\n\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (child.impossible) {\\n\\t\\t\\t\\twidgetEntry.impossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\tif (changed) {\\n\\t\\tvar builder = new Rebuilder(text, elem.start);\\n\\t\\tbuilder.add(newTag, elem.start+1, getEndOfTag(elem, text));\\n\\t\\tfor (var attributeName in elem.attributes) {\\n\\t\\t\\tvar attr = elem.attributes[attributeName];\\n\\t\\t\\tvar quotedValue;\\n\\t\\t\\tswitch (attr.type) {\\n\\t\\t\\tcase 'string':\\n\\t\\t\\t\\tif (attr.valueless) {\\n\\t\\t\\t\\t\\tcontinue;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tvar quote = relinkUtils.determineQuote(text, attr);\\n\\t\\t\\t\\tquotedValue = utils.wrapAttributeValue(attr.value, quote)\\n\\t\\t\\t\\tif (quotedValue === undefined) {\\n\\t\\t\\t\\t\\twidgetEntry.impossible = true;\\n\\t\\t\\t\\t\\tcontinue;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\tcase 'indirect':\\n\\t\\t\\t\\tquotedValue = \\\"{{\\\" + attr.textReference + \\\"}}\\\";\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\tcase 'filtered':\\n\\t\\t\\t\\tquotedValue = \\\"{{{\\\" + attr.filter + \\\"}}}\\\";\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\tcase 'macro':\\n\\t\\t\\t\\tif (attr.output) {\\n\\t\\t\\t\\t\\tquotedValue = attr.output;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tquotedValue = undefined;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\t// Else If output isn't set, this wasn't ever changed\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\tcase 'substituted':\\n\\t\\t\\t\\tvar ticIndex = attr.rawValue.lastIndexOf(\\\"`\\\");\\n\\t\\t\\t\\tif (ticIndex < 0) {\\n\\t\\t\\t\\t\\tquotedValue = \\\"`\\\" + attr.rawValue + \\\"`\\\";\\n\\t\\t\\t\\t} else if (ticIndex < attr.rawValue.length-1\\n\\t\\t\\t\\t\\t\\t&& attr.rawValue.indexOf(\\\"```\\\") < 0) {\\n\\t\\t\\t\\t\\tquotedValue = \\\"```\\\" + attr.rawValue + \\\"```\\\";\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t// We can't have a tic at the end; can't have triple tic.\\n\\t\\t\\t\\t\\twidgetEntry.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\t}\\n\\t\\t\\tvar ptr = attr.start;\\n\\t\\t\\tptr = $tw.utils.skipWhiteSpace(text, ptr);\\n\\t\\t\\tif (attributeName !== attr.name) {\\n\\t\\t\\t\\t// Ooh, the attribute name changed\\n\\t\\t\\t\\tbuilder.add(attr.name, ptr, ptr + attributeName.length);\\n\\t\\t\\t}\\n\\t\\t\\tif (quotedValue) {\\n\\t\\t\\t\\t// We have a new attribute value\\n\\t\\t\\t\\tptr += attributeName.length;\\n\\t\\t\\t\\tptr = $tw.utils.skipWhiteSpace(text, ptr);\\n\\t\\t\\t\\tptr++; // For the equals\\n\\t\\t\\t\\tptr = $tw.utils.skipWhiteSpace(text, ptr);\\n\\t\\t\\t\\tbuilder.add(quotedValue, ptr, attr.end);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (tag.children) {\\n\\t\\t\\tfor (var i = 0; i < tag.children.length; i++) {\\n\\t\\t\\t\\tvar child = tag.children[i];\\n\\t\\t\\t\\tif (child.output) {\\n\\t\\t\\t\\t\\tbuilder.add(child.output, child.start, child.end);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tvar closingTag = '</' + elem.tag + '>';\\n\\t\\tvar startClosingTag = this.parser.pos - closingTag.length;\\n\\t\\tif (text.substring(startClosingTag, this.parser.pos) === closingTag) {\\n\\t\\t\\t// Replace the closing tag in case the tag changed.\\n\\t\\t\\tbuilder.add(newTag, startClosingTag + 2, this.parser.pos-1);\\n\\t\\t}\\n\\t\\twidgetEntry.output = builder.results(this.parser.pos);\\n\\t}\\n\\tif (widgetEntry.output || widgetEntry.impossible) {\\n\\t\\treturn widgetEntry;\\n\\t}\\n\\treturn undefined;\\n};\\n\\nfunction getEndOfTag(element, text) {\\n\\tvar regExp = /[^a-zA-Z\\\\-\\\\$\\\\.]/g;\\n\\tregExp.lastIndex = element.start+1;\\n\\tvar match = regExp.exec(text);\\n\\treturn match.index;\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/image.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles replacement in wiki text inline rules, like,\\n\\n[img[tiddler.jpg]]\\n\\n[img width=23 height=24 [Description|tiddler.jpg]]\\n\\n\\\\*/\\n\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar refHandler = require(\\\"$:/plugins/flibbles/relink/js/fieldtypes/reference\\\");\\nvar filterHandler = require(\\\"$:/plugins/flibbles/relink/js/utils\\\").getType('filter');\\nvar macrocall = require(\\\"./macrocall.js\\\");\\nvar utils = require(\\\"./utils.js\\\");\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nexports.name = \\\"image\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\tvar ptr = this.nextImage.start + 4; //[img\\n\\tvar inSource = false;\\n\\tfor (var attributeName in this.nextImage.attributes) {\\n\\t\\tvar attr = this.nextImage.attributes[attributeName];\\n\\t\\tif (attributeName === \\\"source\\\" || attributeName === \\\"tooltip\\\") {\\n\\t\\t\\tif (inSource) {\\n\\t\\t\\t\\tptr = text.indexOf('|', ptr);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tptr = text.indexOf('[', ptr);\\n\\t\\t\\t\\tinSource = true;\\n\\t\\t\\t}\\n\\t\\t\\tptr += 1;\\n\\t\\t}\\n\\t\\tif (attributeName === \\\"source\\\") {\\n\\t\\t\\tvar tooltip = this.nextImage.attributes.tooltip;\\n\\t\\t\\tvar blurb = '[img[' + (tooltip ? tooltip.value : '') + ']]';\\n\\t\\t\\tcallback(attr.value, blurb);\\n\\t\\t\\tptr = text.indexOf(attr.value, ptr);\\n\\t\\t\\tptr = text.indexOf(']]', ptr) + 2;\\n\\t\\t} else if (attributeName !== \\\"tooltip\\\") {\\n\\t\\t\\tptr = reportAttribute(this.parser, attr, callback, options);\\n\\t\\t}\\n\\t}\\n\\tthis.parser.pos = ptr;\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar ptr = this.nextImage.start,\\n\\t\\tbuilder = new Rebuilder(text, ptr),\\n\\t\\tmakeWidget = false,\\n\\t\\tskipSource = false,\\n\\t\\timageEntry;\\n\\tif (this.nextImage.attributes.source.value === fromTitle && !canBePretty(toTitle, this.nextImage.attributes.tooltip)) {\\n\\t\\tif (this.parser.context.allowWidgets() && utils.wrapAttributeValue(toTitle)) {\\n\\t\\t\\tmakeWidget = true;\\n\\t\\t\\tbuilder.add(\\\"<$image\\\", ptr, ptr+4);\\n\\t\\t} else {\\n\\t\\t\\t// We won't be able to make a wdget to replace\\n\\t\\t\\t// the source attribute. We check now so we don't\\n\\t\\t\\t// prematurely convert into a widget.\\n\\t\\t\\t// Keep going in case other attributes need replacing.\\n\\t\\t\\tskipSource = true;\\n\\t\\t}\\n\\t}\\n\\tptr += 4; //[img\\n\\tvar inSource = false;\\n\\tfor (var attributeName in this.nextImage.attributes) {\\n\\t\\tvar attr = this.nextImage.attributes[attributeName];\\n\\t\\tif (attributeName === \\\"source\\\" || attributeName === \\\"tooltip\\\") {\\n\\t\\t\\tif (inSource) {\\n\\t\\t\\t\\tptr = text.indexOf('|', ptr);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tptr = text.indexOf('[', ptr);\\n\\t\\t\\t\\tinSource = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (makeWidget) {\\n\\t\\t\\t\\tif (\\\" \\\\t\\\\n\\\".indexOf(text[ptr-1]) >= 0) {\\n\\t\\t\\t\\t\\tbuilder.add('', ptr, ptr+1);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tbuilder.add(' ', ptr, ptr+1);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tptr += 1;\\n\\t\\t}\\n\\t\\tif (attributeName === \\\"source\\\") {\\n\\t\\t\\tptr = text.indexOf(attr.value, ptr);\\n\\t\\t\\tif (attr.value === fromTitle) {\\n\\t\\t\\t\\tif (makeWidget) {\\n\\t\\t\\t\\t\\tvar quotedValue = utils.wrapAttributeValue(toTitle);\\n\\t\\t\\t\\t\\tif (quotedValue === undefined) {\\n\\t\\t\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tbuilder.add(\\\"source=\\\"+quotedValue, ptr, ptr+fromTitle.length);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t} else if (!skipSource) {\\n\\t\\t\\t\\t\\tbuilder.add(toTitle, ptr, ptr+fromTitle.length);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tptr = text.indexOf(']]', ptr);\\n\\t\\t\\tif (makeWidget) {\\n\\t\\t\\t\\tbuilder.add(\\\"/>\\\", ptr, ptr+2);\\n\\t\\t\\t}\\n\\t\\t\\tptr += 2;\\n\\t\\t} else if (attributeName === \\\"tooltip\\\") {\\n\\t\\t\\tif (makeWidget) {\\n\\t\\t\\t\\tptr = text.indexOf(attr.value, ptr);\\n\\t\\t\\t\\tvar quotedValue = utils.wrapAttributeValue(attr.value);\\n\\t\\t\\t\\tbuilder.add(\\\"tooltip=\\\"+quotedValue, ptr, ptr+attr.value.length);\\n\\t\\t\\t}\\n\\t\\t} else {\\n\\t\\t\\tptr = relinkAttribute(this.parser, attr, builder, fromTitle, toTitle, options);\\n\\t\\t}\\n\\t}\\n\\tthis.parser.pos = ptr;\\n\\tif (builder.changed() || builder.impossible) {\\n\\t\\timageEntry = {\\n\\t\\t\\toutput: builder.results(ptr),\\n\\t\\t\\timpossible: builder.impossible };\\n\\t}\\n\\treturn imageEntry;\\n};\\n\\nfunction reportAttribute(parser, attribute, callback, options) {\\n\\tvar text = parser.source;\\n\\tvar ptr = text.indexOf(attribute.name, attribute.start);\\n\\tvar end;\\n\\tptr += attribute.name.length;\\n\\tptr = text.indexOf('=', ptr);\\n\\tif (attribute.type === \\\"string\\\") {\\n\\t\\tptr = text.indexOf(attribute.value, ptr)\\n\\t\\tvar quote = relinkUtils.determineQuote(text, attribute);\\n\\t\\t// ignore first quote. We already passed it\\n\\t\\tend = ptr + quote.length + attribute.value.length;\\n\\t} else if (attribute.type === \\\"indirect\\\") {\\n\\t\\tptr = text.indexOf('{{', ptr);\\n\\t\\tvar end = ptr + attribute.textReference.length + 4;\\n\\t\\trefHandler.report(attribute.textReference, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '[img ' + attribute.name + '={{' + (blurb || '') + '}}]', style);\\n\\t\\t}, options);\\n\\t} else if (attribute.type === \\\"filtered\\\") {\\n\\t\\tptr = text.indexOf('{{{', ptr);\\n\\t\\tvar end = ptr + attribute.filter.length + 6;\\n\\t\\tfilterHandler.report(attribute.filter, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '[img ' + attribute.name + '={{{' + blurb + '}}}]', style);\\n\\t\\t}, options);\\n\\t} else if (attribute.type === \\\"macro\\\") {\\n\\t\\tptr = text.indexOf(\\\"<<\\\", ptr);\\n\\t\\tvar end = attribute.value.end;\\n\\t\\tvar macro = attribute.value;\\n\\t\\tvar oldValue = attribute.value;\\n\\t\\tmacrocall.reportAttribute(parser, macro, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '[img ' + attribute.name + '=' + blurb + ']', style);\\n\\t\\t}, options);\\n\\t}\\n\\treturn end;\\n};\\n\\nfunction relinkAttribute(parser, attribute, builder, fromTitle, toTitle, options) {\\n\\tvar text = builder.text;\\n\\tvar ptr = text.indexOf(attribute.name, attribute.start);\\n\\tvar end;\\n\\tptr += attribute.name.length;\\n\\tptr = text.indexOf('=', ptr);\\n\\tif (attribute.type === \\\"string\\\") {\\n\\t\\tptr = text.indexOf(attribute.value, ptr)\\n\\t\\tvar quote = relinkUtils.determineQuote(text, attribute);\\n\\t\\t// ignore first quote. We already passed it\\n\\t\\tend = ptr + quote.length + attribute.value.length;\\n\\t} else if (attribute.type === \\\"indirect\\\") {\\n\\t\\tptr = text.indexOf('{{', ptr);\\n\\t\\tvar end = ptr + attribute.textReference.length + 4;\\n\\t\\tvar ref = refHandler.relinkInBraces(attribute.textReference, fromTitle, toTitle, options);\\n\\t\\tif (ref) {\\n\\t\\t\\tif (ref.impossible) {\\n\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (ref.output) {\\n\\t\\t\\t\\tbuilder.add(\\\"{{\\\"+ref.output+\\\"}}\\\", ptr, end);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t} else if (attribute.type === \\\"filtered\\\") {\\n\\t\\tptr = text.indexOf('{{{', ptr);\\n\\t\\tvar end = ptr + attribute.filter.length + 6;\\n\\t\\tvar filter = filterHandler.relinkInBraces(attribute.filter, fromTitle, toTitle, options);\\n\\t\\tif (filter !== undefined) {\\n\\t\\t\\tif (filter.impossible) {\\n\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (filter.output) {\\n\\t\\t\\t\\tvar quoted = \\\"{{{\\\"+filter.output+\\\"}}}\\\";\\n\\t\\t\\t\\tbuilder.add(quoted, ptr, end);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t} else if (attribute.type === \\\"macro\\\") {\\n\\t\\tptr = text.indexOf(\\\"<<\\\", ptr);\\n\\t\\tvar end = attribute.value.end;\\n\\t\\tvar macro = attribute.value;\\n\\t\\tvar oldValue = attribute.value;\\n\\t\\tvar macroEntry = macrocall.relinkAttribute(parser, macro, text, fromTitle, toTitle, options);\\n\\t\\tif (macroEntry !== undefined) {\\n\\t\\t\\tif (macroEntry.impossible) {\\n\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (macroEntry.output) {\\n\\t\\t\\t\\tbuilder.add(macroEntry.output, ptr, end);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn end;\\n};\\n\\nfunction canBePretty(title, tooltip) {\\n\\treturn title.indexOf(']') < 0 && (tooltip || title.indexOf('|') < 0);\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/image.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/import.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles import pragmas\\n\\n\\\\import [tag[MyTiddler]]\\n\\\\*/\\n\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils.js\\\");\\nvar filterRelinker = utils.getType('filter');\\nvar ImportContext = utils.getContext('import');\\n\\nexports.name = \\\"import\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\t// This moves the pos for us\\n\\tvar parseTree = this.parse();\\n\\tvar filter = parseTree[0].attributes.filter.value || '';\\n\\tfilterRelinker.report(filter, function(title, blurb, style) {\\n\\t\\tif (blurb) {\\n\\t\\t\\tblurb = '\\\\\\\\import ' + blurb;\\n\\t\\t} else {\\n\\t\\t\\tblurb = '\\\\\\\\import';\\n\\t\\t}\\n\\t\\tcallback(title, blurb, style);\\n\\t}, options);\\n\\t// Before we go, we need to actually import the variables\\n\\t// it's calling for, and any /relink pragma\\n\\toptions.settings = this.parser.context = new ImportContext(options.wiki, this.parser.context, filter);\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\t// In this one case, I'll let the parser parse out the filter and move\\n\\t// the ptr.\\n\\tvar start = this.matchRegExp.lastIndex,\\n\\t\\tparseTree = this.parse(),\\n\\t\\tfilter = parseTree[0].attributes.filter.value || '',\\n\\t\\tentry = filterRelinker.relink(filter, fromTitle, toTitle, options);\\n\\tif (entry !== undefined && entry.output) {\\n\\t\\tvar newline = text.substring(start+filter.length, this.parser.pos);\\n\\t\\tfilter = entry.output;\\n\\t\\tentry.output = \\\"\\\\\\\\import \\\" + filter + newline;\\n\\t}\\n\\n\\t// Before we go, we need to actually import the variables\\n\\t// it's calling for, and any /relink pragma\\n\\toptions.settings = this.parser.context = new ImportContext(options.wiki, this.parser.context, filter);\\n\\n\\treturn entry;\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/import.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/macrocall.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles macro calls.\\n\\n<<myMacro '[[MyFilter]]' 'myTitle'>>\\n\\n\\\\*/\\n\\nvar utils = require(\\\"./utils.js\\\");\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar macrocall = require('$:/plugins/flibbles/relink/js/utils/macrocall.js');\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar EntryNode = require('$:/plugins/flibbles/relink/js/utils/entry');\\n\\nexports.name = [\\\"macrocallinline\\\", \\\"macrocallblock\\\"];\\n\\nexports.report = function(text, callback, options) {\\n\\tvar macroInfo = getInfoFromRule(this);\\n\\tthis.parser.pos = macroInfo.end;\\n\\tthis.reportAttribute(this.parser, macroInfo, callback, options);\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar macroInfo = getInfoFromRule(this);\\n\\tthis.parser.pos = macroInfo.end;\\n\\tvar mayBeWidget = this.parser.context.allowWidgets();\\n\\tvar names = getParamNames(this.parser, macroInfo.name, macroInfo.params, options);\\n\\tif (names === undefined) {\\n\\t\\t// Needed the definition, and couldn't find it. So if a single\\n\\t\\t// parameter doesn't work, just fail.\\n\\t\\tmayBeWidget = false;\\n\\t}\\n\\tvar entry = macrocall.relink(this.parser.context, macroInfo, text, fromTitle, toTitle, mayBeWidget, options);\\n\\tif (entry && entry.output) {\\n\\t\\tentry.output = macroToString(entry, text, names, this.parser, options);\\n\\t\\tif (entry.output === undefined) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\n/** Relinks macros that occur as attributes, like <$element attr=<<...>> />\\n *  Processes the same, except it can't downgrade into a widget if the title\\n *  is complicated.\\n * Kept for backward compatibility reasons\\n */\\nexports.relinkAttribute = function(parser, macro, text, fromTitle, toTitle, options) {\\n\\tvar entry = macrocall.relink(parser.context, macro, text, fromTitle, toTitle, false, options);\\n\\tif (entry && entry.output) {\\n\\t\\tentry.output = macrocall.reassemble(entry, text, options);\\n\\t}\\n\\treturn entry;\\n};\\n\\n/** As in, report a macrocall invocation that is an html attribute.\\n * Kept for backward compatibility reasons\\n */\\nexports.reportAttribute = function(parser, macro, callback, options) {\\n\\tmacrocall.report(parser.context, macro, function(title, blurb, style) {\\n\\t\\tcallback(title, \\\"<<\\\" + blurb + \\\">>\\\", style);\\n\\t}, options);\\n};\\n\\nfunction getInfoFromRule(rule) {\\n\\t// Get all the details of the match\\n\\tvar macroInfo = rule.nextCall;\\n\\tif (!macroInfo) {\\n\\t\\t//  rule.match is used <v5.1.24\\n\\t\\tvar match = rule.match,\\n\\t\\t\\toffset = $tw.utils.skipWhiteSpace(match[0], match[1].length+2);\\n\\t\\tmacroInfo = {\\n\\t\\t\\tname: match[1],\\n\\t\\t\\tstart: rule.matchRegExp.lastIndex - match[0].length,\\n\\t\\t\\tend: rule.matchRegExp.lastIndex,\\n\\t\\t};\\n\\t\\tmacroInfo.params = parseParams(match[2], offset+macroInfo.start);\\n\\t}\\n\\t// post v5.3.0 changed it so name and param aren't used, but we still use\\n\\t// them. Maybe I should migrate so that I don't either, and that it's\\n\\t// orderedAttributes and $variable that I use.\\n\\tif (macroInfo.name === undefined) {\\n\\t\\tmacroInfo.name = macroInfo.attributes[\\\"$variable\\\"].value;\\n\\t\\tmacroInfo.params = macroInfo.orderedAttributes.slice(1);\\n\\t\\tvar index = 0;\\n\\t\\tfor (var i = 0; i < macroInfo.params.length; i++) {\\n\\t\\t\\tvar param = macroInfo.params[i];\\n\\t\\t\\tif (param.name === index.toString()) {\\n\\t\\t\\t\\t// Swap out the param with one that doesn't have a name.\\n\\t\\t\\t\\tmacroInfo.params[i] = {\\n\\t\\t\\t\\t\\tstart: param.start,\\n\\t\\t\\t\\t\\tend: param.end,\\n\\t\\t\\t\\t\\ttype: param.type,\\n\\t\\t\\t\\t\\tvalue: param.value\\n\\t\\t\\t\\t};\\n\\t\\t\\t\\tindex++;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn macroInfo;\\n};\\n\\nfunction mustBeAWidget(macro) {\\n\\tfor (var i = 0; i < macro.params.length; i++) {\\n\\t\\tif (macrocall.wrapParameterValue(macro.params[i].value) === undefined) {\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t}\\n\\treturn false\\n};\\n\\n/**Given a macro object ({name:, params:, start: end:}), and the text where\\n * it was parsed from, returns a new macro that maintains any syntactic\\n * structuring.\\n */\\nfunction macroToString(entry, text, names, parser, options) {\\n\\tvar macro = entry.output;\\n\\tif (mustBeAWidget(macro) && parser.context.allowWidgets()) {\\n\\t\\tvar widgetString = macroToWidgetString(macro, names);\\n\\t\\tif (widgetString) {\\n\\t\\t\\t// It worked! return it.\\n\\t\\t\\treturn widgetString;\\n\\t\\t}\\n\\t\\tentry.impossible = true;\\n\\t\\t// Otherwise continue on and try macrocall anyways, despite failutes.\\n\\t}\\n\\treturn macrocall.reassemble(entry, text, options);\\n};\\n\\nfunction macroToWidgetString(macro, names) {\\n\\tvar attrs = [];\\n\\tfor (var i = 0; i < macro.params.length; i++) {\\n\\t\\tvar p = macro.params[i];\\n\\t\\tvar val;\\n\\t\\tif (p.newValue) {\\n\\t\\t\\tval = p.newValue;\\n\\t\\t} else {\\n\\t\\t\\tval = utils.wrapAttributeValue(p.value);\\n\\t\\t}\\n\\t\\tif (val !== undefined) {\\n\\t\\t\\tvar name = p.name;\\n\\t\\t\\tif (name === undefined) {\\n\\t\\t\\t\\tif (names === undefined) {\\n\\t\\t\\t\\t\\t// Oops. We've got to give up here. We can't resolve\\n\\t\\t\\t\\t\\t// the name of one of the parameters.\\n\\t\\t\\t\\t\\treturn undefined;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tname = names[i];\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tattrs.push(\\\" \\\"+name+\\\"=\\\"+val);\\n\\t\\t} else {\\n\\t\\t\\t// Oops. There's an attribute that can't be quoted. We need\\n\\t\\t\\t// to abort.\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\t}\\n\\treturn \\\"<$macrocall $name=\\\"+utils.wrapAttributeValue(macro.name)+attrs.join('')+\\\"/>\\\";\\n};\\n\\nfunction getParamNames(parser, macroName, params, options) {\\n\\tvar used = Object.create(null);\\n\\tvar rtn = new Array(params.length);\\n\\tvar anonsExist = false;\\n\\tvar i;\\n\\tfor (i = 0; i < params.length; i++) {\\n\\t\\tvar name = params[i].name;\\n\\t\\tif (name) {\\n\\t\\t\\trtn[i] = name;\\n\\t\\t\\tused[name] = true;\\n\\t\\t} else {\\n\\t\\t\\tanonsExist = true;\\n\\t\\t}\\n\\t}\\n\\tif (anonsExist) {\\n\\t\\tvar def = parser.context.getMacroDefinition(macroName);\\n\\t\\tif (def === undefined) {\\n\\t\\t\\t// If there are anonymous parameters, and we can't\\n\\t\\t\\t// find the definition, then we can't hope to create\\n\\t\\t\\t// a widget.\\n\\t\\t\\treturn undefined;\\n\\t\\t}\\n\\t\\tvar defParams = def.params || [];\\n\\t\\tvar defPtr = 0;\\n\\t\\tfor (i = 0; i < params.length; i++) {\\n\\t\\t\\tif (rtn[i] === undefined) {\\n\\t\\t\\t\\twhile(defPtr < defParams.length && used[defParams[defPtr].name]) {\\n\\t\\t\\t\\t\\tdefPtr++;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (defPtr >= defParams.length) {\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\trtn[i] = defParams[defPtr].name;\\n\\t\\t\\t\\tused[defParams[defPtr].name] = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn rtn;\\n};\\n\\nfunction parseParams(paramString, pos) {\\n\\tvar params = [],\\n\\t\\treParam = /\\\\s*(?:([A-Za-z0-9\\\\-_]+)\\\\s*:)?(?:\\\\s*(?:\\\"\\\"\\\"([\\\\s\\\\S]*?)\\\"\\\"\\\"|\\\"([^\\\"]*)\\\"|'([^']*)'|\\\\[\\\\[([^\\\\]]*)\\\\]\\\\]|([^\\\"'\\\\s]+)))/mg,\\n\\t\\tparamMatch = reParam.exec(paramString);\\n\\twhile(paramMatch) {\\n\\t\\t// Process this parameter\\n\\t\\tvar paramInfo = { };\\n\\t\\t// We need to find the group match that isn't undefined.\\n\\t\\tfor (var i = 2; i <= 6; i++) {\\n\\t\\t\\tif (paramMatch[i] !== undefined) {\\n\\t\\t\\t\\tparamInfo.value = paramMatch[i];\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif(paramMatch[1]) {\\n\\t\\t\\tparamInfo.name = paramMatch[1];\\n\\t\\t}\\n\\t\\t//paramInfo.start = pos;\\n\\t\\tparamInfo.end = reParam.lastIndex + pos;\\n\\t\\tparams.push(paramInfo);\\n\\t\\t// Find the next match\\n\\t\\tparamMatch = reParam.exec(paramString);\\n\\t}\\n\\treturn params;\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/macrocall.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/macrodef.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles pragma macro definitions.\\nWe may also update placeholder macros that we may have previously installed.\\n\\n\\\\define relink-?() Tough title\\n\\n\\\\*/\\n\\n// We inherit from DefRule\\nvar DefRule = require('./def.js');\\n$tw.utils.extend(exports, DefRule);\\n\\nexports.name = \\\"macrodef\\\";\\n\\nexports.createDefinition = function() {\\n\\tvar m = this.match;\\n\\treturn {\\n\\t\\ttype: \\\"define\\\",\\n\\t\\tname: m[1],\\n\\t\\tparameters: m[2],\\n\\t\\tmultiline: m[3]};\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/macrodef.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/parameters.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles parameters pragma.\\n\\n\\\\parameters(...)\\n\\n\\\\*/\\n\\nexports.name = \\\"parameters\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\toperate(this, options);\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\toperate(this, options);\\n};\\n\\nfunction operate(rule, options) {\\n\\tvar parser = rule.parser;\\n\\tvar parseTreeNode = rule.parse();\\n\\tvar attributes = parseTreeNode[0].orderedAttributes;\\n\\tfor (var i = 0; i < attributes.length; i++) {\\n\\t\\tvar attribute = attributes[i].name;\\n\\t\\tparser.context.addParameter(attribute);\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/parameters.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/prettylink.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles replacement in wiki text inline rules, like,\\n\\n[[Introduction]]\\n\\n[[link description|TiddlerTitle]]\\n\\n\\\\*/\\n\\nvar utils = require(\\\"./utils.js\\\");\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nexports.name = \\\"prettylink\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\tvar text = this.match[1],\\n\\t\\tlink = this.match[2] || text;\\n\\tif (!$tw.utils.isLinkExternal(link)) {\\n\\t\\tvar type = relinkUtils.getType('title');\\n\\t\\ttype.report(link, function(title) {\\n\\t\\t\\tcallback(title, '[[' + text + ']]');\\n\\t\\t}, options);\\n\\t}\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar type = relinkUtils.getType('title'),\\n\\t\\tcaption = this.match[1],\\n\\t\\tlink = this.match[2] || caption,\\n\\t\\tentry = type.relink(link, fromTitle, toTitle, options);\\n\\tif (entry && !entry.impossible) {\\n\\t\\tentry.output = utils.makePrettylink(this.parser, entry.output, this.match[2] && caption);\\n\\t\\tif (entry.output === undefined) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\treturn entry;\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/prettylink.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/quoteblock.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles the quote blocks, as in:\\n\\n<<<\\n...\\n<<<\\n\\n\\\\*/\\n\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\n\\nexports.name = \\\"quoteblock\\\";\\n\\nexports.type = {block: true};\\n\\nexports.report = function(text, callback, options) {\\n\\tvar reEndString = \\\"^\\\" + this.match[1] + \\\"(?!<)\\\";\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\n\\tthis.parser.parseClasses();\\n\\tthis.parser.skipWhitespace({treatNewlinesAsNonWhitespace: true});\\n\\n\\t// Parse the optional cite\\n\\treportCite(this.parser, this.match[1]);\\n\\t// Now parse the body of the quote\\n\\tthis.parser.parseBlocks(reEndString);\\n\\tif (this.match) {\\n\\t\\t// Now parse the closing cite\\n\\t\\treportCite(this.parser, this.match[1]);\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar reEndString = \\\"^\\\" + this.match[1] + \\\"(?!<)\\\";\\n\\tvar builder = new Rebuilder(text, this.parser.pos);\\n\\tvar entry;\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\n\\tthis.parser.parseClasses();\\n\\tthis.parser.skipWhitespace({treatNewlinesAsNonWhitespace: true});\\n\\n\\t// Parse the optional cite\\n\\tmergeRelinks(builder, this.parser.parseInlineRun(/(\\\\r?\\\\n)/mg));\\n\\t// Now parse the body of the quote\\n\\tmergeRelinks(builder, this.parser.parseBlocks(reEndString));\\n\\t// Now parse the closing cite\\n\\tmergeRelinks(builder, this.parser.parseInlineRun(/(\\\\r?\\\\n)/mg));\\n\\n\\tif (builder.changed() || builder.impossible) {\\n\\t\\tentry = {};\\n\\t\\tentry.output = builder.results(this.parser.pos);\\n\\t\\tif (builder.impossible) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\nfunction reportCite(parser, delimeter) {\\n\\tvar callback = parser.callback;\\n\\ttry {\\n\\t\\tparser.callback = function(title, blurb, style) {\\n\\t\\t\\treturn callback(title, delimeter + \\\" \\\" + blurb, style);\\n\\t\\t};\\n\\t\\tparser.parseInlineRun(/(\\\\r?\\\\n)/mg);\\n\\t} finally {\\n\\t\\tparser.callback = callback;\\n\\t}\\n};\\n\\nfunction mergeRelinks(builder, output) {\\n\\tif (output.length > 0) {\\n\\t\\tfor (var i = 0; i < output.length; i++) {\\n\\t\\t\\tvar o = output[i];\\n\\t\\t\\tif (o.output) {\\n\\t\\t\\t\\tbuilder.add(o.output, o.start, o.end);\\n\\t\\t\\t}\\n\\t\\t\\tif (o.impossible) {\\n\\t\\t\\t\\tbuilder.impossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/quoteblock.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/relink.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: wikirule\\n\\nThis defines the \\\\relink inline pragma used to locally declare\\nrelink rules for macros.\\n\\nIt takes care of providing its own relink and report rules.\\n\\n\\\\*/\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar language = require('$:/plugins/flibbles/relink/js/language.js');\\nvar pragmaOperators = utils.getModulesByTypeAsHashmap('relinkpragma', 'name');\\n\\nexports.name = \\\"relink\\\";\\nexports.types = {pragma: true};\\n\\nexports.init = function(parser) {\\n\\tthis.parser = parser;\\n\\tthis.matchRegExp = /^\\\\\\\\relink[^\\\\S\\\\r\\\\n]+([^(\\\\s]+)([^\\\\r\\\\n]*)(\\\\r?\\\\n)?/mg;\\n};\\n\\n/**This makes the widget that the macro library will later parse to determine\\n * new macro relink state.\\n *\\n * It's a <$set> widget so it can appear BEFORE \\\\define pragma and not\\n * prevent that pragma from being scooped up by importvariables.\\n * (importvariables stops scooping as soon as it sees something besides $set) */\\nexports.parse = function() {\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tvar macroName;\\n\\tvar macroParams = Object.create(null);\\n\\tvar error = undefined;\\n\\tvar rtn = [];\\n\\tvar self = this;\\n\\tinterpretSettings(this, function(macro, parameter, type) {\\n\\t\\tmacroName = macro;\\n\\t\\tif (type && !utils.getType(type)) {\\n\\t\\t\\terror = language.getString(\\\"text/plain\\\", \\\"Error/UnrecognizedType\\\",\\n\\t\\t\\t\\t{variables: {type: type}, wiki: self.parser.wiki});\\n\\t\\t}\\n\\t\\tmacroParams[parameter] = type;\\n\\t});\\n\\t// If no macroname. Return nothing, this rule will be ignored by parsers\\n\\tif (macroName) {\\n\\t\\tvar relink = Object.create(null);\\n\\t\\trelink[macroName] = macroParams;\\n\\t\\trtn.push({\\n\\t\\t\\ttype: \\\"set\\\",\\n\\t\\t\\tattributes: {\\n\\t\\t\\t\\tname: {type: \\\"string\\\", value: \\\"\\\"}\\n\\t\\t\\t},\\n\\t\\t\\tchildren: [],\\n\\t\\t\\tisRelinkDefinition: true,\\n\\t\\t\\tisMacroDefinition: true,\\n\\t\\t\\trelink: relink});\\n\\t}\\n\\tif (error) {\\n\\t\\trtn.push({\\n\\t\\t\\ttype: \\\"element\\\", tag: \\\"span\\\", attributes: {\\n\\t\\t\\t\\t\\\"class\\\": {\\n\\t\\t\\t\\t\\ttype: \\\"string\\\",\\n\\t\\t\\t\\t\\tvalue: \\\"tc-error tc-relink-error\\\"\\n\\t\\t\\t\\t}\\n\\t\\t\\t}, children: [\\n\\t\\t\\t\\t{type: \\\"text\\\", text: error}\\n\\t\\t\\t]});\\n\\t}\\n\\treturn rtn;\\n};\\n\\nexports.report = function(text, callback, options) {\\n\\toperate(this, options);\\n\\tfor (var operator in pragmaOperators) {\\n\\t\\tpragmaOperators[operator].report(this, callback, options);\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\toperate(this, options);\\n\\tvar entry;\\n\\tfor (var operator in pragmaOperators) {\\n\\t\\t// Yes, this only handles one thing for now. I haven't bothered\\n\\t\\t// breaking up \\\\relink into a modifiable type.\\n\\t\\tentry = pragmaOperators[operator].relink(this, fromTitle, toTitle, options);\\n\\t}\\n\\treturn entry;\\n};\\n\\nfunction operate(rule, options) {\\n\\tvar parser = rule.parser;\\n\\tvar currentTiddler = parser.context.widget.variables.currentTiddler.value;\\n\\tparser.pos = rule.matchRegExp.lastIndex;\\n\\tinterpretSettings(rule, function(macro, parameter, type) {\\n\\t\\toptions.settings.addSetting(parser.wiki, macro, parameter, type, currentTiddler);\\n\\t});\\n\\t// Return nothing, because this rule is ignored by the parser\\n\\treturn undefined;\\n};\\n\\nfunction interpretSettings(rule, block) {\\n\\tvar paramString = rule.match[2];\\n\\tif (paramString !== \\\"\\\") {\\n\\t\\tvar macro = rule.match[1];\\n\\t\\tvar reParam = /\\\\s*([$A-Za-z0-9\\\\-_]+)(?:\\\\s*:\\\\s*([^\\\\s]+))?/mg;\\n\\t\\tvar paramMatch = reParam.exec(paramString);\\n\\t\\twhile (paramMatch) {\\n\\t\\t\\tvar parameter = paramMatch[1];\\n\\t\\t\\tvar type = paramMatch[2];\\n\\t\\t\\tblock(macro, parameter, type);\\n\\t\\t\\tparamMatch = reParam.exec(paramString);\\n\\t\\t}\\n\\t}\\n};\\n\",\n            \"module-type\": \"wikirule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/relink.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/rules.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nParses and acknowledges any pragma rules a tiddler has.\\n\\n\\\\rules except html wikilink\\n\\n\\\\*/\\n\\nexports.name = \\\"rules\\\";\\n\\n/**This is all we have to do. The rules rule doesn't parse. It just amends\\n * the rules, which is exactly what I want it to do too.\\n * It also takes care of moving the pos pointer forward.\\n */\\nexports.relink = function() {\\n\\tthis.parse();\\n\\treturn undefined;\\n};\\n\\n// Same deal\\nexports.report = exports.relink;\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/rules.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/syslink.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles sys links\\n\\n$:/sys/link\\n\\nbut not:\\n\\n~$:/sys/link\\n\\n\\\\*/\\n\\nvar utils = require(\\\"./utils.js\\\");\\n\\nexports.name = \\\"syslink\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\tvar title = this.match[0];\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tif (title[0] !== \\\"~\\\") {\\n\\t\\tcallback(title, '~' + title);\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar entry = undefined;\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tif (this.match[0] === fromTitle && this.match[0][0] !== \\\"~\\\") {\\n\\t\\tentry = {output: this.makeSyslink(toTitle, options)};\\n\\t\\tif (entry.output === undefined) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\nexports.makeSyslink = function(title, options) {\\n\\tvar match = title.match(this.matchRegExp);\\n\\tif (match && match[0] === title && title[0] !== \\\"~\\\") {\\n\\t\\treturn title;\\n\\t} else {\\n\\t\\treturn utils.makePrettylink(this.parser, title);\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/syslink.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/table.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles tables. Or rather handles the cells inside the tables, since tables\\nthemselves aren't relinked.\\n\\n\\\\*/\\n\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\n\\nexports.name = \\\"table\\\";\\n\\nexports.types = {block: true};\\n\\nexports.report = function(text, callback, options) {\\n\\tvar rowRegExp = /^\\\\|([^\\\\n]*)\\\\|([fhck]?)\\\\r?(?:\\\\n|$)/mg,\\n\\t\\trowTermRegExp = /(\\\\|(?:[fhck]?)\\\\r?(?:\\\\n|$))/mg;\\n\\t// Match the row\\n\\trowRegExp.lastIndex = this.parser.pos;\\n\\tvar rowMatch = rowRegExp.exec(this.parser.source);\\n\\twhile(rowMatch && rowMatch.index === this.parser.pos) {\\n\\t\\tvar rowType = rowMatch[2];\\n\\t\\t// Check if it is a class assignment\\n\\t\\tif(rowType === \\\"k\\\") {\\n\\t\\t\\tthis.parser.pos = rowMatch.index + rowMatch[0].length;\\n\\t\\t} else if(rowType === \\\"c\\\") {\\n\\t\\t\\t// Is this a caption row?\\n\\t\\t\\t// If so, move past the opening `|` of the row\\n\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t// Parse the caption\\n\\t\\t\\tvar oldCallback = this.parser.callback;\\n\\t\\t\\tthis.parser.callback = function(title, blurb, style) {\\n\\t\\t\\t\\tcallback(title, '|' + blurb + '|c', style);\\n\\t\\t\\t};\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tthis.parser.parseInlineRun(rowTermRegExp,{eatTerminator: true});\\n\\t\\t\\t} finally {\\n\\t\\t\\t\\tthis.parser.callback = oldCallback;\\n\\t\\t\\t}\\n\\t\\t} else {\\n\\t\\t\\t// Process the row\\n\\t\\t\\tprocessRow.call(this, rowType, callback);\\n\\t\\t\\tthis.parser.pos = rowMatch.index + rowMatch[0].length;\\n\\t\\t}\\n\\t\\trowMatch = rowRegExp.exec(this.parser.source);\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar rowRegExp = /^\\\\|([^\\\\n]*)\\\\|([fhck]?)\\\\r?(?:\\\\n|$)/mg,\\n\\t\\trowTermRegExp = /(\\\\|(?:[fhck]?)\\\\r?(?:\\\\n|$))/mg,\\n\\t\\tbuilder = new Rebuilder(text, this.parser.pos),\\n\\t\\timpossible = false,\\n\\t\\toutput,\\n\\t\\tentry;\\n\\t// Match the row\\n\\trowRegExp.lastIndex = this.parser.pos;\\n\\tvar rowMatch = rowRegExp.exec(this.parser.source);\\n\\twhile(rowMatch && rowMatch.index === this.parser.pos) {\\n\\t\\tvar rowType = rowMatch[2];\\n\\t\\t// Check if it is a class assignment\\n\\t\\tif(rowType === \\\"k\\\") {\\n\\t\\t\\tthis.parser.pos = rowMatch.index + rowMatch[0].length;\\n\\t\\t} else {\\n\\t\\t\\t// Is this a caption row?\\n\\t\\t\\tif(rowType === \\\"c\\\") {\\n\\t\\t\\t\\t// If so, move past the opening `|` of the row\\n\\t\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t\\t// Parse the caption\\n\\t\\t\\t\\toutput = this.parser.parseInlineRun(rowTermRegExp,{eatTerminator: true});\\n\\t\\t\\t} else {\\n\\t\\t\\t\\t// Process the row\\n\\t\\t\\t\\toutput = processRow.call(this);\\n\\t\\t\\t\\tthis.parser.pos = rowMatch.index + rowMatch[0].length;\\n\\t\\t\\t}\\n\\t\\t\\tif (output.length > 0) {\\n\\t\\t\\t\\tfor (var i = 0; i < output.length; i++) {\\n\\t\\t\\t\\t\\tvar o = output[i];\\n\\t\\t\\t\\t\\tif (o.output) {\\n\\t\\t\\t\\t\\t\\tbuilder.add(o.output, o.start, o.end);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tif (o.impossible) {\\n\\t\\t\\t\\t\\t\\timpossible = true;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\trowMatch = rowRegExp.exec(this.parser.source);\\n\\t}\\n\\tif (builder.changed() || impossible) {\\n\\t\\tentry = {}\\n\\t\\tentry.output = builder.results(this.parser.pos);\\n\\t\\tif (impossible) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\nvar processRow = function(rowType, callback) {\\n\\tvar cellRegExp = /(?:\\\\|([^\\\\n\\\\|]*)\\\\|)|(\\\\|[fhck]?\\\\r?(?:\\\\n|$))/mg,\\n\\t\\tcellTermRegExp = /((?:\\\\x20*)\\\\|)/mg,\\n\\t\\tchildren = [];\\n\\t// Match a single cell\\n\\tcellRegExp.lastIndex = this.parser.pos;\\n\\tvar cellMatch = cellRegExp.exec(this.parser.source);\\n\\twhile(cellMatch && cellMatch.index === this.parser.pos) {\\n\\t\\tif(cellMatch[2]) {\\n\\t\\t\\t// End of row\\n\\t\\t\\tthis.parser.pos = cellRegExp.lastIndex - 1;\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tswitch (cellMatch[1]) {\\n\\t\\tcase '~':\\n\\t\\tcase '>':\\n\\t\\tcase '<':\\n\\t\\t\\t// Move to just before the `|` terminating the cell\\n\\t\\t\\tthis.parser.pos = cellRegExp.lastIndex - 1;\\n\\t\\t\\tbreak;\\n\\t\\tdefault:\\n\\t\\t\\t// For ordinary cells, step beyond the opening `|`\\n\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t// Look for a space at the start of the cell\\n\\t\\t\\tvar spaceLeft = false;\\n\\t\\t\\tvar prefix = '|';\\n\\t\\t\\tvar suffix = '|';\\n\\t\\t\\tif(this.parser.source.substr(this.parser.pos).search(/^\\\\^([^\\\\^]|\\\\^\\\\^)/) === 0) {\\n\\t\\t\\t\\tprefix += '^';\\n\\t\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t} else if(this.parser.source.substr(this.parser.pos).search(/^,([^,]|,,)/) === 0) {\\n\\t\\t\\t\\tprefix += ',';\\n\\t\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t}\\n\\t\\t\\tvar chr = this.parser.source.substr(this.parser.pos,1);\\n\\t\\t\\twhile(chr === \\\" \\\") {\\n\\t\\t\\t\\tspaceLeft = true;\\n\\t\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t\\tchr = this.parser.source.substr(this.parser.pos,1);\\n\\t\\t\\t}\\n\\t\\t\\tif (spaceLeft) {\\n\\t\\t\\t\\tprefix += ' ';\\n\\t\\t\\t}\\n\\t\\t\\t// Check whether this is a heading cell\\n\\t\\t\\tif(chr === \\\"!\\\") {\\n\\t\\t\\t\\tthis.parser.pos++;\\n\\t\\t\\t\\tprefix += '!';\\n\\t\\t\\t}\\n\\t\\t\\t// Parse the cell\\n\\t\\t\\tvar oldCallback = this.parser.callback;\\n\\t\\t\\tvar reports = [];\\n\\t\\t\\tthis.parser.callback = function(title, blurb, style) {\\n\\t\\t\\t\\treports.push(title, blurb, style);\\n\\t\\t\\t};\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tvar output = this.parser.parseInlineRun(cellTermRegExp,{eatTerminator: true});\\n\\t\\t\\t\\tif (output.length > 0) {\\n\\t\\t\\t\\t\\tchildren.push(output[0]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif(this.parser.source.substr(this.parser.pos - 2,1) === \\\" \\\") { // spaceRight\\n\\t\\t\\t\\t\\tsuffix = ' |';\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tfor (var i = 0; i < reports.length; i += 3) {\\n\\t\\t\\t\\t\\tcallback(reports[i], prefix + reports[i+1] + suffix + rowType, reports[i+2]);\\n\\t\\t\\t\\t}\\n\\t\\t\\t} finally {\\n\\t\\t\\t\\tthis.parser.callback = oldCallback;\\n\\t\\t\\t}\\n\\t\\t\\t// Move back to the closing `|`\\n\\t\\t\\tthis.parser.pos--;\\n\\t\\t}\\n\\t\\tcellRegExp.lastIndex = this.parser.pos;\\n\\t\\tcellMatch = cellRegExp.exec(this.parser.source);\\n\\t}\\n\\treturn children;\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/table.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/transclude.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles replacement of transclusions in wiki text like,\\n\\n{{RenamedTiddler}}\\n{{RenamedTiddler||TemplateTitle}}\\n\\nThis renames both the tiddler and the template field.\\n\\n\\\\*/\\n\\nvar refHandler = require(\\\"$:/plugins/flibbles/relink/js/fieldtypes/reference\\\");\\nvar titleHandler = require(\\\"$:/plugins/flibbles/relink/js/fieldtypes/title\\\");\\nvar utils = require(\\\"./utils.js\\\");\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar referenceOperators = relinkUtils.getModulesByTypeAsHashmap('relinkreference', 'name');\\n\\nexports.name = ['transcludeinline', 'transcludeblock'];\\n\\nexports.report = function(text, callback, options) {\\n\\tvar m = this.match,\\n\\t\\trefString = $tw.utils.trim(m[1]),\\n\\t\\tref = parseTextReference(refString),\\n\\t\\ttemplate = $tw.utils.trim(m[2]),\\n\\t\\tparams = m[3];\\n\\tfor (var operator in referenceOperators) {\\n\\t\\treferenceOperators[operator].report(ref, function(title, blurb, style) {\\n\\t\\t\\tblurb = blurb || \\\"\\\";\\n\\t\\t\\tif (template) {\\n\\t\\t\\t\\tblurb += '||' + template;\\n\\t\\t\\t}\\n\\t\\t\\tif (params) {\\n\\t\\t\\t\\tblurb += '|' + params;\\n\\t\\t\\t}\\n\\t\\t\\tcallback(title, \\\"{{\\\" + blurb + \\\"}}\\\", style);\\n\\t\\t}, options);\\n\\t}\\n\\ttitleHandler.report(template, function(title, blurb, style) {\\n\\t\\tvar templateBlurb = refString + '||';\\n\\t\\tif (params) {\\n\\t\\t\\ttemplateBlurb += '|' + params;\\n\\t\\t}\\n\\t\\tcallback(template, '{{' + templateBlurb + '}}', style);\\n\\t}, options);\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar m = this.match,\\n\\t\\treference = parseTextReference(m[1]),\\n\\t\\ttemplate = m[2],\\n\\t\\tparams = m[3],\\n\\t\\tentry = undefined,\\n\\t\\timpossible = false,\\n\\t\\tmodified = false;\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tfor (var operator in referenceOperators) {\\n\\t\\tvar result = referenceOperators[operator].relink(reference, fromTitle, toTitle, options);\\n\\t\\tif (result !== undefined) {\\n\\t\\t\\tif (result.impossible) {\\n\\t\\t\\t\\timpossible = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (result.output) {\\n\\t\\t\\t\\treference = result.output;\\n\\t\\t\\t\\tmodified = true\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\tvar templateEntry = titleHandler.relink($tw.utils.trim(template), fromTitle, toTitle, options);\\n\\tif (templateEntry) {\\n\\t\\tif (templateEntry.impossible) {\\n\\t\\t\\timpossible = true;\\n\\t\\t}\\n\\t\\tif (templateEntry.output) {\\n\\t\\t\\ttemplate = template.replace(fromTitle, toTitle);\\n\\t\\t\\tmodified = true;\\n\\t\\t}\\n\\t}\\n\\tif (modified) {\\n\\t\\tvar output = this.makeTransclude(this.parser, reference, template, params);\\n\\t\\tif (output) {\\n\\t\\t\\t// Adding any newline that might have existed is\\n\\t\\t\\t// what allows this relink method to work for both\\n\\t\\t\\t// the block and inline filter wikitext rule.\\n\\t\\t\\tentry = {output: output + utils.getEndingNewline(m[0])};\\n\\t\\t} else {\\n\\t\\t\\timpossible = true;\\n\\t\\t}\\n\\t}\\n\\tif (impossible) {\\n\\t\\tentry = entry || {};\\n\\t\\tentry.impossible = true;\\n\\t}\\n\\treturn entry;\\n};\\n\\n// I have my own because the core one is deficient for my needs.\\nfunction parseTextReference(textRef) {\\n\\t// Separate out the title, field name and/or JSON indices\\n\\tvar reTextRef = /^([\\\\w\\\\W]*?)(?:!!(\\\\S[\\\\w\\\\W]*)|##(\\\\S[\\\\w\\\\W]*))?$/g,\\n\\t\\tmatch = reTextRef.exec(textRef),\\n\\t\\tresult = {};\\n\\tif(match) {\\n\\t\\t// Return the parts\\n\\t\\tresult.title = match[1];\\n\\t\\tresult.field = match[2];\\n\\t\\tresult.index = match[3];\\n\\t} else {\\n\\t\\t// If we couldn't parse it\\n\\t\\tresult.title = textRef\\n\\t}\\n\\treturn result;\\n};\\n\\n/** This converts a reference and a template into a string representation\\n *  of a transclude.\\n */\\nexports.makeTransclude = function(parser, reference, template, params) {\\n\\tvar rtn;\\n\\tif (!canBePrettyTemplate(template)) {\\n\\t\\tvar widget = utils.makeWidget(parser, '$transclude', {\\n\\t\\t\\ttiddler: $tw.utils.trim(template),\\n\\t\\t\\tfield: reference.field,\\n\\t\\t\\tindex: reference.index});\\n\\t\\tif (reference.title && widget !== undefined) {\\n\\t\\t\\trtn = utils.makeWidget(parser, '$tiddler', {tiddler: $tw.utils.trim(reference.title)}, widget);\\n\\t\\t} else {\\n\\t\\t\\trtn = widget;\\n\\t\\t}\\n\\t} else if (!canBePrettyTitle(reference.title) || !canBePrettyField(reference.field)) {\\n\\t\\t// This block and the next account for the 1%...\\n\\t\\tvar transclude;\\n\\t\\tif (canBePrettyField(reference.field)) {\\n\\t\\t\\tvar reducedRef = {field: reference.field, index: reference.index};\\n\\t\\t\\ttransclude = prettyTransclude(reducedRef, template, params);\\n\\t\\t} else {\\n\\t\\t\\ttransclude = utils.makeWidget(parser, \\\"$transclude\\\", {tiddler: $tw.utils.trim(reference.title), field: reference.field});\\n\\t\\t}\\n\\t\\trtn = utils.makeWidget(parser, '$tiddler', {tiddler: $tw.utils.trim(reference.title)}, transclude);\\n\\t} else {\\n\\t\\t// This block takes care of 99% of all cases\\n\\t\\trtn = prettyTransclude(reference, template, params);\\n\\t}\\n\\treturn rtn;\\n};\\n\\nfunction canBePrettyTitle(value) {\\n\\treturn refHandler.canBePretty(value) && canBePrettyTemplate(value);\\n};\\n\\nfunction canBePrettyField(value) {\\n\\treturn !/[\\\\|\\\\}\\\\{]/.test(value);\\n};\\n\\nfunction canBePrettyTemplate(value) {\\n\\treturn !value || (value.indexOf('}') < 0 && value.indexOf('{') < 0 && value.indexOf('|') < 0);\\n};\\n\\nfunction prettyTransclude(textReference, template, params) {\\n\\tif (typeof textReference !== \\\"string\\\") {\\n\\t\\ttextReference = refHandler.toString(textReference);\\n\\t}\\n\\tif (!textReference) {\\n\\t\\ttextReference = '';\\n\\t}\\n\\tif (template !== undefined) {\\n\\t\\ttextReference += \\\"||\\\" + template;\\n\\t}\\n\\tif (params) {\\n\\t\\ttextReference += \\\"|\\\" + params;\\n\\t}\\n\\treturn \\\"{{\\\"+textReference+\\\"}}\\\";\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/transclude.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/typedblock.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles the typeed blocks, as in:\\n\\n$$$text/vnd.tiddlywiki>text/html\\n...\\n$$$\\n\\n\\\\*/\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar language = require('$:/plugins/flibbles/relink/js/language.js');\\n\\nexports.name = \\\"typedblock\\\";\\n\\nexports.types = {block: true};\\n\\nvar textOperators;\\nvar oldTextOperators;\\n\\nfunction getTextOperator(type, options) {\\n\\tvar operator;\\n\\tif (textOperators === undefined) {\\n\\t\\ttextOperators = utils.getModulesByTypeAsHashmap('relinktext', 'type');\\n\\t\\toldTextOperators = utils.getModulesByTypeAsHashmap('relinktextoperator', 'type');\\n\\t}\\n\\toperator = textOperators[type];\\n\\tif (operator) {\\n\\t\\treturn operator;\\n\\t}\\n\\tvar info = $tw.utils.getFileExtensionInfo(type);\\n\\tif (info && textOperators[info.type]) {\\n\\t\\treturn textOperators[info.type];\\n\\t}\\n\\tvar old = oldTextOperators[type] || (info && oldTextOperators[info.type]);\\n\\tif (old) {\\n\\t\\tvar vars = Object.create(options);\\n\\t\\tvars.variables = {type: old.type, keyword: type};\\n\\t\\tvar warnString = language.getString(\\\"text/html\\\", \\\"Warning/OldRelinkTextOperator\\\", vars)\\n\\t\\tlanguage.warn(warnString);\\n\\t\\toldTextOperators[type] = undefined;\\n\\t}\\n};\\n\\nfunction getText() {\\n\\tvar reEnd = /\\\\r?\\\\n\\\\$\\\\$\\\\$\\\\r?(?:\\\\n|$)/mg;\\n\\t// Move past the match\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\t// Look for the end of the block\\n\\treEnd.lastIndex = this.parser.pos;\\n\\tvar match = reEnd.exec(this.parser.source),\\n\\t\\ttext;\\n\\t// Process the block\\n\\tif(match) {\\n\\t\\ttext = this.parser.source.substring(this.parser.pos,match.index);\\n\\t\\tthis.parser.pos = match.index + match[0].length;\\n\\t} else {\\n\\t\\ttext = this.parser.source.substr(this.parser.pos);\\n\\t\\tthis.parser.pos = this.parser.sourceLength;\\n\\t}\\n\\treturn text;\\n};\\n\\nexports.report = function(text, callback, options) {\\n\\tvar innerText = getText.call(this),\\n\\t\\toperator = getTextOperator(this.match[1], options);\\n\\tif (operator) {\\n\\t\\treturn operator.report(innerText, callback, options);\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar start = this.parser.pos,\\n\\t\\tinnerStart = this.matchRegExp.lastIndex,\\n\\t\\tinnerText = getText.call(this),\\n\\t\\toperator = getTextOperator(this.match[1], options);\\n\\tif (operator) {\\n\\t\\tvar innerOptions = Object.create(options);\\n\\t\\tinnerOptions.settings = this.parser.context;\\n\\t\\tvar results = operator.relink(innerText, fromTitle, toTitle, innerOptions);\\n\\t\\tif (results && results.output) {\\n\\t\\t\\tvar builder = new Rebuilder(text, start);\\n\\t\\t\\tbuilder.add(results.output, innerStart, innerStart + innerText.length);\\n\\t\\t\\tresults.output = builder.results(this.parser.pos);\\n\\t\\t}\\n\\t\\treturn results;\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/typedblock.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/utils.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: library\\n\\nUtility methods for the wikitext relink rules.\\n\\n\\\\*/\\n\\nexports.makeWidget = function(parser, tag, attributes, body) {\\n\\tif (!parser.context.allowWidgets()) {\\n\\t\\treturn undefined;\\n\\t}\\n\\tvar string = '<' + tag;\\n\\tfor (var attr in attributes) {\\n\\t\\tvar value = attributes[attr];\\n\\t\\tif (value !== undefined) {\\n\\t\\t\\tvar quoted = exports.wrapAttributeValue(value);\\n\\t\\t\\tif (!quoted) {\\n\\t\\t\\t\\t// It's not possible to make this widget\\n\\t\\t\\t\\treturn undefined;\\n\\t\\t\\t}\\n\\t\\t\\tstring += ' ' + attr + '=' + quoted;\\n\\t\\t}\\n\\t}\\n\\tif (body !== undefined) {\\n\\t\\tstring += '>' + body + '</' + tag + '>';\\n\\t} else {\\n\\t\\tstring += '/>';\\n\\t}\\n\\treturn string;\\n};\\n\\nexports.makePrettylink = function(parser, title, caption) {\\n\\tvar output;\\n\\tif (parser.context.allowPrettylinks() && canBePrettylink(title, caption)) {\\n\\t\\tif (caption !== undefined) {\\n\\t\\t\\toutput = \\\"[[\\\" + caption + \\\"|\\\" + title + \\\"]]\\\";\\n\\t\\t} else {\\n\\t\\t\\toutput = \\\"[[\\\" + title + \\\"]]\\\";\\n\\t\\t}\\n\\t} else if (caption !== undefined) {\\n\\t\\tvar safeCaption = sanitizeCaption(parser, caption);\\n\\t\\tif (safeCaption !== undefined) {\\n\\t\\t\\toutput = exports.makeWidget(parser, '$link', {to: title}, safeCaption);\\n\\t\\t}\\n\\t} else if (exports.shorthandPrettylinksSupported(parser.wiki)) {\\n\\t\\toutput = exports.makeWidget(parser, '$link', {to: title});\\n\\t}\\n\\treturn output;\\n};\\n\\n/**In version 5.1.20, Tiddlywiki made it so <$link to\\\"something\\\" /> would\\n * use \\\"something\\\" as a caption. This is preferable. However, Relink works\\n * going back to 5.1.14, so we need to have different handling for both\\n * cases.\\n */\\nvar _supported;\\nexports.shorthandPrettylinksSupported = function(wiki) {\\n\\tif (_supported === undefined) {\\n\\t\\tvar test = wiki.renderText(\\\"text/plain\\\", \\\"text/vnd.tiddlywiki\\\", \\\"<$link to=test/>\\\");\\n\\t\\t_supported = (test === \\\"test\\\");\\n\\t}\\n\\treturn _supported;\\n};\\n\\n/**Return true if value can be used inside a prettylink.\\n */\\nfunction canBePrettylink(value, customCaption) {\\n\\treturn value.indexOf(\\\"]]\\\") < 0 && value[value.length-1] !== ']' && (customCaption !== undefined || value.indexOf('|') < 0);\\n};\\n\\nfunction sanitizeCaption(parser, caption) {\\n\\tvar plaintext = parser.wiki.renderText(\\\"text/plain\\\", \\\"text/vnd.tiddlywiki\\\", caption);\\n\\tif (plaintext === caption && caption.indexOf(\\\"</$link>\\\") <= 0) {\\n\\t\\treturn caption;\\n\\t} else {\\n\\t\\treturn exports.makeWidget(parser, '$text', {text: caption});\\n\\t}\\n};\\n\\nexports.containsPlaceholders = function(string) {\\n\\t// Does it contain a variable placeholder?\\n\\tif (/\\\\$\\\\(([^\\\\)\\\\$]+)\\\\)\\\\$/.test(string)) {\\n\\t\\treturn true;\\n\\t}\\n\\t// Does it contain a filter placeholder?\\n\\tvar filterStart = string.indexOf(\\\"${\\\");\\n\\tif (filterStart >= 0 && string.indexOf(\\\"}$\\\", filterStart+3) >= 0) {\\n\\t\\treturn true;\\n\\t}\\n\\t// If no, then it's just a string.\\n\\treturn false;\\n};\\n\\nvar whitelist = [\\\"\\\", \\\"'\\\", '\\\"', '\\\"\\\"\\\"'];\\nvar choices = {\\n\\t\\\"\\\": function(v) {return !/([\\\\/\\\\s<>\\\"'`=])/.test(v) && v.length > 0; },\\n\\t\\\"'\\\": function(v) {return v.indexOf(\\\"'\\\") < 0; },\\n\\t'\\\"': function(v) {return v.indexOf('\\\"') < 0; },\\n\\t'\\\"\\\"\\\"': function(v) {return v.indexOf('\\\"\\\"\\\"') < 0 && v[v.length-1] != '\\\"';},\\n};\\nvar _backticksSupported;\\n\\n/**Finds an appropriate quote mark for a given value.\\n *\\n *Tiddlywiki doesn't have escape characters for attribute values. Instead,\\n * we just have to find the type of quotes that'll work for the given title.\\n * There exist titles that simply can't be quoted.\\n * If it can stick with the preference, it will.\\n *\\n * return: Returns the wrapped value, or undefined if it's impossible to wrap\\n */\\nexports.wrapAttributeValue = function(value, preference) {\\n\\tif (_backticksSupported === undefined) {\\n\\t\\tvar test = $tw.wiki.renderText(\\\"text/plain\\\", \\\"text/vnd.tiddlywiki\\\", \\\"<$link to=`test`/>\\\");\\n\\t\\t_backticksSupported = (test === \\\"test\\\");\\n\\t\\tif (_backticksSupported) {\\n\\t\\t\\t// add in support for the backtick to the lists\\n\\t\\t\\twhitelist.push('`', '```');\\n\\t\\t\\tchoices['`'] = function(v) {return v.indexOf('`') < 0 && !exports.containsPlaceholders(v); };\\n\\t\\t\\tchoices['```'] = function(v) {return v.indexOf('```') < 0 && v[v.length-1] != '`' && !exports.containsPlaceholders(v);};\\n\\t\\t}\\n\\t}\\n\\tif (choices[preference] && choices[preference](value)) {\\n\\t\\treturn wrap(value, preference);\\n\\t}\\n\\tfor (var i = 0; i < whitelist.length; i++) {\\n\\t\\tvar quote = whitelist[i];\\n\\t\\tif (choices[quote](value)) {\\n\\t\\t\\treturn wrap(value, quote);\\n\\t\\t}\\n\\t}\\n\\t// No quotes will work on this\\n\\treturn undefined;\\n};\\n\\nfunction wrap(value, wrapper) {\\n\\tvar wrappers = {\\n\\t\\t\\\"\\\": function(v) {return v; },\\n\\t\\t\\\"'\\\": function(v) {return \\\"'\\\"+v+\\\"'\\\"; },\\n\\t\\t'\\\"': function(v) {return '\\\"'+v+'\\\"'; },\\n\\t\\t'\\\"\\\"\\\"': function(v) {return '\\\"\\\"\\\"'+v+'\\\"\\\"\\\"'; },\\n\\t\\t\\\"[[\\\": function(v) {return \\\"[[\\\"+v+\\\"]]\\\"; },\\n\\t\\t\\\"`\\\": function(v) {return '`'+v+'`'; },\\n\\t\\t'```': function(v) {return '```'+v+'```'; }\\n\\t};\\n\\tvar chosen = wrappers[wrapper];\\n\\tif (chosen) {\\n\\t\\treturn chosen(value);\\n\\t} else {\\n\\t\\treturn undefined;\\n\\t}\\n};\\n\\nfunction canBePrettyOperand(value) {\\n\\treturn value.indexOf(']') < 0;\\n};\\n\\n// Finds the newline at the end of a string and returns it. Empty string if\\n// none exists.\\nexports.getEndingNewline = function(string) {\\n\\tvar l = string.length;\\n\\tif (string[l-1] === '\\\\n') {\\n\\t\\treturn (string[l-2] === '\\\\r') ? \\\"\\\\r\\\\n\\\" : \\\"\\\\n\\\";\\n\\t}\\n\\treturn \\\"\\\";\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/utils.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/whitespace.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles whitespace pragma\\n\\n\\\\*/\\n\\nexports.name = \\\"whitespace\\\";\\n\\n// We don't actually do anything, but we can't rely on\\n// the default behavior of moving to parser.pos.\\n// we have to forward past all the whitespace tokens.\\nexports.relink = exports.report = function() { this.parse(); }\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/whitespace.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/wikilink.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: relinkwikitextrule\\n\\nHandles CamelCase links\\n\\nWikiLink\\n\\nbut not:\\n\\n~WikiLink\\n\\n\\\\*/\\n\\nvar utils = require(\\\"./utils.js\\\");\\n\\nexports.name = \\\"wikilink\\\";\\n\\nexports.report = function(text, callback, options) {\\n\\tvar title = this.match[0],\\n\\t\\tunlink = $tw.config.textPrimitives.unWikiLink;\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tif (title[0] !== unlink) {\\n\\t\\tcallback(title, unlink + title);\\n\\t}\\n};\\n\\nexports.relink = function(text, fromTitle, toTitle, options) {\\n\\tvar entry = undefined,\\n\\t\\ttitle = this.match[0];\\n\\tthis.parser.pos = this.matchRegExp.lastIndex;\\n\\tif (title === fromTitle && title[0] !== $tw.config.textPrimitives.unWikiLink) {\\n\\t\\tentry = { output: this.makeWikilink(toTitle, options) };\\n\\t\\tif (entry.output === undefined) {\\n\\t\\t\\tentry.impossible = true;\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\nexports.makeWikilink = function(title, options) {\\n\\tif (title.match(this.matchRegExp) && title[0] !== $tw.config.textPrimitives.unWikiLink) {\\n\\t\\treturn title;\\n\\t} else {\\n\\t\\treturn utils.makePrettylink(this.parser, title);\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkwikitextrule\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/wikilink.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/def/body.js\": {\n            \"text\": \"/*\\\\\\n\\nTakes care of relinking the bodies of definitions.\\n\\n\\\\*/\\n\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils\\\");\\n\\nexports.name = \\\"body\\\";\\n\\nexports.report = function(definition, callback, options) {\\n\\tvar handler = getHandler(definition.type, definition.name);\\n\\tif (handler) {\\n\\t\\tvar newOptions = Object.create(options);\\n\\t\\tvar entry = handler.report(definition.body, function(title, blurb, style) {\\n\\t\\t\\tvar macroStr = '\\\\\\\\' + definition.type + ' ' + definition.name + '()';\\n\\t\\t\\tif (blurb) {\\n\\t\\t\\t\\tmacroStr += ' ' + blurb;\\n\\t\\t\\t}\\n\\t\\t\\tcallback(title, macroStr, style);\\n\\t\\t}, newOptions);\\n\\t}\\n};\\n\\nexports.relink = function(definition, fromTitle, toTitle, options) {\\n\\tvar handler = getHandler(definition.type, definition.name);\\n\\tvar results;\\n\\tif (handler) {\\n\\t\\tvar newOptions = Object.create(options);\\n\\t\\tresults = handler.relink(definition.body, fromTitle, toTitle, newOptions);\\n\\t\\tif (results && results.output) {\\n\\t\\t\\tdefinition.body = results.output;\\n\\t\\t}\\n\\t}\\n\\treturn results;\\n};\\n\\nfunction getHandler(macroType, macroName) {\\n\\tvar type;\\n\\tswitch (macroType) {\\n\\tcase \\\"function\\\":\\n\\t\\ttype = \\\"filter\\\";\\n\\t\\tbreak;\\n\\tcase \\\"define\\\":\\n\\t\\t/**This returns the handler to use for a macro\\n\\t\\t * By default, we treat them like wikitext, but Relink used to make\\n\\t\\t * little macros as placeholders. If we find one, we must return\\n\\t\\t * the correct handler for what that placeholder represented.\\n\\t\\t */\\n\\t\\tvar placeholder = /^relink-(?:(\\\\w+)-)?\\\\d+$/.exec(macroName);\\n\\t\\t// normal macro or special placeholder?\\n\\t\\tif (placeholder) {\\n\\t\\t\\ttype = placeholder[1] || 'title';\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\tdefault:\\n\\t\\ttype = 'wikitext';\\n\\t}\\n\\treturn utils.getType(type);\\n};\\n\",\n            \"module-type\": \"relinkdef\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/def/body.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/def/substitution.js\": {\n            \"text\": \"exports.name = 'substitution';\\nvar subHandler = require(\\\"$:/plugins/flibbles/relink/js/utils/substitution.js\\\");\\n\\nexports.report = function(definition, callback, options) {\\n\\tif (definition.type === 'define') {\\n\\t\\tvar options = Object.create(options);\\n\\t\\toptions.noFilterSubstitution = true;\\n\\t\\tsubHandler.report(definition.body, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '\\\\\\\\define ' + definition.name + '() ' + (blurb || ''), style);\\n\\t\\t}, options);\\n\\t}\\n};\\n\\nexports.relink = function(definition, fromTitle, toTitle, options) {\\n\\tvar results;\\n\\tif (definition.type === \\\"define\\\") {\\n\\t\\tvar options = Object.create(options);\\n\\t\\toptions.noFilterSubstitution = true;\\n\\t\\tresults = subHandler.relink(definition.body, fromTitle, toTitle, options);\\n\\t\\tif (results && results.output) {\\n\\t\\t\\tdefinition.body = results.output;\\n\\t\\t}\\n\\t}\\n\\treturn results;\\n};\\n\",\n            \"module-type\": \"relinkdef\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/def/substitution.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles all element attribute values. Most widget relinking happens here.\\n\\n\\\\*/\\n\\n'use strict';\\n\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar utils = require('../utils.js');\\nvar refHandler = relinkUtils.getType('reference');\\nvar filterHandler = relinkUtils.getType('filter');\\nvar macrocall = require(\\\"$:/plugins/flibbles/relink/js/utils/macrocall.js\\\");\\nvar substitution = require(\\\"$:/plugins/flibbles/relink/js/utils/substitution.js\\\");\\nvar attributeOperators = relinkUtils.getModulesByTypeAsHashmap('relinkhtmlattributes', 'name');\\n\\nexports.name = \\\"attributes\\\";\\n\\nexports.report = function(element, parser, callback, options) {\\n\\tfor (var attributeName in element.attributes) {\\n\\t\\tvar attr = element.attributes[attributeName];\\n\\t\\tvar nextEql = parser.source.indexOf('=', attr.start);\\n\\t\\t// This is the rare case of changing tiddler\\n\\t\\t// \\\"true\\\" to something else when \\\"true\\\" is\\n\\t\\t// implicit, like <$link to /> We ignore those.\\n\\t\\tif (nextEql < 0 || nextEql > attr.end) {\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\tswitch (attr.type) {\\n\\t\\tcase \\\"string\\\":\\n\\t\\t\\tfor (var operatorName in attributeOperators) {\\n\\t\\t\\t\\tvar operator = attributeOperators[operatorName];\\n\\t\\t\\t\\tvar handler = operator.getHandler(element, attr, options);\\n\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\thandler.report(attr.value, function(title, blurb, style) {\\n\\t\\t\\t\\t\\t\\tif (operator.formBlurb) {\\n\\t\\t\\t\\t\\t\\t\\tif (blurb) {\\n\\t\\t\\t\\t\\t\\t\\t\\tblurb = '\\\"' + blurb + '\\\"';\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\tcallback(title, operator.formBlurb(element, attr, blurb, options), style);\\n\\t\\t\\t\\t\\t\\t} else if (blurb) {\\n\\t\\t\\t\\t\\t\\t\\tcallback(title, element.tag + ' ' + attributeName + '=\\\"' + blurb + '\\\"', style);\\n\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\tcallback(title, element.tag + ' ' + attributeName, style);\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}, options);\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\tcase \\\"indirect\\\":\\n\\t\\t\\trefHandler.report(attr.textReference, function(title, blurb, style) {\\n\\t\\t\\t\\tcallback(title, element.tag + ' ' + attributeName + '={{' + (blurb || '') + '}}', style);\\n\\t\\t\\t}, options);\\n\\t\\t\\tbreak;\\n\\t\\tcase \\\"filtered\\\":\\n\\t\\t\\tfilterHandler.report(attr.filter, function(title, blurb, style) {\\n\\t\\t\\t\\tcallback(title, element.tag + ' ' + attributeName + '={{{' + blurb + '}}}', style);\\n\\t\\t\\t}, options);\\n\\t\\t\\tbreak;\\n\\t\\tcase \\\"macro\\\":\\n\\t\\t\\tvar macro = attr.value;\\n\\t\\t\\tmacrocall.report(options.settings, macro, function(title, blurb, style) {\\n\\t\\t\\t\\tcallback(title, element.tag + ' ' + attributeName + '=<<' + blurb + '>>', style);\\n\\t\\t\\t}, options);\\n\\t\\t\\tbreak;\\n\\t\\tcase \\\"substituted\\\":\\n\\t\\t\\tsubstitution.report(attr.rawValue, function(title, blurb, style) {\\n\\t\\t\\t\\tcallback(title, element.tag + ' ' + attributeName + '=`' + blurb + '`', style);\\n\\t\\t\\t}, options);\\n\\t\\t\\tfor (var operatorName in attributeOperators) {\\n\\t\\t\\t\\tvar operator = attributeOperators[operatorName];\\n\\t\\t\\t\\tvar handler = operator.getHandler(element, attr, options);\\n\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\thandler.report(attr.rawValue, function(title, blurb, style) {\\n\\t\\t\\t\\t\\t\\t// Only consider titles without substitutions.\\n\\t\\t\\t\\t\\t\\tif (!utils.containsPlaceholders(title)) {\\n\\t\\t\\t\\t\\t\\t\\tblurb = (utils.containsPlaceholders(attr.rawValue) || blurb)? '`' + blurb + '`': '';\\n\\t\\t\\t\\t\\t\\t\\tif (operator.formBlurb) {\\n\\t\\t\\t\\t\\t\\t\\t\\tblurb = operator.formBlurb(element, attr, blurb, options);\\n\\t\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\t\\tif (blurb) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tblurb = '=' + blurb;\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t\\tblurb = element.tag + ' ' + attributeName + blurb;\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\tcallback(title, blurb, style);\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}, options);\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.relink = function(element, parser, fromTitle, toTitle, options) {\\n\\tvar changed = undefined, impossible = undefined;\\n\\tfor (var attributeName in element.attributes) {\\n\\t\\tvar attr = element.attributes[attributeName];\\n\\t\\tvar nextEql = parser.source.indexOf('=', attr.start);\\n\\t\\t// This is the rare case of changing tiddler\\n\\t\\t// \\\"true\\\" to something else when \\\"true\\\" is\\n\\t\\t// implicit, like <$link to /> We ignore those.\\n\\t\\tif (nextEql < 0 || nextEql > attr.end) {\\n\\t\\t\\tattr.valueless = true;\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\tvar entry = undefined;\\n\\t\\tswitch (attr.type) {\\n\\t\\tcase 'substituted':\\n\\t\\t\\tif (utils.containsPlaceholders(attr.rawValue)) {\\n\\t\\t\\t\\tvar subEntry = substitution.relink(attr.rawValue, fromTitle, toTitle, options);\\n\\t\\t\\t\\tif (subEntry) {\\n\\t\\t\\t\\t\\tif (subEntry.output) {\\n\\t\\t\\t\\t\\t\\tattr.rawValue = subEntry.output;\\n\\t\\t\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tif (subEntry.impossible) {\\n\\t\\t\\t\\t\\t\\timpossible = true;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (!utils.containsPlaceholders(fromTitle)) {\\n\\t\\t\\t\\t\\tfor (var operatorName in attributeOperators) {\\n\\t\\t\\t\\t\\t\\tvar operator = attributeOperators[operatorName];\\n\\t\\t\\t\\t\\t\\tvar handler = operator.getHandler(element, attr, options);\\n\\t\\t\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\t\\t\\tentry = handler.relink(attr.rawValue, fromTitle, toTitle, options);\\n\\t\\t\\t\\t\\t\\t\\tif (entry && entry.output) {\\n\\t\\t\\t\\t\\t\\t\\t\\tif (utils.containsPlaceholders(toTitle)) {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t// If we relinked, but the toTitle can't be in\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t// a substitution, then we must fail instead.\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tattr.rawValue = entry.output;\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tattr.handler = handler.name;\\n\\t\\t\\t\\t\\t\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\t}\\n\\t\\t\\t// no break. turn it into a string and try to work with it\\n\\t\\t\\tattr.value = attr.rawValue;\\n\\t\\tcase 'string':\\n\\t\\t\\tfor (var operatorName in attributeOperators) {\\n\\t\\t\\t\\tvar operator = attributeOperators[operatorName];\\n\\t\\t\\t\\tvar handler = operator.getHandler(element, attr, options);\\n\\t\\t\\t\\tif (handler) {\\n\\t\\t\\t\\t\\tentry = handler.relink(attr.value, fromTitle, toTitle, options);\\n\\t\\t\\t\\t\\tif (entry && entry.output) {\\n\\t\\t\\t\\t\\t\\tattr.oldValue = attr.value;\\n\\t\\t\\t\\t\\t\\tattr.value = entry.output;\\n\\t\\t\\t\\t\\t\\tattr.handler = handler.name;\\n\\t\\t\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t\\t\\t\\t// Change it into a string if this was a substitution that had no substitutions\\n\\t\\t\\t\\t\\t\\tattr.type = 'string';\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\tcase 'indirect':\\n\\t\\t\\tentry = refHandler.relinkInBraces(attr.textReference, fromTitle, toTitle, options);\\n\\t\\t\\tif (entry && entry.output) {\\n\\t\\t\\t\\tattr.textReference = entry.output;\\n\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\tcase 'filtered':\\n\\t\\t\\tentry = filterHandler.relinkInBraces(attr.filter, fromTitle, toTitle, options);\\n\\t\\t\\tif (entry && entry.output) {\\n\\t\\t\\t\\tattr.filter = entry.output;\\n\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\tcase 'macro':\\n\\t\\t\\tvar macro = attr.value;\\n\\t\\t\\tentry = macrocall.relink(options.settings, macro, parser.source, fromTitle, toTitle, false, options);\\n\\t\\t\\tif (entry && entry.output) {\\n\\t\\t\\t\\tattr.output = macrocall.reassemble(entry, parser.source, options);\\n\\t\\t\\t\\tattr.value = entry.output;\\n\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t}\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tif (entry && entry.impossible) {\\n\\t\\t\\timpossible = true;\\n\\t\\t}\\n\\t}\\n\\tif (changed || impossible) {\\n\\t\\treturn {output: changed, impossible: impossible};\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkhtml\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/importvariables.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles state updating required for $importvariables widgets\\n\\n\\\\*/\\n\\nvar relinkUtils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar ImportContext = relinkUtils.getContext('import');\\n\\nexports.name = \\\"importvariables\\\";\\n\\nexports.report = function(element, parser, callback, options) {\\n\\tif (element.tag === \\\"$importvariables\\\") {\\n\\t\\tprocessImport(element, parser, options);\\n\\t}\\n};\\n\\nexports.relink = function(element, parser, fromTitle, toTitle, options) {\\n\\tif (element.tag === \\\"$importvariables\\\") {\\n\\t\\tprocessImport(element, parser, options);\\n\\t}\\n};\\n\\nfunction processImport(element, parser, options) {\\n\\tvar importFilterAttr = element.attributes.filter;\\n\\tif (importFilterAttr) {\\n\\t\\tprocessImportFilter(parser, importFilterAttr, options);\\n\\t}\\n};\\n\\n// This processes a <$importvariables> filter attribute and adds any new\\n// variables to our parser.\\nfunction processImportFilter(parser, importAttribute, options) {\\n\\tif (typeof importAttribute === \\\"string\\\") {\\n\\t\\t// It was changed. Reparse it. It'll be a quoted\\n\\t\\t// attribute value. Add a dummy attribute name.\\n\\t\\timportAttribute = $tw.utils.parseAttribute(\\\"p=\\\"+importAttribute, 0)\\n\\t}\\n\\tvar context = parser.context;\\n\\tvar importFilter = computeAttribute(context, importAttribute, options);\\n\\tparser.context = new ImportContext(options.wiki, context, importFilter);\\n};\\n\\nfunction computeAttribute(context, attribute, options) {\\n\\tvar value;\\n\\tif(attribute.type === \\\"filtered\\\") {\\n\\t\\tvar parentWidget = context.widget;\\n\\t\\tvalue = options.wiki.filterTiddlers(attribute.filter,parentWidget)[0] || \\\"\\\";\\n\\t} else if(attribute.type === \\\"indirect\\\") {\\n\\t\\tvar parentWidget = context.widget;\\n\\t\\tvalue = options.wiki.getTextReference(attribute.textReference,\\\"\\\",parentWidget.variables.currentTiddler.value);\\n\\t} else if(attribute.type === \\\"macro\\\") {\\n\\t\\tvar parentWidget = context.widget;\\n\\t\\tvalue = parentWidget.getVariable(attribute.value.name,{params: attribute.value.params});\\n\\t} else { // String attribute\\n\\t\\tvalue = attribute.value;\\n\\t}\\n\\treturn value;\\n};\\n\",\n            \"module-type\": \"relinkhtml\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/importvariables.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/parameters.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles replacement in $macrocall widgets\\n\\n\\\\*/\\n\\nexports.name = \\\"parameters\\\";\\n\\nexports.report = function(element, parser, callback, options) {\\n\\tif (element.tag === \\\"$parameters\\\") {\\n\\t\\tprocessParameters(element, parser, options);\\n\\t}\\n};\\n\\nexports.relink = function(element, parser, fromTitle, toTitle, options) {\\n\\tif (element.tag === \\\"$parameters\\\") {\\n\\t\\tprocessParameters(element, parser, options);\\n\\t}\\n};\\n\\nfunction processParameters(element, parser, options) {\\n\\tvar attributes = element.orderedAttributes;\\n\\tvar index = 0;\\n\\tfor (var i = 0; i < attributes.length; i++) {\\n\\t\\tvar attribute = attributes[i].name;\\n\\t\\tif (attribute[0] == '$') {\\n\\t\\t\\tif (attribute[1] == '$') {\\n\\t\\t\\t\\tattribute = attribute.substr(1);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tcontinue;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tparser.context.addParameter(attribute);\\n\\t\\t++index;\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkhtml\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/parameters.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/fields.js\": {\n            \"text\": \"/*\\\\ \\nHandles replacement in widgets which allow arbitrary attributes that\\ncorrespond to tiddler fields.\\n\\n\\\\*/\\n\\nexports.name = \\\"fields\\\";\\n\\nexports.getHandler = function(element, attribute, options) {\\n\\tvar regexp = options.settings.getConfig(\\\"fieldattributes\\\")[element.tag];\\n\\tif (regexp) {\\n\\t\\tvar results = regexp.exec(attribute.name);\\n\\t\\tif (results && results[0] === attribute.name) {\\n\\t\\t\\treturn options.settings.getFields()[results[1]];\\n\\t\\t}\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkhtmlattributes\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/fields.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/macrocall.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles replacement in $macrocall widgets\\n\\n\\\\*/\\n\\nexports.name = \\\"macrocall\\\";\\n\\nexports.getHandler = function(element, attribute, options) {\\n\\tif (element.tag === \\\"$macrocall\\\") {\\n\\t\\tvar nameAttr = element.attributes[\\\"$name\\\"];\\n\\t\\tif (nameAttr) {\\n\\t\\t\\tvar setting = options.settings.getMacro(nameAttr.value);\\n\\t\\t\\treturn setting && setting[attribute.name];\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.formBlurb = function(element, attribute, blurb, options) {\\n\\tvar nameAttr = element.attributes[\\\"$name\\\"];\\n\\tvar newBlurb = '<' + nameAttr.value + ' ' + attribute.name;\\n\\tif (blurb) {\\n\\t\\tnewBlurb += '=' + blurb;\\n\\t}\\n\\treturn newBlurb;\\n};\\n\",\n            \"module-type\": \"relinkhtmlattributes\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/macrocall.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/sendmessage.js\": {\n            \"text\": \"/*\\\\ \\nHandles replacement in $action-sendmessage widgets\\n\\n\\\\*/\\n\\nexports.name = \\\"sendmessage\\\";\\n\\nexports.getHandler = function(element, attribute, options) {\\n\\tif (element.tag === \\\"$action-sendmessage\\\"\\n\\t&& attribute.name[0] !== \\\"$\\\") {\\n\\t\\tvar messageAttr = element.attributes['$message'];\\n\\t\\tif (messageAttr) {\\n\\t\\t\\tvar regexp = options.settings.getConfig(\\\"messages\\\")[messageAttr.value];\\n\\t\\t\\tif (regexp) {\\n\\t\\t\\t\\tvar results = regexp.exec(attribute.name);\\n\\t\\t\\t\\tif (results && results[0] === attribute.name) {\\n\\t\\t\\t\\t\\treturn options.settings.getFields()[results[1]];\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.formBlurb = function(element, attribute, blurb, options) {\\n\\tvar messageAttr = element.attributes['$message'];\\n\\tvar newBlurb = '$action-sendmessage ' + messageAttr.value + ' ' + attribute.name;\\n\\tif (blurb) {\\n\\t\\tnewBlurb += '=' + blurb;\\n\\t}\\n\\treturn newBlurb;\\n};\\n\",\n            \"module-type\": \"relinkhtmlattributes\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/sendmessage.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/transclude.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles replacement in $transclude widgets\\n\\n\\\\*/\\n\\nexports.name = \\\"transclude\\\";\\n\\nexports.getHandler = function(element, attribute, options) {\\n\\tif (element.tag === \\\"$transclude\\\") {\\n\\t\\tvar name = attribute.name;\\n\\t\\tif (name[0] === '$') {\\n\\t\\t\\tif (name[1] === '$') {\\n\\t\\t\\t\\tname = name.substr(1);\\n\\t\\t\\t} else {\\n\\t\\t\\t\\t// This is a reserved attribute\\n\\t\\t\\t\\treturn;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tvar nameAttr = element.attributes[\\\"$variable\\\"];\\n\\t\\tif (nameAttr) {\\n\\t\\t\\tvar setting = options.settings.getMacro(nameAttr.oldValue || nameAttr.value);\\n\\t\\t\\treturn setting && setting[name];\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.formBlurb = function(element, attribute, blurb, options) {\\n\\tvar nameAttr = element.attributes[\\\"$variable\\\"];\\n\\tvar name = attribute.name;\\n\\tif (name[0] === '$') {\\n\\t\\tname = name.substr(1);\\n\\t}\\n\\tvar newBlurb = '<' + nameAttr.value + ' ' + name;\\n\\tif (blurb) {\\n\\t\\tnewBlurb += '=' + blurb;\\n\\t}\\n\\treturn newBlurb;\\n};\\n\",\n            \"module-type\": \"relinkhtmlattributes\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/transclude.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/whitelist.js\": {\n            \"text\": \"/*\\\\ \\n\\nHandles replacement of widget attributes that are specified in the whitelist.\\n\\n\\\\*/\\n\\nexports.name = \\\"whitelist\\\";\\n\\nexports.getHandler = function(element, attribute, options) {\\n\\tvar setting = options.settings.getAttribute(element.tag);\\n\\treturn setting && setting[attribute.name];\\n};\\n\",\n            \"module-type\": \"relinkhtmlattributes\",\n            \"title\": \"$:/plugins/flibbles/relink/js/relinkoperations/text/wikitext/html/attributes/whitelist.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/context.js\": {\n            \"text\": \"/*\\\\\\n\\nBase class for relink contexts.\\n\\n\\\\*/\\n\\nfunction Context() {\\n};\\n\\nexports.context = Context;\\n\\n// This class does no special handling of fields, operators, or attributes.\\n// we pass it along to the parent.\\nContext.prototype.getFields = function() {\\n\\treturn this.parent.getFields();\\n};\\n\\nContext.prototype.getOperator = function(name, index) {\\n\\treturn this.parent.getOperator(name, index);\\n};\\n\\nContext.prototype.getOperators = function() {\\n\\treturn this.parent.getOperators();\\n};\\n\\nContext.prototype.getAttribute = function(elementName) {\\n\\treturn this.parent.getAttribute(elementName);\\n};\\n\\nContext.prototype.getAttributes = function() {\\n\\treturn this.parent.getAttributes();\\n};\\n\\nContext.prototype.getConfig = function(category) {\\n\\treturn this.parent.getConfig(category);\\n};\\n\\nContext.prototype.getMacro = function(macroName) {\\n\\treturn this.parent.getMacro(macroName);\\n};\\n\\nContext.prototype.getMacros = function() {\\n\\treturn this.parent.getMacros();\\n};\\n\\n/* Exceptions are tiddlers that have text/vnd.tiddlywiki type, but should\\n * not be treated as such.\\n */\\nContext.prototype.getException = function(tiddlerTitle) {\\n\\treturn this.parent.getException(tiddlerTitle);\\n};\\n\\nContext.prototype.allowPrettylinks = function() {\\n\\treturn this.parent.allowPrettylinks();\\n};\\n\\nContext.prototype.allowWidgets = function() {\\n\\treturn this.parent.allowWidgets();\\n};\\n\\nContext.prototype.hasImports = function(value) {\\n\\treturn this.parent.hasImports(value);\\n};\\n\\nContext.prototype.getFocus = function() {\\n\\tif (this.parent) {\\n\\t\\treturn this.parent.getFocus();\\n\\t}\\n};\\n\\nContext.prototype.getPlaceholderList = function() {\\n\\tif (this.parent) {\\n\\t\\treturn this.parent.getPlaceholderList();\\n\\t}\\n\\treturn null;\\n};\\n\\nContext.prototype.addParameter = function(parameter) {\\n\\tif(this.parent) {\\n\\t\\treturn this.parent.addParameter(parameter);\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/context.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/import.js\": {\n            \"text\": \"/*\\\\\\n\\nThis handles the fetching and distribution of relink settings.\\n\\n\\\\*/\\n\\nvar WidgetContext = require('./widget').widget;\\n\\nfunction ImportContext(wiki, parent, filter) {\\n\\tthis.parent = parent;\\n\\tthis.wiki = wiki;\\n\\tvar importWidget = createImportWidget(filter, this.wiki, this.parent.widget);\\n\\tthis._compileList(importWidget.tiddlerList, importWidget.variables);\\n\\t// this.widget is where we ask for macro definitions.\\n\\t// This only works if only one filter is imported\\n\\tthis.widget = this.getBottom(importWidget);\\n\\t// We keep this one because it's where we need to test for changes from.\\n\\tthis.importWidget = importWidget\\n\\t// Trickle this up, so that any containing tiddlercontext knows that this\\n\\t// tiddler does some importing, and must be checked regularly.\\n\\tparent.hasImports(true);\\n};\\n\\nexports.import = ImportContext;\\n\\nImportContext.prototype = new WidgetContext();\\n\\nImportContext.prototype.changed = function(changes) {\\n\\treturn this.importWidget && this.importWidget.refresh(changes)\\n};\\n\\nfunction createImportWidget(filter, wiki, parent) {\\n\\tvar widget = wiki.makeWidget( { tree: [{\\n\\t\\ttype: \\\"importvariables\\\",\\n\\t\\tattributes: {\\n\\t\\t\\t\\\"filter\\\": {\\n\\t\\t\\t\\ttype: \\\"string\\\",\\n\\t\\t\\t\\tvalue: filter\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}] }, { parentWidget: parent} );\\n\\tif (parent) {\\n\\t\\tparent.children.push(widget);\\n\\t}\\n\\twidget.execute();\\n\\twidget.renderChildren();\\n\\tvar importWidget = widget.children[0];\\n\\treturn importWidget;\\n};\\n\\nImportContext.prototype._compileList = function(titleList, variables) {\\n\\tfor (var i = 0; i < titleList.length; i++) {\\n\\t\\tvar parser = this.wiki.parseTiddler(titleList[i]);\\n\\t\\tif (parser) {\\n\\t\\t\\tvar parseTreeNode = parser.tree[0];\\n\\t\\t\\twhile (parseTreeNode && parseTreeNode.type === \\\"set\\\") {\\n\\t\\t\\t\\tvar variable = variables[parseTreeNode.attributes.name.value];\\n\\t\\t\\t\\tif(variable) {\\n\\t\\t\\t\\t\\tvariable.tiddler = titleList[i];\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (parseTreeNode.relink) {\\n\\t\\t\\t\\t\\tfor (var macroName in parseTreeNode.relink) {\\n\\t\\t\\t\\t\\t\\tvar parameters = parseTreeNode.relink[macroName];\\n\\t\\t\\t\\t\\t\\tfor (var paramName in parameters) {\\n\\t\\t\\t\\t\\t\\t\\tthis.addSetting(this.wiki, macroName, paramName, parameters[paramName], titleList[i]);\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tparseTreeNode = parseTreeNode.children && parseTreeNode.children[0];\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/import.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/tiddler.js\": {\n            \"text\": \"/*\\\\\\n\\nContext for a tiddler. Defines nothing but makes an entry point to test if\\na tiddler must be refreshed.\\n\\n\\\\*/\\n\\nvar WidgetContext = require('./widget.js').widget;\\n\\nfunction TiddlerContext(wiki, parentContext, title) {\\n\\tthis.title = title;\\n\\tthis.parent = parentContext;\\n\\tvar globalWidget = parentContext && parentContext.widget;\\n\\tvar parentWidget = wiki.makeWidget(null, {parentWidget: globalWidget});\\n\\tparentWidget.setVariable('currentTiddler', title);\\n\\tthis.widget = wiki.makeWidget(null, {parentWidget: parentWidget});\\n};\\n\\nexports.tiddler = TiddlerContext;\\n\\nTiddlerContext.prototype = new WidgetContext();\\n\\nTiddlerContext.prototype.getFocus = function() {\\n\\t// Tiddler Contexts are the last possible focus when not embedded in contexts.\\n\\treturn this;\\n};\\n\\nTiddlerContext.prototype.changed = function(changes) {\\n\\treturn this.widget && this.widget.refresh(changes);\\n};\\n\\n// By default, a tiddler context does not use imports, unless an import\\n// statement is later discovered somewhere in the fields.\\nTiddlerContext.prototype.hasImports = function(value) {\\n\\treturn this._hasImports || (this._hasImports = value);\\n};\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/tiddler.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/variable.js\": {\n            \"text\": \"/*\\\\\\n\\nThis handles the context for variables. Either from $set, $vars, or \\\\define\\n\\n\\\\*/\\n\\nvar WidgetContext = require('./widget').widget;\\n\\nfunction VariableContext(parent, setParseTreeNode) {\\n\\tvar name = setParseTreeNode.attributes.name.value;\\n\\tthis.parent = parent;\\n\\t// Now create a new widget and attach it.\\n\\tvar attachPoint = parent.widget;\\n\\tthis.setWidget = attachPoint.makeChildWidget(setParseTreeNode);\\n\\tattachPoint.children.push(this.setWidget);\\n\\tthis.setWidget.computeAttributes();\\n\\tthis.setWidget.execute();\\n\\t// We get the title of our current parameter focus\\n\\t// (i.e. what \\\\param would affect)\\n\\t// If it's another definition, then title will be null.\\n\\tthis.setWidget.variables[name].tiddler = parent.getFocus().title;\\n\\t// point our widget to bottom, where any other contexts would attach to\\n\\tthis.widget = this.getBottom(this.setWidget);\\n\\tthis.parameterFocus = true;\\n\\tif (setParseTreeNode.isMacroDefinition) {\\n\\t\\tthis.placeholderList = Object.create(parent.getPlaceholderList());\\n\\t\\tfor (var i = 0; i < setParseTreeNode.params.length; i++) {\\n\\t\\t\\tthis.placeholderList[setParseTreeNode.params[i].name] = true;\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.variable = VariableContext;\\n\\nVariableContext.prototype = new WidgetContext();\\n\\nVariableContext.prototype.getFocus = function() {\\n\\tif(this.parameterFocus) {\\n\\t\\treturn this;\\n\\t} else {\\n\\t\\treturn this.parent.getFocus();\\n\\t}\\n};\\n\\nVariableContext.prototype.getPlaceholderList = function() {\\n\\tif (this.placeholderList !== undefined) {\\n\\t\\treturn this.placeholderList;\\n\\t} else {\\n\\t\\treturn this.parent.getPlaceholderList();\\n\\t}\\n};\\n\\nVariableContext.prototype.addParameter = function(parameter) {\\n\\tif(this.parameterFocus) {\\n\\t\\tvar name = this.setWidget.setName;\\n\\t\\tvar data = this.setWidget.variables[name];\\n\\t\\tdata.params.push({name: parameter});\\n\\t} else if (this.parent) {\\n\\t\\tthis.parent.addParameter(parameter);\\n\\t}\\n};\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/variable.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/whitelist.js\": {\n            \"text\": \"/*\\\\\\n\\nThis top-level context manages settings inside the whitelist. It never has\\na parent.\\n\\n\\\\*/\\n\\nvar utils = require('../utils');\\nvar Context = require('./context').context;\\n\\nvar prefix = \\\"$:/config/flibbles/relink/\\\";\\n\\n/**Factories define methods that create settings given config tiddlers.\\n * for factory method 'example', it will be called once for each:\\n * \\\"$:/config/flibbles/relink/example/...\\\" tiddler that exists.\\n * the argument \\\"key\\\" will be set to the contents of \\\"...\\\"\\n *\\n * The reason I build relink settings in this convoluted way is to minimize\\n * the number of times tiddlywiki has to run through EVERY tiddler looking\\n * for relink config tiddlers.\\n */\\nvar settingsGenerators = utils.getModulesByTypeAsHashmap('relinksetting', 'name');\\n\\nfunction WhitelistContext(wiki) {\\n\\tbuild(this, wiki);\\n};\\n\\nexports.whitelist = WhitelistContext;\\n\\nWhitelistContext.prototype = new Context();\\n\\n/**Hot directories are directories for which if anything changes inside them,\\n * then Relink must completely rebuild its index.\\n * By default, this includes the whitelist settings, but relink-titles also\\n * includes its rules disabling directory.\\n * This is the FIRST solution I came up with to this problem. If you're\\n * looking at this, please make a github issue so I have a chance to understand\\n * your needs. This is currently a HACK solution.\\n */\\nWhitelistContext.hotDirectories = [prefix];\\n\\nWhitelistContext.prototype.getAttribute = function(elementName) {\\n\\treturn this.attributes[elementName];\\n};\\n\\nWhitelistContext.prototype.getAttributes = function() {\\n\\treturn flatten(this.attributes);\\n};\\n\\nWhitelistContext.prototype.getFields = function() {\\n\\treturn this.fields;\\n};\\n\\nWhitelistContext.prototype.getConfig = function(category) {\\n\\treturn this[category];\\n};\\n\\nWhitelistContext.prototype.getOperator = function(operatorName, operandIndex) {\\n\\tvar op = this.operators[operatorName];\\n\\treturn op && op[operandIndex || 1];\\n};\\n\\nWhitelistContext.prototype.getOperators = function() {\\n\\tvar signatures = Object.create(null);\\n\\tfor (var op in this.operators) {\\n\\t\\tvar operandSet = this.operators[op];\\n\\t\\tfor (var index in operandSet) {\\n\\t\\t\\tvar entry = operandSet[index];\\n\\t\\t\\tsignatures[entry.key] = entry;\\n\\t\\t}\\n\\t}\\n\\treturn signatures;\\n};\\n\\nWhitelistContext.prototype.getMacro = function(macroName) {\\n\\treturn this.macros[macroName];\\n};\\n\\nWhitelistContext.prototype.getMacros = function() {\\n\\treturn flatten(this.macros);\\n};\\n\\nWhitelistContext.prototype.getException = function(tiddlerTitle) {\\n\\treturn this.exceptions[tiddlerTitle];\\n};\\n\\nWhitelistContext.prototype.changed = function(changedTiddlers) {\\n\\tfor (var i = 0; i < WhitelistContext.hotDirectories.length; i++) {\\n\\t\\tvar dir = WhitelistContext.hotDirectories[i];\\n\\t\\tfor (var title in changedTiddlers) {\\n\\t\\t\\tif (title.substr(0, dir.length) === dir) {\\n\\t\\t\\t\\treturn true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn false;\\n};\\n\\nWhitelistContext.prototype.hasImports = function(value) {\\n\\t// We don't care if imports are used. This is the global level.\\n\\treturn false;\\n};\\n\\nfunction build(settings, wiki) {\\n\\tfor (var name in settingsGenerators) {\\n\\t\\tsettings[name] = Object.create(null);\\n\\t}\\n\\twiki.eachShadowPlusTiddlers(function(tiddler, title) {\\n\\t\\tif (title.substr(0, prefix.length) === prefix) {\\n\\t\\t\\tvar remainder = title.substr(prefix.length);\\n\\t\\t\\tvar category = root(remainder);\\n\\t\\t\\tvar factory = settingsGenerators[category];\\n\\t\\t\\tif (factory) {\\n\\t\\t\\t\\tvar name = remainder.substr(category.length+1);\\n\\t\\t\\t\\tfactory.generate(settings[category], tiddler, name, wiki);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n};\\n\\n/* Returns first bit of a path. path/to/tiddler -> path\\n */\\nfunction root(string) {\\n\\tvar index = string.indexOf('/');\\n\\tif (index >= 0) {\\n\\t\\treturn string.substr(0, index);\\n\\t}\\n};\\n\\n/* Turns {dir: {file1: 'value1', file2: 'value2'}}\\n * into {dir/file1: 'value1', dir/file2: 'value2'}\\n */\\nfunction flatten(set) {\\n\\tvar signatures = Object.create(null);\\n\\tfor (var outerName in set) {\\n\\t\\tvar setItem = set[outerName];\\n\\t\\tfor (var innerName in setItem) {\\n\\t\\t\\tsignatures[outerName + \\\"/\\\" + innerName] = setItem[innerName];\\n\\t\\t}\\n\\t}\\n\\treturn signatures;\\n};\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/whitelist.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/widget.js\": {\n            \"text\": \"/*\\\\\\n\\nThis is a virtual subclass of context for contexts that exist within widgets\\nof a specific tiddler.\\n\\nAll widget contexts must have a widget member.\\n\\n\\\\*/\\n\\nvar Context = require('./context.js').context;\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nfunction WidgetContext() {};\\n\\nexports.widget = WidgetContext;\\n\\nWidgetContext.prototype = new Context();\\n\\nWidgetContext.prototype.getMacroDefinition = function(variableName) {\\n\\t// widget.variables is prototyped, so it looks up into all its parents too\\n\\tvar def = this.widget.variables[variableName];\\n\\tif (!def) {\\n\\t\\t// It might be a javascript macro\\n\\t\\tdef = $tw.macros[variableName];\\n\\t\\tif (def && !def.tiddler) {\\n\\t\\t\\t// We haven't assigned associated tiddlers to these macros yet.\\n\\t\\t\\t// That may be important for some installed supplemental plugins.\\n\\t\\t\\t$tw.modules.forEachModuleOfType('macro', function(title, module) {\\n\\t\\t\\t\\tif (module.name) {\\n\\t\\t\\t\\t\\t// For now, we just attach it directly to the definition\\n\\t\\t\\t\\t\\t// It's easier, albeit a little sloppy.\\n\\t\\t\\t\\t\\t$tw.macros[module.name].tiddler = title;\\n\\t\\t\\t\\t}\\n\\t\\t\\t});\\n\\t\\t}\\n\\t}\\n\\treturn def;\\n};\\n\\nWidgetContext.prototype.addSetting = function(wiki, macroName, parameter, type, sourceTitle) {\\n\\tthis.macros = this.macros || Object.create(null);\\n\\tvar macro = this.macros[macroName];\\n\\ttype = type || utils.getDefaultType(wiki);\\n\\tif (macro === undefined) {\\n\\t\\tmacro = this.macros[macroName] = Object.create(null);\\n\\t}\\n\\tvar handler = utils.getType(type);\\n\\tif (handler) {\\n\\t\\thandler.source = sourceTitle;\\n\\t\\tmacro[parameter] = handler;\\n\\t}\\n};\\n\\nWidgetContext.prototype.getMacros = function() {\\n\\tvar signatures = this.parent.getMacros();\\n\\tif (this.macros) {\\n\\t\\tfor (var macroName in this.macros) {\\n\\t\\t\\tvar macro = this.macros[macroName];\\n\\t\\t\\tfor (var param in macro) {\\n\\t\\t\\t\\tsignatures[macroName + \\\"/\\\" + param] = macro[param];\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn signatures;\\n};\\n\\n/**This does strange handling because it's possible for a macro to have\\n * its individual parameters whitelisted in separate places.\\n * Don't know WHY someone would do this, but it can happen.\\n */\\nWidgetContext.prototype.getMacro = function(macroName) {\\n\\tvar theseSettings = this.macros && this.macros[macroName];\\n\\tvar parentSettings;\\n\\tif (this.parent) {\\n\\t\\tparentSettings = this.parent.getMacro(macroName);\\n\\t}\\n\\tif (theseSettings && parentSettings) {\\n\\t\\t// gotta merge them without changing either. This is expensive,\\n\\t\\t// but it'll happen rarely.\\n\\t\\tvar rtnSettings = $tw.utils.extend(Object.create(null), theseSettings, parentSettings);\\n\\t\\treturn rtnSettings;\\n\\t}\\n\\treturn theseSettings || parentSettings;\\n};\\n\\nWidgetContext.prototype.getAttribute = function(elementName) {\\n\\tif (elementName.charAt(0) == '$' && elementName.indexOf('.') >= 0) {\\n\\t\\t// This is potentially a \\\\widget, look in macros for it.\\n\\t\\tvar macroSettings = this.getMacro(elementName);\\n\\t\\tif (macroSettings) {\\n\\t\\t\\t// Make sure that it's actually a widget definition\\n\\t\\t\\tvar def = this.getMacroDefinition(elementName);\\n\\t\\t\\tif (def) {\\n\\t\\t\\t\\t// We found a definition, but if it's not a widget, abort all.\\n\\t\\t\\t\\treturn (def.isWidgetDefinition)? macroSettings: undefined;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn this.parent.getAttribute(elementName);\\n};\\n\\nWidgetContext.prototype.getOperator = function(name, index) {\\n\\tif (name.indexOf('.') >= 0) {\\n\\t\\t// This is potentially a \\\\function, look in macros for it.\\n\\t\\tvar macroSettings = this.getMacro(name);\\n\\t\\tif (macroSettings) {\\n\\t\\t\\t//Make sure that it's actually a macro definition\\n\\t\\t\\tvar def = this.getMacroDefinition(name);\\n\\t\\t\\tif (def) {\\n\\t\\t\\t\\tif (def.isFunctionDefinition) {\\n\\t\\t\\t\\t\\t// Minus one because operator indices are 1 indexed,\\n\\t\\t\\t\\t\\t// but parameters as we store them are not.\\n\\t\\t\\t\\t\\tvar param = def.params[index - 1];\\n\\t\\t\\t\\t\\treturn param && macroSettings[param.name];\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\t// If it's not a filter, abort all.\\n\\t\\t\\t\\treturn undefined;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn this.parent.getOperator(name, index);\\n};\\n\\n/**Returns the deepest descendant of the given widget.\\n */\\nWidgetContext.prototype.getBottom = function(widget) {\\n\\twhile (widget.children.length > 0) {\\n\\t\\twidget = widget.children[0];\\n\\t}\\n\\treturn widget;\\n};\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/widget.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/contexts/wikitext.js\": {\n            \"text\": \"/*\\\\\\n\\nContext for wikitext. It can contain rules about what's allowed in this\\ncurrent layer of wikitext.\\n\\n\\\\*/\\n\\nvar WidgetContext = require('./widget.js').widget;\\n\\nfunction WikitextContext(parentContext) {\\n\\tthis.parent = parentContext;\\n\\tthis.widget = parentContext.widget;\\n};\\n\\nexports.wikitext = WikitextContext;\\n\\nWikitextContext.prototype = new WidgetContext();\\n\\n// Unless this specific context has rules about it, widgets and prettyLInks are allowed.\\nWikitextContext.prototype.allowWidgets = enabled;\\nWikitextContext.prototype.allowPrettylinks = enabled;\\n\\nfunction enabled() { return true; };\\n\",\n            \"module-type\": \"relinkcontext\",\n            \"title\": \"$:/plugins/flibbles/relink/js/contexts/wikitext.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils/backupIndexer.js\": {\n            \"text\": \"/*\\\\\\nmodule-type: library\\n\\nThis is a backup indexer Relink uses if the real one is disabled, or we're\\n<V5.1.23. It's not nearly as good, but it caches some.\\n\\n\\\\*/\\n\\n\\\"use strict\\\";\\n\\nvar utils = require(\\\"$:/plugins/flibbles/relink/js/utils.js\\\");\\nvar TiddlerContext = utils.getContext('tiddler');\\n\\n// This is the indexer we use if the current wiki doesn't support indexers.\\nfunction BackupIndexer(wiki) {\\n\\tthis.wiki = wiki;\\n};\\n\\nmodule.exports = BackupIndexer;\\n\\nBackupIndexer.prototype.lookup = function(title) {\\n\\treturn getCache(this.wiki).lookup[title];\\n};\\n\\nBackupIndexer.prototype.reverseLookup = function(title) {\\n\\tvar index = getCache(this.wiki);\\n\\tif (!index.reverse[title]) {\\n\\t\\tvar record = Object.create(null);\\n\\t\\tfor (var other in index.lookup) {\\n\\t\\t\\tif (index.lookup[other][title]) {\\n\\t\\t\\t\\trecord[other] = index.lookup[other][title];\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tindex.reverse[title] = record;\\n\\t}\\n\\treturn index.reverse[title];\\n};\\n\\n/* The backup indexer doesn't bother caching relink reports. It would always\\n * be called after a draft tiddler had changed, which would defeat the point.\\n */\\nBackupIndexer.prototype.relinkLookup = function(fromTitle, toTitle, options) {\\n\\tvar cache = getCache(this.wiki);\\n\\tif (cache.lastRelinkFrom === fromTitle && cache.lastRelinkTo === toTitle) {\\n\\t\\toptions.cache = cache.lastRelinkCache;\\n\\t\\treturn cache.lastRelink;\\n\\t}\\n\\tcache.lastRelink = utils.getRelinkResults(this.wiki, fromTitle, toTitle, cache.context, undefined, options);\\n\\tcache.lastRelinkFrom = fromTitle;\\n\\tcache.lastRelinkTo = toTitle;\\n\\tcache.lastRelinkCache = options.cache;\\n\\treturn cache.lastRelink;\\n};\\n\\nBackupIndexer.prototype.orphans = function() {\\n\\tvar index = getCache(this.wiki).lookup;\\n\\tvar results = [];\\n\\tfor (var title in index) {\\n\\t\\tvar found = false;\\n\\t\\tfor (var anything in this.reverseLookup(title)) {\\n\\t\\t\\tfound = true;\\n\\t\\t\\tbreak;\\n\\t\\t}\\n\\t\\tif (!found) {\\n\\t\\t\\tresults.push(title);\\n\\t\\t}\\n\\t}\\n\\treturn results;\\n};\\n\\nfunction getCache(wiki) {\\n\\treturn wiki.getGlobalCache('relink', function() {\\n\\t\\tvar tiddlerList = wiki.getRelinkableTitles();\\n\\t\\tvar index = Object.create(null);\\n\\t\\tvar wikiContext = utils.getWikiContext(wiki);\\n\\t\\tfor (var i = 0; i < tiddlerList.length; i++) {\\n\\t\\t\\tvar title = tiddlerList[i];\\n\\t\\t\\tvar tiddler = wiki.getTiddler(title);\\n\\t\\t\\tif (tiddler && !tiddler.fields[\\\"plugin-type\\\"]) {\\n\\t\\t\\t\\tvar context = new TiddlerContext(wiki, wikiContext, title);\\n\\t\\t\\t\\tindex[title] = utils.getTiddlerRelinkReferences(wiki, title, context);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\treturn {\\n\\t\\t\\tlookup: index,\\n\\t\\t\\treverse: Object.create(null),\\n\\t\\t\\tcontext: wikiContext};\\n\\t});\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils/backupIndexer.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils/entry.js\": {\n            \"text\": \"/*\\\\\\n\\nEntries are deprecated. Don't use them. These classes are here just so that\\nany 3rd party modules built for Relink V1 don't break.\\n\\nJust return an object like, {output: \\\"string\\\", impossible: true|undefined}\\n\\n\\\\*/\\n\\nfunction EntryNode() {\\n\\tthis.children = [];\\n};\\n\\nmodule.exports = EntryNode;\\n\\n/**  PURE VIRTUAL\\n * EntryNode.prototype.report = function() -> [\\\"string\\\", ...]\\n */\\n\\nEntryNode.newType = function() {\\n\\treturn EntryNode;\\n};\\n\\nEntryNode.prototype.add = function(entry) {\\n\\tthis.children.push(entry);\\n};\\n\\nfunction EntryCollection() {\\n\\tthis.children = Object.create(null);\\n\\tthis.types = Object.create(null);\\n};\\n\\nEntryNode.newCollection = function(name) {\\n\\treturn EntryCollection;\\n};\\n\\n// Again. I reiterate. Don't use this. All this is just legacy support.\\nObject.defineProperty(EntryCollection, 'impossible', {\\n\\tget: function() {\\n\\t\\tvar imp = this._impossible;\\n\\t\\tthis.eachChild(function(child) { imp = imp || child.impossible; });\\n\\t\\treturn imp;\\n\\t},\\n\\tset: function(impossible) {\\n\\t\\tthis._impossible = true;\\n\\t}\\n});\\n\\nEntryCollection.prototype.eachChild = function(method) {\\n\\tfor (var child in this.children) {\\n\\t\\tmethod(this.children[child]);\\n\\t}\\n};\\n\\nEntryCollection.prototype.addChild = function(child, name, type) {\\n\\tthis.children[name] = child;\\n\\tthis.types[name] = type;\\n};\\n\\nEntryCollection.prototype.hasChildren = function() {\\n\\treturn Object.keys(this.children).length > 0;\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils/entry.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils/macrocall.js\": {\n            \"text\": \"/*\\\\\\n\\nMethods for reporting and relinking macros. Behaves much like a fieldtype, except that it's not.\\n\\n\\\\*/\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar Rebuilder = require(\\\"$:/plugins/flibbles/relink/js/utils/rebuilder\\\");\\nvar macrocallOperators = utils.getModulesByTypeAsHashmap('relinkmacrocall', 'name');\\n\\n/** As in, report a macrocall invocation that is an html attribute.\\n * macro: must be a macro object.*/\\nexports.report = function(context, macro, callback, options) {\\n\\tfor (var operator in macrocallOperators) {\\n\\t\\tmacrocallOperators[operator].report(context, macro, callback, options);\\n\\t}\\n};\\n\\n/**Processes the given macro,\\n * macro: {name:, params:, start:, end:}\\n * each parameters: {name:, end:, value:}\\n * Macro invocation returned is the same, but relinked, and may have new keys:\\n * parameters: {type: macro, start:, newValue: (quoted replacement value)}\\n * Output of the returned entry isn't a string, but a macro object. It needs\\n * to be converted.\\n */\\nexports.relink = function(context, macro, text, fromTitle, toTitle, mayBeWidget, options) {\\n\\tvar entry;\\n\\tfor (var operator in macrocallOperators) {\\n\\t\\tvar results = macrocallOperators[operator].relink(context, macro, text, fromTitle, toTitle, options);\\n\\t\\tif (results) {\\n\\t\\t\\tentry = entry || {};\\n\\t\\t\\tif (results.impossible) {\\n\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t}\\n\\t\\t\\tif (results.output) {\\n\\t\\t\\t\\tmacro = results.output;\\n\\t\\t\\t\\tentry.output = macro;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn entry;\\n};\\n\\n/**Converts the macro object into a string, includes the <<..>>.\\n * The text is the old text the macro was formed from. It's used to preserve\\n * whitespace.\\n */\\nexports.reassemble = function(entry, text, options) {\\n\\tvar macro = entry.output;\\n\\tvar builder = new Rebuilder(text, macro.start);\\n\\tvar varAttribute = macro.attributes && macro.attributes['$variable'];\\n\\tif (varAttribute && varAttribute.value !== macro.name) {\\n\\t\\t// The name of the macro changed. Update it.\\n\\t\\tbuilder.add(varAttribute.value, macro.start + 2, macro.start + 2 + macro.name.length);\\n\\t}\\n\\tfor (var i = 0; i < macro.params.length; i++) {\\n\\t\\tvar param = macro.params[i];\\n\\t\\tif (param.modified) {\\n\\t\\t\\tvar newValue = exports.wrapParameterValue(param.value, param.quote);\\n\\t\\t\\tif (newValue === undefined) {\\n\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tbuilder.add(newValue, param.start, param.end);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn builder.results(macro.end);\\n};\\n\\n\\n/**Like wrapAttribute value, except for macro parameters, not attributes.\\n *\\n * These are more permissive. Allows brackets,\\n * and slashes and '<' in unquoted values.\\n */\\nexports.wrapParameterValue = function(value, preference) {\\n\\tvar whitelist = [\\\"\\\", \\\"'\\\", '\\\"', '[[', '\\\"\\\"\\\"'];\\n\\tvar choices = {\\n\\t\\t\\\"\\\": function(v) {return !/([\\\\s>\\\"':])/.test(v); },\\n\\t\\t\\\"'\\\": function(v) {return v.indexOf(\\\"'\\\") < 0; },\\n\\t\\t'\\\"': function(v) {return v.indexOf('\\\"') < 0; },\\n\\t\\t\\\"[[\\\": canBePrettyOperand,\\n\\t\\t'\\\"\\\"\\\"': function(v) {return v.indexOf('\\\"\\\"\\\"') < 0 && v[v.length-1] != '\\\"';}\\n\\t};\\n\\tif (choices[preference] && choices[preference](value)) {\\n\\t\\treturn wrap(value, preference);\\n\\t}\\n\\tfor (var i = 0; i < whitelist.length; i++) {\\n\\t\\tvar quote = whitelist[i];\\n\\t\\tif (choices[quote](value)) {\\n\\t\\t\\treturn wrap(value, quote);\\n\\t\\t}\\n\\t}\\n\\t// No quotes will work on this\\n\\treturn undefined;\\n};\\n\\nfunction canBePrettyOperand(value) {\\n\\treturn value.indexOf(']') < 0;\\n};\\n\\n\\nfunction wrap(value, wrapper) {\\n\\tvar wrappers = {\\n\\t\\t\\\"\\\": function(v) {return v; },\\n\\t\\t\\\"'\\\": function(v) {return \\\"'\\\"+v+\\\"'\\\"; },\\n\\t\\t'\\\"': function(v) {return '\\\"'+v+'\\\"'; },\\n\\t\\t'\\\"\\\"\\\"': function(v) {return '\\\"\\\"\\\"'+v+'\\\"\\\"\\\"'; },\\n\\t\\t\\\"[[\\\": function(v) {return \\\"[[\\\"+v+\\\"]]\\\"; }\\n\\t};\\n\\tvar chosen = wrappers[wrapper];\\n\\tif (chosen) {\\n\\t\\treturn chosen(value);\\n\\t} else {\\n\\t\\treturn undefined;\\n\\t}\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils/macrocall.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils/rebuilder.js\": {\n            \"text\": \"/*\\\\\\n\\nThis helper class aids in reconstructing an existing string with new parts.\\n\\n\\\\*/\\n\\nfunction Rebuilder(text, start) {\\n\\tthis.text = text;\\n\\tthis.index = start || 0;\\n\\tthis.pieces = [];\\n};\\n\\nmodule.exports = Rebuilder;\\n\\n/**Pieces must be added consecutively.\\n * Start and end are the indices in the old string specifying where to graft\\n * in the new piece.\\n */\\nRebuilder.prototype.add = function(value, start, end) {\\n\\tthis.pieces.push(this.text.substring(this.index, start), value);\\n\\tthis.index = end;\\n};\\n\\nRebuilder.prototype.changed = function() {\\n\\treturn this.pieces.length > 0;\\n};\\n\\nRebuilder.prototype.results = function(end) {\\n\\tif (this.changed()) {\\n\\t\\tthis.pieces.push(this.text.substring(this.index, end));\\n\\t\\treturn this.pieces.join('');\\n\\t}\\n\\treturn undefined;\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils/rebuilder.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils/substitution.js\": {\n            \"text\": \"/*\\\\\\n\\nHandles relinking substitution text, like strings containing $(this)$.\\n\\n\\\\*/\\n\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\nvar filterHandler = utils.getType('filter');\\nvar macrocallHandler = require(\\\"./macrocall.js\\\");\\n\\nexports.report = function(string, callback, options) {\\n\\tif (!options.noFilterSubstitution) {\\n\\t\\tvar filterRegex = /\\\\$\\\\{([\\\\S\\\\s]+?)\\\\}\\\\$/g, filter;\\n\\t\\twhile (filter = filterRegex.exec(string)) {\\n\\t\\t\\tfilterHandler.report(filter[1], function(title, blurb, style) {\\n\\t\\t\\t\\tcallback(title, '${' + blurb + '}$', style);\\n\\t\\t\\t}, options);\\n\\t\\t}\\n\\t}\\n\\tvar varRegex = /\\\\$\\\\(([^\\\\)\\\\$]+)\\\\)\\\\$/g, varMatch;\\n\\twhile (varMatch = varRegex.exec(string)) {\\n\\t\\tmacrocallHandler.report(options.settings, {name: varMatch[1], params: []}, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, '$(' + blurb + ')$', style);\\n\\t\\t}, options);\\n\\t}\\n};\\n\\nexports.relink = function(string, fromTitle, toTitle, options) {\\n\\tvar entry;\\n\\tvar changed = false;\\n\\tvar newValue = string;\\n\\tif (!options.noFilterSubstitution) {\\n\\t\\tnewValue = newValue.replace(/\\\\$\\\\{([\\\\S\\\\s]+?)\\\\}\\\\$/g, function(match, filter) {\\n\\t\\t\\tvar filterEntry = filterHandler.relink(filter, fromTitle, toTitle, options);\\n\\t\\t\\tif (filterEntry) {\\n\\t\\t\\t\\tentry = entry || {};\\n\\t\\t\\t\\tif (filterEntry.output) {\\n\\t\\t\\t\\t\\t// The only }$ should be the one at the very end\\n\\t\\t\\t\\t\\tif (filterEntry.output.indexOf(\\\"}$\\\") < 0) {\\n\\t\\t\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t\\t\\t\\tmatch = '${' + filterEntry.output + '}$';\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif (filterEntry.impossible) {\\n\\t\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\treturn match;\\n\\t\\t});\\n\\t}\\n\\tnewValue = newValue.replace(/\\\\$\\\\(([^\\\\)\\\\$]+)\\\\)\\\\$/g, function(match, varname) {\\n\\t\\tvar macroEntry = macrocallHandler.relink(options.settings, {name: varname, params: []}, string, fromTitle, toTitle, false, options);\\n\\t\\tif (macroEntry) {\\n\\t\\t\\tentry = entry || {};\\n\\t\\t\\tif (macroEntry.output) {\\n\\t\\t\\t\\tvar newTitle = macroEntry.output.attributes.$variable.value;\\n\\t\\t\\t\\tif (newTitle.indexOf('$') >= 0 || newTitle.indexOf(')') >= 0) {\\n\\t\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tchanged = true;\\n\\t\\t\\t\\t\\tmatch = '$(' + newTitle + ')$';\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t\\tif (macroEntry.impossible) {\\n\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\treturn match;\\n\\t});\\n\\tif (changed) {\\n\\t\\tentry.output = newValue;\\n\\t}\\n\\treturn entry;\\n};\\n\",\n            \"module-type\": \"library\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils/substitution.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/js/utils/macrocall/parameters.js\": {\n            \"text\": \"var utils = require('$:/plugins/flibbles/relink/js/utils.js');\\n\\nexports.name = \\\"parameters\\\";\\n\\n// Error thrown when a macro's definition is needed, but can't be found.\\nfunction CannotFindMacroDef() {};\\nCannotFindMacroDef.prototype.impossible = true;\\nCannotFindMacroDef.prototype.name = \\\"macroparam\\\";\\n// Failed relinks due to missing definitions aren't reported for now.\\n// I may want to do something special later on.\\nCannotFindMacroDef.prototype.report = function() { return []; };\\n\\nexports.report = function(context, macro, callback, options) {\\n\\tvar managedMacro = context.getMacro(macro.name);\\n\\tif (!managedMacro) {\\n\\t\\t// We don't manage this macro. Bye.\\n\\t\\treturn undefined;\\n\\t}\\n\\tfor (var managedArg in managedMacro) {\\n\\t\\tvar index;\\n\\t\\ttry {\\n\\t\\t\\tindex = getParamIndexWithinMacrocall(context, macro.name, managedArg, macro.params, options);\\n\\t\\t} catch (e) {\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\tif (index < 0) {\\n\\t\\t\\t// The argument was not supplied. Move on to next.\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\tvar param = macro.params[index];\\n\\t\\tvar handler = managedMacro[managedArg];\\n\\t\\tvar nestedOptions = Object.create(options);\\n\\t\\tnestedOptions.settings = context;\\n\\t\\tvar entry = handler.report(param.value, function(title, blurb, style) {\\n\\t\\t\\tvar rtn = managedArg;\\n\\t\\t\\tif (blurb) {\\n\\t\\t\\t\\trtn += ': \\\"' + blurb + '\\\"';\\n\\t\\t\\t}\\n\\t\\t\\tcallback(title, macro.name + ' ' + rtn, style);\\n\\t\\t}, nestedOptions);\\n\\t}\\n};\\n\\nexports.relink = function(context, macro, text, fromTitle, toTitle, options) {\\n\\tvar managedMacro = context.getMacro(macro.name);\\n\\tvar modified = false;\\n\\tif (!managedMacro) {\\n\\t\\t// We don't manage this macro. Bye.\\n\\t\\treturn undefined;\\n\\t}\\n\\tvar outMacro = $tw.utils.extend({}, macro);\\n\\tvar macroEntry = {};\\n\\toutMacro.params = macro.params.slice();\\n\\tfor (var managedArg in managedMacro) {\\n\\t\\tvar index;\\n\\t\\ttry {\\n\\t\\t\\tindex = getParamIndexWithinMacrocall(context, macro.name, managedArg, macro.params, options);\\n\\t\\t} catch (e) {\\n\\t\\t\\tif (e instanceof CannotFindMacroDef) {\\n\\t\\t\\t\\tmacroEntry.impossible = true;\\n\\t\\t\\t\\tcontinue;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif (index < 0) {\\n\\t\\t\\t// this arg either was not supplied, or we can't find\\n\\t\\t\\t// the definition, so we can't tie it to an anonymous\\n\\t\\t\\t// argument. Either way, move on to the next.\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\tvar param = macro.params[index];\\n\\t\\tvar handler = managedMacro[managedArg];\\n\\t\\tvar nestedOptions = Object.create(options);\\n\\t\\tnestedOptions.settings = context;\\n\\t\\tvar entry = handler.relink(param.value, fromTitle, toTitle, nestedOptions);\\n\\t\\tif (entry === undefined) {\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\t// Macro parameters can only be string parameters, not\\n\\t\\t// indirect, or macro, or filtered\\n\\t\\tif (entry.impossible) {\\n\\t\\t\\tmacroEntry.impossible = true;\\n\\t\\t}\\n\\t\\tif (!entry.output) {\\n\\t\\t\\tcontinue;\\n\\t\\t}\\n\\t\\tvar quote = utils.determineQuote(text, param);\\n\\t\\tvar newParam = $tw.utils.extend({}, param);\\n\\t\\tnewParam.start = newParam.end - (newParam.value.length + (quote.length*2));\\n\\t\\tnewParam.value = entry.output;\\n\\t\\tnewParam.quote = quote;\\n\\t\\tnewParam.modified = true;\\n\\t\\toutMacro.params[index] = newParam;\\n\\t\\tmodified = true;\\n\\t}\\n\\tif (modified || macroEntry.impossible) {\\n\\t\\tif (modified) {\\n\\t\\t\\tmacroEntry.output = outMacro;\\n\\t\\t}\\n\\t\\treturn macroEntry;\\n\\t}\\n\\treturn undefined;\\n};\\n\\n/** Returns -1 if param definitely isn't in macrocall.\\n */\\nfunction getParamIndexWithinMacrocall(context, macroName, param, params, options) {\\n\\tvar index, i, anonsExist = false;\\n\\tfor (i = 0; i < params.length; i++) {\\n\\t\\tvar name = params[i].name;\\n\\t\\tif (name === param) {\\n\\t\\t\\treturn i;\\n\\t\\t}\\n\\t\\tif (name === undefined) {\\n\\t\\t\\tanonsExist = true;\\n\\t\\t}\\n\\t}\\n\\tif (!anonsExist) {\\n\\t\\t// If no anonymous parameters are present, and we didn't find\\n\\t\\t// it among the named ones, it must not be there.\\n\\t\\treturn -1;\\n\\t}\\n\\tvar expectedIndex = indexOfParameterDef(context, macroName, param, options);\\n\\t// We've got to skip over all the named parameter instances.\\n\\tif (expectedIndex >= 0) {\\n\\t\\tvar anonI = 0;\\n\\t\\tfor (i = 0; i < params.length; i++) {\\n\\t\\t\\tif (params[i].name === undefined) {\\n\\t\\t\\t\\tif (anonI === expectedIndex) {\\n\\t\\t\\t\\t\\treturn i;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tanonI++;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tvar indexOfOther = indexOfParameterDef(context, macroName, params[i].name, options);\\n\\t\\t\\t\\tif (indexOfOther < expectedIndex) {\\n\\t\\t\\t\\t\\tanonI++;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n\\treturn -1;\\n};\\n\\n// Looks up the definition of a macro, and figures out what the expected index\\n// is for the given parameter.\\nfunction indexOfParameterDef(context, macroName, paramName, options) {\\n\\tvar def = context.getMacroDefinition(macroName);\\n\\tif (def === undefined) {\\n\\t\\tthrow new CannotFindMacroDef();\\n\\t}\\n\\tvar params = def.params || [];\\n\\tfor (var i = 0; i < params.length; i++) {\\n\\t\\tif (params[i].name === paramName) {\\n\\t\\t\\treturn i;\\n\\t\\t}\\n\\t}\\n\\treturn -1;\\n};\\n\\n\",\n            \"module-type\": \"relinkmacrocall\",\n            \"title\": \"$:/plugins/flibbles/relink/js/utils/macrocall/parameters.js\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink/Filters/Missing\": {\n            \"title\": \"$:/plugins/flibbles/relink/Filters/Missing\",\n            \"description\": \"{{$:/plugins/flibbles/relink/language/Filters/Missing}}\",\n            \"filter\": \"[all[]!is[system]relink:references:hard[]!is[tiddler]!is[shadow]!prefix[$:/tags/]sort[title]] -[[]]\",\n            \"tags\": \"$:/tags/Filter\"\n        },\n        \"$:/plugins/flibbles/relink/Filters/Orphans\": {\n            \"title\": \"$:/plugins/flibbles/relink/Filters/Orphans\",\n            \"description\": \"{{$:/plugins/flibbles/relink/language/Filters/Orphans}}\",\n            \"filter\": \"[relink:orphans[]!is[system]sort[title]]\",\n            \"tags\": \"$:/tags/Filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-deletefield/$tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-deletefield/$tiddler\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-deletetiddler/$filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-deletetiddler/$filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-deletetiddler/$tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-deletetiddler/$tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-listops/$filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-listops/$filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-listops/$tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-listops/$tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-log/$$filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-log/$$filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-navigate/$to\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-navigate/$to\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-popup/$state\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-popup/$state\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-sendmessage/$names\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-sendmessage/$names\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-sendmessage/$values\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-sendmessage/$values\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-setfield/$tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-setfield/$tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$fields\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$fields\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$indexes\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$indexes\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$values\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$action-setmultiplefields/$values\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$button/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$button/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$button/set\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$button/set\",\n            \"text\": \"reference\"\n        },\n        \"$:/config/flibbles/relink/attributes/$button/setTo\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$button/setTo\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$button/to\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$button/to\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$checkbox/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$checkbox/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$checkbox/checkactions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$checkbox/checkactions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$checkbox/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$checkbox/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$checkbox/tag\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$checkbox/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$checkbox/uncheckactions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$checkbox/uncheckactions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$count/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$count/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$draggable/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$draggable/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$draggable/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$draggable/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$droppable/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$droppable/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$dropzone/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$dropzone/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$edit-bitmap/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$edit-bitmap/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$edit-text/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$edit-text/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$edit/inputActions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$edit/inputActions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$edit/refreshTitle\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$edit/refreshTitle\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$edit/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$edit/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$encrypt/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$encrypt/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$fieldmangler/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$fieldmangler/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$fields/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$fields/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$genesis/$names\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$genesis/$names\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$genesis/$values\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$genesis/$values\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$image/source\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$image/source\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$importvariables/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$importvariables/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$jsontiddler/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$jsontiddler/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$keyboard/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$keyboard/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$linkcatcher/to\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$linkcatcher/to\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$linkcatcher/set\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$linkcatcher/set\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$link/to\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$link/to\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$link/tooltip\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$link/tooltip\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$linkcatcher/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$linkcatcher/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$list/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$list/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$list/template\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$list/template\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$list/editTemplate\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$list/editTemplate\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$list/emptyMessage\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$list/emptyMessage\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$list/history\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$list/history\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$log/$$filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$log/$$filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$messagecatcher/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$messagecatcher/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$navigator/story\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$navigator/story\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$navigator/history\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$navigator/history\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$radio/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$radio/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$radio/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$radio/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$range/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$range/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$range/actionsStart\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$range/actionsStart\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$range/actionsStop\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$range/actionsStop\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$range/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$range/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$reveal/state\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$reveal/state\",\n            \"text\": \"reference\"\n        },\n        \"$:/config/flibbles/relink/attributes/$reveal/stateTitle\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$reveal/stateTitle\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$select/actions\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$select/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/attributes/$select/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$select/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$setvariable/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$setvariable/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$setvariable/subtiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$setvariable/subtiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$setvariable/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$setvariable/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$set/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$set/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$set/subtiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$set/subtiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$set/filter\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$set/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$setmultiplevariables/$names\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$setmultiplevariables/$names\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$setmultiplevariables/$values\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$setmultiplevariables/$values\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/attributes/$tiddler/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$tiddler/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$transclude/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$transclude/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$transclude/$tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$transclude/$tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$transclude/subtiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$transclude/subtiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$transclude/$subtiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$transclude/$subtiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$view/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$view/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$view/subtiddler\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$view/subtiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/attributes/$wikify/text\": {\n            \"title\": \"$:/config/flibbles/relink/attributes/$wikify/text\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/plugins/flibbles/relink/configuration\": {\n            \"title\": \"$:/plugins/flibbles/relink/configuration\",\n            \"text\": \"\\\\whitespace trim\\n<div class=\\\"tc-control-panel\\\">\\n<<tabs \\\"[all[shadows+tiddlers]tag[$:/tags/flibbles/relink/Configuration]!has[draft.of]]\\\" \\\"$:/plugins/flibbles/relink/ui/configuration/Fields\\\">>\\n</div>\\n\"\n        },\n        \"$:/config/flibbles/relink/exceptions/$:/DefaultTiddlers\": {\n            \"title\": \"$:/config/flibbles/relink/exceptions/$:/DefaultTiddlers\",\n            \"text\": \"application/x-tiddler-filter\"\n        },\n        \"$:/config/flibbles/relink/exceptions/$:/config/FileSystemPaths\": {\n            \"title\": \"$:/config/flibbles/relink/exceptions/$:/config/FileSystemPaths\",\n            \"text\": \"application/x-tiddler-filter\"\n        },\n        \"$:/config/flibbles/relink/exceptions/$:/config/FileSystemExtensions\": {\n            \"title\": \"$:/config/flibbles/relink/exceptions/$:/config/FileSystemExtensions\",\n            \"text\": \"application/x-tiddler-filter\"\n        },\n        \"$:/config/flibbles/relink/fieldattributes/$action-createtiddler\": {\n            \"title\": \"$:/config/flibbles/relink/fieldattributes/$action-createtiddler\",\n            \"text\": \"([^$].*)\"\n        },\n        \"$:/config/flibbles/relink/fieldattributes/$action-deletefield\": {\n            \"title\": \"$:/config/flibbles/relink/fieldattributes/$action-deletefield\",\n            \"text\": \"([^$].*)\"\n        },\n        \"$:/config/flibbles/relink/fieldattributes/$action-setfield\": {\n            \"title\": \"$:/config/flibbles/relink/fieldattributes/$action-setfield\",\n            \"text\": \"([^$].*)\"\n        },\n        \"$:/config/flibbles/relink/fieldattributes/$jsontiddler\": {\n            \"title\": \"$:/config/flibbles/relink/fieldattributes/$jsontiddler\",\n            \"text\": \"\\\\$(.*)\"\n        },\n        \"$:/config/flibbles/relink/fields/caption\": {\n            \"title\": \"$:/config/flibbles/relink/fields/caption\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/fields/filter\": {\n            \"title\": \"$:/config/flibbles/relink/fields/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/fields/list\": {\n            \"title\": \"$:/config/flibbles/relink/fields/list\",\n            \"text\": \"list\"\n        },\n        \"$:/config/flibbles/relink/fields/list-after\": {\n            \"title\": \"$:/config/flibbles/relink/fields/list-after\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/fields/list-before\": {\n            \"title\": \"$:/config/flibbles/relink/fields/list-before\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/fields/tags\": {\n            \"title\": \"$:/config/flibbles/relink/fields/tags\",\n            \"text\": \"list\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/Delete/Hint\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/Delete/Hint\",\n            \"text\": \"delete\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/LinkToInline/Hint\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/LinkToInline/Hint\",\n            \"text\": \"go to defining tiddler\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewAttribute/Hint\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewAttribute/Hint\",\n            \"text\": \"Specify a new widget/element attribute to be updated whenever a tiddler is renamed\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewAttribute/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewAttribute/Caption\",\n            \"text\": \"add\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewField/Hint\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewField/Hint\",\n            \"text\": \"Specify a new field to be updated whenever a tiddler is renamed\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewField/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewField/Caption\",\n            \"text\": \"add\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewOperator/Hint\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewOperator/Hint\",\n            \"text\": \"Specify a new filter operator to be considered whenever a tiddler is renamed\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewOperator/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewOperator/Caption\",\n            \"text\": \"add\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewParameter/Hint\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewParameter/Hint\",\n            \"text\": \"Specify a new macro parameter to be updated whenever a tiddler is renamed\"\n        },\n        \"$:/plugins/flibbles/relink/language/Buttons/NewParameter/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Buttons/NewParameter/Caption\",\n            \"text\": \"add\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/InvalidAttributeName\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/InvalidAttributeName\",\n            \"text\": \"Illegal characters in attribute name \\\"<$text text=<<attributeName>>/>\\\". Attributes cannot contain slashes ('/'), closing angle or square brackets ('>' or ']'), quotes or apostrophes ('\\\"' or \\\"'\\\"), equals ('='), or whitespace\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/InvalidElementName\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/InvalidElementName\",\n            \"text\": \"Illegal characters in element/widget name \\\"<$text text=<<elementName>>/>\\\". Element tags can only contain letters and the characters hyphen (`-`) and dollar sign (`$`)\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/InvalidMacroName\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/InvalidMacroName\",\n            \"text\": \"Illegal characters in macro name \\\"<$text text=<<macroName>>/>\\\". Macros cannot contain whitespace\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/InvalidParameterName\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/InvalidParameterName\",\n            \"text\": \"Illegal characters in parameter name \\\"<$text text=<<parameterName>>/>\\\". Parameters can only contain letters, digits, and the characters underscore (`_`) and hyphen (`-`)\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/RelinkFilterOperator\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/RelinkFilterOperator\",\n            \"text\": \"Filter Error: Unknown suffix for the 'relink' filter operator\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/ReportFailedRelinks\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/ReportFailedRelinks\",\n            \"text\": \"Relink could not update '<<from>>' to '<<to>>' inside the following tiddlers:\"\n        },\n        \"$:/plugins/flibbles/relink/language/Error/UnrecognizedType\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Error/UnrecognizedType\",\n            \"text\": \"Relink parse error: Unrecognized field type '<<type>>'\"\n        },\n        \"$:/plugins/flibbles/relink/language/Filters/Missing\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Filters/Missing\",\n            \"text\": \"//Relink// Missing tiddlers\"\n        },\n        \"$:/plugins/flibbles/relink/language/Filters/Orphans\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Filters/Orphans\",\n            \"text\": \"//Relink// Orphans tiddlers\"\n        },\n        \"$:/plugins/flibbles/relink/language/Help/Attributes\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Help/Attributes\",\n            \"text\": \"See the <a href={{{[{$:/plugins/flibbles/relink!!demo}addsuffix[#Attributes]]}}} class=\\\"tc-tiddlylink-external\\\">Attributes documentation page</a> for details.\"\n        },\n        \"$:/plugins/flibbles/relink/language/Help/Fields\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Help/Fields\",\n            \"text\": \"See the <a href={{{[{$:/plugins/flibbles/relink!!demo}addsuffix[#Fields]]}}} class=\\\"tc-tiddlylink-external\\\">Fields documentation page</a> for details.\"\n        },\n        \"$:/plugins/flibbles/relink/language/Help/Macros\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Help/Macros\",\n            \"text\": \"See the <a href={{{[{$:/plugins/flibbles/relink!!demo}addsuffix[#Macros]]}}} class=\\\"tc-tiddlylink-external\\\">Macros documentation page</a> for details.\"\n        },\n        \"$:/plugins/flibbles/relink/language/Help/Operators\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Help/Operators\",\n            \"text\": \"See the <a href={{{[{$:/plugins/flibbles/relink!!demo}addsuffix[#Operators]]}}} class=\\\"tc-tiddlylink-external\\\">Operators documentation page</a> for details.\"\n        },\n        \"$:/plugins/flibbles/relink/language/SideBar/Missing/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/SideBar/Missing/Caption\",\n            \"text\": \"//Relink//<br>Missing\"\n        },\n        \"$:/plugins/flibbles/relink/language/SideBar/Orphans/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/SideBar/Orphans/Caption\",\n            \"text\": \"//Relink//<br>Orphans\"\n        },\n        \"$:/plugins/flibbles/relink/language/TiddlerInfo/References/Empty\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/TiddlerInfo/References/Empty\",\n            \"text\": \"No tiddlers contain any fields, links, macros, transclusions, or widgets referencing this one\"\n        },\n        \"$:/plugins/flibbles/relink/language/TiddlerInfo/References/Description\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/TiddlerInfo/References/Description\",\n            \"text\": \"The following tiddlers contain fields, links, macros, transclusions, or widgets referencing this one:\"\n        },\n        \"$:/plugins/flibbles/relink/language/TiddlerInfo/References/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/TiddlerInfo/References/Caption\",\n            \"text\": \"//Relink// References\"\n        },\n        \"$:/plugins/flibbles/relink/language/ui/Attributes/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/ui/Attributes/Caption\",\n            \"text\": \"Attributes\"\n        },\n        \"$:/plugins/flibbles/relink/language/ui/Fields/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/ui/Fields/Caption\",\n            \"text\": \"Fields\"\n        },\n        \"$:/plugins/flibbles/relink/language/ui/Macros/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/ui/Macros/Caption\",\n            \"text\": \"Macros\"\n        },\n        \"$:/plugins/flibbles/relink/language/ui/Operators/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/ui/Operators/Caption\",\n            \"text\": \"Operators\"\n        },\n        \"$:/plugins/flibbles/relink/language/Warning/OldRelinkTextOperator\": {\n            \"title\": \"$:/plugins/flibbles/relink/language/Warning/OldRelinkTextOperator\",\n            \"text\": \"Relink cannot parse your <code>$$$<<keyword>></code> wikitext until you migrate your \\\"<<type>>\\\" relink module from the deprecated ''relinktextoperator'' module-type to ''relinktext''.<br><br>See <a href={{{ [[Versions/2.1.0]addprefix[#]addprefix{$:/plugins/flibbles/relink!!demo}encodeuri[]] }}} class=\\\"tc-tiddlylink-external\\\">the online documentation</a> for details.\"\n        },\n        \"$:/plugins/flibbles/relink/license\": {\n            \"title\": \"$:/plugins/flibbles/relink/license\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"<a href={{$:/plugins/flibbles/relink!!demo}} class=\\\"tc-tiddlylink-external\\\">Relink Plugin</a> Copyright (c) 2019-<<now YYYY>> Cameron Fischer\\n\\n[[BSD 3-Clause License|https://raw.githubusercontent.com/flibbles/tw5-relink/master/LICENSE]]\\n\"\n        },\n        \"$:/config/flibbles/relink/macros/colour-picker/actions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/colour-picker/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/csvtiddlers/filter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/csvtiddlers/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/datauri/title\": {\n            \"title\": \"$:/config/flibbles/relink/macros/datauri/title\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/image-picker/actions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/image-picker/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/jsontiddler/title\": {\n            \"title\": \"$:/config/flibbles/relink/macros/jsontiddler/title\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/jsontiddlers/filter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/jsontiddlers/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/configTiddlerFilter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/configTiddlerFilter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/inputAcceptActions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/inputAcceptActions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/inputAcceptVariantActions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/inputAcceptVariantActions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/inputCancelActions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/inputCancelActions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/selectionStateTitle\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/selectionStateTitle\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/storeTitle\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/storeTitle\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/keyboard-driven-input/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/macros/keyboard-driven-input/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/list-links/filter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-links/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/list-links/emptyMessage\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-links/emptyMessage\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/list-links-draggable/tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-links-draggable/tiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/list-links-draggable/itemTemplate\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-links-draggable/itemTemplate\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/list-tagged-draggable/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-tagged-draggable/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/list-tagged-draggable/emptyMessage\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-tagged-draggable/emptyMessage\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/list-tagged-draggable/itemTemplate\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-tagged-draggable/itemTemplate\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/list-thumbnails/filter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/list-thumbnails/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/tabs/actions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tabs/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/tabs/buttonTemplate\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tabs/buttonTemplate\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/tabs/default\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tabs/default\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/tabs/tabsList\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tabs/tabsList\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/tabs/template\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tabs/template\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/tag/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tag/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/tag-picker/actions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tag-picker/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/tag-pill/actions\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tag-pill/actions\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/tag-pill/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/tag-pill/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc/itemClassFilter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc/itemClassFilter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-expandable/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-expandable/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-expandable/itemClassFilter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-expandable/itemClassFilter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-expandable/exclude\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-expandable/exclude\",\n            \"text\": \"list\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-selective-expandable/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-selective-expandable/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-selective-expandable/itemClassFilter\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-selective-expandable/itemClassFilter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-selective-expandable/exclude\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-selective-expandable/exclude\",\n            \"text\": \"list\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/selectedTiddler\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/selectedTiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/unselectedText\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/unselectedText\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/missingText\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/missingText\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/template\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-external-nav/template\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/tag\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/selectedTiddler\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/selectedTiddler\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/unselectedText\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/unselectedText\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/missingText\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/missingText\",\n            \"text\": \"wikitext\"\n        },\n        \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/template\": {\n            \"title\": \"$:/config/flibbles/relink/macros/toc-tabbed-internal-nav/template\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/macros/translink/title\": {\n            \"title\": \"$:/config/flibbles/relink/macros/translink/title\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/messages/tm-new-tiddler\": {\n            \"title\": \"$:/config/flibbles/relink/messages/tm-new-tiddler\",\n            \"text\": \"(.*)\"\n        },\n        \"$:/config/flibbles/relink/operators/filter\": {\n            \"title\": \"$:/config/flibbles/relink/operators/filter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/operators/list\": {\n            \"title\": \"$:/config/flibbles/relink/operators/list\",\n            \"text\": \"reference\"\n        },\n        \"$:/config/flibbles/relink/operators/subfilter\": {\n            \"title\": \"$:/config/flibbles/relink/operators/subfilter\",\n            \"text\": \"filter\"\n        },\n        \"$:/config/flibbles/relink/operators/tag\": {\n            \"title\": \"$:/config/flibbles/relink/operators/tag\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/operators/title\": {\n            \"title\": \"$:/config/flibbles/relink/operators/title\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/operators/field:title\": {\n            \"title\": \"$:/config/flibbles/relink/operators/field:title\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/operators/relink:report\": {\n            \"title\": \"$:/config/flibbles/relink/operators/relink:report\",\n            \"text\": \"title\"\n        },\n        \"$:/language/EditTemplate/Title/Impossibles/Prompt\": {\n            \"title\": \"$:/language/EditTemplate/Title/Impossibles/Prompt\",\n            \"text\": \"''Warning:'' Not all references in the following tiddlers can be updated by //Relink// due to the complexity of the new title:\"\n        },\n        \"$:/language/EditTemplate/Title/References/Prompt\": {\n            \"title\": \"$:/language/EditTemplate/Title/References/Prompt\",\n            \"text\": \"The following tiddlers will be updated if relinking:\"\n        },\n        \"$:/language/EditTemplate/Title/Relink/Prompt\": {\n            \"title\": \"$:/language/EditTemplate/Title/Relink/Prompt\",\n            \"text\": \"Use //Relink// to update ''<$text text=<<fromTitle>>/>'' to ''<$text text=<<toTitle>>/>'' across all other tiddlers\"\n        },\n        \"$:/core/ui/EditTemplate/title\": {\n            \"title\": \"$:/core/ui/EditTemplate/title\",\n            \"tags\": \"$:/tags/EditTemplate\",\n            \"text\": \"\\\\whitespace trim\\n<$edit-text field=\\\"draft.title\\\" class=\\\"tc-titlebar tc-edit-texteditor\\\" focus={{{ [{$:/config/AutoFocus}match[title]then[true]] ~[[false]] }}} tabindex={{$:/config/EditTabIndex}} cancelPopups=\\\"yes\\\" dir={{$:/config/DefaultTextDirection}}/>\\n\\n<$vars pattern=\\\"\\\"\\\"[\\\\|\\\\[\\\\]{}]\\\"\\\"\\\" bad-chars=\\\"\\\"\\\"`| [ ] { }`\\\"\\\"\\\">\\n\\n<$list filter=\\\"[all[current]regexp:draft.title<pattern>]\\\" variable=\\\"listItem\\\">\\n\\n<div class=\\\"tc-message-box\\\" dir={{$:/config/DefaultTextDirection}}>\\n\\n{{$:/core/images/warning}}&#32;{{$:/language/EditTemplate/Title/BadCharacterWarning}}\\n\\n</div>\\n\\n</$list>\\n\\n</$vars>\\n\\n<$reveal state=\\\"!!draft.title\\\" type=\\\"nomatch\\\" text={{!!draft.of}} tag=\\\"div\\\" dir={{$:/config/DefaultTextDirection}}>\\n\\n<$list filter=\\\"[{!!draft.title}!is[missing]]\\\" variable=\\\"listItem\\\">\\n\\n<div class=\\\"tc-message-box\\\">\\n\\n{{$:/core/images/warning}}&#32;{{$:/language/EditTemplate/Title/Exists/Prompt}}:&#32;<$link to={{!!draft.title}} />\\n\\n</div>\\n\\n</$list>\\n\\n<$list filter=\\\"[{!!draft.of}!is[missing]]\\\" variable=\\\"listItem\\\">\\n\\n<$vars fromTitle={{!!draft.of}} toTitle={{!!draft.title}}>\\n\\n<$checkbox tiddler=\\\"$:/config/RelinkOnRename\\\" field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"no\\\" default=\\\"no\\\">&#32;{{$:/language/EditTemplate/Title/Relink/Prompt}}</$checkbox>\\n\\n<$tiddler tiddler=<<fromTitle>> >\\n\\n<$list filter=\\\"[relink:wouldchange<toTitle>limit[1]]\\\" variable=\\\"listItem\\\">\\n\\n<$vars stateTiddler=<<qualify \\\"$:/state/edit/references\\\">> >\\n\\n<$set\\n\\tname=\\\"prompt\\\"\\n\\tfilter=\\\"[relink:wouldchange<toTitle>relink:impossible<toTitle>]\\\"\\n\\tvalue=\\\"EditTemplate/Title/Impossibles/Prompt\\\"\\n\\temptyValue=\\\"EditTemplate/Title/References/Prompt\\\" >\\n<$reveal type=\\\"nomatch\\\" state=<<stateTiddler>> text=\\\"show\\\">\\n<$button set=<<stateTiddler>> setTo=\\\"show\\\" class=\\\"tc-btn-invisible\\\">\\n{{$:/core/images/right-arrow}}\\n&#32;\\n<$macrocall $name=lingo title=<<prompt>> />\\n</$button>\\n</$reveal>\\n<$reveal type=\\\"match\\\" state=<<stateTiddler>> text=\\\"show\\\">\\n<$button set=<<stateTiddler>> setTo=\\\"hide\\\" class=\\\"tc-btn-invisible\\\">\\n{{$:/core/images/down-arrow}}\\n&#32;\\n<$macrocall $name=lingo title=<<prompt>> />\\n</$button>\\n</$reveal>\\n</$set>\\n\\n<$reveal type=\\\"match\\\" state=<<stateTiddler>> text=\\\"show\\\">\\n<$list variable=\\\"listItem\\\" filter=\\\"[relink:wouldchange<toTitle>!title[$:/StoryList]sort[title]]\\\" template=\\\"$:/plugins/flibbles/relink/ui/ListItemTemplate\\\">\\n</$list>\\n</$reveal>\\n\\n</$vars>\\n\\n</$list>\\n\\n</$tiddler>\\n\\n</$vars>\\n\\n</$list>\\n\\n</$reveal>\\n\"\n        },\n        \"$:/config/flibbles/relink/PluginLibrary\": {\n            \"title\": \"$:/config/flibbles/relink/PluginLibrary\",\n            \"caption\": \"//Relink// Library\",\n            \"url\": \"https://flibbles.github.io/tw5-relink/library/index.html\",\n            \"tags\": \"$:/tags/PluginLibrary\",\n            \"text\": \"The //Relink// library contains //Relink// as well as its supplemental plugins. It is maintained by Flibbles. See the [[github page|https://github.com/flibbles/tw5-relink]] for more information.\\n\"\n        },\n        \"$:/plugins/flibbles/relink/readme\": {\n            \"title\": \"$:/plugins/flibbles/relink/readme\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"When renaming a tiddler, Relink can update the fields, filters, and widgets\\nof all other tiddlers. However, it works through whitelisting.\\n\\nIt's already configured to update tiddler titles for all core widgets, filters,\\nand fields, but the whitelists can be customized for each of this in the\\nconfiguration panel.\\n\\nSee <a href={{$:/plugins/flibbles/relink!!source}} class=\\\"tc-tiddlylink-external\\\">the tw5-relink website</a> for more details and examples.\\n\"\n        },\n        \"$:/config/flibbles/relink/settings/default-type\": {\n            \"title\": \"$:/config/flibbles/relink/settings/default-type\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/touch-modify\": {\n            \"title\": \"$:/config/flibbles/relink/touch-modify\",\n            \"text\": \"yes\"\n        },\n        \"$:/config/DefaultColourMappings/relink-impossible\": {\n            \"title\": \"$:/config/DefaultColourMappings/relink-impossible\",\n            \"text\": \"<<colour dirty-indicator>>\"\n        },\n        \"$:/language/Docs/PaletteColours/relink-impossible\": {\n            \"title\": \"$:/language/Docs/PaletteColours/relink-impossible\",\n            \"text\": \"Relink link impossible\"\n        },\n        \"$:/plugins/flibbles/relink/ui/ListItemTemplate\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/ListItemTemplate\",\n            \"text\": \"\\\\whitespace trim\\n<$set\\n\\tname=\\\"classes\\\"\\n\\tfilter=\\\"[<listItem>relink:impossible<toTitle>]\\\"\\n\\tvalue=\\\"tc-menu-list-item tc-relink-impossible\\\"\\n\\temptyValue=\\\"tc-menu-list-item\\\">\\n<div class=<<classes>>>\\n<$link to=<<listItem>>><$text text=<<listItem>> /></$link>\\n</div>\\n</$set>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/ListItemWithBlurbTemplate\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/ListItemWithBlurbTemplate\",\n            \"text\": \"<div class=\\\"tc-menu-list-item\\\"><$link /></div>\\n<$list variable=blurb filter=\\\"[<currentTiddler>relink:report<missingTiddler>]\\\"><div class=\\\"tc-relink-menu-missing-blurb\\\"><$text text=<<blurb>> /></div>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/MissingTemplate\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/MissingTemplate\",\n            \"text\": \"\\\\whitespace trim\\n<$set name=\\\"missingTiddler\\\" value=<<currentTiddler>> >\\n<div class=\\\"tc-tiddler-missing\\\">\\n<$button popup=<<qualify \\\"$:/state/relink/popup/missing\\\">> class=\\\"tc-btn-invisible tc-missing-tiddler-label\\\">\\n<$view field=\\\"title\\\" format=\\\"text\\\" />\\n</$button>\\n<$reveal state=<<qualify \\\"$:/state/relink/popup/missing\\\">> type=\\\"popup\\\" position=\\\"below\\\" animate=\\\"yes\\\">\\n<div class=\\\"tc-drop-down\\\">\\n<$transclude tiddler=\\\"$:/core/ui/ListItemTemplate\\\"/>\\n<hr>\\n<$list filter=\\\"[all[current]relink:backreferences[]sort[title]]\\\" template=\\\"$:/plugins/flibbles/relink/ui/ListItemWithBlurbTemplate\\\"/>\\n</div>\\n</$reveal>\\n</div>\\n</$set>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/MoreSideBar/Missing\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/MoreSideBar/Missing\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/SideBar/Missing/Caption}}\",\n            \"tags\": \"$:/tags/MoreSideBar\",\n            \"text\": \"<$list filter={{$:/plugins/flibbles/relink/Filters/Missing!!filter}} template=\\\"$:/plugins/flibbles/relink/ui/MissingTemplate\\\" />\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/MoreSideBar/Orphans\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/MoreSideBar/Orphans\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/SideBar/Orphans/Caption}}\",\n            \"tags\": \"$:/tags/MoreSideBar\",\n            \"text\": \"<$list filter={{$:/plugins/flibbles/relink/Filters/Orphans!!filter}} template=\\\"$:/core/ui/ListItemTemplate\\\" />\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/TiddlerInfo/References\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/TiddlerInfo/References\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/TiddlerInfo/References/Caption}}\",\n            \"tags\": \"$:/tags/TiddlerInfo\",\n            \"text\": \"\\\\define lingo-base() $:/plugins/flibbles/relink/language/TiddlerInfo/\\n\\\\define filter() [all[current]relink:backreferences[]!title[$:/StoryList]!prefix[$:/temp/]sort[title]]\\n\\\\whitespace trim\\n<$list filter=\\\"[subfilter<filter>first[]]\\\">\\n<<lingo References/Description>>\\n</$list>\\n<table class=\\\"tc-relink-references-table\\\">\\n<tbody>\\n<$vars toTitle='' >\\n<$list filter=<<filter>> emptyMessage=<<lingo References/Empty>> variable=\\\"listItem\\\" template=\\\"$:/plugins/flibbles/relink/ui/TiddlerInfo/ReferencesTemplate\\\" />\\n</$vars>\\n</tbody>\\n</table>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/TiddlerInfo/ReferencesTemplate\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/TiddlerInfo/ReferencesTemplate\",\n            \"text\": \"\\\\whitespace trim\\n<tr class=\\\"tc-relink-references\\\">\\n<td class={{{ tc-relink-references-title [<toTitle>!match[]then<listItem>relink:impossible<toTitle>then[tc-relink-impossible]] +[join[ ]] }}} >\\n\\t<$list\\n\\t\\tvariable=whitelist\\n\\t\\tfilter=\\\"[<listItem>removeprefix[$:/config/flibbles/relink/]split[/]first[]titlecase[]addprefix[$:/plugins/flibbles/relink/ui/configuration/]]\\\"\\n\\t\\temptyMessage=\\\"<$link to=<<listItem>>/>\\\" >\\n\\t\\t<$link to=<<whitelist>>>\\n\\t\\t\\t''//Relink//&#32;whitelist''\\n\\t\\t</$link>\\n\\t</$list>\\n</td>\\n<td class=\\\"tc-relink-references-report\\\">\\n\\t<$list filter=\\\"[<listItem>relink:report<currentTiddler>]\\\">\\n\\n\\t\\t<$text text=<<currentTiddler>> />\\n\\t</$list>\\n</td></tr>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/components/button-delete\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/components/button-delete\",\n            \"text\": \"\\\\define lingo-base() $:/plugins/flibbles/relink/language/Buttons/\\n\\\\define prefix() $:/config/flibbles/relink/\\n\\\\whitespace trim\\n\\n<$list\\n\\tfilter=\\\"[all[current]prefix<prefix>]\\\"\\n\\temptyMessage=\\\"<$link><$button class='tc-btn-invisible' tooltip={{$:/plugins/flibbles/relink/language/Buttons/LinkToInline/Hint}}>{{$:/core/images/link}}</$button></$link>\\\">\\n<$button class=\\\"tc-btn-invisible\\\" tooltip={{$:/plugins/flibbles/relink/language/Buttons/Delete/Hint}}><$list filter=\\\"[all[current]is[tiddler]]\\\">\\n<$action-deletetiddler $tiddler=<<currentTiddler>> />\\n</$list><$list filter=\\\"[all[current]is[shadow]]\\\">\\n<$action-setfield $tiddler=<<tiddlerName>> text=\\\"\\\" />\\n</$list>\\n{{$:/core/images/delete-button}}\\n</$button>\\n</$list>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/components/select-fieldtype\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/components/select-fieldtype\",\n            \"text\": \"\\\\define prefix() $:/config/flibbles/relink/\\n\\\\whitespace trim\\n\\n<$vars type={{{ [<signature>relink:type[]] }}} >\\n<$list filter=\\\"[all[current]prefix<prefix>]\\\" >\\n<$select tiddler=<<currentTiddler>> >\\n<$list variable=\\\"option\\\" filter=\\\"[relink:types[]]\\\">\\n<option><$text text=<<option>> /></option>\\n</$list>\\n</$select>\\n</$list><$list filter=\\\"[all[current]!prefix<prefix>]\\\">\\n<$text text=<<type>> />\\n</$list>\\n</$vars>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/components/tables\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/components/tables\",\n            \"text\": \"\\\\define .make-table(title, plugin, default-table-state:yes)\\n\\\\whitespace trim\\n\\n<$list variable=\\\"render\\\" filter=\\\"[relink:signatures<__plugin__>prefix<__category__>first[]]\\\">\\n<$vars table-state=<<qualify \\\"\\\"\\\"$:/state/flibbles/relink/tables/$plugin$\\\"\\\"\\\">>>\\n<tr><th class=\\\"tc-relink-header-plugin\\\" colspan=<<column-count>> >\\n<$reveal type=\\\"nomatch\\\" state=<<table-state>> text=\\\"yes\\\" default=\\\"\\\"\\\"$default-table-state$\\\"\\\"\\\">\\n<$button class=\\\"tc-btn-invisible tc-btn-dropdown\\\" set=<<table-state>> setTo=\\\"yes\\\">\\n{{$:/core/images/right-arrow}}&#32;$title$\\n</$button>\\n</$reveal>\\n<$reveal type=\\\"match\\\" state=<<table-state>> text=\\\"yes\\\" default=\\\"\\\"\\\"$default-table-state$\\\"\\\"\\\">\\n<$button class=\\\"tc-btn-invisible tc-btn-dropdown\\\" set=<<table-state>> setTo=\\\"no\\\">\\n{{$:/core/images/down-arrow}}&#32;$title$\\n</$button>\\n</$reveal>\\n</th></tr>\\n<$list\\n\\tvariable=\\\"signature\\\"\\n\\tfilter=\\\"[relink:signatures<__plugin__>prefix<__category__>sort[]]\\\">\\n<$vars key={{{ [<signature>removeprefix<__category__>removeprefix[/]] }}} >\\n<$tiddler tiddler={{{[<signature>relink:source[]]}}} >\\n<$reveal tag=\\\"tr\\\" type=\\\"match\\\" state=<<table-state>> text=\\\"yes\\\" default=\\\"\\\"\\\"$default-table-state$\\\"\\\"\\\">\\n<$macrocall $name=<<__list-row-macro__>> signature=<<signature>> />\\n<td class=\\\"tc-relink-column-type\\\">{{||$:/plugins/flibbles/relink/ui/components/select-fieldtype}}</td>\\n<td class=\\\"tc-relink-column-delete\\\">{{||$:/plugins/flibbles/relink/ui/components/button-delete}}</td>\\n</$reveal>\\n</$tiddler>\\n</$vars>\\n</$list>\\n</$vars>\\n</$list>\\n\\\\end\\n\\n\\\\define tables(category, list-row-macro, header-list)\\n\\\\whitespace trim\\n<$vars\\n\\tcolumn-count={{{[enlist<__header-list__>] [[DeleteColumn]] +[count[]]}}}>\\n<table class=\\\"tc-relink-whitelist\\\"><tbody>\\n<tr>\\n<$list variable=\\\"header\\\" filter=\\\"[enlist<__header-list__>butlast[]]\\\"><th><<header>></th></$list>\\n<!-- We have the last column extend into the delete/link column, which is unlabeled. -->\\n<th colspan=2><$text text={{{ [enlist<__header-list__>last[]] }}} /></th>\\n</tr>\\n<<.make-table Custom \\\"\\\" yes>>\\n\\n<$list\\n\\tfilter=\\\"[plugin-type[plugin]![$:/core]![$:/plugins/flibbles/relink]]\\\">\\n<$set name=\\\"subtitle\\\"\\n\\tfilter=\\\"[all[current]has[description]]\\\"\\n\\tvalue=\\\"''{{!!name}}'':&#32;<$text text={{!!description}}/>\\\"\\n\\temptyValue=\\\"''{{!!name}}''\\\" >\\n<$macrocall $name=\\\".make-table\\\" title=<<subtitle>> plugin=<<currentTiddler>> />\\n</$set>\\n</$list>\\n<<.make-table Core \\\"$:/plugins/flibbles/relink\\\">>\\n\\n</tbody></table>\\n</$vars>\\n\\\\end\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/configuration/Attributes\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/configuration/Attributes\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/ui/Attributes/Caption}}\",\n            \"tags\": \"$:/tags/flibbles/relink/Configuration\",\n            \"text\": \"\\\\import $:/plugins/flibbles/relink/ui/components/tables\\n\\\\define prefix-attr() $:/config/flibbles/relink/attributes/\\n\\\\define lingo-base() $:/plugins/flibbles/relink/language/Buttons/\\n\\\\define element-name-tiddler() $:/state/flibbles/relink/element-name\\n\\\\define attribute-name-tiddler() $:/state/flibbles/relink/attribute-name\\n\\n\\\\define row()\\n\\\\whitespace trim\\n<$set name='element'\\n      value={{{[<key>splitbefore[/]removesuffix[/]]}}}>\\n<$set name=\\\"attribute\\\"\\n      value={{{[<key>removeprefix<element>removeprefix[/]]}}}>\\n<td><$text text=<<element>> /></td>\\n<td><$text text=<<attribute>> /></td>\\n</$set></$set>\\n\\\\end\\n\\\\define body()\\n\\\\whitespace trim\\n\\n<em class=\\\"tc-edit\\\">Add a new attribute:</em>\\n&#32;\\n<$edit-text\\n\\ttiddler=<<element-name-tiddler>>\\n\\ttag=\\\"input\\\"\\n\\tdefault=\\\"\\\"\\n\\tplaceholder=\\\"widget/element\\\" />\\n&#32;\\n<$edit-text\\n\\ttiddler=<<attribute-name-tiddler>>\\n\\ttag=\\\"input\\\"\\n\\tdefault=\\\"\\\"\\n\\tplaceholder=\\\"attribute\\\" />\\n&#32;\\n<$reveal type=\\\"nomatch\\\" text=\\\"\\\" state=<<element-name-tiddler>> >\\n<$reveal type=\\\"nomatch\\\" text=\\\"\\\" state=<<attribute-name-tiddler>> >\\n<$relinkmangler>\\n<$button\\n\\ttooltip={{$(lingo-base)$NewAttribute/Hint}}\\n\\taria-label={{$(lingo-base)$NewAttribute/Caption}}>\\n<$action-sendmessage\\n\\t$message=\\\"relink-add-attribute\\\"\\n\\telement={{$(element-name-tiddler)$}}\\n\\tattribute={{$(attribute-name-tiddler)$}} />\\n<$action-deletetiddler $tiddler=<<attribute-name-tiddler>> />\\n<$action-deletetiddler $tiddler=<<element-name-tiddler>> />\\n<$text text={{$(lingo-base)$NewAttribute/Caption}}/>\\n</$button>\\n</$relinkmangler>\\n</$reveal>\\n<$reveal type=\\\"match\\\" text=\\\"\\\" state=<<attribute-name-tiddler>> >\\n<$button>\\n<$text text={{$(lingo-base)$NewAttribute/Caption}}/>\\n</$button>\\n</$reveal>\\n</$reveal>\\n<$reveal type=\\\"match\\\" text=\\\"\\\" state=<<element-name-tiddler>> >\\n<$button>\\n<$text text={{$(lingo-base)$NewAttribute/Caption}}/>\\n</$button>\\n</$reveal>\\n\\n@@.tc-control-panel\\n<$macrocall\\n\\t$name=tables\\n\\tcategory=\\\"attributes\\\"\\n\\theader-list=\\\"[[Widget/HTML Element]] Attribute Type\\\"\\n\\tlist-row-macro=\\\"row\\\" />\\n@@\\n\\\\end\\n\\n{{$:/plugins/flibbles/relink/language/Help/Attributes}}\\n\\n<<body>>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/configuration/Fields\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/configuration/Fields\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/ui/Fields/Caption}}\",\n            \"tags\": \"$:/tags/flibbles/relink/Configuration\",\n            \"text\": \"\\\\import $:/plugins/flibbles/relink/ui/components/tables\\n\\\\define lingo-base() $:/plugins/flibbles/relink/language/Buttons/\\n\\\\define field-name-tiddler() $:/state/flibbles/relink/field-name\\n\\n\\\\define row()\\n<td><$text text=<<key>> /></td>\\n\\\\end\\n\\n\\\\define body()\\n\\\\whitespace trim\\n\\n<em class='tc-edit'>Add a new field:</em>\\n&#32;\\n<$edit-text\\n\\ttiddler=<<field-name-tiddler>>\\n\\ttag=\\\"input\\\"\\n\\tdefault=\\\"\\\"\\n\\tplaceholder=\\\"field name\\\" />\\n&#32;\\n<$reveal type=\\\"nomatch\\\" text=\\\"\\\" state=<<field-name-tiddler>> >\\n<$relinkmangler>\\n<$button\\n\\ttooltip={{$(lingo-base)$NewField/Hint}}\\n\\taria-label={{$(lingo-base)$NewField/Caption}}>\\n<$action-sendmessage\\n\\t$message=\\\"relink-add-field\\\"\\n\\tfield={{$(field-name-tiddler)$}} />\\n<$action-deletetiddler $tiddler=<<field-name-tiddler>> />\\n<$text text={{$(lingo-base)$NewField/Caption}}/>\\n</$button>\\n</$relinkmangler>\\n</$reveal>\\n<$reveal type=\\\"match\\\" text=\\\"\\\" state=<<field-name-tiddler>> >\\n<$button>\\n<$text text={{$(lingo-base)$NewField/Caption}}/>\\n</$button>\\n</$reveal>\\n\\n@@.tc-control-panel\\n<$macrocall\\n\\t$name=tables\\n\\tcategory=\\\"fields\\\"\\n\\theader-list=\\\"[[Field Name]] [[Field Type]]\\\"\\n\\tlist-row-macro=\\\"row\\\" />\\n@@\\n\\\\end\\n\\n{{$:/plugins/flibbles/relink/language/Help/Fields}}\\n\\n<<body>>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/configuration/Macros\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/configuration/Macros\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/ui/Macros/Caption}}\",\n            \"tags\": \"$:/tags/flibbles/relink/Configuration\",\n            \"text\": \"\\\\import $:/plugins/flibbles/relink/ui/components/tables\\n\\\\define prefix-macro() $:/config/flibbles/relink/macros/\\n\\\\define lingo-base() $:/plugins/flibbles/relink/language/Buttons/\\n\\\\define macro-name-tiddler() $:/state/flibbles/relink/macro-name\\n\\\\define parameter-name-tiddler() $:/state/flibbles/relink/parameter-name\\n\\n\\\\define row()\\n\\\\whitespace trim\\n<$set name=\\\"parameter\\\"\\n      value={{{[<key>relink:splitafter[/]]}}}>\\n<$set name='macro'\\n      value={{{[<key>removesuffix<parameter>removesuffix[/]]}}}>\\n<td><$text text=<<macro>> /></td>\\n<td><$text text=<<parameter>> /></td>\\n</$set></$set>\\n\\\\end\\n\\n\\\\define body()\\n\\\\whitespace trim\\n\\n<em class=\\\"tc-edit\\\">Add a new macro parameter:</em>\\n&#32;\\n<$edit-text\\n\\ttiddler=<<macro-name-tiddler>>\\n\\ttag=\\\"input\\\"\\n\\tdefault=\\\"\\\"\\n\\tplaceholder=\\\"macro\\\" />\\n&#32;\\n<$edit-text\\n\\ttiddler=<<parameter-name-tiddler>>\\n\\ttag=\\\"input\\\"\\n\\tdefault=\\\"\\\"\\n\\tplaceholder=\\\"parameter\\\" />\\n&#32;\\n<$reveal type=\\\"nomatch\\\" text=\\\"\\\" state=<<macro-name-tiddler>> >\\n<$reveal type=\\\"nomatch\\\" text=\\\"\\\" state=<<parameter-name-tiddler>> >\\n<$relinkmangler>\\n<$button\\n\\ttooltip={{$(lingo-base)$NewParameter/Hint}}\\n\\taria-label={{$(lingo-base)$NewParameter/Caption}}>\\n<$action-sendmessage\\n\\t$message=\\\"relink-add-parameter\\\"\\n\\tmacro={{$(macro-name-tiddler)$}}\\n\\tparameter={{$(parameter-name-tiddler)$}} />\\n<$action-deletetiddler $tiddler=<<parameter-name-tiddler>> />\\n<$action-deletetiddler $tiddler=<<macro-name-tiddler>> />\\n<$text text={{$(lingo-base)$NewParameter/Caption}}/>\\n</$button>\\n</$relinkmangler>\\n</$reveal>\\n<$reveal type=\\\"match\\\" text=\\\"\\\" state=<<parameter-name-tiddler>> >\\n<$button>\\n<$text text={{$(lingo-base)$NewParameter/Caption}}/>\\n</$button>\\n</$reveal>\\n</$reveal>\\n<$reveal type=\\\"match\\\" text=\\\"\\\" state=<<macro-name-tiddler>> >\\n<$button>\\n<$text text={{$(lingo-base)$NewParameter/Caption}}/>\\n</$button>\\n</$reveal>\\n\\n@@.tc-control-panel\\n<$macrocall\\n\\t$name=tables\\n\\tcategory=\\\"macros\\\"\\n\\theader-list=\\\"Macro Parameter Type\\\"\\n\\tlist-row-macro=\\\"row\\\" />\\n@@\\n\\\\end\\n\\n{{$:/plugins/flibbles/relink/language/Help/Macros}}\\n\\n<<body>>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/configuration/Operators\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/configuration/Operators\",\n            \"caption\": \"{{$:/plugins/flibbles/relink/language/ui/Operators/Caption}}\",\n            \"tags\": \"$:/tags/flibbles/relink/Configuration\",\n            \"text\": \"\\\\import $:/plugins/flibbles/relink/ui/components/tables\\n\\\\define lingo-base() $:/plugins/flibbles/relink/language/Buttons/\\n\\\\define operator-name-tiddler() $:/state/flibbles/relink/operator-name\\n\\n\\\\define row()\\n<td><$text text=<<key>> /></td>\\n\\\\end\\n\\n\\\\define body()\\n\\\\whitespace trim\\n\\n<em class='tc-edit'>Add a new filter operator:</em>\\n&#32;\\n<$edit-text\\n\\ttiddler=<<operator-name-tiddler>>\\n\\ttag=\\\"input\\\"\\n\\tdefault=\\\"\\\"\\n\\tplaceholder=\\\"operator name\\\" />\\n&#32;\\n<$reveal type=\\\"nomatch\\\" text=\\\"\\\" state=<<operator-name-tiddler>>>\\n<$relinkmangler>\\n<$button\\n\\ttooltip={{$(lingo-base)$NewOperator/Hint}}\\n\\taria-label={{$(lingo-base)$NewOperator/Caption}}>\\n<$action-sendmessage\\n\\t$message=\\\"relink-add-operator\\\"\\n\\toperator={{$(operator-name-tiddler)$}} />\\n<$action-deletetiddler $tiddler=<<operator-name-tiddler>> />\\n<$text text={{$(lingo-base)$NewOperator/Caption}}/>\\n</$button>\\n</$relinkmangler>\\n</$reveal>\\n<$reveal type=\\\"match\\\" text=\\\"\\\" state=<<operator-name-tiddler>>>\\n<$button>\\n<$text text={{$(lingo-base)$NewOperator/Caption}}/>\\n</$button>\\n</$reveal>\\n\\n@@.tc-control-panel\\n<$macrocall\\n\\t$name=tables\\n\\tcategory=\\\"operators\\\"\\n\\theader-list=\\\"[[Filter Operator]] [[Operand Type]]\\\"\\n\\tlist-row-macro=\\\"row\\\" />\\n@@\\n\\\\end\\n\\n{{$:/plugins/flibbles/relink/language/Help/Operators}}\\n\\n<<body>>\\n\"\n        },\n        \"$:/plugins/flibbles/relink/ui/stylesheet.css\": {\n            \"title\": \"$:/plugins/flibbles/relink/ui/stylesheet.css\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"text\": \".tc-relink-references {\\n}\\n\\n.tc-relink-references-table {\\n\\twidth: 100%;\\n\\tborder: none;\\n}\\n\\n.tc-relink-references-table td {\\n\\tborder-left: none;\\n}\\n\\n.tc-relink-references-table tr:first-child td {\\n\\tborder-top: none;\\n}\\n\\n.tc-relink-references-title {\\n\\ttext-align: left;\\n\\tvertical-align: top;\\n\\tpadding-top: 3px;\\n\\tpadding-bottom: 3px;\\n}\\n\\n.tc-relink-references-occurrence {\\n\\tfont-style: italic;\\n\\ttext-align: left;\\n\\tfont-weight: 200;\\n\\tpadding-left: 25px;\\n\\tvertical-align: top;\\n}\\n\\n.tc-relink-header-plugin {\\n\\ttext-align: left;\\n}\\n\\n.tc-relink-header-plugin button {\\n\\twidth: 100%\\n}\\n\\n.tc-relink-column-type {\\n\\twidth: 8em;\\n}\\n\\n.tc-relink-column-type select {\\n\\twidth: 100%;\\n}\\n\\n.tc-relink-column-delete {\\n\\tborder-left: none;\\n\\ttext-align: left;\\n}\\n\\n.tc-relink-column-delete button {\\n\\tpadding-left: 1em;\\n}\\n\\n.tc-relink-impossible a.tc-tiddlylink {\\n\\tcolor: <<colour relink-impossible>>;\\n}\\n\\n.tc-relink-menu-missing-blurb {\\n\\tmargin-left: 30pt;\\n}\\n\"\n        }\n    }\n}"
  },
  {
    "name": "Relink Titles",
    "title": "$:/plugins/flibbles/relink-titles",
    "description": "Renames tiddlers with titles derived from Relinked tiddler",
    "author": "Flibbles",
    "version": "2.4.0",
    "core-version": ">=5.1.22",
    "parent-plugin": "$:/plugins/flibbles/relink",
    "source": "https://github.com/flibbles/tw5-relink",
    "demo": "http://flibbles.github.io/tw5-relink/",
    "list": "readme configuration",
    "dependents": "",
    "plugin-type": "plugin",
    "type": "application/json",
    "text": "{\n    \"tiddlers\": {\n        \"$:/plugins/flibbles/relink-titles/configuration\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/configuration\",\n            \"caption\": \"{{$:/plugins/flibbles/relink-titles/language/Caption}}\",\n            \"tags\": \"$:/tags/flibbles/relink/Configuration\",\n            \"list-after\": \"\",\n            \"text\": \"\\\\define lingo-base() $:/plugins/flibbles/relink-titles/language/\\n\\\\define prefix() $:/config/flibbles/relink-titles/relink/\\n\\\\whitespace trim\\n\\n<div class=\\\"tc-control-panel\\\">\\n\\n<<lingo Help>>\\n\\n<table>\\n<tbody>\\n<$list filter=\\\"[[relinktitlesrule]modules[]]\\\">\\n<tr>\\n<td>\\n<$checkbox\\n\\ttiddler={{{ [all[current]addprefix<prefix>] }}}\\n\\tfield=\\\"text\\\"\\n\\tchecked=\\\"enabled\\\"\\n\\tunchecked=\\\"disabled\\\"\\n\\tdefault=\\\"enabled\\\">\\n&#32;\\n''{{!!caption}}''\\n</$checkbox></td><td>\\n\\n<$transclude field='description' />\\n\\n</td></tr></$list>\\n</tbody></table></div>\\n\"\n        },\n        \"$:/plugins/flibbles/relink-titles/language/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/language/Caption\",\n            \"text\": \"Titles\"\n        },\n        \"$:/plugins/flibbles/relink-titles/language/Directory/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/language/Directory/Caption\",\n            \"text\": \"Rename subdirectories\"\n        },\n        \"$:/plugins/flibbles/relink-titles/language/Directory/Description\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/language/Directory/Description\",\n            \"text\": \"For wikis set up hierarchically using `/`, like a filesystem. This option will update all tiddlers nested inside the target tiddler. i.e. `fromTiddler/path/file` becomes `toTiddler/path/file`.\"\n        },\n        \"$:/plugins/flibbles/relink-titles/language/Lookup/Caption\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/language/Lookup/Caption\",\n            \"text\": \"Lookup tiddlers\"\n        },\n        \"$:/plugins/flibbles/relink-titles/language/Help\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/language/Help\",\n            \"text\": \"See the <a href={{{ [{$:/plugins/flibbles/relink-titles!!demo}addsuffix[#Plugins/Titles]] }}} class=\\\"tc-tiddlylink-external\\\">//Relink-titles// documentation page</a> for details.\"\n        },\n        \"$:/plugins/flibbles/relink-titles/readme\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/readme\",\n            \"text\": \"Highly customizable relinking of tiddler titles //related// to the renamed tiddler.\\n\\n* Rename a hierarchy of subtiddlers when renaming a root tiddler.\\n* Make custom filter rules to rename other tiddlers the way you want when Relinking.\\n* Integrates with other plugins for plugin-specific rules.\\n\\nSee <a href={{$:/plugins/flibbles/relink-titles!!source}} class=\\\"tc-tiddlylink-external\\\">the tw5-relink website</a> for more details and examples.\\n\\n{{$:/core/images/warning}} ''Warning:'' You must use //Relink// v1.10.2 or greater with this, or this plugin may delete some tiddler bodies while trying to relink titles.\\n\"\n        },\n        \"$:/plugins/flibbles/relink-titles/relinkoperations/title.js\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/relinkoperations/title.js\",\n            \"text\": \"/*\\\\\\nmodule-type: relinkoperator\\ntitle: $:/plugins/flibbles/relink-titles/relinkoperations/title.js\\ntype: application/javascript\\n\\nRenames tiddlers which have titles derived from fromTitle. Then it makes\\nsure that those tiddlers are properly relinked too.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar configPrefix = \\\"$:/config/flibbles/relink-titles/relink/\\\";\\nvar utils = require('$:/plugins/flibbles/relink/js/utils.js');\\n// This is using hotDirectories, which is a deprecated feature. It should be\\n// using the $:/config/flibbles/relink/{cateogory} directory which would be\\n// automatically maintained and regenerated.\\n// Maybe in time I'll get around to migrating this, but no need to complicate\\n// things now with changes that would require migration, and that would\\n// have no outward effect.\\nutils.getContext('whitelist').hotDirectories.push(configPrefix);\\n\\nvar titleRules = Object.create(null);\\n$tw.modules.forEachModuleOfType('relinktitlesrule', function(title, module) {\\n\\ttitleRules[title] = module;\\n});\\n\\nexports.name = 'title';\\n\\nexports.report = function(tiddler, callback, options) {\\n\\tvar cache = getCache(options),\\n\\t\\trules = cache.rules;\\n\\tfor (var i = 0; i < rules.length; i++) {\\n\\t\\trules[i].report(tiddler.fields.title, function(title, blurb, style) {\\n\\t\\t\\tcallback(title, blurb ? ('title: ' + blurb) : 'title', style);\\n\\t\\t}, options);\\n\\t}\\n};\\n\\nexports.relink = function(tiddler, fromTitle, toTitle, changes, options) {\\n\\tvar cache = getCache(options),\\n\\t\\ttitle = tiddler.fields.title;\\n\\tif (!cache.touched[title]) {\\n\\t\\tvar rules = cache.rules;\\n\\t\\tfor (var i = 0; i < rules.length; i++) {\\n\\t\\t\\tvar rule = rules[i];\\n\\t\\t\\tvar entry = rule.relink(title, fromTitle, toTitle, options);\\n\\t\\t\\tif (entry) {\\n\\t\\t\\t\\tvar result = entry.output;\\n\\t\\t\\t\\tif (result && (result !== title)) {\\n\\t\\t\\t\\t\\tif (options.wiki.getTiddler(result) || cache.touched[result]) {\\n\\t\\t\\t\\t\\t\\t// There's already a tiddler there. We won't clobber it.\\n\\t\\t\\t\\t\\t\\tentry.impossible = true;\\n\\t\\t\\t\\t\\t\\tentry.output = undefined;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tcache.touched[result] = true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\t// Record that we've touched this one, so we only touch it once.\\n\\t\\t\\t\\t// Both its prior and latter. Neither should be touched again.\\n\\t\\t\\t\\tcache.touched[title] = true;\\n\\t\\t\\t\\tchanges.title = entry;\\n\\t\\t\\t\\tbreak;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t}\\n};\\n\\nfunction getCache(options) {\\n\\treturn utils.getCacheForRun(options, 'titles', function() {\\n\\t\\treturn {\\n\\t\\t\\trules: getRules(options.wiki),\\n\\t\\t\\ttouched: Object.create(null)\\n\\t\\t};\\n\\t});\\n};\\n\\nfunction getRules(wiki) {\\n\\tvar activeRules = [];\\n\\tfor (var rule in titleRules) {\\n\\t\\tvar configTiddler = wiki.getTiddler(configPrefix + rule);\\n\\t\\tif (!configTiddler || configTiddler.fields.text !== \\\"disabled\\\") {\\n\\t\\t\\tactiveRules.push(titleRules[rule]);\\n\\t\\t}\\n\\t}\\n\\treturn activeRules;\\n};\\n\",\n            \"module-type\": \"relinkoperator\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink-titles/rules/directory\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/rules/directory\",\n            \"text\": \"/*\\\\\\ncaption: {{$:/plugins/flibbles/relink-titles/language/Directory/Caption}}\\ndescription: {{$:/plugins/flibbles/relink-titles/language/Directory/Description}}\\nmodule-type: relinktitlesrule\\ntitle: $:/plugins/flibbles/relink-titles/rules/directory\\ntype: application/javascript\\n\\nHandles subdirectory renaming.\\n\\n\\\\*/\\n\\n/*jslint node: false, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.name = 'directory';\\n\\n/**The report returns all parent directories of a given title which exist.\\n */\\nexports.report = function(title, callback, options) {\\n\\tvar index = -1;\\n\\twhile ((index = title.indexOf('/', index+1)) >= 0) {\\n\\t\\tvar dir = title.substr(0, index);\\n\\t\\tcallback(dir, '.' + title.substr(index), {soft: true});\\n\\t}\\n};\\n\\n/**The relink returns the new title (if any) derived from title for a given\\n * rename of fromTitle to toTitle.\\n */\\nexports.relink = function(title, fromTitle, toTitle, options) {\\n\\tvar length = fromTitle.length;\\n\\tif (title.charAt(length) === '/' && title.substr(0, length) === fromTitle) {\\n\\t\\treturn {output: toTitle + title.substr(length)};\\n\\t}\\n\\treturn undefined;\\n};\\n\",\n            \"caption\": \"{{$:/plugins/flibbles/relink-titles/language/Directory/Caption}}\",\n            \"description\": \"{{$:/plugins/flibbles/relink-titles/language/Directory/Description}}\",\n            \"module-type\": \"relinktitlesrule\",\n            \"type\": \"application/javascript\"\n        },\n        \"$:/plugins/flibbles/relink-titles/language/Lookup/Description\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/language/Lookup/Description\",\n            \"text\": \"This option updates all configuration tiddlers which relate to target tiddlers either through fixed prefixes or suffixes, i.e. `$:/config/Buttons/Visibility/fromFile` becomes `$:/config/Buttons/Visibility/toFile` when \\\"fromFile\\\" is renamed.\\n\\nEach line corresponds to a pattern, where `$(currentTiddler)$` would be the name of the tiddler being renamed, and `$(*)$` matches with anything.\\n\\n<$edit-text\\n\\ttiddler=\\\"$:/config/flibbles/relink-titles/lookup/patterns\\\"\\n\\ttag=\\\"textarea\\\"\\n/>\\n\"\n        },\n        \"$:/config/flibbles/relink-titles/lookup/patterns\": {\n            \"title\": \"$:/config/flibbles/relink-titles/lookup/patterns\",\n            \"text\": \"$:/config/$(*)$/Visibility/$(currentTiddler)$\\n\"\n        },\n        \"$:/plugins/flibbles/relink-titles/rules/lookup\": {\n            \"title\": \"$:/plugins/flibbles/relink-titles/rules/lookup\",\n            \"text\": \"/*\\\\\\ncaption: {{$:/plugins/flibbles/relink-titles/language/Lookup/Caption}}\\ndescription: {{$:/plugins/flibbles/relink-titles/language/Lookup/Description}}\\nmodule-type: relinktitlesrule\\ntitle: $:/plugins/flibbles/relink-titles/rules/lookup\\ntype: application/javascript\\n\\nHandles setting tiddlers which are derived from other tiddlers, like how\\n\\n```\\n$:/config/PageControlButtons/Visibility/$(currentTiddler)$\\n```\\n\\nset the visibility for $(currentTiddler)$\\n\\n\\\\*/\\n\\n\\\"use strict\\\";\\n\\nexports.name = 'lookup';\\n\\nvar patternTiddler = \\\"$:/config/flibbles/relink-titles/lookup/patterns\\\";\\nvar anyMatcher = /\\\\$\\\\((?:\\\\*|currentTiddler)\\\\)\\\\$/g;\\n\\nexports.report = function(targetTitle, callback, options) {\\n\\tvar patterns = getPatterns(options.wiki);\\n\\tfor (var i = 0; i < patterns.length; i++) {\\n\\t\\tvar pattern = patterns[i];\\n\\t\\tvar index = 0;\\n\\t\\tvar results = match(pattern, targetTitle);\\n\\t\\tif (results) {\\n\\t\\t\\tvar blurb = pattern.string.replace(anyMatcher, function(match) {\\n\\t\\t\\t\\tindex++;\\n\\t\\t\\t\\tif (match === \\\"$(*)$\\\") {\\n\\t\\t\\t\\t\\treturn results[index];\\n\\t\\t\\t\\t} else { // must be \\\"$(currentTiddler)$\\\"\\n\\t\\t\\t\\t\\treturn \\\"...\\\";\\n\\t\\t\\t\\t}\\n\\t\\t\\t});\\n\\t\\t\\tcallback(results.title, blurb);\\n\\t\\t}\\n\\t}\\n};\\n\\nexports.relink = function(targetTitle, fromTitle, toTitle, options) {\\n\\tvar patterns = getPatterns(options.wiki);\\n\\tfor (var i = 0; i < patterns.length; i++) {\\n\\t\\tvar pattern = patterns[i];\\n\\t\\tvar results = match(pattern, targetTitle, fromTitle);\\n\\t\\tif (results) {\\n\\t\\t\\tvar groupIndex = 0;\\n\\t\\t\\t// Make all the correct substitutions to create the new title\\n\\t\\t\\tvar output = pattern.string.replace(anyMatcher, function(match) {\\n\\t\\t\\t\\tgroupIndex++;\\n\\t\\t\\t\\tif (match === \\\"$(*)$\\\") {\\n\\t\\t\\t\\t\\treturn results[groupIndex];\\n\\t\\t\\t\\t} else { // must be \\\"$(currentTiddler)$\\\"\\n\\t\\t\\t\\t\\treturn toTitle;\\n\\t\\t\\t\\t}\\n\\t\\t\\t});\\n\\t\\t\\treturn {output: output};\\n\\t\\t}\\n\\t}\\n\\treturn undefined;\\n};\\n\\nfunction match(pattern, string, matchTitle) {\\n\\tvar results = pattern.matcher.exec(string);\\n\\tif (results) {\\n\\t\\t// It superficially matches, but we need to make sure all the right\\n\\t\\t// groups match too.\\n\\t\\tfor (var j = 0; j < pattern.groups.length; j++) {\\n\\t\\t\\tvar index = pattern.groups[j];\\n\\t\\t\\tif (matchTitle === undefined) {\\n\\t\\t\\t\\t// It doesn't matter what matchTitle is, as long as all\\n\\t\\t\\t\\t// groups match the same thing.\\n\\t\\t\\t\\tmatchTitle = results[index];\\n\\t\\t\\t} else if (results[index] !== matchTitle) {\\n\\t\\t\\t\\treturn null;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tresults.title = matchTitle;\\n\\t}\\n\\treturn results;\\n};\\n\\nfunction getPatterns(wiki) {\\n\\treturn wiki.getCacheForTiddler(patternTiddler, \\\"relink-titles\\\", function() {\\n\\t\\tvar text = wiki.getTiddlerText(patternTiddler);\\n\\t\\tvar matchers = []\\n\\t\\tif (text) {\\n\\t\\t\\tvar array = text.split('\\\\n');\\n\\t\\t\\tfor (var i = 0; i < array.length; i++) {\\n\\t\\t\\t\\tvar pattern = formPatternFromString(array[i]);\\n\\t\\t\\t\\tif (pattern) {\\n\\t\\t\\t\\t\\tmatchers.push(pattern);\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\treturn matchers;\\n\\t});\\n};\\n\\nfunction formPatternFromString(string) {\\n\\tvar groupIndex = 1;\\n\\tvar matchingGroups = [];\\n\\tstring = $tw.utils.trim(string);\\n\\tvar parts = string.split(\\\"$(currentTiddler)$\\\");\\n\\tif (parts.length <= 1) {\\n\\t\\t// $(currentTiddler)$ must not have been there\\n\\t\\treturn null;\\n\\t}\\n\\tfor (var j = 0; j < parts.length; j++) {\\n\\t\\t// Split it up by the wildcards\\n\\t\\tvar sections = parts[j].split(\\\"$(*)$\\\");\\n\\t\\tfor (var k = 0; k < sections.length; k++) {\\n\\t\\t\\tsections[k] = $tw.utils.escapeRegExp(sections[k]);\\n\\t\\t}\\n\\t\\tparts[j] = sections.join(\\\"(.*)\\\");\\n\\t\\t// If there are 3 sections, then there is 2 $(*)$, so the index\\n\\t\\t// must skip them. etc...\\n\\t\\tgroupIndex += sections.length-1;\\n\\t\\tif (j < parts.length-1) {\\n\\t\\t\\t// If there are 3 parts, that means 2 $(currentTiddler)$, and\\n\\t\\t\\t// so we skip the last part\\n\\t\\t\\tmatchingGroups.push(groupIndex);\\n\\t\\t\\tgroupIndex++;\\n\\t\\t}\\n\\t}\\n\\treturn {\\n\\t\\tstring: string,\\n\\t\\tgroups: matchingGroups,\\n\\t\\tmatcher: new RegExp(\\\"^\\\" + parts.join(\\\"(.*)\\\") + \\\"$\\\")\\n\\t};\\n};\\n\",\n            \"caption\": \"{{$:/plugins/flibbles/relink-titles/language/Lookup/Caption}}\",\n            \"description\": \"{{$:/plugins/flibbles/relink-titles/language/Lookup/Description}}\",\n            \"module-type\": \"relinktitlesrule\",\n            \"type\": \"application/javascript\"\n        }\n    }\n}"
  },
  {
    "title": "$:/plugins/sq/editor-autolist",
    "name": "Editor AutoList",
    "description": "Editor extension to automatically continue lists",
    "author": "Saq Imtiaz",
    "core-version": ">=5.2.0",
    "plugin-priority": "0",
    "list": "readme",
    "version": "0.1.14",
    "plugin-type": "plugin",
    "dependents": "",
    "type": "application/json",
    "text": "{\"tiddlers\":{\"$:/plugins/sq/editor-autolist/editor-operation-autolist.js\":{\"title\":\"$:/plugins/sq/editor-autolist/editor-operation-autolist.js\",\"text\":\"/*\\\\\\ntitle: $:/plugins/sq/editor-autolist/editor-operation-autolist.js\\ntype: application/javascript\\nmodule-type: texteditoroperation\\nText editor operation to automate syntax for lists\\n\\\\*/\\n(function(){\\n\\n\\nfunction getListLevelInfoForLine(state,index,lineContent) {\\n\\tif(index && !state.allLines[index]) {\\n\\t\\treturn null;\\n\\t}\\n\\tconst listPrefixRegex = /^((\\\\*|#)+)(.*)$/;\\n\\tconst match = (index!= null ? state.allLines[index] : lineContent).match(listPrefixRegex);\\n\\treturn match && match[1] ? {listPrefix: match[1], level: match[1].length, listType: match[2], content: match[3]} : null;\\n}\\n\\nexports[\\\"autolist\\\"] = function(event,operation) {\\n\\t\\n\\tlet state = Object.create(null),\\n\\t\\tmode = event.paramObject? event.paramObject.mode : undefined,\\n\\t\\tlistPrefixRegex = /^(?:(?:\\\\*|#)+).*/\\n\\t\\n\\tif(mode === \\\"newline\\\") {\\n\\t\\tlet firstLineStart = $tw.utils.findPrecedingLineBreak(operation.text,operation.selStart),\\n\\t\\t\\tfirstLineEnd = $tw.utils.findFollowingLineBreak(operation.text,operation.selStart),\\n\\t\\t\\tfirstLine = operation.text.substring(firstLineStart,firstLineEnd),\\n\\t\\t\\temptyListItemRegex = /^((\\\\*|#)+)$/;\\n\\n\\t\\tif(listPrefixRegex.test(firstLine)) {\\n\\t\\t\\t// we are on a list line\\n\\t\\t\\tif(emptyListItemRegex.test(firstLine.trimEnd())){\\n\\t\\t\\t\\t// we have an empty list line with no content so terminate the list\\n\\t\\t\\t\\toperation.replacement = \\\"\\\\n\\\";\\n\\t\\t\\t\\toperation.cutStart = firstLineStart;\\n\\t\\t\\t\\toperation.cutEnd = operation.selEnd;\\n\\t\\t\\t\\toperation.newSelStart = firstLineStart + 1;\\n\\t\\t\\t\\toperation.newSelEnd = operation.newSelStart;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\t//list line with content, continue list on next line\\n\\t\\t\\t\\tlet listItemInfo = getListLevelInfoForLine(state,null,firstLine);\\n\\t\\t\\t\\tif(operation.selStart === firstLineStart && operation.selStart === operation.selEnd) {\\n\\t\\t\\t\\t\\t//cursor is at the beginning of the line, add a new list item before this one at the same level and prefix\\n\\t\\t\\t\\t\\toperation.replacement = `${listItemInfo.listPrefix} \\\\n`;\\n\\t\\t\\t\\t\\toperation.newSelStart = operation.selStart = operation.selStart + listItemInfo.listPrefix.length + 1;\\n\\t\\t\\t\\t\\toperation.newSelEnd = operation.newSelStart;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\toperation.replacement = `\\\\n${listItemInfo.listPrefix} `;\\n\\t\\t\\t\\t\\toperation.newSelStart = operation.selStart + listItemInfo.listPrefix.length + 2;\\n\\t\\t\\t\\t\\toperation.newSelEnd = operation.newSelStart;\\t\\t\\t\\t\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\toperation.cutStart = operation.selStart;\\n\\t\\t\\t\\toperation.cutEnd = operation.selEnd;\\n\\t\\t\\t\\t// check for trailing whitespace after selEnd that we want to remove\\n\\t\\t\\t\\tif(!operation.text.substring(operation.selEnd,firstLineEnd).trim().length) {\\n\\t\\t\\t\\t\\toperation.cutEnd = firstLineEnd;\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t}\\n\\t\\t} else {\\n\\t\\t\\t// selection does not start on a list line, so we need to manually add a linebreak for lines not starting with list markup\\n\\t\\t\\toperation.replacement = \\\"\\\\n\\\";\\n\\t\\t\\toperation.cutStart = operation.selStart;\\n\\t\\t\\toperation.cutEnd = operation.selEnd;\\n\\t\\t\\toperation.newSelStart = operation.selStart + 1;\\n\\t\\t\\toperation.newSelEnd = operation.newSelStart;\\n\\t\\t}\\n\\t} else if(mode === \\\"indent\\\" || mode === \\\"unindent\\\") {\\n\\t\\tlet selModifier;\\n\\t\\tstate.startSelectedLines = $tw.utils.findPrecedingLineBreak(operation.text,operation.selStart);\\n\\t\\t// if there is a selection move the marker back by one to make sure we don't include a trailing line break\\n\\t\\tlet endMarker = (operation.selStart !== operation.selEnd) ? operation.selEnd - 1 : operation.selEnd;\\n\\t\\tstate.endSelectedLines = $tw.utils.findFollowingLineBreak(operation.text,endMarker);\\n\\t\\tstate.selectedText = operation.text.substring(state.startSelectedLines,state.endSelectedLines);\\t\\t\\n\\t\\tstate.selectedLines = state.selectedText.split(\\\"\\\\n\\\");\\n\\t\\tstate.selectedLinesCount = state.selectedLines.length;\\n\\t\\tstate.allLines = operation.text.split(\\\"\\\\n\\\");\\n\\t\\tstate.allLinesCount = state.allLines.length;\\n\\t\\tstate.prefixText = operation.text.substring(0,state.startSelectedLines-1);\\n\\t\\tstate.suffixText = operation.text.substring(state.endSelectedLines+1);\\n\\t\\tstate.prefixLinesCount = state.prefixText.length ? state.prefixText.split(\\\"\\\\n\\\").length : 0;\\n\\t\\tstate.suffixLinesCount = state.suffixText.length ? state.suffixText.split(\\\"\\\\n\\\").length : 0;\\n\\t\\tstate.selectedLinesInfo = state.selectedLines.map((line,index,selLines) => {\\n\\t\\t\\treturn getListLevelInfoForLine(state,index + state.prefixLinesCount);\\n\\t\\t});\\n\\t\\t//non list items will have null value for info in selectedLinesInfo\\n\\t\\tstate.modifiedLines = Array(state.selectedLines.length).fill(\\\"\\\");\\n\\t\\tif(mode === \\\"indent\\\"){\\n\\t\\t\\tlet prevListItemInfo,\\n\\t\\t\\t\\tlistItemInfo,\\n\\t\\t\\t\\tprevNewListType;\\n\\t\\t\\tselModifier = 1;\\n\\t\\t\\tstate.selectedLines.forEach(function(element,index,array) {\\n\\t\\t\\t\\t/// exclude lines that dont start with a list prefix, they will have listItemInfo as null\\n\\t\\t\\t\\tlistItemInfo = listItemInfo || getListLevelInfoForLine(state,index + state.prefixLinesCount); // use from selectedLinesInfo XXX\\n\\t\\t\\t\\tif(!listItemInfo) {\\n\\t\\t\\t\\t\\t// not a list item so put the original text in modifiedLines\\n\\t\\t\\t\\t\\tstate.modifiedLines[index] = element;\\n\\t\\t\\t\\t\\treturn;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tlet\\tnewlistType,\\n\\t\\t\\t\\t\\tnextListItemInfo;\\n\\t\\t\\t\\t//better if we were changing the new levels and prefixes for selected lines somewhere and I could check against that\\n\\t\\t\\t\\tif(prevListItemInfo && prevListItemInfo.level === listItemInfo.level && prevListItemInfo.listPrefix === listItemInfo.listPrefix) {\\n\\t\\t\\t\\t\\tnewlistType = prevNewListType;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tprevListItemInfo = prevListItemInfo || getListLevelInfoForLine(state, index -1 + state.prefixLinesCount);\\n\\t\\t\\t\\t\\tif(prevListItemInfo && prevListItemInfo.level >= listItemInfo.level + 1) {\\n\\t\\t\\t\\t\\t\\tnewlistType = prevListItemInfo.listPrefix[listItemInfo.level];\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tnextListItemInfo = getListLevelInfoForLine(state,index + 1 + state.prefixLinesCount);\\n\\t\\t\\t\\t\\t\\tif(nextListItemInfo && nextListItemInfo.level >= listItemInfo.level + 1) {\\n\\t\\t\\t\\t\\t\\t\\tnewlistType = nextListItemInfo.listPrefix[listItemInfo.level];\\n\\t\\t\\t\\t\\t\\t} else if(nextListItemInfo) {\\n\\t\\t\\t\\t\\t\\t\\t// as long as there is a next list item in the SELECTION that is the same level and prefix, keep going further\\n\\t\\t\\t\\t\\t\\t\\tlet selIndex = index + 1,\\n\\t\\t\\t\\t\\t\\t\\t\\tnextInfo = state.selectedLinesInfo[selIndex];\\n\\t\\t\\t\\t\\t\\t\\twhile(nextInfo && nextInfo.level === listItemInfo.level && nextInfo.listType === listItemInfo.listType) {\\n\\t\\t\\t\\t\\t\\t\\t\\tselIndex++;\\n\\t\\t\\t\\t\\t\\t\\t\\tnextInfo = state.selectedLinesInfo[selIndex];\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t\\tnextInfo = getListLevelInfoForLine(state,selIndex + state.prefixLinesCount);\\n\\t\\t\\t\\t\\t\\t\\tif(nextInfo && nextInfo.level >= listItemInfo.level + 1) {\\n\\t\\t\\t\\t\\t\\t\\t\\tnewlistType = nextInfo.listPrefix[listItemInfo.level];\\n\\t\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t}\\t\\t\\t\\t\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif(!newlistType) {\\n\\t\\t\\t\\t\\tnewlistType = listItemInfo.listType;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tstate.modifiedLines[index] = `${listItemInfo.listPrefix}${newlistType}${listItemInfo.content}`;\\n\\t\\t\\t\\t//console.log(`${listItemInfo.content} => ${newlistType} | `,state.modifiedLines[index]);\\n\\t\\t\\t\\tprevListItemInfo = listItemInfo;\\n\\t\\t\\t\\tlistItemInfo = nextListItemInfo;\\n\\t\\t\\t\\tprevNewListType = newlistType;\\n\\t\\t\\t},this);\\t\\t\\t\\n\\t\\t} else if(mode === \\\"unindent\\\") {\\n\\t\\t\\tselModifier = -1;\\n\\t\\t\\tstate.selectedLines.forEach(function(element,index,array) {\\n\\t\\t\\t\\tlet listItemInfo = state.selectedLinesInfo[index];\\n\\t\\t\\t\\tif(listItemInfo) {\\n\\t\\t\\t\\t\\t//remove the last character of the listPrefix if its a list item\\n\\t\\t\\t\\t\\tstate.modifiedLines[index] = `${listItemInfo.listPrefix.slice(0,-1)}${listItemInfo.content}`;\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t// if its not a list item then use the original text\\n\\t\\t\\t\\t\\tstate.modifiedLines[index] = element;\\n\\t\\t\\t\\t}\\n\\t\\t\\t});\\n\\t\\t}\\n\\t\\tlet replacement = state.modifiedLines.join(\\\"\\\\n\\\");\\n\\t\\tif(replacement) {\\n\\t\\t\\toperation.replacement = state.modifiedLines.join(\\\"\\\\n\\\");\\n\\t\\t\\toperation.cutStart = state.startSelectedLines;\\n\\t\\t\\toperation.cutEnd = state.endSelectedLines;\\n\\t\\t\\tif(operation.selStart !== operation.selEnd) {\\n\\t\\t\\t\\toperation.newSelStart = state.startSelectedLines;\\n\\t\\t\\t\\toperation.newSelEnd = state.startSelectedLines + operation.replacement.length;\\n\\t\\t\\t} else {\\n\\t\\t\\t\\t// we did not have a selection to start so just modify the selection start and end to accomodate the change in indentation\\n\\t\\t\\t\\toperation.newSelEnd = operation.selEnd + selModifier;\\n\\t\\t\\t\\toperation.newSelStart = operation.newSelEnd;\\n\\t\\t\\t}\\n\\t\\t}\\n\\t} \\n};\\n\\n})();\\n\",\"type\":\"application/javascript\",\"module-type\":\"texteditoroperation\"},\"$:/plugins/sq/editor-autolist/icon\":{\"title\":\"$:/plugins/sq/editor-autolist/icon\",\"text\":\"<svg viewBox=\\\"31.626 273.967 117.45 122.86\\\" height=\\\"22pt\\\" width=\\\"22pt\\\">\\n<path d=\\\"M39.846 273.967h101.02a8.2 8.2 0 0 1 5.81 2.4 8.2 8.2 0 0 1 2.4 5.81v106.44a8.2 8.2 0 0 1-2.4 5.81 8.2 8.2 0 0 1-5.81 2.4H39.846a8.2 8.2 0 0 1-5.81-2.4 8.109 8.109 0 0 1-2.41-5.8v-106.44c0-2.27.92-4.34 2.4-5.82a8.224 8.224 0 0 1 5.82-2.4Zm101.02 7.08H39.846c-.32 0-.61.13-.82.34-.21.21-.34.5-.34.82v106.44c0 .32.13.61.34.82.21.21.5.34.82.34h101.02c.32 0 .61-.13.82-.34.21-.21.34-.5.34-.82v-106.44c0-.32-.13-.61-.34-.82-.22-.21-.51-.34-.82-.34Z\\\"/>\\n<path d=\\\"m107.502 333.58 3.045 14.498 14.495 3.168-12.87 7.372 1.458 14.74-11-9.942-13.59 5.944 6.073-13.518-9.864-11.068 14.755 1.588 7.498-12.783Zm8.267 36.294 12.588 12.783a.789.789 0 0 0 1.11.005l4.891-4.84a.786.786 0 0 0 .005-1.109l-17.206-17.416c-.302-.307-1.1-.434-1.11-.005l-.278 10.582ZM67.605 301.084c-3.678-.637-5.255-4.833-2.837-7.555a4.91 4.91 0 0 1 2.837-1.56h53.098c3.675.636 5.249 4.832 2.834 7.553a4.902 4.902 0 0 1-2.834 1.562H67.605ZM53.025 291.364c3.973 0 6.457 4.05 4.47 7.29-1.986 3.241-6.954 3.241-8.94 0a4.642 4.642 0 0 1-.692-2.43c0-2.684 2.311-4.86 5.162-4.86ZM67.605 317.255c-3.678-.638-5.255-4.834-2.837-7.556a4.91 4.91 0 0 1 2.837-1.56h53.098c3.675.636 5.249 4.832 2.834 7.553a4.909 4.909 0 0 1-2.834 1.563H67.605ZM53.025 307.534c3.973 0 6.457 4.05 4.47 7.29-1.986 3.241-6.954 3.241-8.94 0a4.642 4.642 0 0 1-.692-2.43c0-2.684 2.311-4.86 5.162-4.86ZM66.214 333.579c-2.434-.638-3.477-4.834-1.877-7.555.48-.818 1.145-1.371 1.877-1.561h35.141c2.432.636 3.474 4.833 1.876 7.553-.48.818-1.144 1.371-1.876 1.563H66.214ZM52.985 323.858c3.973 0 6.457 4.05 4.469 7.291-1.985 3.24-6.953 3.24-8.939 0a4.645 4.645 0 0 1-.692-2.43c0-2.684 2.311-4.861 5.162-4.861Z\\\"/>\\n</svg>\"},\"$:/plugins/sq/editor-autolist/indent.svg\":{\"title\":\"$:/plugins/sq/editor-autolist/indent.svg\",\"text\":\"<svg height=\\\"22pt\\\" width=\\\"22pt\\\" viewBox=\\\"0 0 122.88 95.07\\\"><path d=\\\"M46.06 26.43h76.82v15.8H46.06v-15.8Zm76.82 52.85H.01L0 95.07h122.88V79.28Zm0-26.43H46.54v15.8h76.34v-15.8Zm0-52.85H.02v15.8h122.87L122.88 0Z\\\"/><path d=\\\"m7.497 47.851 23.24-22.35v44.7l-23.24-22.35Z\\\" transform=\\\"rotate(180 19.117 47.851)\\\"/></svg>\"},\"$:/plugins/sq/editor-autolist/EditorToolbar/autolist-indent\":{\"title\":\"$:/plugins/sq/editor-autolist/EditorToolbar/autolist-indent\",\"condition\":\"[<targetTiddler>!has[type]] [<targetTiddler>type[text/vnd.tiddlywiki]]\",\"icon\":\"$:/plugins/sq/editor-autolist/indent.svg\",\"shortcuts\":\"((autolist-indent))\",\"tags\":\"$:/tags/EditorToolbar\",\"list-after\":\"$:/core/ui/EditorToolbar/list-number\",\"caption\":\"Indent list items\",\"description\":\"Indent list items\",\"text\":\"<$action-sendmessage\\n\\t$message=\\\"tm-edit-text-operation\\\"\\n\\t$param=\\\"autolist\\\"\\n\\tmode=\\\"indent\\\"\\n/>\\n\"},\"$:/plugins/sq/editor-autolist/EditorToolbar/autolist-newline\":{\"title\":\"$:/plugins/sq/editor-autolist/EditorToolbar/autolist-newline\",\"button-classes\":\"sq-text-editor-btn-hidden\",\"condition\":\"[<targetTiddler>!has[type]] [<targetTiddler>type[text/vnd.tiddlywiki]]\",\"icon\":\"$:/core/images/list-bullet\",\"shortcuts\":\"((autolist-newline))\",\"tags\":\"$:/tags/EditorToolbar\",\"text\":\"<$action-sendmessage\\n\\t$message=\\\"tm-edit-text-operation\\\"\\n\\t$param=\\\"autolist\\\"\\n\\tmode=\\\"newline\\\"\\n/>\\n\"},\"$:/plugins/sq/editor-autolist/EditorToolbar/autolist-unindent\":{\"title\":\"$:/plugins/sq/editor-autolist/EditorToolbar/autolist-unindent\",\"condition\":\"[<targetTiddler>!has[type]] [<targetTiddler>type[text/vnd.tiddlywiki]]\",\"icon\":\"$:/plugins/sq/editor-autolist/unindent.svg\",\"shortcuts\":\"((autolist-unindent))\",\"tags\":\"$:/tags/EditorToolbar\",\"list-after\":\"$:/core/ui/EditorToolbar/list-number\",\"caption\":\"Unindent list items\",\"description\":\"Unindent list items\",\"text\":\"<$action-sendmessage\\n\\t$message=\\\"tm-edit-text-operation\\\"\\n\\t$param=\\\"autolist\\\"\\n\\tmode=\\\"unindent\\\"\\n/>\\n\"},\"$:/plugins/sq/editor-autolist/readme\":{\"title\":\"$:/plugins/sq/editor-autolist/readme\",\"text\":\"@@color:red;''Experimental plugin - no support available. Use at your own risk.''@@\\n\\nAutomatically continue lists when creating new lines. Indent and unindent line(s) with list markup.\\n\\n!!Known limitations:\\n* no support for mixing block quotes with numbered and unordered lists.\\n* no support for classname syntax in list markup, e.g.: `*.myclass hello there`\\n* treats list items separated by empty lines are separate lists\"},\"$:/config/ShortcutInfo/autolist-indent\":{\"title\":\"$:/config/ShortcutInfo/autolist-indent\",\"text\":\"Indent a line in a list\"},\"$:/config/ShortcutInfo/autolist-newline\":{\"title\":\"$:/config/ShortcutInfo/autolist-newline\",\"text\":\"Add a newline and list markup if in a list\"},\"$:/config/ShortcutInfo/autolist-unindent\":{\"title\":\"$:/config/ShortcutInfo/autolist-unindent\",\"text\":\"Unindent a line in a list\"},\"$:/config/shortcuts/autolist-indent\":{\"title\":\"$:/config/shortcuts/autolist-indent\",\"text\":\"Tab\"},\"$:/config/shortcuts/autolist-newline\":{\"title\":\"$:/config/shortcuts/autolist-newline\",\"text\":\"Enter\"},\"$:/config/shortcuts/autolist-unindent\":{\"title\":\"$:/config/shortcuts/autolist-unindent\",\"text\":\"shift-Tab\"},\"$:/plugins/sq/editor-autolist/styles\":{\"title\":\"$:/plugins/sq/editor-autolist/styles\",\"tags\":\"$:/tags/Stylesheet\",\"text\":\".sq-text-editor-btn-hidden {\\n\\tdisplay: none;\\n}\"},\"$:/plugins/sq/editor-autolist/unindent.svg\":{\"title\":\"$:/plugins/sq/editor-autolist/unindent.svg\",\"text\":\"<svg height=\\\"22pt\\\" width=\\\"22pt\\\" viewBox=\\\"0 0 122.88 95.07\\\"><path d=\\\"M46.06 26.43h76.82v15.8H46.06v-15.8zM7.47 48.01l23.24 22.35v-44.7L7.47 48.01zm115.41 31.27H.01L0 95.07h122.88V79.28zm0-26.43H46.54v15.8h76.34v-15.8zm0-52.85H.02v15.8h122.87L122.88 0z\\\" /></svg>\"}}}",
    "revision": "0",
    "bag": "default"
  },
  {
    "title": "$:/plugins/sq/streams",
    "name": "Streams",
    "description": "Rapid data entry with a keyboard driven workflow. Divide content into smaller tiddlers as you write.",
    "plugin-type": "plugin",
    "plugin-priority": "1",
    "author": "Saq Imtiaz",
    "version": "1.2.24",
    "core-version": ">=5.1.23",
    "list": "Settings CHANGELOG",
    "source": "https://saqimtiaz.github.io/streams/",
    "dependents": "$:/plugins/flibbles/relink",
    "type": "application/json",
    "text": "{\n    \"tiddlers\": {\n        \"$:/plugins/sq/streams/CHANGELOG\": {\n            \"title\": \"$:/plugins/sq/streams/CHANGELOG\",\n            \"text\": \"Release notes for the current release:\\n\\n{{$:/plugins/sq/streams/releasenotes}}\\n\\n[[Full changelog|https://saqimtiaz.github.io/streams/#CHANGELOG]] for Streams\\n\"\n        },\n        \"$:/plugins/sq/streams/Settings/config\": {\n            \"title\": \"$:/plugins/sq/streams/Settings/config\",\n            \"caption\": \"Configuration\",\n            \"text\": \"\\\\define sortBySettingsGroupFilter()\\n[get[settings-group]!is[blank]else[!general]] [get[settings-group-header]!is[blank]else[99]] +[join[]]\\n\\\\end\\n\\n<$edit-text tiddler=\\\"$:/state/sq/streams/settings/search\\\" class=\\\"sq-search-input\\\" default=\\\"\\\" tag=\\\"input\\\" type=\\\"search\\\" placeholder=\\\"search...\\\"/>\\n\\n<div class=\\\"sq-list-group sq-list-group-box-shadow sq-list-stream-settings\\\">\\n<$list filter=\\\"[all[shadows+tiddlers]prefix[$:/config/sq/streams]has[settings-template]]  +[search:title,caption,description{$:/state/sq/streams/settings/search}] +[sortsub<sortBySettingsGroupFilter>]\\\">\\n<$list filter={{{[{!!condition}!is[blank]] :else[{!!title}]}}} variable=\\\"list-condition\\\">\\n<div class=\\\"sq-list-group-item\\\">\\n<$transclude tiddler={{!!settings-template}}/>\\n</div>\\n</$list>\\n</$list>\\n</div>\"\n        },\n        \"$:/plugins/sq/streams/Settings/shortcuts\": {\n            \"title\": \"$:/plugins/sq/streams/Settings/shortcuts\",\n            \"caption\": \"Shortcuts\",\n            \"text\": \"\\\\import $:/core/ui/ControlPanel/KeyboardShortcuts\\n\\n<table>\\n<tbody>\\n<$list filter=\\\"[all[shadows+tiddlers]prefix[$:/config/ShortcutInfo/streams-]removeprefix[$:/config/ShortcutInfo/]]\\\" variable=\\\"shortcutName\\\">\\n<<shortcut-item>>\\n</$list>\\n</tbody>\\n</table>\"\n        },\n        \"$:/plugins/sq/streams/Settings\": {\n            \"title\": \"$:/plugins/sq/streams/Settings\",\n            \"tags\": \"$:/tags/ControlPanel\",\n            \"caption\": \"Streams settings\",\n            \"text\": \"<<tabs \\\"$:/plugins/sq/streams/Settings/config $:/plugins/sq/streams/Settings/shortcuts\\\" \\\"$:/plugins/sq/streams/Settings/config\\\" \\\"$:/state/streams/settings/tabs\\\">>\\n\"\n        },\n        \"$:/plugins/sq/streams/action-macros\": {\n            \"title\": \"$:/plugins/sq/streams/action-macros\",\n            \"text\": \"\\\\whitespace trim\\n\\n\\\\define swiped-right-actions()\\n<$list filter=\\\"[{$:/config/sq/streams/swipe-behaviour}match[contextmenu]]\\\" variable=\\\"_NULL\\\">\\n<$action-setfield $tiddler=<<contextmenu-state>> $field=\\\"current\\\" $value=<<dom-data-node-title>>/>\\n<$action-setfield $tiddler=<<contextmenu-state>> $field=\\\"position\\\" $value={{$:/config/sq/streams/swipe-contextmenu-position}}/>\\n<$action-popup $coords=<<tv-popup-coords>> $state=<<contextmenu-state>>/>\\n</$list>\\n<$list filter=\\\"[{$:/config/sq/streams/swipe-behaviour}match[indent]]\\\" variable=\\\"_NULL\\\">\\n<$vars currentTiddler=<<dom-data-node-title>>>\\n<<indent-node-actions>>\\n</$vars>\\n</$list>\\n\\\\end\\n\\n\\\\define swiped-left-actions()\\n<$list filter=\\\"[{$:/config/sq/streams/swipe-behaviour}match[indent]]\\\" variable=\\\"_NULL\\\">\\n<$vars currentTiddler=<<dom-data-node-title>>>\\n<<unindent-node-actions>>\\n</$vars>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define oncontext-menu-actions()\\n<$action-setfield $tiddler=<<contextmenu-state>> $field=\\\"current\\\" $value=<<dom-data-node-title>>/>\\n<$action-setfield $tiddler=<<contextmenu-state>> $field=\\\"position\\\" $value=\\\"left\\\"/>\\n<$action-popup $coords=<<tv-popup-coords>> $state=<<contextmenu-state>>/>\\n\\\\end\\n\\n\\n\\\\define node-ctrl-btn-actions()\\n<$list filter=\\\"[<dom-data-btn-role>match[stream-node-visibility]]\\\" variable=\\\"NULL\\\">\\n<$action-setfield $tiddler=<<dom-data-rowchildren-visibility-state>> text={{{ [<dom-data-rowchildren-visibility-state>get[text]match[hide]then[show]else[hide]] }}} />\\n</$list>\\n<$list filter=\\\"[<dom-data-btn-role>match[stream-node-decorator]]\\\" variable=\\\"NULL\\\">\\n<$action-navigate $to=<<dom-data-node-title>>/>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define toggle-row-edit-state()\\n<$action-unselect/>\\n<$list filter=\\\"[<row-edit-state>get[text]else[]!match<dom-data-node-title>]\\\" variable=\\\"NULL\\\">\\n<$list filter=\\\"[[$:/status/IsReadOnly]get[text]!is[blank]else[no]!match[yes]]\\\" variable=\\\"NULL\\\">\\n\\t<$action-setfield $tiddler=<<row-edit-state>> text=<<dom-data-node-title>> />\\n<!--\\t<$action-setfield $tiddler=<<dom-data-node-title>> throttle.refresh=\\\"yes\\\"/>-->\\n</$list>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define save-edit-node-actions()\\n<!-- handle saving a node being edited -->\\n<!-- XXX draft -->\\n<!--<$action-deletefield $tiddler={{{ [<dom-data-node-title>!is[blank]else<currentTiddler>] }}} $field=\\\"throttle.refresh\\\" />-->\\n<$action-deletetiddler $tiddler=<<row-edit-state>> />\\n\\\\end\\n\\n\\n\\\\define indent-node-actions()\\n<!-- handle indenting a node -->\\n<$vars previous-node={{{ [{!!parent}get[stream-list]enlist-input[]is[tiddler]before<currentTiddler>] }}}>\\n<$list filter=\\\"[<previous-node>minlength[1]]\\\" variable=\\\"_NULL\\\">\\n\\t<$action-listops $tiddler=<<previous-node>> $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] [<currentTiddler>]\\\"/>\\n\\t<$action-listops $tiddler={{!!parent}} $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] -[<currentTiddler>]\\\"/>\\n\\t<$action-setfield $tiddler=<<currentTiddler>> parent=<<previous-node>> />\\n</$list>\\n</$vars>\\n\\\\end\\n\\n\\n\\\\define unindent-node-actions()\\n<!-- handle unindenting a node -->\\n<$vars new-parent={{{ [{!!parent}get[parent]] }}} new-next-node={{{ [{!!parent}get[parent]get[stream-list]enlist-input[]is[tiddler]after{!!parent}] }}}>\\n    <$list filter=\\\"[<new-parent>minlength[1]]\\\" variable=\\\"_NULL\\\">\\n        <$action-listops $tiddler=<<new-parent>> $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] +[insertbefore:new-next-node<currentTiddler>]\\\"/>\\n        <$action-listops $tiddler={{!!parent}} $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] -[<currentTiddler>]\\\"/>\\n        <$action-setfield $tiddler=<<currentTiddler>> parent=<<new-parent>> />\\n    </$list>\\n</$vars>\\n\\\\end\\n\\n\\n\\\\define demote-node-actions()\\n<!-- move a node below the next node -->\\n<$list filter=\\\"[{!!parent}get[stream-list]enlist-input[]after<currentTiddler>]\\\" variable=\\\"next-node\\\">\\n    <$action-listops $tiddler={{!!parent}} $field=\\\"stream-list\\\" $subfilter=\\\"+[insertbefore:currentTiddler<next-node>]\\\"/>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define promote-node-actions()\\n<!-- move a node above the previous node -->\\n<$list filter=\\\"[{!!parent}get[stream-list]enlist-input[]before<currentTiddler>]\\\" variable=\\\"previous-node\\\">\\n    <$action-listops $tiddler={{!!parent}} $field=\\\"stream-list\\\" $subfilter=\\\"+[insertbefore:previous-node<currentTiddler>]\\\"/>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define save-node-actions()\\n<$list filter=\\\"\\\"\\\"[{$:/config/sq/streams/split-at-caret}match[yes]]\\\"\\\"\\\" variable=\\\"_NULL\\\" emptyMessage=<<add-node-actions>> >\\n<$list filter=\\\"[<selectionEnd>!is[blank]else[0]!match[0]]\\\" variable=\\\"_NULL\\\">\\n<$list filter=\\\"[<currentTiddler>get[text]length[]subtract<selectionEnd>!match[0]]\\\" variable=\\\"_NULL\\\" emptyMessage=<<add-node-actions>>>\\n\\t<$macrocall $name=\\\"add-node-actions\\\" startText={{{[<currentTiddler>get[text]split[]rest<selectionEnd>join[]trim[]]}}} streamList={{!!stream-list}} /><!--insertPosition=\\\"title\\\"-->\\n\\t<$action-setfield $tiddler=\\\"$:/state/sq/streams/caret-position\\\" text=\\\"0\\\"/>\\n\\t<$action-setfield $tiddler=<<currentTiddler>> text={{{[<currentTiddler>get[text]split[]first<selectionEnd>join[]]}}} stream-list=\\\"\\\"/>\\n</$list>\\n</$list>\\n<$list filter=\\\"[<selectionEnd>!is[blank]else[0]match[0]]\\\" variable=\\\"_NULL\\\">\\n\\t<$list filter=\\\"[<currentTiddler>!has[text]]\\\" variable=\\\"_NULL\\\" emptyMessage=<<add-node-actions \\\"\\\" \\\"title\\\">> >\\n\\t\\t<$list filter=\\\"\\\"\\\"[{$:/config/sq/streams/exit-on-saving-empty-node}match[yes]]\\\"\\\"\\\" variable=\\\"_NULL\\\" emptyMessage=<<add-node-actions>> >\\n\\t\\t\\t<<cancel-edit-node-actions>>\\n\\t\\t</$list>\\n\\t</$list>\\n</$list>\\n</$list>\\n\\\\end\\n\\n\\\\define add-new-node-actions()\\n<!-- used by new node button at the bottom of a stream -->\\n<$list filter=\\\"[[$:/status/IsReadOnly]get[text]!is[blank]else[no]!match[yes]]\\\" variable=\\\"NULL\\\">\\n<<add-node-actions>>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define add-node-actions(startText:\\\"\\\",insertPosition:\\\"after\\\",streamList:\\\"\\\")\\n<!-- handle saving a node edit and creating a new subsequent node -->\\n<$set name=\\\"parent\\\" filter=\\\"[<currentTiddler>match<stream-root-title>] ~[{!!parent}] +[first[]]\\\" select=\\\"0\\\">\\n<$wikify name=\\\"new-node\\\" text={{$:/config/sq/streams/new-node-title}}>\\n<$wikify name=\\\"new-node\\\" text={{{[[<<unusedtitle \\\"\\\"\\\"]addsuffix<new-node>addsuffix[\\\"\\\"\\\">>]]}}}>\\n\\t<$action-createtiddler $basetitle=<<new-node>> text=<<__startText__>> $template={{$:/config/sq/streams/new-node-tiddler-template}} parent=<<parent>> stream-type=\\\"default\\\" stream-list=<<__streamList__>>/>\\n\\t<$set name=\\\"parent-nodes\\\" filter=\\\"[<parent>get[stream-list]]\\\" select=\\\"0\\\">\\n\\t<$set name=\\\"next-node\\\" filter=\\\"[enlist<parent-nodes>is[tiddler]$insertPosition$<currentTiddler>]\\\" select=\\\"0\\\">\\n\\t<$action-listops $tiddler=<<parent>> $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] +[insertbefore:next-node<new-node>]\\\"/>\\n\\t<$list filter=\\\"[<parent>!has[stream-type]]\\\" variable=\\\"_NULL\\\">\\n\\t\\t<$action-setfield $tiddler=<<parent>> stream-type=\\\"default\\\"/>\\n\\t</$list>\\n\\t<$list filter=\\\"[enlist<__streamList__>]\\\">\\n\\t\\t<$action-setfield $tiddler=<<currentTiddler>> parent=<<new-node>>/>\\n\\t</$list>\\n\\t</$set>\\n\\t</$set>\\n\\t<$action-setfield $tiddler=<<row-edit-state>> text=<<new-node>>/>\\n</$wikify>\\n</$wikify>\\n</$set>\\n\\\\end\\n\\n\\n\\\\define save-multiple-actions()\\n<!-- handle multiple nodes entered at once -->\\n<$action-confirm $message=\\\"Split into multiple nodes?\\\" $prompt={{$:/config/sq/streams/prompt-split-to-multiple}}>\\n<$list filter=\\\"[{!!text}splitregexp{$:/config/sq/streams/node-split-regexp}rest[]reverse[]]\\\" variable=\\\"fragment\\\">\\n\\t<$action-confirm $message=\\\"Split into multiple nodes?\\\" $prompt=\\\"no\\\">\\n\\t\\t<$macrocall $name=\\\"add-node-actions\\\" startText=<<fragment>> />\\n\\t</$action-confirm>\\n</$list>\\n<$action-setfield $tiddler=<<currentTiddler>> text={{{[{!!text}splitregexp{$:/config/sq/streams/node-split-regexp}first[]]}}}/>\\n<<add-node-actions>>\\n</$action-confirm>\\n\\\\end\\n\\n\\n\\\\define cancel-edit-node-actions()\\n<!-- handle cancelling the edit on an empty node -->\\n<$list filter=\\\"[<currentTiddler>!has[stream-list]!has[text]]\\\" variable=\\\"_NULL\\\">\\n\\t<$action-listops $tiddler={{{[{!!parent}]}}} $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] -[<currentTiddler>]\\\"/>\\n\\t<$action-deletetiddler $tiddler=<<currentTiddler>> />\\n</$list>\\n<!--<$action-deletefield $tiddler=<<currentTiddler>> $field=\\\"throttle.refresh\\\" />-->\\n<$action-deletetiddler $tiddler=<<row-edit-state>> />\\n\\\\end\\n\\n\\n\\\\define merge-with-previous-node-actions()\\n<!-- handle backspace on an empty node -->\\n<$list filter=\\\"\\\"\\\"[<currentTiddler>!has[text]]\\\"\\\"\\\" variable=\\\"_NULL\\\">\\n\\t<<cancel-edit-node-actions>>\\n\\t<<focus-higher-node-actions>>\\n</$list>\\n\\n<$list filter=\\\"\\\"\\\"[<currentTiddler>has[text]]\\\"\\\"\\\" variable=\\\"_NULL\\\">\\n<$list filter=\\\"[<selectionEnd>match[0]]\\\" variable=\\\"_NULL\\\">\\n\\n<!--<$action-log/>-->\\n\\t<$set name=\\\"parent\\\" value={{!!parent}} select=\\\"0\\\">\\n\\t<$set name=\\\"stream-list\\\" filter=\\\"[<parent>get[stream-list]]\\\" select=\\\"0\\\">\\n\\t<$list filter=\\\"[enlist<stream-list>before<currentTiddler>]\\\" variable=\\\"previous-node\\\">\\n\\t\\t<$list filter=\\\"[<previous-node>!has[stream-list]]\\\" variable=\\\"_NULL\\\">\\n\\t\\t<$action-confirm $message=\\\"Merge with previous node?\\\" $prompt={{$:/config/sq/streams/prompt-merge-with-previous}}>\\n\\t\\t\\t<$action-setfield $tiddler=\\\"$:/state/sq/streams/caret-position\\\" text={{{[<previous-node>get[text]length[]]}}}/>\\n\\t\\t\\t<$action-setfield $tiddler=<<previous-node>> text={{{[<previous-node>get[text]!is[blank]else[]addsuffix{!!text}]}}} stream-list={{!!stream-list}}/>\\n\\t\\t\\t<$action-setfield $tiddler=<<row-edit-state>> text=<<previous-node>>/>\\n\\t\\t\\t<$action-listops $tiddler={{!!parent}} $field=\\\"stream-list\\\" $subfilter=\\\"+[is[tiddler]] -[<currentTiddler>]\\\"/>\\t\\t\\t\\n\\t\\t\\t<$action-deletetiddler $tiddler=<<currentTiddler>>/>\\n\\t\\t</$action-confirm>\\t\\n\\t\\t</$list>\\n\\t</$list>\\n\\t</$set>\\n\\t</$set>\\n\\t\\n</$list>\\n</$list>\\n\\n\\\\end\\n\\n\\n\\\\define delete-node-actions()\\n<$action-confirm  $message=\\\"Do you wish to delete this tiddler?\\\">\\n\\t<$transclude tiddler=\\\"$:/plugins/sq/streams/delete-hook/actions\\\"/>\\n\\t<$action-deletetiddler $tiddler=<<currentTiddler>> />\\n\\t<$list filter=\\\"[<row-edit-state>get[text]match<currentTiddler>]\\\">\\n\\t\\t<<focus-higher-node-actions>>\\n\\t</$list>\\n</$action-confirm>\\n\\\\end\\n\\n\\n\\\\define rename-node-actions()\\n<$action-withinput message=\\\"Rename this tiddler?\\\" default=<<currentTiddler>> actions=\\\"\\\"\\\"\\n\\t<$action-sendmessage $message=\\\"tm-rename-tiddler\\\" from=<<currentTiddler>> to=<<userInput>>/>\\n\\t<$list filter=\\\"[<row-edit-state>match<currentTiddler>]\\\" variable=\\\"_NULL\\\">\\n\\t\\t<$action-setfield $tiddler=<<row-edit-state>> text=<<userInput>>/>\\n\\t</$list>\\n\\\"\\\"\\\"/>\\n\\\\end\\n\\n\\n\\\\define find-last-child()\\n<!-- used by focus-higher-node-actions macro -->\\n<$list filter=\\\"[enlist{!!stream-list}is[tiddler]last[]]\\\" emptyMessage=\\\"\\\"\\\"<$action-setfield $tiddler=<<row-edit-state>> text=<<currentTiddler>>/>\\\"\\\"\\\">\\n\\t<$macrocall $name=\\\"find-last-child\\\"/>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define focus-higher-node-actions()\\n<!-- handles moving up in the nodes with the keyboard -->\\n<$vars old-parent={{!!parent}} >\\n<$list filter=\\\"[{!!parent}get[stream-list]enlist-input[]is[tiddler]before<currentTiddler>]\\\" emptyMessage=\\\"\\\"\\\"<$list filter=\\\"[<old-parent>!match<stream-root-title>]\\\"><$action-setfield $tiddler=<<row-edit-state>> text=<<old-parent>> /></$list>\\\"\\\"\\\">\\n\\t<$macrocall $name=\\\"find-last-child\\\"/>\\n</$list>\\n</$vars>\\n\\\\end\\n\\n\\n\\\\define find-next-downwards-node()\\n<!-- used by focus-lower-node-actions macro -->\\n<$list filter=\\\"[<currentTiddler>has[parent]]\\\" variable=\\\"_NULL\\\">\\n<$set name=\\\"old-parent\\\" value={{!!parent}} select=\\\"0\\\">\\n<$set name=\\\"old-parent-nodes\\\" filter=\\\"[<old-parent>get[stream-list]]\\\" select=\\\"0\\\">\\n<$list filter=\\\"[enlist<old-parent-nodes>is[tiddler]after<currentTiddler>]\\\" emptyMessage=\\\"\\\"\\\"<$set name=\\\"currentTiddler\\\" value=<<old-parent>>><<find-next-downwards-node>></$set>\\\"\\\"\\\">\\n\\t<$action-setfield $tiddler=<<row-edit-state>> text=<<currentTiddler>>/>\\t\\n</$list>\\n</$set>\\n</$set>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define focus-lower-node-actions()\\n<!-- handles moving down in the nodes with the keyboard -->\\n<!--if children, get the first child-->\\n<$list filter=\\\"[<currentTiddler>get[stream-list]enlist-input[]is[tiddler]first[]]\\\" variable=\\\"next-node\\\">\\n    <$action-setfield $tiddler=<<row-edit-state>> text=<<next-node>> />\\n</$list>\\n<!-- if no children-->\\n<!--- get closest ancestor with next sibling -->\\n<$list filter=\\\"[<currentTiddler>!has[stream-list]]\\\" variable=\\\"_NULL\\\">\\n\\t<$set name=\\\"old-active-node\\\" value=<<currentTiddler>> >\\n\\t\\t<<find-next-downwards-node>>\\n\\t</$set>\\n</$list>\\n\\\\end\\n\\n\\n\\\\define node-drag-start-actions()\\n<!-- parameter to draggable widget -->\\n<$action-setfield $tiddler=<<drag-title-state>> text=<<currentTiddler>>/>\\n<$action-setfield $tiddler=\\\"$:/state/sq/nodes/global-drag-state\\\" text=\\\"yes\\\"/>\\n<$set name=\\\"siblings\\\" filter=\\\"[{!!parent}get[stream-list]]\\\" select=\\\"0\\\">\\n<$list filter=\\\"[enlist<siblings>after<currentTiddler>]\\\" variable=\\\"next-node\\\">\\n\\t<$action-setfield $tiddler=<<drag-title-nextsibling-state>> text=<<next-node>> />\\n</$set>\\n\\\\end\\n\\n\\n\\\\define node-drag-end-actions()\\n<!-- parameter to draggable widget -->\\n<$action-deletetiddler $filter=\\\"\\\"\\\"[<drag-title-state>][<drag-title-nextsibling-state>][[$:/state/sq/nodes/global-drag-state]]\\\"\\\"\\\" />\\n\\\\end\\n\\n\\n\\\\define stream-drop-actions()\\n<!-- handles drag and drop -->\\n<$vars startBrackets=\\\"[[\\\" endBrackets=\\\"]]\\\" parent=<<dropTargetTiddler>> >\\n<$vars actionTiddler={{{[<actionTiddler>trim:suffix<endBrackets>trim:prefix<startBrackets>]}}}>\\n<!-- if target has no stream-type, assign one -->\\n<$list filter=\\\"[<dropTargetTiddler>!has[stream-type]]\\\">\\n\\t<$action-setfield $tiddler=<<dropTargetTiddler>> stream-type=\\\"default\\\"/>\\n</$list>\\n<!-- if action tiddler has no stream-type, assign one -->\\n<$list filter=\\\"[<actionTiddler>!has[stream-type]]\\\" variable=\\\"_NULL\\\">\\n\\t<$action-setfield $tiddler=<<actionTiddler>> stream-type=\\\"default\\\" />\\n</$list>\\n<!-- if we are dropping onto a new parent, then we might need to handle modifier keys -->\\n<$list filter=\\\"[<actionTiddler>get[parent]!match<parent>] [<actionTiddler>!has[parent]]\\\" variable=\\\"_NULL\\\">\\n\\t<$wikify name=\\\"new-node\\\" text={{$:/config/sq/streams/new-node-title}}>\\n\\t\\t<!-- ctrl modifier key on drop event -->\\n\\t\\t<!-- create a new node with text of dropped node -->\\n\\t\\t<$list filter=\\\"[<modifier>match{$:/config/sq/streams/dnd-modifier-copy-node}]\\\" variable=\\\"_NULL\\\">\\n\\t\\t\\t<$action-createtiddler $basetitle=<<new-node>> text={{{ [<actionTiddler>get[text]] }}} parent=<<parent>> stream-type=\\\"default\\\"/>\\n\\t\\t\\t<!-- insert into correct position on new parent -->\\n\\t\\t\\t<$action-listops $tiddler=<<dropTargetTiddler>> $field=\\\"stream-list\\\" $subfilter=\\\"+[insertbefore:currentTiddler<new-node>]\\\"/>\\n\\t\\t</$list>\\n\\t\\t<!-- shift modifier key on drop event -->\\n\\t\\t<$list filter=\\\"[<modifier>match{$:/config/sq/streams/dnd-modifier-transclude-node}]\\\" variable=\\\"_NULL\\\">\\n\\t\\t\\t<!-- create new node on target, in correct position, text is a transclusion-->\\n\\t\\t\\t<$action-createtiddler $basetitle=<<new-node>> text={{{ [<actionTiddler>addprefix[{{]addsuffix[}}]] }}} parent=<<parent>> stream-type=\\\"default\\\"/>\\n\\t\\t\\t<!-- insert into correct position on new parent -->\\n\\t\\t\\t<$action-listops $tiddler=<<dropTargetTiddler>> $field=\\\"stream-list\\\" $subfilter=\\\"+[insertbefore:currentTiddler<new-node>]\\\"/>\\n\\t\\t</$list>\\n\\t</$wikify>\\n\\t<!-- no modifier key on drop event -->\\n\\t<!-- insert in correct position on new parent, and remove from old parent -->\\n\\t<!-- assign new parent -->\\n\\t<$list filter=\\\"[<modifier>match[normal]]\\\" variable=\\\"_NULL\\\">\\n\\t\\t<$action-listops $tiddler=<<dropTargetTiddler>> $field=\\\"stream-list\\\" $subfilter=\\\"+[insertbefore:currentTiddler<actionTiddler>]\\\"/>\\n\\t\\t<$set name=\\\"original-parent\\\" filter=\\\"[<actionTiddler>get[parent]]\\\" select=\\\"0\\\">\\n\\t\\t\\t<$action-listops $tiddler=<<original-parent>> $field=\\\"stream-list\\\" $subfilter=\\\"-[title<actionTiddler>]\\\"/>\\n\\t\\t</$set>\\n\\t\\t<$action-setfield $tiddler=<<actionTiddler>> parent=<<parent>>/>\\n\\t</$list>\\n</$list>\\n<!-- we are dropping on to the same parent, insert in the correct position -->\\n<$list filter=\\\"[<actionTiddler>get[parent]match<parent>]\\\" variable=\\\"_NULL\\\">\\n\\t<$action-listops $tiddler=<<dropTargetTiddler>> $field=\\\"stream-list\\\" $subfilter=\\\"+[insertbefore:currentTiddler<actionTiddler>]\\\"/>\\n</$list>\\n</$vars>\\n</$vars>\\n\\\\end\"\n        },\n        \"$:/plugins/sq/streams/icons/node-expand-arrow\": {\n            \"title\": \"$:/plugins/sq/streams/icons/node-expand-arrow\",\n            \"created\": \"20200526035137040\",\n            \"modified\": \"20200526100520031\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"<svg width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 20 20\\\"><path d=\\\"M13.75 9.56879C14.0833 9.76124 14.0833 10.2424 13.75 10.4348L8.5 13.4659C8.16667 13.6584 7.75 13.4178 7.75 13.0329L7.75 6.97072C7.75 6.58582 8.16667 6.34525 8.5 6.5377L13.75 9.56879Z\\\"></path></svg>\"\n        },\n        \"$:/config/ShortcutInfo/streams-cancel-edit\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-cancel-edit\",\n            \"text\": \"Cancel and exit editing\"\n        },\n        \"$:/config/ShortcutInfo/streams-delete\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-delete\",\n            \"text\": \"Delete node\"\n        },\n        \"$:/config/ShortcutInfo/streams-demote\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-demote\",\n            \"text\": \"Demote node\"\n        },\n        \"$:/config/ShortcutInfo/streams-focus-higher\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-focus-higher\",\n            \"text\": \"Move focus to higher node\"\n        },\n        \"$:/config/ShortcutInfo/streams-focus-lower\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-focus-lower\",\n            \"text\": \"Move focus to lower node\"\n        },\n        \"$:/config/ShortcutInfo/streams-indent\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-indent\",\n            \"text\": \"Indent node\"\n        },\n        \"$:/config/ShortcutInfo/streams-merge-with-previous\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-merge-with-previous\",\n            \"text\": \"Merge with previous node, if caret is at start of a node\"\n        },\n        \"$:/config/ShortcutInfo/streams-promote\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-promote\",\n            \"text\": \"Promote node\"\n        },\n        \"$:/config/ShortcutInfo/streams-rename\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-rename\",\n            \"text\": \"Rename node\"\n        },\n        \"$:/config/ShortcutInfo/streams-save-and-continue\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-save-and-continue\",\n            \"text\": \"Save and create next node\"\n        },\n        \"$:/config/ShortcutInfo/streams-save-and-exit\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-save-and-exit\",\n            \"text\": \"Save and exit editing\"\n        },\n        \"$:/config/ShortcutInfo/streams-save-multiple\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-save-multiple\",\n            \"text\": \"Split and save as multiple nodes\"\n        },\n        \"$:/config/ShortcutInfo/streams-unindent\": {\n            \"title\": \"$:/config/ShortcutInfo/streams-unindent\",\n            \"text\": \"Unindent node\"\n        },\n        \"$:/config/sq/streams/dnd-modifier-copy-node\": {\n            \"title\": \"$:/config/sq/streams/dnd-modifier-copy-node\",\n            \"description\": \"Modifier key for drag and drop to create a copy of a node.\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/select\",\n            \"option-names\": \"ctrl alt shift meta\",\n            \"option-values\": \"ctrl alt shift meta\",\n            \"caption\": \"Modifier key to copy a node when dragging.\",\n            \"text\": \"ctrl\"\n        },\n        \"$:/config/sq/streams/dnd-modifier-transclude-node\": {\n            \"title\": \"$:/config/sq/streams/dnd-modifier-transclude-node\",\n            \"description\": \"Modifier key for drag and drop to create a transclusion of a node.\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/select\",\n            \"option-names\": \"ctrl alt shift meta\",\n            \"option-values\": \"ctrl alt shift meta\",\n            \"caption\": \"Modifier key to transclude a node when dragging.\",\n            \"text\": \"shift\"\n        },\n        \"$:/config/sq/streams/editor-engine\": {\n            \"title\": \"$:/config/sq/streams/editor-engine\",\n            \"description\": \"Editor to use for Streams\",\n            \"caption\": \"Editor to use for Streams\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/select\",\n            \"option-names\": \"[[Default]] [[CodeMirror]]\",\n            \"option-values\": \"text codemirror\",\n            \"condition\": \"[[widget]modules[]prefix[$:/plugins/tiddlywiki/codemirror/edit-codemirror.js]]\",\n            \"text\": \"text\"\n        },\n        \"$:/config/sq/streams/enable-breadcrumbs\": {\n            \"title\": \"$:/config/sq/streams/enable-breadcrumbs\",\n            \"description\": \"Enable breadcrumbs in nodes\",\n            \"caption\": \"Show breadcrumbs\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"yes\"\n        },\n        \"$:/config/sq/streams/enable-edit-toolbar\": {\n            \"title\": \"$:/config/sq/streams/enable-edit-toolbar\",\n            \"description\": \"Enable toolbar in editor\",\n            \"caption\": \"Show toolbar in editor\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"no\"\n        },\n        \"$:/config/sq/streams/exit-on-saving-empty-node\": {\n            \"title\": \"$:/config/sq/streams/exit-on-saving-empty-node\",\n            \"description\": \"Enable to exit edit mode on saving an empty node\",\n            \"caption\": \"Exit editing on saving an empty node\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"no\"\n        },\n        \"$:/config/sq/streams/new-node-tiddler-template\": {\n            \"title\": \"$:/config/sq/streams/new-node-tiddler-template\",\n            \"description\": \"T iddler to use as a template for new nodes\",\n            \"caption\": \"Tiddler to use as new node template\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input\"\n        },\n        \"$:/config/sq/streams/new-node-title\": {\n            \"title\": \"$:/config/sq/streams/new-node-title\",\n            \"description\": \"Wikitext that is wikified to generate the title for new nodes\",\n            \"caption\": \"Template wikified for node title\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input\",\n            \"text\": \"<<stream-root-title>>/<<now \\\"[UTC]YYYY0MM0DD0hh0mm0ssXXX\\\">>\"\n        },\n        \"$:/config/sq/streams/node-max-width\": {\n            \"title\": \"$:/config/sq/streams/node-max-width\",\n            \"description\": \"Maximum displayed width of a Stream node\",\n            \"caption\": \"Maximum node width\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input\",\n            \"text\": \"550\"\n        },\n        \"$:/config/sq/streams/node-split-regexp\": {\n            \"title\": \"$:/config/sq/streams/node-split-regexp\",\n            \"description\": \"Regular expression that is used to split longform text into multiple tiddlers\",\n            \"caption\": \"Regular expression used to split text\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input\",\n            \"text\": \"\\\\n\\\\n\"\n        },\n        \"$:/config/sq/streams/prompt-merge-with-previous\": {\n            \"title\": \"$:/config/sq/streams/prompt-merge-with-previous\",\n            \"description\": \"Enable to be prompted before merging a node with the previous node\",\n            \"caption\": \"Prompt before merging with previous\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"yes\"\n        },\n        \"$:/config/sq/streams/prompt-split-to-multiple\": {\n            \"title\": \"$:/config/sq/streams/prompt-split-to-multiple\",\n            \"description\": \"Enable to be prompted before splitting a node to multiple nodes\",\n            \"caption\": \"Prompt before creating multiple nodes\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"yes\"\n        },\n        \"$:/config/shortcuts/streams-cancel-edit\": {\n            \"title\": \"$:/config/shortcuts/streams-cancel-edit\",\n            \"created\": \"20200914162547334\",\n            \"modified\": \"20200914162547341\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"Escape\"\n        },\n        \"$:/config/shortcuts/streams-delete\": {\n            \"title\": \"$:/config/shortcuts/streams-delete\",\n            \"created\": \"20200914163552494\",\n            \"modified\": \"20200914163552502\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"ctrl-Delete\"\n        },\n        \"$:/config/shortcuts/streams-demote\": {\n            \"title\": \"$:/config/shortcuts/streams-demote\",\n            \"created\": \"20200914163104446\",\n            \"modified\": \"20200914163104456\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"alt-Down\"\n        },\n        \"$:/config/shortcuts/streams-focus-higher\": {\n            \"title\": \"$:/config/shortcuts/streams-focus-higher\",\n            \"created\": \"20200914163342651\",\n            \"modified\": \"20200914163342659\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"ctrl-Up\"\n        },\n        \"$:/config/shortcuts/streams-focus-lower\": {\n            \"title\": \"$:/config/shortcuts/streams-focus-lower\",\n            \"created\": \"20200914163347755\",\n            \"modified\": \"20200914163347764\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"ctrl-Down\"\n        },\n        \"$:/config/shortcuts/streams-indent\": {\n            \"title\": \"$:/config/shortcuts/streams-indent\",\n            \"created\": \"20200914162901728\",\n            \"modified\": \"20200914162901735\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"Tab\"\n        },\n        \"$:/config/shortcuts/streams-merge-with-previous\": {\n            \"title\": \"$:/config/shortcuts/streams-merge-with-previous\",\n            \"created\": \"20200914164323982\",\n            \"modified\": \"20200914164323991\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"Backspace\"\n        },\n        \"$:/config/shortcuts/streams-promote\": {\n            \"title\": \"$:/config/shortcuts/streams-promote\",\n            \"created\": \"20200914163110776\",\n            \"modified\": \"20200914163110785\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"alt-Up\"\n        },\n        \"$:/config/shortcuts/streams-rename\": {\n            \"title\": \"$:/config/shortcuts/streams-rename\",\n            \"created\": \"20200914163600676\",\n            \"modified\": \"20200914163600683\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"alt-R\"\n        },\n        \"$:/config/shortcuts/streams-save-and-continue\": {\n            \"title\": \"$:/config/shortcuts/streams-save-and-continue\",\n            \"created\": \"20200914164329638\",\n            \"modified\": \"20200914164329647\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"Enter\"\n        },\n        \"$:/config/shortcuts/streams-save-and-exit\": {\n            \"title\": \"$:/config/shortcuts/streams-save-and-exit\",\n            \"created\": \"20200914163850209\",\n            \"modified\": \"20200914163850217\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"ctrl-Enter\"\n        },\n        \"$:/config/shortcuts/streams-save-multiple\": {\n            \"title\": \"$:/config/shortcuts/streams-save-multiple\",\n            \"created\": \"20200914163843685\",\n            \"modified\": \"20200914163843694\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"alt-Enter\"\n        },\n        \"$:/config/shortcuts/streams-unindent\": {\n            \"title\": \"$:/config/shortcuts/streams-unindent\",\n            \"created\": \"20200914162907631\",\n            \"modified\": \"20200914162907639\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"shift-Tab\"\n        },\n        \"$:/config/sq/streams/split-at-caret\": {\n            \"title\": \"$:/config/sq/streams/split-at-caret\",\n            \"description\": \"Enable to split text at caret position on saving a node\",\n            \"caption\": \"Split text at caret position\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"yes\"\n        },\n        \"$:/config/sq/streams/stream-enable-filter\": {\n            \"title\": \"$:/config/sq/streams/stream-enable-filter\",\n            \"description\": \"Filter that determines which tiddlers get the add node button at the bottom\",\n            \"caption\": \"Filter to enable Streams\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input\",\n            \"text\": \"[!is[shadow]]\"\n        },\n        \"$:/config/sq/streams/swipe-behaviour\": {\n            \"title\": \"$:/config/sq/streams/swipe-behaviour\",\n            \"description\": \"Choose whether swipe should show a contextmenu, or be used to indent/unindent nodes.\",\n            \"caption\": \"Swipe behaviour\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/select\",\n            \"option-names\": \"[[Show ContextMenu]] [[Indent / Un-indent]]\",\n            \"option-values\": \"contextmenu indent\",\n            \"condition\": \"[[$:/config/sq/streams/swipe-behaviour-animated]!is[missing]]\",\n            \"text\": \"contextmenu\"\n        },\n        \"$:/config/sq/streams/swipe-contextmenu-position\": {\n            \"title\": \"$:/config/sq/streams/swipe-contextmenu-position\",\n            \"description\": \"Position of context menu shown on swiping.\",\n            \"caption\": \"Position of context menu shown on swiping.\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/select\",\n            \"settings-group\": \"swipe\",\n            \"option-names\": \"[[Right]] [[Left]]\",\n            \"option-values\": \"right left\",\n            \"condition\": \"[[$:/config/sq/streams/swipe-enabled]get[text]match[yes]]\",\n            \"text\": \"right\"\n        },\n        \"$:/config/sq/streams/swipe-enabled\": {\n            \"title\": \"$:/config/sq/streams/swipe-enabled\",\n            \"description\": \"Enable swipe to show context menu on touch devices.\",\n            \"caption\": \"Enable swipe to show context menu on nodes.\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"settings-group\": \"swipe\",\n            \"settings-group-header\": \"0\",\n            \"text\": \"yes\"\n        },\n        \"$:/config/sq/streams/swipe-threshold\": {\n            \"title\": \"$:/config/sq/streams/swipe-threshold\",\n            \"description\": \"Distance in pixels that triggers a swipe, defaults to 100\",\n            \"caption\": \"Swipe threshold in pixels\",\n            \"settings-template\": \"$:/plugins/sq/streams/ui/templates/settings/input\",\n            \"settings-group\": \"swipe\",\n            \"condition\": \"[[$:/config/sq/streams/swipe-enabled]get[text]match[yes]]\",\n            \"text\": \"70\"\n        },\n        \"$:/plugins/sq/streams/contextmenu/contextmenu-styles\": {\n            \"title\": \"$:/plugins/sq/streams/contextmenu/contextmenu-styles\",\n            \"text\": \".sq-contextmenu {\\n\\tpadding: 12px 0;\\n\\tbox-shadow: rgba(0, 0, 0, 0.40) 0px 2px 20px;\\n\\tfont-family: \\\"Segoe UI\\\", Roboto, Helvetica, Arial;\\n\\tfont-size: 13px;\\n\\tmargin-top: 4px;\\n\\tmin-width: 100px;\\n\\tmax-width: 240px;\\n\\tleft: -16px;\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\tborder-radius: 6px;\\n\\tborder: 1px solid #dce0e2;\\n\\ttransition: opacity 200ms ease 0s, transform 200ms ease 0s;\\n\\tmargin-top: 30px;\\n}\\n\\n.sq-contextmenu-alignright {\\n\\ttransform: translate3d(-100%,0,0);\\n}\\n\\n.sq-contextmenu .tc-menu-list-item {\\n\\tpadding: 0 18px;\\n\\tline-height: 24px;\\n\\twhite-space: nowrap;\\n\\tcolor: #4b5155;\\n\\tcursor: default !important;\\n\\ttext-indent: 0;\\n}\\n\\n.sq-contextmenu-itemwrapper {\\n\\tdisplay: flex;\\n\\tjustify-content: space-between;\\n\\talign-items: center;\\n\\tposition: relative;\\t\\n}\\n\\n.sq-contextmenu-itemtext {\\n\\tdisplay: flex;\\n\\twhite-space: nowrap;\\n\\ttext-overflow: ellipsis;\\n\\tflex-grow: 1;\\n\\toverflow: hidden;\\t\\n}\\n\\n.sq-contextmenu-itemicon {\\n\\tcolor: #b7bcbf;\\n\\tmargin-left: 16px;\\n\\tmin-width: 22px;\\t\\n}\\n\\n.sq-contextmenu-divider {\\n\\tborder-top-width: 1px;\\n\\tborder-top-color: #eceef0;\\n\\tborder-top-style: solid;\\n\\tmargin: 6px 0;\\n}\",\n            \"created\": \"20200602120854810\",\n            \"modified\": \"20200603055942655\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"type\": \"text/css\"\n        },\n        \"$:/plugins/sq/streams/contextmenu/contextmenu-template\": {\n            \"title\": \"$:/plugins/sq/streams/contextmenu/contextmenu-template\",\n            \"created\": \"20200602163018613\",\n            \"modified\": \"20200603055942658\",\n            \"tags\": \"\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"\\\\define menu-item(title,subtitle:\\\"\\\",actions:\\\"\\\")\\n\\t\\t<$button class=\\\"tc-menu-list-item tc-btn-invisible\\\" actions=<<__actions__>> >\\n\\t\\t\\t<span class=\\\"sq-contextmenu-itemwrapper\\\">\\n\\t\\t\\t\\t<span class=\\\"sq-contextmenu-itemtext\\\">$title$</span>\\n\\t\\t\\t\\t<span class=\\\"sq-contextmenu-itemicon\\\"><$macrocall $name=\\\"displayshortcuts\\\" $output=\\\"text/plain\\\" shortcuts=\\\"$subtitle$\\\" prefix=\\\"\\\" separator=\\\" \\\" suffix=\\\"\\\"/></span>\\n\\t\\t\\t</span>\\n\\t\\t</$button>\\n\\\\end\\n\\n\\\\define menu-divider() <div class=\\\"sq-contextmenu-divider\\\"/>\\n\\n<$reveal type=\\\"popup\\\" state=<<contextmenu-state>> position={{{[<contextmenu-state>get[position]]}}} tag=\\\"div\\\">\\n\\t<div class={{{tc-drop-down sq-contextmenu [<contextmenu-state>get[position]match[right]then[sq-contextmenu-alignright]else[]] +[join[ ]]}}}>\\n\\t\\t<$macrocall $name=\\\"menu-item\\\" title=\\\"Open\\\" actions=\\\"\\\"\\\"<$action-navigate/>\\\"\\\"\\\"/>\\n\\t\\t<$macrocall $name=\\\"menu-item\\\" title=\\\"Rename\\\" subtitle=\\\"((streams-rename))\\\" actions=<<rename-node-actions>>/>\\n\\t\\t<$macrocall $name=\\\"menu-item\\\" title=\\\"Delete\\\" subtitle=\\\"((streams-delete))\\\" actions=<<delete-node-actions>>/>\\n\\t\\t<$list filter=\\\"[all[shadows+tiddlers]tag[$:/tags/streams/contextmenu]]\\\" variable=\\\"listItem\\\">\\n\\t\\t\\t<$macrocall $name=\\\"menu-item\\\"\\n\\t\\t\\t\\ttitle={{{[<listItem>get[sq-contextmenu-name]]}}} \\n\\t\\t\\t\\tsubtitle={{{[<listItem>get[key]] [<listItem>get[sq-contextmenu-subtitle]] +[first[]]}}} \\n\\t\\t\\t\\tactions={{{[<listItem>get[text]]}}} />\\n\\t\\t</$list>\\n\\t\\t<<menu-divider>>\\n\\t\\t<$macrocall $name=\\\"menu-item\\\" title=\\\"Keyboard Shortcuts (?)\\\" actions=\\\"\\\"\\\"<$action-navigate $to=\\\"$:/plugins/sq/streams/info/keyboard-shortcuts\\\"/>\\\"\\\"\\\"/>\\n\\t</div>\\n</$reveal>\"\n        },\n        \"$:/plugins/sq/streams/codemirror-tweak\": {\n            \"title\": \"$:/plugins/sq/streams/codemirror-tweak\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/codemirror-tweak\\ntype: application/javascript\\nmodule-type: startup\\n\\n\\\\*/\\n\\nexports.platforms = [\\\"browser\\\"];\\nexports.synchronous = true;\\n\\nexports.startup = function() {\\n\\n\\tif($tw.wiki.getTiddler(\\\"$:/plugins/tiddlywiki/codemirror\\\") && ($tw.wiki.getTiddlerText(\\\"$:/config/Plugins/Disabled/$:/plugins/tiddlywiki/codemirror\\\",\\\"no\\\") === \\\"no\\\")) {\\n\\t\\tvar CMEngine = require(\\\"$:/plugins/tiddlywiki/codemirror/engine.js\\\").CodeMirrorEngine;\\n\\t\\tCMEngine.prototype.focus = function() {\\n\\t\\t\\tthis.cm.focus();\\n\\t\\t\\tvar caretPosition = this.widget.getAttribute(\\\"caretPosition\\\",\\\"end\\\");\\t\\n\\t\\t\\tvar index = (caretPosition === \\\"end\\\") ? this.cm.getValue().length : parseInt(caretPosition);\\n\\t\\t\\tthis.cm.doc.setSelection(this.cm.doc.posFromIndex(index));\\n\\t\\t}\\n\\t}\\n\\n}\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/sq/streams/draggable-tweaks.js\": {\n            \"title\": \"$:/plugins/sq/streams/draggable-tweaks.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/draggable-tweaks.js\\ntype: application/javascript\\nmodule-type: widget-subclass\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.baseClass = \\\"draggable\\\";\\n\\nexports.constructor = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\nexports.prototype = {};\\n\\nexports.prototype.render = function(parent,nextSibling) {\\n\\t// Call the base class handleChangeEvent function\\n\\tObject.getPrototypeOf(Object.getPrototypeOf(this)).render.call(this,parent,nextSibling);\\n\\tvar self = this;\\n\\t$tw.utils.each(this.attributes,function(v,a) {\\n\\t\\tif(a.substring(0,10) === \\\"data-node-\\\") {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tself.domNodes[0].setAttributeNS(null,a,v);\\n\\t\\t\\t} catch(e){\\n\\t\\t\\t\\t\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n};\\n\\n})();\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget-subclass\"\n        },\n        \"$:/plugins/sq/streams/droppable-tweaks.js\": {\n            \"title\": \"$:/plugins/sq/streams/droppable-tweaks.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/droppable-tweaks.js\\ntype: application/javascript\\nmodule-type: widget-subclass\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.baseClass = \\\"droppable\\\";\\n\\nexports.constructor = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\nexports.prototype = {};\\n\\nexports.prototype.render = function(parent,nextSibling) {\\n\\t// Call the base class handleChangeEvent function\\n\\tObject.getPrototypeOf(Object.getPrototypeOf(this)).render.call(this,parent,nextSibling);\\n\\tvar self = this;\\n\\t$tw.utils.each(this.attributes,function(v,a) {\\n\\t\\tif(a.substring(0,10) === \\\"data-node-\\\") {\\n\\t\\t\\ttry {\\n\\t\\t\\t\\tself.domNode.setAttributeNS(null,a,v);\\n\\t\\t\\t} catch(e){\\n\\t\\t\\t\\t\\n\\t\\t\\t}\\n\\t\\t}\\n\\t});\\n};\\n\\n})();\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget-subclass\"\n        },\n        \"$:/plugins/sq/streams/framed-engine-tweak\": {\n            \"title\": \"$:/plugins/sq/streams/framed-engine-tweak\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/framed-engine-tweak\\ntype: application/javascript\\nmodule-type: startup\\n\\n\\\\*/\\n\\nvar FramedEngine = require(\\\"$:/core/modules/editor/engines/framed.js\\\").FramedEngine;\\n\\nFramedEngine.prototype.focus = function() {\\n\\tif(this.domNode.focus && this.domNode.select) {\\n\\t\\tthis.domNode.focus();\\n\\t\\tif(this.widget.getAttribute(\\\"select\\\")===\\\"false\\\") {\\n\\t\\t\\tvar caretPosition = this.widget.getAttribute(\\\"caretPosition\\\",\\\"end\\\");\\n\\t\\t\\tcaretPosition = (caretPosition === \\\"end\\\") ? this.domNode.value.length : parseInt(caretPosition);\\n\\t\\t\\tthis.domNode.setSelectionRange(caretPosition,caretPosition);\\n\\t\\t} else {\\n\\t\\t\\tthis.domNode.select();\\n\\t\\t}\\n\\t}\\n\\t/*\\n\\tif(!this.setupDblClick) {\\n\\t\\tthis.domNode.addEventListener(\\\"dblclick\\\",this.propagateDblClick.bind(this));\\n\\t\\tthis.setupDblClick = true;\\n\\t}\\n\\t*/\\n}\\n\\n/*\\nFramedEngine.prototype.propagateDblClick = function(event) {\\n\\tif(this.widget.wiki.getTiddlerText(\\\"$:/config/sq/streams/dblclick-editor-to-exit\\\") === \\\"yes\\\") {\\n\\t\\tvar newEvent = this.widget.document.createEventObject ? this.widget.document.createEventObject() : this.widget.document.createEvent(\\\"Events\\\");\\n\\t\\tif(newEvent.initEvent) {\\n\\t\\t\\tnewEvent.initEvent(\\\"dblclick\\\", true, true);\\n\\t\\t}\\n\\t\\tnewEvent.keyCode = event.keyCode;\\n\\t\\tnewEvent.which = event.which;\\n\\t\\tnewEvent.metaKey = event.metaKey;\\n\\t\\tnewEvent.ctrlKey = event.ctrlKey;\\n\\t\\tnewEvent.altKey = event.altKey;\\n\\t\\tnewEvent.shiftKey = event.shiftKey;\\n\\t\\treturn !this.widget.parentDomNode.dispatchEvent(newEvent);\\n\\t}\\n\\treturn false;\\n}\\n*/\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/sq/streams/simple-engine-tweak\": {\n            \"title\": \"$:/plugins/sq/streams/simple-engine-tweak\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/simple-engine-tweak\\ntype: application/javascript\\nmodule-type: startup\\n\\n\\\\*/\\n\\nvar SimpleEngine = require(\\\"$:/core/modules/editor/engines/simple.js\\\").SimpleEngine;\\n\\nSimpleEngine.prototype.focus = function() {\\n\\tif(this.domNode.focus && this.domNode.select) {\\n\\t\\tthis.domNode.focus();\\n\\t\\tif(this.widget.getAttribute(\\\"select\\\")===\\\"false\\\") {\\n\\t\\t\\tvar caretPosition = this.widget.getAttribute(\\\"caretPosition\\\",\\\"end\\\");\\n\\t\\t\\tcaretPosition = (caretPosition === \\\"end\\\") ? this.domNode.value.length : parseInt(caretPosition);\\n\\t\\t\\tthis.domNode.setSelectionRange(caretPosition,caretPosition);\\n\\t\\t} else {\\n\\t\\t\\tthis.domNode.select();\\n\\t\\t}\\n\\t}\\n}\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/sq/streams/delete-hook/actions\": {\n            \"title\": \"$:/plugins/sq/streams/delete-hook/actions\",\n            \"created\": \"20200527200401408\",\n            \"modified\": \"20200527234136578\",\n            \"tags\": \"$:/tags/deleteTiddlerAction\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"\\\\define delete-children()\\n\\t<$list filter=\\\"[enlist{!!stream-list}]\\\">\\n\\t\\t<<delete-children>>\\n\\t</$list>\\n\\t<<$action-deletetiddler $filter=\\\"[enlist{!!stream-list}]\\\"/>\\n\\\\end\\n\\n<$list filter=\\\"[<currentTiddler>has[stream-type]]\\\">\\n\\t<$list filter=\\\"[<currentTiddler>has[parent]]\\\">\\n\\t\\t<$action-listops $tiddler={{!!parent}} $field=\\\"stream-list\\\" $subfilter=\\\"-[<currentTiddler>]\\\" />\\n\\t</$list>\\n\\t<$list variable=\\\"count\\\" filter=\\\"[enlist{!!stream-list}count[]!match[0]]\\\">\\n\\t\\t<$action-confirm $message=\\\"Do you wish to delete all tiddlers descended from this tiddler?\\\">\\n\\t\\t\\t<<delete-children>>\\n\\t\\t</$action-confirm>\\n\\t</$list>\\n</$list>\"\n        },\n        \"$:/plugins/sq/streams/delete-hook/hook\": {\n            \"title\": \"$:/plugins/sq/streams/delete-hook/hook\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/delete-hook/hook\\ntype: application/javascript\\nmodule-type: startup\\n\\n\\\\*/\\n\\n$tw.hooks.addHook(\\\"th-deleting-tiddler\\\",function(tiddler) {\\n\\tif(tiddler.fields[\\\"draft.of\\\"]) {\\n\\t\\treturn;\\n\\t}\\n\\t\\n\\t$tw.rootWidget.invokeActionsByTag(\\\"$:/tags/deleteTiddlerAction\\\",null,{currentTiddler : tiddler.fields.title});\\n});\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/sq/streams/filters/get-stream-nodes.js\": {\n            \"title\": \"$:/plugins/sq/streams/filters/get-stream-nodes.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/filters/get-stream-nodes.js\\ntype: application/javascript\\nmodule-type: filteroperator\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n/*\\nExport our filter function\\n*/\\nexports[\\\"get-stream-nodes\\\"] = function(source,operator,options) {\\n\\tvar results = [],\\n        suffixes = (operator.suffixes || []),\\n\\t\\tmatchTitles = (suffixes[0] || []).indexOf(\\\"matchtitles\\\") !== -1;\\n\\n\\tsource(function(tiddler,title) {\\n\\t\\t\\n\\t\\tvar processNode = function(node,nodeTitle) {\\n\\t\\t\\tif(node && node.fields[\\\"stream-list\\\"] && node.fields[\\\"stream-type\\\"]) {\\n\\t\\t\\t\\tresults.push(nodeTitle);\\n\\t\\t\\t\\tvar streamList = $tw.utils.parseStringArray(node.fields[\\\"stream-list\\\"]);\\n\\t\\t\\t\\t$tw.utils.each(streamList,function(streamListNodeTitle) {\\n\\t\\t\\t\\t\\tvar streamListNode = options.wiki.getTiddler(streamListNodeTitle);\\n\\t\\t\\t\\t\\tif(streamListNode) {\\n\\t\\t\\t\\t\\t\\tprocessNode(streamListNode,streamListNodeTitle);\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t});\\n\\t\\t\\t} else {\\n\\t\\t\\t\\tresults.push(nodeTitle);\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\tif(tiddler) {\\n\\t\\t\\tprocessNode(tiddler,title);\\n\\t\\t}\\n\\t});\\n\\treturn results;\\n};\\n\\n})();\\n\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"filteroperator\"\n        },\n        \"$:/plugins/sq/streams/filters/get-stream-root.js\": {\n            \"title\": \"$:/plugins/sq/streams/filters/get-stream-root.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/filters/get-stream-root.js\\ntype: application/javascript\\nmodule-type: filteroperator\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\n/*\\nExport our filter function\\n\\n//\\t[[xyz]get-stream-root[]]\\n//\\t[[xyz]get-stream-root:matchtitles[]]\\n//\\t[[xyz]get-stream-root:includeall,matchtitles[]]\\n\\n*/\\nexports[\\\"get-stream-root\\\"] = function(source,operator,options) {\\n\\tvar results = [],\\n        suffixes = (operator.suffixes || []),\\n\\t\\tincludeAll = (suffixes[0] || []).indexOf(\\\"includeall\\\") !== -1,\\n\\t\\tmatchTitles = (suffixes[0] || []).indexOf(\\\"matchtitles\\\") !== -1;\\n\\n\\tsource(function(tiddler,title) {\\n\\t\\tvar ancestors = [];\\n\\t\\tif(tiddler && tiddler.fields[\\\"parent\\\"] && tiddler.fields[\\\"stream-type\\\"]) {\\n\\t\\t\\tvar parentTiddler = tiddler;\\n\\t\\t\\twhile(parentTiddler) {\\n\\t\\t\\t\\t\\tif(tiddler.fields.title.startsWith(parentTiddler.fields[\\\"title\\\"].split(\\\"/\\\")[0]) || !matchTitles ) {\\n\\t\\t\\t\\t\\t\\tancestors.unshift(parentTiddler.fields.title);\\n\\t\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\tif(parentTiddler.fields.parent) {\\t\\n\\t\\t\\t\\t\\tparentTiddler = options.wiki.getTiddler(parentTiddler.fields.parent);\\n\\t\\t\\t\\t} else {\\n\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t} else {\\n\\t\\t\\tancestors.unshift(title);\\n\\t\\t}\\n\\t\\tif(!includeAll) {\\n\\t\\t\\tancestors.splice(1);\\n\\t\\t}\\n\\t\\t$tw.utils.pushTop(results,ancestors);\\n\\t});\\n\\treturn results;\\n};\\n\\n})();\\n\\n\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"filteroperator\"\n        },\n        \"$:/plugins/sq/streams/info/keyboard-shortcuts\": {\n            \"title\": \"$:/plugins/sq/streams/info/keyboard-shortcuts\",\n            \"text\": \"!! Streams keyboard shortcuts\\n\\n<table>\\n<tbody>\\n<$list filter=\\\"[all[shadows+tiddlers]prefix[$:/config/ShortcutInfo/streams-]]\\\">\\n<tr>\\n<td>{{!!text}}</td>\\n<td><$macrocall $name=\\\"displayshortcuts\\\" $output=\\\"text/plain\\\" shortcuts={{{[<currentTiddler>removeprefix[$:/config/ShortcutInfo/]addprefix[((]addsuffix[))]]}}} prefix=\\\"\\\" separator=\\\" \\\" suffix=\\\"\\\"/></td>\\n</tr>\\n</$list>\\n</tbody>\\n</table>\\n\\nShortcuts can be customized in the [[Control Panel|$:/core/ui/ControlPanel/KeyboardShortcuts]]\\n\\n''Drag and drop''\\n\\n* hold <kbd>control</kbd> key to drag and drop and create a copy of the node in another stream tiddler\\n* hold <kbd>shift</kbd> key to drag and drop and create a node that transcludes the contents of this node, in another stream tiddler\\n\\n''for the moment it is a design decision to disallow copying/transcluding the node inside the same root (story) tiddler''\\n\\n//Note that it is a known limitation that copying a node or transcluding it does not apply to the children of the node. This is on the [[list of things to implement|Roadmap]].//\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/cancel-edit-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/cancel-edit-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-cancel-edit))\",\n            \"text\": \"<<cancel-edit-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/delete-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/delete-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-delete))\",\n            \"text\": \"<<delete-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/demote-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/demote-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-demote))\",\n            \"text\": \"<<demote-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/focus-higher-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/focus-higher-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-focus-higher))\",\n            \"text\": \"<<focus-higher-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/focus-lower-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/focus-lower-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-focus-lower))\",\n            \"text\": \"<<focus-lower-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/indent-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/indent-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts $:/tags/streams/contextmenu\",\n            \"key\": \"((streams-indent))\",\n            \"sq-contextmenu-name\": \"Indent\",\n            \"sq-contextmenu-subtitle\": \"\",\n            \"text\": \"<<indent-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/merge-with-previous\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/merge-with-previous\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-merge-with-previous))\",\n            \"prevent-default\": \"no\",\n            \"text\": \"<<merge-with-previous-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/promote-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/promote-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-promote))\",\n            \"text\": \"<<promote-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/rename-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/rename-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-rename))\",\n            \"text\": \"<<rename-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/save-and-continue\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/save-and-continue\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-save-and-continue))\",\n            \"text\": \"<<save-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/save-and-exit\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/save-and-exit\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-save-and-exit))\",\n            \"text\": \"<<save-edit-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/save-multiple\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/save-multiple\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts\",\n            \"key\": \"((streams-save-multiple))\",\n            \"text\": \"<<save-multiple-actions>>\"\n        },\n        \"$:/plugins/sq/streams/keyboard-shortcuts/unindent-node\": {\n            \"title\": \"$:/plugins/sq/streams/keyboard-shortcuts/unindent-node\",\n            \"tags\": \"$:/tags/streams/keyboard-shortcuts $:/tags/streams/contextmenu\",\n            \"key\": \"((streams-unindent))\",\n            \"sq-contextmenu-name\": \"Un-indent\",\n            \"sq-contextmenu-subtitle\": \"\",\n            \"text\": \"<<unindent-node-actions>>\"\n        },\n        \"$:/plugins/sq/streams/icons/new-node-btn\": {\n            \"title\": \"$:/plugins/sq/streams/icons/new-node-btn\",\n            \"created\": \"20200528160920973\",\n            \"modified\": \"20200528164140128\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"<svg width=\\\"20\\\" height=\\\"20\\\" viewBox=\\\"0 0 20 20\\\">\\n<style>\\n  .line{\\n    stroke:#868c90;\\n  }\\n</style>\\n  <circle cx=\\\"10.5\\\" cy=\\\"10.5\\\" r=\\\"9\\\" class=\\\"circle\\\" fill=\\\"#fff\\\" ></circle>\\n  <line x1=\\\"6\\\" y1=\\\"10.5\\\" x2=\\\"15\\\" y2=\\\"10.5\\\" class=\\\"line\\\"></line>\\n  <line x1=\\\"10.5\\\" y1=\\\"6\\\" x2=\\\"10.5\\\" y2=\\\"15\\\" class=\\\"line\\\"></line>\\n</svg>\"\n        },\n        \"$:/plugins/sq/streams/refresh-hook.js\": {\n            \"title\": \"$:/plugins/sq/streams/refresh-hook.js\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/refresh-hook.js\\ntype: application/javascript\\nmodule-type: startup\\n\\\\*/\\n\\n$tw.hooks.addHook(\\\"th-page-refreshed\\\",function handleEvent() {\\n\\t$tw.wiki.deleteTiddler(\\\"$:/state/sq/streams/caret-position\\\");\\n});\\n\\n\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"startup\"\n        },\n        \"$:/plugins/sq/streams/releasenotes\": {\n            \"title\": \"$:/plugins/sq/streams/releasenotes\",\n            \"text\": \"<h3 id=\\\"1224-2022-04-07\\\"><a href=\\\"https://github.com/saqimtiaz/streams/compare/v1.2.23...v1.2.24\\\">1.2.24</a> (2022-04-07)</h3>\\n<h3 id=\\\"bug-fixes\\\">Bug Fixes</h3>\\n<ul>\\n<li>hide breadcrumbs when tiddler is folded (<a href=\\\"https://github.com/saqimtiaz/streams/commit/814bc9e604a55ec91d9d7b2600905469a2cfa10b\\\">814bc9e</a>)</li>\\n</ul>\\n\",\n            \"type\": \"text/vnd.tiddlywiki\"\n        },\n        \"$:/config/flibbles/relink/fields/parent\": {\n            \"title\": \"$:/config/flibbles/relink/fields/parent\",\n            \"created\": \"20200530105147302\",\n            \"modified\": \"20200530105155682\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"title\"\n        },\n        \"$:/config/flibbles/relink/fields/stream-list\": {\n            \"title\": \"$:/config/flibbles/relink/fields/stream-list\",\n            \"created\": \"20200530105147302\",\n            \"modified\": \"20200530105155682\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"list\"\n        },\n        \"$:/plugins/sq/streams/styles\": {\n            \"title\": \"$:/plugins/sq/streams/styles\",\n            \"created\": \"20170922203553093\",\n            \"modified\": \"20170927050808722\",\n            \"tags\": \"[[$:/tags/Stylesheet]]\",\n            \"text\": \".stream-root {\\n\\tmargin-left: -2.5em;\\n}\\n\\n@media only screen and (max-width: 600px) {\\n\\t.stream-root {\\n\\t\\tmargin-left: -1em;\\n\\t}\\n}\\n\\n.stream-row {\\n    display: flex;\\n    flex: 0 0 auto;\\n\\tuser-select: none;\\n}\\n\\n.stream-row-children {\\n\\tdisplay:flex;\\n\\tflex: 0 0 auto;\\n\\tflex-direction: column;\\n\\t/*padding-left: 0.5em;*/\\n\\tborder-left: 1px solid <<color message-border>>;\\n\\tmargin-left: 30px;\\n}\\n\\n.stream-row-nochildren + .stream-row-children {\\n\\tborder-left: none;\\n}\\n\\n\\n.stream-node-disabled,\\n.stream-node-disabled + div.stream-row-children{\\n\\tbackground-color: <<color tiddler-editor-border>>;\\n}\\n\\n.stream-node-disabled + div.stream-row-children + div.stream-node-disabled,\\n.stream-node-disabled + div.stream-row-children + div.stream-node-disabled + div.stream-row-children,\\n.stream-node-disabled.stream-row-nochildren + div.stream-row-children,\\n.stream-node-disabled.stream-row-nochildren + div.stream-row-children > div.stream-node-disabled {\\n\\tbackground-color: transparent;\\n}\\n\\n/* hide last droppable in a list when the last row is disabled */\\n.stream-node-disabled + div.stream-row-children + div.stream-droppable.tc-droppable.stream-droppable-terminal{\\n\\tdisplay: none;\\n\\t/*visibility: hidden;*/\\n}\\n\\n.stream-node-disabled + div.stream-row-children + .stream-node-disabled + div.stream-row-children + div.stream-droppable.tc-droppable.stream-droppable-terminal{\\n\\tdisplay: block;\\n}\\n\\n\\n/*\\n.stream-node-disabled.stream-row-nochildren + div.stream-row-children  {\\n\\tvisibility: hidden;\\n}\\n\\n.stream-node-disabled.stream-row-nochildren + div.stream-row-children + div + div {\\n\\tvisibility: visible;\\n}\\n*/\\n\\n\\n.stream-droppable.tc-droppable.tc-dragover > .tc-droppable-placeholder,\\n.stream-droppable.tc-droppable.tc-dragover > div > .tc-droppable-placeholder {\\n\\tmargin-left: 29px;\\n\\tline-height: 5px;\\n\\theight: 5px;\\n\\tborder: 2px solid <<color dropzone-background>>;\\n\\tbackground-color: <<color dropzone-background>>;\\n}\\n\\n/*\\n.stream-droppable-terminal.tc-drag-over .stream-droppable-spacer {\\n\\theight: 0;\\n}\\n*/\\n\\n.stream-droppable-spacer {\\n\\theight: 0.3em;\\n}\\n\\n<$vars currentTiddler={{{[prefix[$:/state/sq-context-popup]]}}}>\\n[data-node-title=\\\"{{!!current}}\\\"],\\n[data-node-title=\\\"{{!!current}}\\\"] + div{\\n\\tbackground: <<color notification-background>>;\\n\\tcolor: <<color message-foreground>>;\\n}\\n</$vars>\\n\\n.stream-node-control {\\n\\tdisplay: flex;\\n    flex: 0 0 45px;\\n    padding-top: 4px;\\n    padding-left: 4px;\\n}\\n\\n.stream-node-control .stream-node-collapser,\\n.stream-node-control .stream-node-handle {\\n    display: flex;\\n    height: 13px;\\n    width: 13px;\\n    margin-top: 4px;\\n    border-radius: 50%;\\n    justify-content: center;\\n    align-items: center;\\n}\\n\\n.stream-node-control.stream-node-control-addnew .stream-node-handle {\\n\\twidth: 20px;\\n\\theight: 20px;\\n\\tmargin-top: 0;\\n}\\n\\n.stream-node-control.stream-node-control-addnew .stream-node-collapser {\\n\\twidth: 16px;\\n}\\n\\n.stream-node-control.stream-node-control-addnew div.tc-btn-invisible svg {\\n\\topacity: 0.8;\\n}\\n\\n\\n.stream-node-control.stream-node-control-addnew div.tc-btn-invisible svg circle {\\n\\tfill: <<color tiddler-controls-foreground>>;\\n\\topacity: 0.6;\\n}\\n\\n.stream-node-control.stream-node-control-addnew div.tc-btn-invisible svg line.line {\\n\\tstroke: <<color foreground>>;\\n\\topacity: 1;\\n}\\n\\n.stream-node-control.stream-node-control-addnew div.tc-btn-invisible:hover svg circle {\\n\\tfill: <<color tiddler-controls-foreground-hover>>;\\n}\\n\\n.stream-node-control .stream-node-collapser {\\n\\theight: 13px;\\n\\twidth: 20px;\\n\\topacity:0;\\n}\\n\\n.stream-row-nochildren .stream-node-collapser {\\n\\tvisibility: hidden;\\n}\\n\\n.stream-row:hover .stream-node-collapser,\\n.stream-row-children-collapsed.stream-row:hover .stream-node-collapser {\\n\\topacity: 0.4;\\n}\\n\\n.stream-row:hover .stream-node-collapser:hover,\\n.stream-row-children-collapsed.stream-row:hover .stream-node-collapser:hover {\\n\\topacity: 0.9;\\n}\\n\\n.stream-row-children-collapsed .stream-node-control .stream-node-collapser {\\n\\topacity: 0.4;\\n}\\n\\n.stream-node-collapser.tc-btn-invisible,\\n.stream-node-collapser.tc-btn-invisible:focus {\\n\\toutline: none;\\n}\\n\\n.stream-node-collapser svg {\\n\\ttransform: rotateZ(90deg);\\n\\ttransition: transform 200ms ease-in-out 0s;\\n}\\n\\n.stream-row-children-collapsed .stream-node-collapser svg {\\n\\ttransform: rotateZ(0deg);\\n}\\n\\n/*\\n.stream-node-control .stream-node-handle-wrapper .stream-node-handle {\\n\\twidth: 13px;\\n\\theight: 13px;\\n\\tdisplay: flex;\\n\\talign-items : center;\\n\\tjustify-content: center;\\n}\\n*/\\n\\n.stream-node-control .stream-node-handle .stream-node-handle-inner {\\n    border-radius: 50%;\\n    width: 6px;\\n    height: 6px;\\n    background-color: <<color foreground>>;\\n\\topacity: 0.3;\\n}\\n\\n.stream-node-control .sq-contextmenu-container {\\n\\tdisplay: flex;\\n}\\n\\n/*\\n.stream-row:hover .stream-node-control .stream-node-handle-wrapper .stream-node-handle-inner {\\n\\topacity: 0.7;\\n}\\n*/\\n\\n.stream-row:hover .stream-node-control .stream-node-handle:hover .stream-node-handle-inner {\\n\\topacity: 1;\\n} \\n\\n<$vars currentTiddler={{{[prefix[$:/state/sq-context-popup]]}}}>\\n[data-node-title=\\\"{{!!current}}\\\"] .stream-node-handle .stream-node-handle-inner  {\\n    border: 5px solid #5778d8;\\n    opacity: 1;\\n}\\n</$vars>\\n\\n\\n.stream-node-block {\\n    overflow-wrap: break-word;\\n\\tmax-width: {{$:/config/sq/streams/node-max-width}}px;\\n    min-height: calc(1.5em + 8px);\\n    box-sizing: border-box;\\n    margin-top: -1px;\\n    min-width: 100px;\\n    width: 100%;\\n    line-height: 1.5em;\\n    cursor: text;\\n    padding-top: 4px;\\n    padding-bottom: 4px;\\n\\tuser-select: text;\\n\\t/*white-space: pre-wrap;*/\\n}\\n\\n.stream-node-block textarea {\\n\\twidth: 100%;\\n\\toutline-color: <<color tiddler-editor-border>>;\\n\\tborder: 1px solid <<color tiddler-editor-border>>;\\n\\n\\tresize: none;\\n}\\n\\n.stream-node-block textarea.streams-editor {\\n\\tline-height:1.5em;\\n\\tmargin-bottom: 0.6em;\\n}\\n\\n.stream-node-block > h1:first-child,\\n.stream-node-block > h2:first-child,\\n.stream-node-block > h3:first-child,\\n.stream-node-block > h4:first-child,\\n.stream-node-block > h5:first-child,\\n.stream-node-block > h6:first-child,\\n.stream-node-block p:first-child {\\n\\tmargin-top:0;\\n}\\n\\n.stream-node-block > h1:last-child,\\n.stream-node-block > h2:last-child,\\n.stream-node-block > h3:last-child,\\n.stream-node-block > h4:last-child,\\n.stream-node-block > h5:last-child,\\n.stream-node-block > h6:last-child,\\n.stream-node-block p:last-child {\\n\\tmargin-bottom:0;\\n}\\n\\nspan.sq-breadcrumbs-fragment {\\n    white-space: nowrap;\\n    overflow: hidden;\\n    display: inline-block;\\n    text-overflow: ellipsis;\\n    max-width: calc({{$:/config/sq/streams/node-max-width}}px - 50px);\\n}\\n\\nspan.sq-breadcrumbs-fragment a.tc-tiddlylink {\\n\\tcolor: <<color foreground>>;\\n}\\n\\n/*** framed engine styles ***/\\n\\n.tc-tiddler-frame .stream-node-block input.tc-edit-texteditor,\\n.tc-tiddler-frame .stream-node-block textarea.tc-edit-texteditor,\\n.tc-tiddler-frame .stream-node-block iframe.tc-edit-texteditor {\\n\\tbackground: <<color background>> !important;\\n\\tmargin-top:0;\\n\\tmargin-bottom: -1.6em;\\n}\\n\\n<$reveal state=\\\"$:/config/sq/streams/enable-edit-toolbar\\\" type=\\\"nomatch\\\" text=\\\"yes\\\">\\n.stream-node-block .tc-editor-toolbar {\\n\\tdisplay: none;\\n}\\n</$reveal>\\n\\n<$reveal state=\\\"$:/state/sq/streams/global-drag-state\\\" type=\\\"match\\\" text=\\\"yes\\\">\\n\\n/** active drag css **/\\n\\n</$reveal>\\n\\n<$reveal state=\\\"$:/state/sq/streams/global-drag-state\\\" type=\\\"nomatch\\\" text=\\\"yes\\\">\\n\\n/**no active drag css **/\\n\\n</$reveal>\"\n        },\n        \"$:/plugins/sq/streams/breadcrumbs-view-template\": {\n            \"title\": \"$:/plugins/sq/streams/breadcrumbs-view-template\",\n            \"created\": \"20200529205858594\",\n            \"list-before\": \"$:/core/ui/ViewTemplate/body\",\n            \"modified\": \"20200530055142652\",\n            \"tags\": \"$:/tags/ViewTemplate\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"\\\\whitespace trim\\n\\\\define stream-show-breadcrumbs()\\n<$list filter=\\\"[<currentTiddler>has[stream-type]]\\\">\\n\\t<$list filter=\\\"[<currentTiddler>has[parent]]\\\">\\n\\t\\t<$set name=\\\"currentTiddler\\\" filter=\\\"[{!!parent}]\\\" select=\\\"0\\\">\\n\\t\\t\\t<<stream-show-breadcrumbs>>\\n\\t\\t</$set>\\n\\t</$list>\\t\\n\\t<$list filter=\\\"[<currentTiddler>!match<storyTiddler>]\\\">\\n\\t\\t<$wikify name=\\\"display-title\\\" text={{{ [<currentTiddler>!is[binary]get[text]!is[blank]] ~[{!!title}] }}}>\\n\\t\\t\\t<span class=\\\"sq-breadcrumbs-fragment\\\">\\n\\t\\t\\t<$link to=<<currentTiddler>>>\\n\\t\\t\\t\\t<$text text={{{ [<display-title>split[]first[50]join[]] }}}/>\\n\\t\\t\\t</$link>>\\n\\t\\t\\t</span>\\n\\t\\t</$wikify>\\n\\t</$list>\\n</$list>\\n\\\\end\\n<$list filter=\\\"\\\"\\\"[<folded-state>get[text]!is[blank]else[show]!match[hide]]\\\"\\\"\\\" variable=\\\"_NULL\\\">\\n<$list filter=\\\"[{$:/config/sq/streams/enable-breadcrumbs}match[yes]]\\\" variable=\\\"_NULL\\\">\\n<<stream-show-breadcrumbs>>\\n</$list>\\n</$list>\\n\\n\"\n        },\n        \"$:/plugins/sq/streams/editor-template\": {\n            \"title\": \"$:/plugins/sq/streams/editor-template\",\n            \"created\": \"20200601145424630\",\n            \"modified\": \"20200602053704598\",\n            \"tags\": \"\",\n            \"type\": \"text/vnd.tiddlywiki\",\n            \"text\": \"\\\\define config-visibility-title()\\n$:/config/EditorToolbarButtons/Visibility/$(currentTiddler)$\\n\\\\end\\n<$streams-edit tag=\\\"textarea\\\" autoHeight=\\\"yes\\\" minHeight=\\\"1em\\\" focus=\\\"yes\\\" select=\\\"false\\\" class=\\\"streams-editor tc-edit-texteditor tc-edit-texteditor-body\\\" caretPosition={{{[{$:/state/sq/streams/caret-position}!is[blank]else[end]]}}}><$set name=\\\"targetTiddler\\\"value=<<currentTiddler>>><$list filter=\\\"[all[shadows+tiddlers]tag[$:/tags/EditorToolbar]!has[draft.of]]\\\"><$reveal type=\\\"nomatch\\\" state=<<config-visibility-title>> text=\\\"hide\\\" class=\\\"tc-text-editor-toolbar-item-wrapper\\\"><$transclude tiddler=\\\"$:/core/ui/EditTemplate/body/toolbar/button\\\"\\nmode=\\\"inline\\\"/></$reveal></$list></$set></$streams-edit>\"\n        },\n        \"$:/plugins/sq/streams/nodes-list-template\": {\n            \"title\": \"$:/plugins/sq/streams/nodes-list-template\",\n            \"created\": \"20171022203553093\",\n            \"modified\": \"20171122050808722\",\n            \"text\": \"\\\\import [[$:/plugins/sq/streams/action-macros]] [all[shadows+tiddlers]tag[$:/tags/streams/actionmacros]]  [all[shadows+tiddlers]tag[$:/tags/streams/user-actionmacros]]\\n\\\\whitespace trim\\n\\n<$vars stream-root-title=<<currentTiddler>>\\n\\tcontextmenu-state=<<qualify \\\"$:/state/sq-context-popup\\\">>\\n\\trow-edit-state=<<qualify \\\"$:/state/sq/streams/current-edit-tiddler\\\">>\\n\\tdrag-title-state=<<qualify \\\"$:/state/sq/streams/current-drag-title\\\">>\\n\\tdrag-title-nextsibling-state=<<qualify \\\"$:/state/sq/streams/current-drag-nextsibling\\\">> \\n>\\n\\t<$eventcatcher\\n\\t\\tevents=\\\"click\\\"\\n\\t\\tselector=\\\".stream-node-ctrl-btn\\\"\\n\\t\\tactions-click=<<node-ctrl-btn-actions>>\\n\\t\\ttag=\\\"div\\\"\\n\\t>\\n\\t<$eventcatcher\\n\\t\\tevents=\\\"dblclick swiped-right swiped-left\\\"\\n\\t\\ttag=\\\"div\\\"\\n\\t\\tselector=\\\".stream-row\\\"\\n\\t\\tactions-dblclick=<<toggle-row-edit-state>>\\n\\t\\tactions-swiped-right=<<swiped-right-actions>>\\n\\t\\tactions-swiped-left=<<swiped-left-actions>>\\n\\t>\\n\\t<$eventcatcher\\n\\t\\ttag=\\\"div\\\"\\n\\t\\tevents=\\\"contextmenu\\\"\\n\\t\\tselector=\\\".sq-contextmenu-container\\\"\\n\\t\\tactions-contextmenu=<<oncontext-menu-actions>>\\n\\t>\\n\\t<$swiper\\n\\t\\ttag=\\\"div\\\"\\n\\t\\tenable={{$:/config/sq/streams/swipe-enabled}}\\n\\t\\tswipethreshold={{$:/config/sq/streams/swipe-threshold}}\\n\\t>\\n\\t<div class={{{ stream-root [{$:/state/sq/nodes/global-drag-state}match[yes]then[stream-dragactive]] [<currentTiddler>!has[stream-list]then[stream-newlist]] +[join[ ]] }}}>\\n\\t\\t{{||$:/plugins/sq/streams/templates/stream-root-template}}\\n\\t\\t<$list filter=\\\"[all[current]match<stream-root-title>]\\\" variable=\\\"_NULL\\\">\\n\\t\\t\\t<!-- if we are the root, add a button to add more nodes-->\\n\\t\\t\\t<div class=\\\"stream-row\\\">\\n\\t\\t\\t\\t<div class=\\\"stream-node-control stream-node-control-addnew\\\">\\n\\t\\t\\t\\t\\t<div class=\\\"stream-node-collapser\\\">\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<div class=\\\"stream-node-handle\\\">\\n\\t\\t\\t\\t\\t\\t<$button tag=\\\"div\\\" class=\\\"tc-btn-invisible\\\" tooltip=\\\"add node\\\" actions=<<add-new-node-actions>> >\\n\\t\\t\\t\\t\\t\\t\\t{{$:/plugins/sq/streams/icons/new-node-btn}}\\n\\t\\t\\t\\t\\t\\t</$button>\\n\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t<$list filter=\\\"[all[shadows+tiddlers]tag[$:/tags/streams/root-buttons]]\\\" variable=\\\"btnTiddler\\\">\\n\\t\\t\\t\\t\\t\\t<div class=\\\"stream-node-handle\\\">\\n\\t\\t\\t\\t\\t\\t\\t<$transclude tiddler=<<btnTiddler>>/>\\n\\t\\t\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t\\t</$list>\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t\\t<div class=\\\"stream-node-block\\\">\\n\\t\\t\\t\\t\\t<!--consider moving last child dropzone in here, though thats for children too-->\\n\\t\\t\\t\\t</div>\\n\\t\\t\\t</div>\\t\\t\\t\\t\\n\\t\\t\\t<$set name=\\\"currentTiddler\\\" filter={{{[<contextmenu-state>get[current]]}}}>\\n\\t\\t\\t\\t{{||$:/plugins/sq/streams/contextmenu/contextmenu-template}}\\n\\t\\t\\t</$set>\\n\\t\\t</$list>\\t\\n\\t</div>\\n\\t</$swiper>\\n\\t</$eventcatcher>\\n\\t</$eventcatcher>\\n\\t</$eventcatcher>\\n</$vars>\\n\"\n        },\n        \"$:/plugins/sq/streams/templates/stream-root-template\": {\n            \"title\": \"$:/plugins/sq/streams/templates/stream-root-template\",\n            \"text\": \"\\\\whitespace trim\\n<$vars dropTargetTiddler=<<currentTiddler>> >\\n\\t<$list filter=\\\"[list[!!stream-list]!is[missing]]\\\">\\n\\t\\t<$set name=\\\"enable-dnd\\\" filter=\\\"[<enable-dnd>match[no]] ~[<drag-title-state>get[text]match<currentTiddler>then[no]]\\\" select=\\\"0\\\">\\n\\t\\t\\t{{||$:/plugins/sq/streams/templates/stream-row-template}}\\n\\t\\t</$set>\\n\\t</$list>\\n\\t<$tiddler tiddler=\\\"\\\">\\n\\t\\t<!-- to drop after the last child of any list level-->\\n\\t\\t<$droppable\\n\\t\\t\\tactions=<<stream-drop-actions>>\\n\\t\\t\\ttag=\\\"div\\\"\\n\\t\\t\\tenable=<<enable-dnd>>\\n\\t\\t\\tclass=\\\"stream-droppable stream-droppable-terminal\\\"\\n\\t\\t\\tdisabledClass=\\\"stream-node-disabled\\\"\\n\\t\\t>\\n\\t\\t\\t<div class=\\\"tc-droppable-placeholder\\\">\\n\\t\\t\\t&nbsp;\\n\\t\\t\\t</div><!-- idea only want below div with height when its a child with no more children-->\\n\\t\\t\\t<$list filter=\\\"[<currentTiddler>!has[stream-list]]\\\" variable=\\\"_NULL\\\"><div class=\\\"stream-droppable-spacer\\\"/></$list>\\n\\t\\t</$droppable>\\n\\t</$tiddler>\\n</$vars>\"\n        },\n        \"$:/plugins/sq/streams/templates/stream-row-body\": {\n            \"title\": \"$:/plugins/sq/streams/templates/stream-row-body\",\n            \"text\": \"<$transclude mode=\\\"block\\\"/>\"\n        },\n        \"$:/plugins/sq/streams/templates/stream-row-template\": {\n            \"title\": \"$:/plugins/sq/streams/templates/stream-row-template\",\n            \"text\": \"\\\\whitespace trim\\n<$qualify\\n\\tname=\\\"row-children-visibility-state\\\"\\n\\ttitle={{{ [[$:/state/sq/streams/visibility/]addsuffix<currentTiddler>] }}}\\n>\\n<$droppable \\n\\tactions=<<stream-drop-actions>>\\n\\ttag=\\\"div\\\"\\n\\tclass={{{ stream-droppable [list[!!stream-list]is[tiddler]then[]else[stream-row-nochildren]] +[join[ ]]}}}\\n\\tenable={{{[<drag-title-nextsibling-state>get[text]match<currentTiddler>then[no]] ~[<enable-dnd>]}}}\\n\\tdisabledClass=\\\"stream-node-disabled\\\"\\n\\tdata-node-title=<<currentTiddler>>\\n>\\n\\t<div class=\\\"tc-droppable-placeholder\\\"/>\\n\\t<div class={{{ stream-row [<row-children-visibility-state>get[text]match[hide]then[stream-row-children-collapsed]] +[join[ ]]}}}\\n\\t\\tdata-node-title=<<currentTiddler>>\\n\\t\\tdata-node-tags={{!!tags}}\\n\\t>\\n\\t\\t<$draggable\\n\\t\\t\\ttag=\\\"div\\\"\\n\\t\\t\\ttiddler=<<currentTiddler>>\\n\\t\\t\\tstartactions=<<node-drag-start-actions>>\\n\\t\\t\\tendactions=<<node-drag-end-actions>>\\n\\t\\t\\tclass=\\\"stream-node-control sq-contextmenu-container\\\"\\n\\t\\t\\tdata-node-title=<<currentTiddler>>\\n\\t\\t>\\n\\t\\t\\t<button type=\\\"button\\\" class=\\\"tc-btn-invisible stream-node-ctrl-btn stream-node-collapser\\\" data-btn-role=\\\"stream-node-visibility\\\" data-rowchildren-visibility-state=<<row-children-visibility-state>>>\\n\\t\\t\\t\\t{{$:/plugins/sq/streams/icons/node-expand-arrow}}\\n\\t\\t\\t</button>\\n\\t\\t\\t<div class=\\\"stream-node-handle tc-btn-invisible stream-node-ctrl-btn\\\" data-btn-role=\\\"stream-node-decorator\\\" data-node-title=<<currentTiddler>>>\\n\\t\\t\\t\\t\\t<div class=\\\"stream-node-handle-inner\\\"/>\\n\\t\\t\\t</div>\\n\\t\\t</$draggable>\\n\\t\\t<div class=\\\"stream-node-block\\\">\\n\\t\\t\\t<$list filter=\\\"[<row-edit-state>get[text]!is[blank]else[]match<currentTiddler>]\\\" variable=\\\"NULL\\\" emptyMessage=\\\"\\\"\\\"{{||$:/plugins/sq/streams/templates/stream-row-body}}\\\"\\\"\\\">\\n\\t\\t\\t\\t<$keyboard-plus shortcutTag=\\\"$:/tags/streams/keyboard-shortcuts\\\">\\n\\t\\t\\t\\t\\t{{||$:/plugins/sq/streams/editor-template}}\\n\\t\\t\\t\\t</$keyboard-plus>\\t\\t\\t\\n\\t\\t\\t</$list>\\n\\t\\t</div>\\n\\t</div>\\n</$droppable>\\n<$reveal\\n\\ttag=\\\"div\\\"\\n\\ttype=\\\"nomatch\\\"\\n\\tstateTitle=<<row-children-visibility-state>>\\n\\ttext=\\\"hide\\\"\\n\\tclass=\\\"stream-row-children\\\"\\n>\\n\\t\\t{{||$:/plugins/sq/streams/templates/stream-root-template}}\\n</$reveal>\\n</$qualify>\"\n        },\n        \"$:/plugins/sq/streams/stream-view-template\": {\n            \"title\": \"$:/plugins/sq/streams/stream-view-template\",\n            \"created\": \"20170922203553093\",\n            \"modified\": \"20170929050808722\",\n            \"tags\": \"[[$:/tags/ViewTemplate]]\",\n            \"list-after\": \"$:/core/ui/ViewTemplate/body\",\n            \"text\": \"<$list filter=\\\"\\\"\\\"[<folded-state>get[text]!is[blank]else[show]!match[hide]]\\\"\\\"\\\" variable=\\\"_NULL\\\">\\n<$list filter=\\\"\\\"\\\"[all[current]subfilter{$:/config/sq/streams/stream-enable-filter}]\\\"\\\"\\\">\\n{{||$:/plugins/sq/streams/nodes-list-template}}\\n</$list>\\n</$list>\"\n        },\n        \"$:/plugins/sq/streams/sq-ui-styles\": {\n            \"title\": \"$:/plugins/sq/streams/sq-ui-styles\",\n            \"tags\": \"[[$:/tags/Stylesheet]]\",\n            \"text\": \"/** checkbox switches start **/\\n/** https://www.w3schools.com/howto/howto_css_switch.asp **/\\n/* The switch - the box around the slider */\\nlabel.squi-form-switch {\\n\\tposition: relative;\\n\\tdisplay: inline-block;\\n\\twidth: 36px;\\n\\theight: 12px;\\n}\\n\\n/* Hide default HTML checkbox */\\nlabel.squi-form-switch input {\\n\\topacity: 0;\\n\\twidth: 0;\\n\\theight: 0;\\n}\\n\\n/* The slider */\\nlabel.squi-form-switch span {\\n\\tposition: absolute;\\n\\tcursor: pointer;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n\\tbackground-color: <<color tiddler-controls-foreground>>;\\n\\t-webkit-transition: .2s;\\n\\ttransition: .2s;\\n}\\n\\nlabel.squi-form-switch span:before {\\n\\tposition: absolute;\\n\\tcontent: \\\"\\\";\\n\\theight: 20px;\\n\\twidth: 20px;\\n\\tleft: -1px;\\n\\ttop: -4px;\\n\\tbottom: 4px;\\n\\tbackground-color: <<color background>>;\\n\\t-webkit-transition: .2s;\\n\\ttransition: .2s;\\n\\tbox-shadow: 0 1px 3px 0 rgba(0,0,0,0.7);\\n}\\n\\nlabel.squi-form-switch input:checked + span {\\n\\tbackground-color: rgba(26,115,232,0.5);\\n}\\n\\nlabel.squi-form-switch input:checked + span:before {\\n\\tbackground-color: rgb(26,115,232);\\n\\topacity: 1;\\n}\\n\\nlabel.squi-form-switch input:focus + span {\\n\\tbox-shadow: 0 0 1px #2196F3;\\n}\\n\\nlabel.squi-form-switch input:checked + span:before {\\n\\t-webkit-transform: translateX(17px);\\n\\t-ms-transform: translateX(17px);\\n\\ttransform: translateX(17px);\\n}\\n\\nlabel.squi-form-switch span {\\n\\tborder-radius: 12px;\\n}\\n\\nlabel.squi-form-switch span:before {\\n\\tborder-radius: 50%;\\n}\\n\\ndiv.squi-form-label {\\n\\t\\n}\\n\\n/*** checkbox switches end ***/\\n\\n/** form select elements **/\\n.squi-form-select {\\n\\tappearance: none;\\n\\tbackground: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='12' fill='%235F6368'%3E%3Cpath d='M0 0h24L12 12z'/%3E%3C/svg%3E\\\") calc(100% - 8px) center no-repeat;\\n\\tbackground-color: rgb(241,243,244);\\n\\tbackground-size: 10px;\\n\\tborder: none;\\n\\tborder-radius: 4px;\\n\\tcolor: rgb(32,33,36);\\n\\tcursor: pointer;\\n\\tmax-width: 100%;\\n\\toutline: none;\\n\\tpadding: 6px 21px 6px 8px;\\n/*\\twidth: 200px;*/\\n}\\n\\ninput.squi-form-input {\\n\\tborder: 1px solid <<color tiddler-controls-foreground>>;\\n\\tborder-radius: 3px;\\n\\tbackground-color: rgb(241,243,244);\\n\\tpadding: 6px;\\n}\\n\\ninput.squi-form-input:focus {\\n\\toutline-color: #ccc;\\n}\\n\\n\\n.sq-list-group {\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\\tpadding-left: 0;\\n\\tmargin-bottom: 0;\\n\\tbox-sizing: border-box;\\n}\\n\\n.sq-list-group-box-shadow {\\n\\tbox-shadow:1px 1px 5px rgba(0, 0, 0, 0.3);\\t\\n\\tborder-bottom-left-radius: .25rem;\\n\\tborder-bottom-right-radius: .25rem;\\n\\tborder-top-left-radius: .25rem;\\n\\tborder-top-right-radius: .25rem;\\t\\t\\n}\\n\\t\\n.sq-list-group-item\\t{\\n\\tposition: relative;\\n\\tdisplay: block;\\n\\tpadding: 0.75rem 1.25rem;\\n\\tbackground-color:  <<color background>>;\\n\\tborder: 1px solid rgba(0,0,0,.125);\\n\\twidth: 100%;\\n\\tcolor: #495057;\\n\\ttext-align:\\tinherit;\\t\\n\\tdisplay: flex;\\n\\tflex-direction: row;\\n\\tjustify-content: space-between!important;\\n\\talign-items: center!important;\\n\\tword-spacing: 0.1em;\\n}\\n\\n\\n.sq-list-group-item+.sq-list-group-item {\\n\\tborder-top-width: 0;\\n}\\n\\n.sq-list-group-item:first-child {\\n\\tborder-top-left-radius: .25rem;\\n\\tborder-top-right-radius: .25rem;\\n}\\n\\n.sq-list-group-item:last-child {\\n\\tborder-bottom-left-radius: .25rem;\\n\\tborder-bottom-right-radius: .25rem;\\n}\\n\\n.sq-list-stream-settings {\\n\\tfont-size: 90%;\\n}\\n\\ninput.sq-search-input {\\n    display: block;\\n    width: 100%;\\n    height: calc(1.5em + .75rem + 2px);\\n    padding: .375rem .75rem;\\n    font-size: 0.8rem;\\n    font-weight: 400;\\n    line-height: 1.5;\\n    color: #495057;\\n    background-color:  <<color background>>;\\n    background-clip: padding-box;\\n    border: 1px solid #ced4da;\\n    border-radius: .25rem;\\n    transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;\\n    margin-bottom: 0.75em;\\n}\\n\\ninput.sq-search-input:focus {\\ncolor: #495057;\\n    background-color:  <<color background>>;\\n    border-color: #80bdff;\\n    outline: 0;\\n    box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);\\n}\\n\"\n        },\n        \"$:/plugins/sq/streams/ui/templates/settings/input-switch\": {\n            \"title\": \"$:/plugins/sq/streams/ui/templates/settings/input-switch\",\n            \"text\": \"<label class=\\\"squi-form-label\\\"><$link tooltip={{!!description}}>{{!!caption}}</$link></label><$checkbox field=\\\"text\\\" checked=\\\"yes\\\" unchecked=\\\"no\\\" class=\\\"squi-form-switch\\\"/>\"\n        },\n        \"$:/plugins/sq/streams/ui/templates/settings/input\": {\n            \"title\": \"$:/plugins/sq/streams/ui/templates/settings/input\",\n            \"text\": \"<label class=\\\"squi-form-label\\\"><$link tooltip={{!!description}}>{{!!caption}}</$link></label>\\n<$edit-text tag=\\\"input\\\" class=\\\"squi-form-input\\\"/>\"\n        },\n        \"$:/plugins/sq/streams/ui/templates/settings/select\": {\n            \"title\": \"$:/plugins/sq/streams/ui/templates/settings/select\",\n            \"text\": \"<label class=\\\"squi-form-label\\\"><$link tooltip={{!!description}}>{{!!caption}}</$link></label>\\n<$vars cnt={{{[enlist{!!option-names}count[]]}}}>\\n<$select class=\\\"squi-form-select\\\">\\n<$list filter=\\\"[range<cnt>]\\\" variable=\\\"index\\\">\\n<option value={{{[enlist{!!option-values}nth<index>]}}}><$text text={{{[enlist{!!option-names}nth<index>]}}}/></option>\\n</$list>\\n</$select>\\n</$vars>\"\n        },\n        \"$:/plugins/sq/lib/swipeevents.js\": {\n            \"title\": \"$:/plugins/sq/lib/swipeevents.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/lib/swipeevents.js\\ntype: application/javascript\\nmodule-type: library\\nBased on https://github.com/john-doherty/swiped-events\\nhttps://github.com/umanghome/swipe-listener\\nhttps://github.com/scriptex/touchsweep/blob/master/src/touchsweep.js\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nexports.platforms = [\\\"browser\\\"];\\n\\nfunction SwipeEventsFactory(element,options) {\\n\\n\\tif(typeof window.CustomEvent !== 'function') {\\n\\t\\t\\n\\t\\twindow.CustomEvent = function (event, params) {\\n\\t\\t\\tparams = params || { bubbles: false, cancelable: false, detail: undefined };\\n\\t\\t\\tvar evt = document.createEvent('CustomEvent');\\n\\t\\t\\tevt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\\n\\t\\t\\treturn evt;\\n\\t\\t};\\n\\t\\twindow.CustomEvent.prototype = window.Event.prototype;\\n\\t}\\n\\t\\n\\tif(!element) {\\n\\t\\treturn;\\n\\t}\\n\\telement.addEventListener(\\\"touchstart\\\", handleTouchStart, false);\\n\\telement.addEventListener(\\\"touchmove\\\", handleTouchMove, false);\\n\\telement.addEventListener(\\\"touchend\\\", handleTouchEnd, false);\\n\\t\\n\\toptions = options || {};\\n\\t\\n\\tvar xDown = null,\\n\\t\\tyDown = null,\\n\\t\\txDiff = null,\\n\\t\\tyDiff = null,\\n\\t\\ttimeDown = null,\\n\\t\\tstartEl = null,\\n\\t\\tdefaults = {\\n\\t\\t\\t\\\"swipe-threshold\\\": 20,\\n\\t\\t\\t\\\"swipe-timeout\\\": 500\\n\\t\\t};\\n\\t\\t\\n\\t$tw.utils.extend(defaults,options);\\t\\n\\n\\t/**\\n\\t * Fires swiped event if swipe detected on touchend\\n\\t * @param {object} e - browser event object\\n\\t * @returns {void}\\n\\t */\\n\\tfunction handleTouchEnd(e) {\\n\\n\\t\\t// if the user released on a different target, cancel!\\n\\t\\tif (startEl !== e.target) return;\\n\\n\\t\\tvar swipeThreshold = parseInt(getNearestAttribute(startEl, 'data-swipe-threshold', defaults[\\\"swipe-threshold\\\"]), 10); // default 20px\\n\\t\\tvar swipeTimeout = parseInt(getNearestAttribute(startEl, 'data-swipe-timeout', defaults[\\\"swipe-timeout\\\"]), 10);\\t   // default 500ms\\n\\t\\tvar timeDiff = Date.now() - timeDown;\\n\\t\\tvar eventType = '';\\n\\t\\tvar changedTouches = e.changedTouches || e.touches || [];\\n\\n\\t\\tif (Math.abs(xDiff) > Math.abs(yDiff)) { // most significant\\n\\t\\t\\tif (Math.abs(xDiff) > swipeThreshold && timeDiff < swipeTimeout) {\\n\\t\\t\\t\\tif (xDiff > 0) {\\n\\t\\t\\t\\t\\teventType = 'swiped-left';\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\telse {\\n\\t\\t\\t\\t\\teventType = 'swiped-right';\\n\\t\\t\\t\\t}\\n\\t\\t\\t}\\n\\t\\t}\\n\\t\\telse if (Math.abs(yDiff) > swipeThreshold && timeDiff < swipeTimeout) {\\n\\t\\t\\tif (yDiff > 0) {\\n\\t\\t\\t\\teventType = 'swiped-up';\\n\\t\\t\\t}\\n\\t\\t\\telse {\\n\\t\\t\\t\\teventType = 'swiped-down';\\n\\t\\t\\t}\\n\\t\\t}\\n\\n\\t\\tif (eventType !== '') {\\n\\n\\t\\t\\tvar eventData = {\\n\\t\\t\\t\\tdir: eventType.replace(/swiped-/, ''),\\n\\t\\t\\t\\txStart: parseInt(xDown, 10),\\n\\t\\t\\t\\txEnd: parseInt((changedTouches[0] || {}).clientX || -1, 10),\\n\\t\\t\\t\\tyStart: parseInt(yDown, 10),\\n\\t\\t\\t\\tyEnd: parseInt((changedTouches[0] || {}).clientY || -1, 10)\\n\\t\\t\\t};\\n\\n\\t\\t\\t// fire `swiped` event event on the element that started the swipe\\n\\t\\t\\tstartEl.dispatchEvent(new CustomEvent('swiped', { bubbles: true, cancelable: true, detail: eventData }));\\n\\n\\t\\t\\t// fire `swiped-dir` event on the element that started the swipe\\n\\t\\t\\tstartEl.dispatchEvent(new CustomEvent(eventType, { bubbles: true, cancelable: true, detail: eventData }));\\n\\t\\t}\\n\\n\\t\\t// reset values\\n\\t\\txDown = null;\\n\\t\\tyDown = null;\\n\\t\\ttimeDown = null;\\n\\t}\\n\\n\\t/**\\n\\t * Records current location on touchstart event\\n\\t * @param {object} e - browser event object\\n\\t * @returns {void}\\n\\t */\\n\\tfunction handleTouchStart(e) {\\n\\n\\t\\t// if the element has data-swipe-ignore=\\\"true\\\" we stop listening for swipe events\\n\\t\\tif (e.target.getAttribute('data-swipe-ignore') === 'true') return;\\n\\n\\t\\tstartEl = e.target;\\n\\n\\t\\ttimeDown = Date.now();\\n\\t\\txDown = e.touches[0].clientX;\\n\\t\\tyDown = e.touches[0].clientY;\\n\\t\\txDiff = 0;\\n\\t\\tyDiff = 0;\\n\\t}\\n\\n\\t/**\\n\\t * Records location diff in px on touchmove event\\n\\t * @param {object} e - browser event object\\n\\t * @returns {void}\\n\\t */\\n\\tfunction handleTouchMove(e) {\\n\\n\\t\\tif (!xDown || !yDown) return;\\n\\n\\t\\tvar xUp = e.touches[0].clientX;\\n\\t\\tvar yUp = e.touches[0].clientY;\\n\\n\\t\\txDiff = xDown - xUp;\\n\\t\\tyDiff = yDown - yUp;\\n\\t}\\n\\n\\t/**\\n\\t * Gets attribute off HTML element or nearest parent\\n\\t * @param {object} el - HTML element to retrieve attribute from\\n\\t * @param {string} attributeName - name of the attribute\\n\\t * @param {any} defaultValue - default value to return if no match found\\n\\t * @returns {any} attribute value or defaultValue\\n\\t */\\n\\tfunction getNearestAttribute(el, attributeName, defaultValue) {\\n\\n\\t\\t// walk up the dom tree looking for data-action and data-trigger\\n\\t\\twhile (el && el !== document.documentElement) {\\n\\n\\t\\t\\tvar attributeValue = el.getAttribute(attributeName);\\n\\n\\t\\t\\tif (attributeValue) {\\n\\t\\t\\t\\treturn attributeValue;\\n\\t\\t\\t}\\n\\n\\t\\t\\tel = el.parentNode;\\n\\t\\t}\\n\\n\\t\\treturn defaultValue;\\n\\t}\\n};\\n\\nexports.SwipeEvents = SwipeEventsFactory;\\n\\n})();\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"library\",\n            \"Based on https\": \"//github.com/john-doherty/swiped-events\",\n            \"https\": \"//github.com/scriptex/touchsweep/blob/master/src/touchsweep.js\"\n        },\n        \"$:/plugins/sq/streams/action-unselect.js\": {\n            \"title\": \"$:/plugins/sq/streams/action-unselect.js\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/action-unselect.js\\ntype: application/javascript\\nmodule-type: widget\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\n\\nvar UnselectWidget = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\n/*\\nInherit from the base widget class\\n*/\\nUnselectWidget.prototype = new Widget();\\n\\n/*\\nRender this widget into the DOM\\n*/\\nUnselectWidget.prototype.render = function(parent,nextSibling) {\\n\\tthis.computeAttributes();\\n\\tthis.execute();\\n\\tthis.parentDomNode = parent;\\n\\tthis.renderChildren(parent,nextSibling);\\n};\\n\\n/*\\nCompute the internal state of the widget\\n*/\\nUnselectWidget.prototype.execute = function() {\\n\\tthis.makeChildWidgets();\\n};\\n\\n/*\\nRefresh the widget by ensuring our attributes are up to date\\n*/\\nUnselectWidget.prototype.refresh = function(changedTiddlers) {\\n\\treturn this.refreshChildren(changedTiddlers);\\n};\\n\\n/*\\nInvoke the action associated with this widget\\n*/\\nUnselectWidget.prototype.invokeAction = function(triggeringWidget,event) {\\n\\tif (window.getSelection) {\\n\\t\\twindow.getSelection().removeAllRanges();\\n\\t} else if (document.selection) {\\n\\t\\tdocument.selection.empty();\\n\\t}\\n\\treturn true;\\n};\\n\\nUnselectWidget.prototype.allowActionPropagation = function() {\\n\\treturn false;\\n};\\n\\nexports[\\\"action-unselect\\\"] = UnselectWidget;\\n\\n})();\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        },\n        \"$:/plugins/sq/streams/action-withinput.js\": {\n            \"title\": \"$:/plugins/sq/streams/action-withinput.js\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/action-withinput.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nPrompt user for input before executing actions contained inside the widget.\\nThe string entered by the user is available in the variable userInput in the actions contained in the widget.\\n\\nPrompt user for confirmation before executing actions contained inside the widget.\\nIf the user cancels, the actions are not executed.\\n\\nExample:\\n<$button>go\\n<$action-withinput message=\\\"What is your name?\\\" actions=\\\"\\\"\\\"<$action-setfield $tiddler=\\\"name\\\" $value=<<userInput>>/>\\\"\\\"\\\" />\\n</$button>\\n\\nParameters:\\nmessage : message to display\\ndefault: default value, defaults to an empty string\\n\\n\\n\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\n\\nvar WithInputWidget = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\n/*\\nInherit from the base widget class\\n*/\\nWithInputWidget.prototype = new Widget();\\n\\n/*\\nRender this widget into the DOM\\n*/\\nWithInputWidget.prototype.render = function(parent,nextSibling) {\\n\\tthis.computeAttributes();\\n\\tthis.execute();\\n\\tthis.parentDomNode = parent;\\n\\tthis.renderChildren(parent,nextSibling);\\n};\\n\\n/*\\nCompute the internal state of the widget\\n*/\\nWithInputWidget.prototype.execute = function() {\\n\\tthis.message = this.getAttribute(\\\"message\\\");\\n\\tthis.defaultValue = this.getAttribute(\\\"default\\\",\\\"\\\");\\n\\tthis.actions = this.getAttribute(\\\"actions\\\");\\n\\tthis.makeChildWidgets();\\n};\\n\\n/*\\nRefresh the widget by ensuring our attributes are up to date\\n*/\\nWithInputWidget.prototype.refresh = function(changedTiddlers) {\\n\\tvar changedAttributes = this.computeAttributes();\\n\\tif(changedAttributes[\\\"message\\\"] || changedAttributes[\\\"default\\\"] || changedAttributes[\\\"actions\\\"]) {\\n\\t\\tthis.refreshSelf();\\n\\t\\treturn true;\\n\\t}\\n\\treturn this.refreshChildren(changedTiddlers);\\n};\\n\\n/*\\nInvoke the action associated with this widget\\n*/\\nWithInputWidget.prototype.invokeAction = function(triggeringWidget,event) {\\n\\tif(this.message && this.actions) {\\n\\t\\tvar userData = prompt(this.message,this.defaultValue);\\n\\t\\tif(userData != null) {\\n\\t\\t\\tthis.setVariable(\\\"userInput\\\",userData);\\n\\t\\t\\tthis.invokeActionString(this.actions,this,event);\\n\\t\\t\\treturn true;\\n\\t\\t}\\n\\t}\\n};\\n\\nWithInputWidget.prototype.allowActionPropagation = function() {\\n\\treturn false;\\n};\\n\\nexports[\\\"action-withinput\\\"] = WithInputWidget;\\n\\n})();\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        },\n        \"$:/plugins/sq/streams/widgets/keyboard-plus.js\": {\n            \"title\": \"$:/plugins/sq/streams/widgets/keyboard-plus.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/widgets/keyboard-plus.js\\ntype: application/javascript\\nmodule-type: widget\\n\\\\*/\\n(function(){\\n\\t\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\n\\nvar KeyboardWidget = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\n/*\\nInherit from the base widget class\\n*/\\nKeyboardWidget.prototype = new Widget();\\n\\n/*\\nRender this widget into the DOM\\n*/\\nKeyboardWidget.prototype.render = function(parent,nextSibling) {\\n\\tvar self = this;\\n\\t// Remember parent\\n\\tthis.parentDomNode = parent;\\n\\t// Compute attributes and execute state\\n\\tthis.computeAttributes();\\n\\tthis.execute();\\n\\tvar tag = this.parseTreeNode.isBlock ? \\\"div\\\" : \\\"span\\\";\\n\\tif(this.tag && $tw.config.htmlUnsafeElements.indexOf(this.tag) === -1) {\\n\\t\\ttag = this.tag;\\n\\t}\\n\\t// Create element\\n\\tvar domNode = this.document.createElement(tag);\\n\\t// Assign classes\\n\\tvar classes = (this[\\\"class\\\"] || \\\"\\\").split(\\\" \\\");\\n\\tclasses.push(\\\"tc-keyboard\\\");\\n\\tdomNode.className = classes.join(\\\" \\\");\\n\\t\\n\\t\\n\\t// Add a keyboard event handler\\n\\tdomNode.addEventListener(\\\"keydown\\\",function (event) {\\n\\t\\t\\t// CM triggers two events\\n\\t\\t\\t// second event has:\\n\\t\\t\\t//\\t\\tdefaultPrevented : true\\n\\t\\t\\t//\\t\\tdetail: 0\\n\\t\\t\\t// \\t\\teventPhase 3 (instead of 2)\\n\\t\\t\\t// \\t\\tisComposing : false\\n\\t\\t\\tif(!event.defaultPrevented) {\\n\\t\\t\\t\\tvar key, action, preventDefault;\\n\\t\\t\\t\\tfor(var i=0; i<self.shortcutTiddlers.length; i++) {\\n\\t\\t\\t\\t\\tif(self.shortcutParsedList[i] !== undefined && $tw.keyboardManager.checkKeyDescriptors(event,self.shortcutParsedList[i])) {\\n\\t\\t\\t\\t\\t\\tkey = self.shortcutParsedList[i];\\n\\t\\t\\t\\t\\t\\taction = self.shortcutActionList[i];\\n\\t\\t\\t\\t\\t\\tpreventDefault = self.shortcutPreventDefaultList[i];\\n\\t\\t\\t\\t\\t\\tbreak;\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\tif(key !== undefined) {\\n\\t\\t\\t\\t\\tif(preventDefault) {\\n\\t\\t\\t\\t\\t\\tevent.preventDefault();\\n\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\tObject.defineProperty(event,\\\"sqHandled\\\",{value:true});\\n\\t\\t\\t\\t\\t//event.sqHandled = true;\\n\\t\\t\\t\\t\\tevent.stopPropagation();\\n\\t\\t\\t\\t\\t//event.stopImmediatePropagation();\\n\\t\\t\\t\\t\\tself.invokeActionString(action,self,event);\\n\\t\\t\\t\\t\\treturn true;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\\treturn false;\\n\\t\\t}\\n\\t},false);\\n\\t\\n\\t// Insert element\\n\\tparent.insertBefore(domNode,nextSibling);\\n\\tthis.renderChildren(domNode,null);\\n\\tthis.domNodes.push(domNode);\\t\\n}\\t\\n\\t\\nKeyboardWidget.prototype.execute = function() {\\n\\tvar self = this;\\n\\t// Get attributes\\n\\tthis.tag = this.getAttribute(\\\"tag\\\",\\\"\\\");\\n\\tthis[\\\"class\\\"] = this.getAttribute(\\\"class\\\",\\\"\\\");\\n\\tthis.shortcutTiddlerTag = this.getAttribute(\\\"shortcutTag\\\");\\n\\t//var keyInfoArray = [];\\n\\t\\n\\tthis.shortcutTiddlers = this.wiki.getTiddlersWithTag(this.shortcutTiddlerTag);\\n\\tthis.shortcutKeysList = [];\\n\\tthis.shortcutActionList = [];\\n\\tthis.shortcutParsedList = [];\\n\\tthis.shortcutPreventDefaultList = [];\\n\\t\\n\\tfor(var i=0; i<this.shortcutTiddlers.length; i++) {\\n\\t\\tvar title = this.shortcutTiddlers[i],\\n\\t\\t\\ttiddlerFields = this.wiki.getTiddler(title).fields;\\n\\t\\tthis.shortcutKeysList[i] = tiddlerFields.key !== undefined ? tiddlerFields.key : undefined;\\n\\t\\tthis.shortcutActionList[i] = tiddlerFields.text;\\n\\t\\tthis.shortcutPreventDefaultList[i] = tiddlerFields[\\\"prevent-default\\\"] && tiddlerFields[\\\"prevent-default\\\"] === \\\"no\\\" ? false : true;\\n\\t\\tthis.shortcutParsedList[i] = this.shortcutKeysList[i] !== undefined ? $tw.keyboardManager.parseKeyDescriptors(this.shortcutKeysList[i]) : undefined;\\n\\t}\\n\\t\\n\\t// Make child widgets\\n\\tthis.makeChildWidgets();\\n};\\n\\n/*\\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\\n*/\\nKeyboardWidget.prototype.refresh = function(changedTiddlers) {\\n\\t\\n\\tvar newList = this.wiki.getTiddlersWithTag(this.shortcutTiddlerTag)\\n\\tvar hasChanged = $tw.utils.hopArray(changedTiddlers,this.shortcutTiddlers) ? true :\\n\\t\\t($tw.utils.hopArray(changedTiddlers,newList) ? true :\\n\\t\\t($tw.keyboardManager.detectNewShortcuts(changedTiddlers))\\n\\t);\\n\\t// Re-cache shortcuts if something changed\\n\\tif(hasChanged) {\\n\\t//\\tthis.updateShortcutLists(newList);\\n\\t\\tthis.refreshSelf();\\n\\t\\treturn true;\\n\\t}\\n\\t\\n\\tvar changedAttributes = this.computeAttributes();\\n\\tif(changedAttributes[\\\"class\\\"] || changedAttributes.tag) {\\n\\t\\tthis.refreshSelf();\\n\\t\\treturn true;\\n\\t}\\n\\n\\treturn this.refreshChildren(changedTiddlers);\\n};\\n\\n\\nKeyboardWidget.prototype.invokeActionString = function(actions,triggeringWidget,event,variables) {\\n\\tif(!variables) {\\n\\t\\tvariables = {};\\n\\t}\\n\\t\\n\\tvar activeElement = document.activeElement;\\n\\tvar selection;\\n\\tif(activeElement && activeElement.tagName === \\\"IFRAME\\\") {\\n\\t\\tvar idoc = activeElement.contentDocument || activeElement.contentWindow.document;\\n\\t\\tactiveElement = idoc.activeElement;\\n\\t\\tselection = idoc.getSelection();\\n\\t} else {\\n\\t\\tselection = window.getSelection();\\n\\t}\\n\\n\\tif(window.CodeMirror && document.activeElement.closest(\\\".CodeMirror\\\")) {\\n\\t\\tvar cm = document.activeElement.closest(\\\".CodeMirror\\\").CodeMirror;\\n\\t\\tvar cursor = cm.getCursor(\\\"start\\\");\\n\\t\\tvar startRange = cm.getRange({\\\"line\\\":0,\\\"ch\\\":0},{\\\"line\\\":cursor.line,\\\"ch\\\":cursor.ch});\\n\\t\\tvar selectionStart = startRange.length;\\n\\t\\tvar selection = cm.getSelection();\\n\\t\\tvar selectionEnd = selectionStart + selection.length;\\n\\t\\t\\n\\t\\tvariables[\\\"selectionStart\\\"] = startRange.length.toString();\\n\\t\\tvariables[\\\"selectionEnd\\\"] = (selectionStart + selection.length).toString();\\n\\t\\tvariables[\\\"selection\\\"] = cm.getSelection().toString();\\n\\t} else if(activeElement && selection && ((activeElement.tagName === \\\"INPUT\\\" && activeElement.type === \\\"TEXT\\\") || activeElement.tagName === \\\"TEXTAREA\\\")) {\\n\\t\\tvariables[\\\"selectionStart\\\"] = activeElement.selectionStart.toString();\\n\\t\\tvariables[\\\"selectionEnd\\\"] = activeElement.selectionEnd.toString();\\n\\t\\tvariables[\\\"selection\\\"] = selection.toString();\\n\\t}\\n\\n\\t//this.selection_original_invokeActionString(actions,triggeringWidget,event,variables);\\n\\tObject.getPrototypeOf(Object.getPrototypeOf(this)).invokeActionString.call(this,actions,triggeringWidget,event,variables);\\n}\\n\\nexports[\\\"keyboard-plus\\\"] = KeyboardWidget;\\n\\n})();\\t\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        },\n        \"$:/plugins/sq/streams/streams-edit\": {\n            \"title\": \"$:/plugins/sq/streams/streams-edit\",\n            \"text\": \"/*\\\\\\n\\ntitle: $:/plugins/sq/streams/streams-edit\\ntype: application/javascript\\nmodule-type: widget-subclass\\n\\n\\\\*/\\n\\nexports.baseClass = \\\"edit\\\";\\nexports.name = \\\"streams-edit\\\";\\n\\nexports.constructor = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n}\\nexports.prototype = {};\\n\\nexports.prototype.getEditorType = function() {\\n\\tvar tiddler = this.wiki.getTiddler(this.editTitle);\\n\\tvar type = tiddler.fields.type || \\\"text/vnd.tiddlywiki\\\";\\n\\tvar editorType;\\n\\tif(type === \\\"text/vnd.tiddlywiki\\\") {\\n\\t\\teditorType = this.wiki.getTiddlerText(\\\"$:/config/sq/streams/editor-engine\\\");\\n\\t\\tif((!$tw.wiki.getTiddler(\\\"$:/plugins/tiddlywiki/codemirror\\\") || $tw.wiki.getTiddlerText(\\\"$:/config/Plugins/Disabled/$:/plugins/tiddlywiki/codemirror\\\",\\\"no\\\") === \\\"yes\\\" || !$tw.modules.titles[\\\"$:/plugins/tiddlywiki/codemirror/edit-codemirror.js\\\"]) && (editorType === \\\"codemirror\\\") ) {\\n\\t\\t\\teditorType = \\\"text\\\";\\n\\t\\t}\\n\\t\\treturn editorType;\\n\\t}\\n\\teditorType = this.wiki.getTiddlerText(EDITOR_MAPPING_PREFIX + type);\\n\\tif(!editorType) {\\n\\t\\tvar typeInfo = $tw.config.contentTypeInfo[type];\\n\\t\\tif(typeInfo && typeInfo.encoding === \\\"base64\\\") {\\n\\t\\t\\teditorType = \\\"binary\\\";\\n\\t\\t} else {\\n\\t\\t\\teditorType = \\\"text\\\";\\n\\t\\t}\\n\\t}\\n\\treturn editorType;\\n};\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget-subclass\"\n        },\n        \"$:/plugins/sq/streams/widgets/swiper.js\": {\n            \"title\": \"$:/plugins/sq/streams/widgets/swiper.js\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/sq/streams/widgets/swiper.js\\ntype: application/javascript\\nmodule-type: widget\\n\\nSwipe event handler widget\\n\\n\\\\*/\\n(function(){\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\\"use strict\\\";\\n\\nvar Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\n//var SwipeListener = require(\\\"$:/sq/lib/swipe-listener\\\");\\nvar SwipeEvents = require(\\\"$:/plugins/sq/lib/swipeevents.js\\\").SwipeEvents;\\n\\nvar SwipeWidget = function(parseTreeNode,options) {\\n\\tthis.initialise(parseTreeNode,options);\\n};\\n\\n/*\\nInherit from the base widget class\\n*/\\nSwipeWidget.prototype = new Widget();\\n\\n/*\\nRender this widget into the DOM\\n*/\\nSwipeWidget.prototype.render = function(parent,nextSibling) {\\n\\tvar self = this;\\n\\t// Remember parent\\n\\tthis.parentDomNode = parent;\\n\\t// Compute attributes and execute state\\n\\tthis.computeAttributes();\\n\\tthis.execute();\\n\\t// Create element\\n\\tvar tag = this.parseTreeNode.isBlock ? \\\"div\\\" : \\\"span\\\";\\n\\tif(this.swipeTag && $tw.config.htmlUnsafeElements.indexOf(this.swipeTag) === -1) {\\n\\t\\ttag = this.swipeTag;\\n\\t}\\t\\n\\tvar domNode = this.document.createElement(tag);\\n\\tif(this.swipeEnable) {\\n\\t\\tSwipeEvents(domNode,{\\\"swipe-threshold\\\": this.swipeThreshold});\\n\\t}\\n\\tparent.insertBefore(domNode,nextSibling);\\n\\tthis.renderChildren(domNode,null);\\n\\tthis.domNodes.push(domNode);\\n}\\n\\n/*\\nCompute the internal state of the widget\\n*/\\nSwipeWidget.prototype.execute = function() {\\n\\tvar self = this;\\n\\tthis.swipeThreshold = parseInt(this.getAttribute(\\\"swipethreshold\\\",\\\"100\\\"));\\n\\tthis.swipeEnable = this.getAttribute(\\\"enable\\\",\\\"yes\\\") === \\\"yes\\\";\\n\\tthis.swipeTag = this.getAttribute(\\\"tag\\\");\\n\\tthis.makeChildWidgets();\\n};\\n\\n/*\\nSelectively refreshes the widget if needed. Returns true if the widget or any of its children needed re-rendering\\n*/\\nSwipeWidget.prototype.refresh = function(changedTiddlers) {\\n\\tvar changedAttributes = this.computeAttributes();\\n\\tif($tw.utils.count(changedAttributes) > 0) {\\n\\t\\tthis.refreshSelf();\\n\\t\\treturn true;\\n\\t} else {\\n\\t\\treturn this.refreshChildren(changedTiddlers);\\n\\t}\\n};\\n\\nexports.swiper = SwipeWidget;\\n\\n})();\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        }\n    }\n}"
  },
  {
    "title": "$:/themes/tiddlywiki/snowwhite",
    "name": "Snow White",
    "author": "JeremyRuston",
    "core-version": ">=5.0.0",
    "plugin-type": "theme",
    "description": "Emphasises individual tiddlers",
    "dependents": "$:/themes/tiddlywiki/vanilla",
    "plugin-priority": "0",
    "version": "5.3.5",
    "type": "application/json",
    "text": "{\"tiddlers\":{\"$:/themes/tiddlywiki/snowwhite/base\":{\"title\":\"$:/themes/tiddlywiki/snowwhite/base\",\"tags\":\"[[$:/tags/Stylesheet]]\",\"text\":\"\\\\define sidebarbreakpoint-minus-one()\\n<$text text={{{ [{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}removesuffix[px]subtract[1]addsuffix[px]] ~[{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}] }}}/>\\n\\\\end\\n\\n\\\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline\\n\\n.tc-sidebar-header {\\n\\ttext-shadow: 0 1px 0 <<colour sidebar-foreground-shadow>>;\\n}\\n\\n.tc-tiddler-info {\\n\\t<<box-shadow \\\"inset 1px 2px 3px rgba(0,0,0,0.1)\\\">>\\n}\\n\\n@media screen {\\n\\t.tc-tiddler-frame {\\n\\t\\t<<box-shadow \\\"1px 1px 5px rgba(0, 0, 0, 0.3)\\\">>\\n\\t}\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\t.tc-tiddler-frame {\\n\\t\\t<<box-shadow none>>\\n\\t}\\n}\\n\\n.tc-page-controls button svg, .tc-tiddler-controls button svg, .tc-topbar button svg {\\n\\t<<transition \\\"fill 150ms ease-in-out\\\">>\\n}\\n\\n.tc-tiddler-controls button.tc-selected,\\n.tc-page-controls button.tc-selected {\\n\\t<<filter \\\"drop-shadow(0px -1px 2px rgba(0,0,0,0.25))\\\">>\\n}\\n\\n.tc-tiddler-frame input.tc-edit-texteditor,\\n.tc-tiddler-frame select.tc-edit-texteditor {\\n\\t<<box-shadow \\\"inset 0 1px 8px rgba(0, 0, 0, 0.15)\\\">>\\n}\\n\\n.tc-edit-tags {\\n\\t<<box-shadow \\\"inset 0 1px 8px rgba(0, 0, 0, 0.15)\\\">>\\n}\\n\\n.tc-tiddler-frame .tc-edit-tags input.tc-edit-texteditor {\\n\\t<<box-shadow \\\"none\\\">>\\n\\tborder: none;\\n\\toutline: none;\\n}\\n\\ntextarea.tc-edit-texteditor {\\n\\tfont-family: {{$:/themes/tiddlywiki/vanilla/settings/editorfontfamily}};\\n}\\n\\ncanvas.tc-edit-bitmapeditor  {\\n\\t<<box-shadow \\\"2px 2px 5px rgba(0, 0, 0, 0.5)\\\">>\\n}\\n\\n.tc-drop-down {\\n\\tborder-radius: 4px;\\n\\t<<box-shadow \\\"2px 2px 10px rgba(0, 0, 0, 0.5)\\\">>\\n}\\n\\n.tc-block-dropdown {\\n\\tborder-radius: 4px;\\n\\t<<box-shadow \\\"2px 2px 10px rgba(0, 0, 0, 0.5)\\\">>\\n}\\n\\n.tc-modal {\\n\\tborder-radius: 6px;\\n\\t<<box-shadow \\\"0 3px 7px rgba(0,0,0,0.3)\\\">>\\n}\\n\\n.tc-modal-footer {\\n\\tborder-radius: 0 0 6px 6px;\\n\\t<<box-shadow \\\"inset 0 1px 0 #fff\\\">>;\\n}\\n\\n\\n.tc-alert {\\n\\tborder-radius: 6px;\\n\\t<<box-shadow \\\"0 3px 7px rgba(0,0,0,0.6)\\\">>\\n}\\n\\n.tc-notification {\\n\\tborder-radius: 6px;\\n\\t<<box-shadow \\\"0 3px 7px rgba(0,0,0,0.3)\\\">>\\n\\ttext-shadow: 0 1px 0 rgba(255,255,255, 0.8);\\n}\\n\\n.tc-sidebar-lists .tc-tab-set .tc-tab-divider {\\n\\tborder-top: none;\\n\\theight: 1px;\\n\\t<<background-linear-gradient \\\"left, rgba(0,0,0,0.15) 0%, rgba(0,0,0,0.0) 100%\\\">>\\n}\\n\\n.tc-more-sidebar > .tc-tab-set > .tc-tab-buttons > button {\\n\\t<<background-linear-gradient \\\"left, rgba(0,0,0,0.01) 0%, rgba(0,0,0,0.1) 100%\\\">>\\n}\\n\\n.tc-more-sidebar > .tc-tab-set > .tc-tab-buttons > button.tc-tab-selected {\\n\\t<<background-linear-gradient \\\"left, rgba(0,0,0,0.05) 0%, rgba(255,255,255,0.05) 100%\\\">>\\n}\\n\\n.tc-message-box img {\\n\\t<<box-shadow \\\"1px 1px 3px rgba(0,0,0,0.5)\\\">>\\n}\\n\\n.tc-plugin-info {\\n\\t<<box-shadow \\\"1px 1px 3px rgba(0,0,0,0.5)\\\">>\\n}\\n\"}}}"
  },
  {
    "title": "$:/themes/tiddlywiki/vanilla",
    "name": "Vanilla",
    "author": "JeremyRuston",
    "core-version": ">=5.0.0",
    "plugin-type": "theme",
    "description": "Basic theme",
    "plugin-priority": "0",
    "version": "5.3.5",
    "dependents": "",
    "type": "application/json",
    "text": "{\"tiddlers\":{\"$:/themes/tiddlywiki/vanilla/themetweaks\":{\"title\":\"$:/themes/tiddlywiki/vanilla/themetweaks\",\"tags\":\"$:/tags/ControlPanel/Appearance\",\"caption\":\"{{$:/language/ThemeTweaks/ThemeTweaks}}\",\"text\":\"\\\\define lingo-base() $:/language/ThemeTweaks/\\n\\n\\\\define replacement-text()\\n[img[$(imageTitle)$]]\\n\\\\end\\n\\n\\\\define backgroundimage-dropdown()\\n<div class=\\\"tc-drop-down-wrapper\\\">\\n<$set name=\\\"state\\\" value=<<qualify \\\"$:/state/popup/themetweaks/backgroundimage\\\">>>\\n<$button popup=<<state>> class=\\\"tc-btn-invisible tc-btn-dropdown\\\">{{$:/core/images/down-arrow}}</$button>\\n<$reveal state=<<state>> type=\\\"popup\\\" position=\\\"belowleft\\\" text=\\\"\\\" default=\\\"\\\" class=\\\"tc-popup-keep\\\">\\n<div class=\\\"tc-drop-down\\\" style=\\\"text-align:center;\\\">\\n<$macrocall $name=\\\"image-picker\\\" actions=\\\"\\\"\\\"\\n\\n<$action-setfield\\n\\t$tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimage\\\"\\n\\t$value=<<imageTitle>>\\n/>\\n\\n<$action-deletetiddler $tiddler=<<state>>/>\\n\\n\\\"\\\"\\\"/>\\n</div>\\n</$reveal>\\n</$set>\\n</div>\\n\\\\end\\n\\n\\\\define backgroundimageattachment-dropdown()\\n<$select tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimageattachment\\\" default=\\\"scroll\\\">\\n<option value=\\\"scroll\\\"><<lingo Settings/BackgroundImageAttachment/Scroll>></option>\\n<option value=\\\"fixed\\\"><<lingo Settings/BackgroundImageAttachment/Fixed>></option>\\n</$select>\\n\\\\end\\n\\n\\\\define backgroundimagesize-dropdown()\\n<$select tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize\\\" default=\\\"scroll\\\">\\n<option value=\\\"auto\\\"><<lingo Settings/BackgroundImageSize/Auto>></option>\\n<option value=\\\"cover\\\"><<lingo Settings/BackgroundImageSize/Cover>></option>\\n<option value=\\\"contain\\\"><<lingo Settings/BackgroundImageSize/Contain>></option>\\n</$select>\\n\\\\end\\n\\n<<lingo ThemeTweaks/Hint>>\\n\\n! <<lingo Options>>\\n\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/options/sidebarlayout\\\"><<lingo Options/SidebarLayout>></$link> |<$select tiddler=\\\"$:/themes/tiddlywiki/vanilla/options/sidebarlayout\\\"><option value=\\\"fixed-fluid\\\"><<lingo Options/SidebarLayout/Fixed-Fluid>></option><option value=\\\"fluid-fixed\\\"><<lingo Options/SidebarLayout/Fluid-Fixed>></option></$select> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/options/stickytitles\\\"><<lingo Options/StickyTitles>></$link><br>//<<lingo Options/StickyTitles/Hint>>// |<$select tiddler=\\\"$:/themes/tiddlywiki/vanilla/options/stickytitles\\\"><option value=\\\"no\\\">{{$:/language/No}}</option><option value=\\\"yes\\\">{{$:/language/Yes}}</option></$select> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/options/codewrapping\\\"><<lingo Options/CodeWrapping>></$link> |<$select tiddler=\\\"$:/themes/tiddlywiki/vanilla/options/codewrapping\\\"><option value=\\\"pre\\\">{{$:/language/No}}</option><option value=\\\"pre-wrap\\\">{{$:/language/Yes}}</option></$select> |\\n\\n! <<lingo Settings>>\\n\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/settings/fontfamily\\\"><<lingo Settings/FontFamily>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/fontfamily\\\" default=\\\"\\\" tag=\\\"input\\\"/> | |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/settings/codefontfamily\\\"><<lingo Settings/CodeFontFamily>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/codefontfamily\\\" default=\\\"\\\" tag=\\\"input\\\"/> | |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/settings/editorfontfamily\\\"><<lingo Settings/EditorFontFamily>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/editorfontfamily\\\" default=\\\"\\\" tag=\\\"input\\\"/> | |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimage\\\"><<lingo Settings/BackgroundImage>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimage\\\" default=\\\"\\\" tag=\\\"input\\\"/> |<<backgroundimage-dropdown>> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimageattachment\\\"><<lingo Settings/BackgroundImageAttachment>></$link> |<<backgroundimageattachment-dropdown>> | |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize\\\"><<lingo Settings/BackgroundImageSize>></$link> |<<backgroundimagesize-dropdown>> | |\\n\\n! <<lingo Metrics>>\\n\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/fontsize\\\"><<lingo Metrics/FontSize>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/fontsize\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/lineheight\\\"><<lingo Metrics/LineHeight>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/lineheight\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize\\\"><<lingo Metrics/BodyFontSize>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/bodylineheight\\\"><<lingo Metrics/BodyLineHeight>></$link> |<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/bodylineheight\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/storyleft\\\"><<lingo Metrics/StoryLeft>></$link><br>//<<lingo Metrics/StoryLeft/Hint>>// |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/storyleft\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/storytop\\\"><<lingo Metrics/StoryTop>></$link><br>//<<lingo Metrics/StoryTop/Hint>>// |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/storytop\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/storyright\\\"><<lingo Metrics/StoryRight>></$link><br>//<<lingo Metrics/StoryRight/Hint>>// |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/storyright\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/storywidth\\\"><<lingo Metrics/StoryWidth>></$link><br>//<<lingo Metrics/StoryWidth/Hint>>// |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/storywidth\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth\\\"><<lingo Metrics/TiddlerWidth>></$link><br>//<<lingo Metrics/TiddlerWidth/Hint>>//<br> |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint\\\"><<lingo Metrics/SidebarBreakpoint>></$link><br>//<<lingo Metrics/SidebarBreakpoint/Hint>>// |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n|<$link to=\\\"$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth\\\"><<lingo Metrics/SidebarWidth>></$link><br>//<<lingo Metrics/SidebarWidth/Hint>>// |^<$edit-text tiddler=\\\"$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth\\\" default=\\\"\\\" tag=\\\"input\\\"/> |\\n\"},\"$:/themes/tiddlywiki/vanilla/base\":{\"title\":\"$:/themes/tiddlywiki/vanilla/base\",\"tags\":\"[[$:/tags/Stylesheet]]\",\"list-before\":\"\",\"code-body\":\"yes\",\"text\":\"\\\\define custom-background-datauri()\\n<$set name=\\\"background\\\" value={{$:/themes/tiddlywiki/vanilla/settings/backgroundimage}}>\\n<$list filter=\\\"[<background>is[image]]\\\">\\n`background: url(`\\n<$list filter=\\\"[<background>!has[_canonical_uri]]\\\">\\n`\\\"`<$macrocall $name=\\\"datauri\\\" title={{$:/themes/tiddlywiki/vanilla/settings/backgroundimage}}/>`\\\"`\\n</$list>\\n<$list filter=\\\"[<background>has[_canonical_uri]]\\\">\\n`\\\"`<$view tiddler={{$:/themes/tiddlywiki/vanilla/settings/backgroundimage}} field=\\\"_canonical_uri\\\"/>`\\\"`\\n</$list>\\n`) center center;`\\n`background-attachment: `{{$:/themes/tiddlywiki/vanilla/settings/backgroundimageattachment}}`;\\n-webkit-background-size:` {{$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize}}`;\\n-moz-background-size:` {{$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize}}`;\\n-o-background-size:` {{$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize}}`;\\nbackground-size:` {{$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize}}`;`\\n</$list>\\n</$set>\\n\\\\end\\n\\n\\\\define sidebarbreakpoint()\\n<$text text={{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}}/>\\n\\\\end\\n\\n\\\\define sidebarbreakpoint-minus-one()\\n<$text text={{{ [{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}removesuffix[px]subtract[1]addsuffix[px]] ~[{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}] }}}/>\\n\\\\end\\n\\n\\\\define if-fluid-fixed(text,hiddenSidebarText)\\n<$reveal state=\\\"$:/themes/tiddlywiki/vanilla/options/sidebarlayout\\\" type=\\\"match\\\" text=\\\"fluid-fixed\\\">\\n$text$\\n<$reveal state=\\\"$:/state/sidebar\\\" type=\\\"nomatch\\\" text=\\\"yes\\\" default=\\\"yes\\\">\\n$hiddenSidebarText$\\n</$reveal>\\n</$reveal>\\n\\\\end\\n\\n\\\\define if-editor-height-fixed(then,else)\\n<$reveal state=\\\"$:/config/TextEditor/EditorHeight/Mode\\\" type=\\\"match\\\" text=\\\"fixed\\\">\\n$then$\\n</$reveal>\\n<$reveal state=\\\"$:/config/TextEditor/EditorHeight/Mode\\\" type=\\\"match\\\" text=\\\"auto\\\">\\n$else$\\n</$reveal>\\n\\\\end\\n\\n\\\\define set-type-selector-min-width()\\n<$set name=\\\"typeLength\\\" value={{{ [all[shadows+tiddlers]prefix[$:/language/Docs/Types/]get[name]length[]maxall[]] }}}>\\n\\n\\t.tc-type-selector-dropdown-wrapper {\\n\\t\\tmin-width: calc(<<typeLength>>ch + 4em);\\n\\t}\\n\\n\\t.tc-type-selector-dropdown-wrapper input.tc-edit-typeeditor {\\n\\t\\tmin-width: <<typeLength>>ch;\\n\\t}\\n\\n</$set>\\n\\\\end\\n\\n\\\\rules only filteredtranscludeinline transcludeinline macrodef macrocallinline macrocallblock\\n\\n/*\\n** Start with the normalize CSS reset, and then belay some of its effects\\n*/\\n\\n{{$:/themes/tiddlywiki/vanilla/reset}}\\n\\n*, input[type=\\\"search\\\"] {\\n\\tbox-sizing: border-box;\\n\\t-moz-box-sizing: border-box;\\n\\t-webkit-box-sizing: border-box;\\n}\\n\\n/*\\n** Button default styles. Makes them look consistent for all browsers\\n*/\\nhtml button {\\n\\tline-height: 1.2;\\n\\tcolor: <<colour button-foreground>>;\\n\\tfill: <<colour button-foreground>>;\\n\\tbackground: <<colour button-background>>;\\n\\tborder-color: <<colour button-border>>;\\n}\\n\\nbutton:disabled svg {\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n/*\\n** Basic element styles\\n*/\\n\\nhtml, body {\\n\\tfont-family: {{$:/themes/tiddlywiki/vanilla/settings/fontfamily}};\\n\\ttext-rendering: optimizeLegibility; /* Enables kerning and ligatures etc. */\\n\\t-webkit-font-smoothing: antialiased;\\n\\t-moz-osx-font-smoothing: grayscale;\\n}\\n\\nhtml:-webkit-full-screen {\\n\\tbackground-color: <<colour page-background>>;\\n}\\n\\nbody.tc-body {\\n\\tfont-size: {{$:/themes/tiddlywiki/vanilla/metrics/fontsize}};\\n\\tline-height: {{$:/themes/tiddlywiki/vanilla/metrics/lineheight}};\\n\\tword-wrap: break-word;\\n\\t<<custom-background-datauri>>\\n\\tcolor: <<colour foreground>>;\\n\\tbackground-color: <<colour page-background>>;\\n\\tfill: <<colour foreground>>;\\n}\\n\\n<<if-background-attachment \\\"\\\"\\\"\\n\\nbody.tc-body {\\n\\tbackground-color: transparent;\\n}\\n\\n\\\"\\\"\\\">>\\n\\n/**\\n * Correct the font size and margin on `h1` elements within `section` and\\n * `article` contexts in Chrome, Firefox, and Safari.\\n */\\n\\nh1 {\\n\\tfont-size: 2em;\\n}\\n\\nh1, h2, h3, h4, h5, h6 {\\n\\tline-height: 1.2;\\n\\tfont-weight: normal;\\n}\\n\\npre {\\n\\tdisplay: block;\\n\\tmargin-top: 1em;\\n\\tmargin-bottom: 1em;\\n\\tword-break: normal;\\n\\tword-wrap: break-word;\\n\\twhite-space: {{$:/themes/tiddlywiki/vanilla/options/codewrapping}};\\n\\tbackground-color: <<colour pre-background>>;\\n\\tborder: 1px solid <<colour pre-border>>;\\n\\tpadding: 0 3px 2px;\\n\\tborder-radius: 3px;\\n\\tfont-family: {{$:/themes/tiddlywiki/vanilla/settings/codefontfamily}};\\n}\\n\\ncode {\\n\\tcolor: <<colour code-foreground>>;\\n\\tbackground-color: <<colour code-background>>;\\n\\tborder: 1px solid <<colour code-border>>;\\n\\twhite-space: {{$:/themes/tiddlywiki/vanilla/options/codewrapping}};\\n\\tpadding: 0 3px 2px;\\n\\tborder-radius: 3px;\\n\\tfont-family: {{$:/themes/tiddlywiki/vanilla/settings/codefontfamily}};\\n}\\n\\nblockquote {\\n\\tborder-left: 5px solid <<colour blockquote-bar>>;\\n\\tmargin-left: 25px;\\n\\tpadding-left: 10px;\\n\\tquotes: \\\"\\\\201C\\\"\\\"\\\\201D\\\"\\\"\\\\2018\\\"\\\"\\\\2019\\\";\\n}\\n\\nblockquote > div {\\n\\tmargin-top: 1em;\\n\\tmargin-bottom: 1em;\\n}\\n\\nblockquote.tc-big-quote {\\n\\tfont-family: Georgia, serif;\\n\\tposition: relative;\\n\\tbackground: <<colour pre-background>>;\\n\\tborder-left: none;\\n\\tmargin-left: 50px;\\n\\tmargin-right: 50px;\\n\\tpadding: 10px;\\n\\tborder-radius: 8px;\\n}\\n\\nblockquote.tc-big-quote cite:before {\\n\\tcontent: \\\"\\\\2014 \\\\2009\\\";\\n}\\n\\nblockquote.tc-big-quote:before {\\n\\tfont-family: Georgia, serif;\\n\\tcolor: <<colour blockquote-bar>>;\\n\\tcontent: open-quote;\\n\\tfont-size: 8em;\\n\\tline-height: 0.1em;\\n\\tmargin-right: 0.25em;\\n\\tvertical-align: -0.4em;\\n\\tposition: absolute;\\n\\tleft: -50px;\\n\\ttop: 42px;\\n}\\n\\nblockquote.tc-big-quote:after {\\n\\tfont-family: Georgia, serif;\\n\\tcolor: <<colour blockquote-bar>>;\\n\\tcontent: close-quote;\\n\\tfont-size: 8em;\\n\\tline-height: 0.1em;\\n\\tmargin-right: 0.25em;\\n\\tvertical-align: -0.4em;\\n\\tposition: absolute;\\n\\tright: -80px;\\n\\tbottom: -20px;\\n}\\n\\ndl dt {\\n\\tfont-weight: bold;\\n\\tmargin-top: 6px;\\n}\\n\\ntextarea,\\ninput[type=text],\\ninput[type=search],\\ninput[type=\\\"\\\"],\\ninput:not([type]) {\\n\\tcolor: <<colour foreground>>;\\n\\tbackground: <<colour background>>;\\n}\\n\\ninput[type=\\\"checkbox\\\"] {\\n\\tvertical-align: middle;\\n}\\n\\ninput[type=\\\"search\\\"]::-webkit-search-decoration,\\ninput[type=\\\"search\\\"]::-webkit-search-cancel-button,\\ninput[type=\\\"search\\\"]::-webkit-search-results-button,\\ninput[type=\\\"search\\\"]::-webkit-search-results-decoration {\\n\\t-webkit-appearance:none;\\n}\\n\\n.tc-muted {\\n\\tcolor: <<colour muted-foreground>>;\\n}\\n\\nsvg.tc-image-button {\\n\\tpadding: 0px 1px 1px 0px;\\n}\\n\\n.tc-icon-wrapper > svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n}\\n\\nkbd {\\n\\tdisplay: inline-block;\\n\\tpadding: 3px 5px;\\n\\tfont-size: 0.8em;\\n\\tline-height: 1.2;\\n\\tcolor: <<colour foreground>>;\\n\\tvertical-align: middle;\\n\\tbackground-color: <<colour background>>;\\n\\tborder: solid 1px <<colour muted-foreground>>;\\n\\tborder-bottom-color: <<colour muted-foreground>>;\\n\\tborder-radius: 3px;\\n\\tbox-shadow: inset 0 -1px 0 <<colour muted-foreground>>;\\n}\\n\\n::selection {\\n\\tbackground-color: Highlight;\\n\\tcolor: HighlightText;\\n\\tbackground-color: <<colour selection-background>>;\\n\\tcolor: <<colour selection-foreground>>;\\n}\\n\\n.tc-inline-style {\\n\\tbackground: <<colour highlight-background>>;\\n\\tcolor: <<colour highlight-foreground>>;\\n}\\n\\nform.tc-form-inline {\\n\\tdisplay: inline;\\n}\\n\\n/*\\nMarkdown likes putting code elements inside pre elements\\n*/\\npre > code {\\n\\tpadding: 0;\\n\\tborder: none;\\n\\tbackground-color: inherit;\\n\\tcolor: inherit;\\n}\\n\\n/*\\nTable defaults\\n*/\\n\\ntable {\\n\\tborder: 1px solid <<colour table-border>>;\\n\\twidth: auto;\\n\\tmax-width: 100%;\\n\\tcaption-side: bottom;\\n\\tmargin-top: 1em;\\n\\tmargin-bottom: 1em;\\n\\t/* next 2 elements needed, since normalize 8.0.1 */\\n\\tborder-collapse: collapse;\\n\\tborder-spacing: 0;\\n}\\n\\ntable th, table td {\\n\\tpadding: 0 7px 0 7px;\\n\\tborder-top: 1px solid <<colour table-border>>;\\n\\tborder-left: 1px solid <<colour table-border>>;\\n}\\n\\ntable thead tr td, table th {\\n\\tbackground-color: <<colour table-header-background>>;\\n\\tfont-weight: bold;\\n}\\n\\ntable tfoot tr td {\\n\\tbackground-color: <<colour table-footer-background>>;\\n}\\n\\n/*\\nTable utility classes\\n*/\\n\\n/* Remove borders from table as used in eg: GettingStarted*/\\n.tc-table-no-border,\\n.tc-table-no-border th,\\n.tc-table-no-border td {\\n\\tborder: initial;\\n}\\n\\n/* First column in table width will fit to text.*/\\n/* This rule makes most sense with tc-first-link-nowrap*/\\n.tc-first-col-min-width td:nth-child(1) {\\n\\twidth: 1%;\\n}\\n\\n/*\\n** Utility classes work well with tables but also for other containers\\n*/\\n\\n/* First link A element will not wrap */\\n.tc-first-link-nowrap:first-of-type a {\\n\\twhite-space: nowrap;\\n}\\n\\n/* Move the table to the center of the container */\\n.tc-center {\\n\\tmargin-left: auto;\\n\\tmargin-right: auto;\\n}\\n\\n.tc-max-width {\\n\\twidth: 100%;\\n}\\n\\n.tc-max-width-80 {\\n\\tmax-width: 80%;\\n}\\n\\n/* Allow input and textarea to look like the ControlPanel inputs */\\n.tc-edit-max-width input,\\n.tc-edit-max-width textarea {\\n\\twidth: 100%;\\n\\tpadding: 3px;\\n}\\n\\n/*\\nCSV parser plugin\\n*/\\n\\n.tc-csv-table {\\n\\twhite-space: nowrap;\\n}\\n\\n.tc-csv-table th,\\n.tc-csv-table td {\\n\\twhite-space: pre-line;\\n}\\n\\n/*\\nTiddler frame in story river\\n*/\\n\\n.tc-tiddler-frame img,\\n.tc-tiddler-frame svg,\\n.tc-tiddler-frame canvas,\\n.tc-tiddler-frame embed,\\n.tc-tiddler-frame iframe {\\n\\tmax-width: 100%;\\n}\\n\\n.tc-tiddler-body > embed,\\n.tc-tiddler-body > iframe {\\n\\twidth: 100%;\\n\\theight: 600px;\\n}\\n\\n:root {\\n\\tcolor-scheme: {{{ [{$:/palette}get[color-scheme]] ~light }}};\\n}\\n\\n/*\\n** Links\\n*/\\n\\nbutton.tc-tiddlylink,\\na.tc-tiddlylink {\\n\\ttext-decoration: none;\\n\\tfont-weight: 500;\\n\\tcolor: <<colour tiddler-link-foreground>>;\\n\\t-webkit-user-select: inherit; /* Otherwise the draggable attribute makes links impossible to select */\\n\\t-webkit-touch-callout: none; /* Prevents long presses from bringing up a link preview */\\n}\\n\\n.tc-sidebar-lists a.tc-tiddlylink {\\n\\tcolor: <<colour sidebar-tiddler-link-foreground>>;\\n}\\n\\n.tc-sidebar-lists a.tc-tiddlylink:hover {\\n\\tcolor: <<colour sidebar-tiddler-link-foreground-hover>>;\\n}\\n\\nbutton.tc-tiddlylink:hover,\\na.tc-tiddlylink:hover {\\n\\ttext-decoration: underline;\\n}\\n\\na.tc-tiddlylink-resolves {\\n}\\n\\na.tc-tiddlylink-shadow {\\n\\tfont-weight: bold;\\n}\\n\\na.tc-tiddlylink-shadow.tc-tiddlylink-resolves {\\n\\tfont-weight: normal;\\n}\\n\\na.tc-tiddlylink-missing {\\n\\tfont-style: italic;\\n}\\n\\na.tc-tiddlylink-external {\\n\\ttext-decoration: underline;\\n\\tcolor: <<colour external-link-foreground>>;\\n\\tbackground-color: <<colour external-link-background>>;\\n}\\n\\na.tc-tiddlylink-external:visited {\\n\\tcolor: <<colour external-link-foreground-visited>>;\\n\\tbackground-color: <<colour external-link-background-visited>>;\\n}\\n\\na.tc-tiddlylink-external:hover {\\n\\tcolor: <<colour external-link-foreground-hover>>;\\n\\tbackground-color: <<colour external-link-background-hover>>;\\n}\\n\\n.tc-drop-down a.tc-tiddlylink:hover {\\n\\tcolor: <<colour tiddler-link-background>>;\\n}\\n\\n/*\\n** Drag and drop styles\\n*/\\n\\n.tc-tiddler-dragger {\\n\\tposition: relative;\\n\\tz-index: -10000;\\n}\\n\\n.tc-tiddler-dragger-inner {\\n\\tposition: absolute;\\n\\ttop: -1000px;\\n\\tleft: -1000px;\\n\\tdisplay: inline-block;\\n\\tpadding: 8px 20px;\\n\\tfont-size: 16.9px;\\n\\tfont-weight: bold;\\n\\tline-height: 20px;\\n\\tcolor: <<colour dragger-foreground>>;\\n\\ttext-shadow: 0 1px 0 rgba(0, 0, 0, 1);\\n\\twhite-space: nowrap;\\n\\tvertical-align: baseline;\\n\\tbackground-color: <<colour dragger-background>>;\\n\\tborder-radius: 20px;\\n}\\n\\n.tc-tiddler-dragger-cover {\\n\\tposition: absolute;\\n\\tbackground-color: <<colour page-background>>;\\n}\\n\\n.tc-page-container > .tc-dropzone {\\n\\tmin-height: 100vh;\\n}\\n\\n.tc-dropzone {\\n\\tposition: relative;\\n}\\n\\n.tc-dropzone.tc-dragover:before {\\n\\tz-index: 10000;\\n\\tdisplay: block;\\n\\tposition: fixed;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbackground: <<colour dropzone-background>>;\\n\\ttext-align: center;\\n\\tcontent: \\\"<<lingo DropMessage>>\\\";\\n}\\n\\n.tc-droppable > .tc-droppable-placeholder {\\n\\tdisplay: none;\\n}\\n\\n.tc-droppable.tc-dragover > .tc-droppable-placeholder {\\n\\tdisplay: block;\\n\\tborder: 2px dashed <<colour dropzone-background>>;\\n}\\n\\n.tc-draggable {\\n\\tcursor: move;\\n}\\n\\n.tc-sidebar-tab-open .tc-droppable-placeholder, .tc-tagged-draggable-list .tc-droppable-placeholder,\\n.tc-links-draggable-list .tc-droppable-placeholder {\\n\\tline-height: 2em;\\n\\theight: 2em;\\n}\\n\\n.tc-sidebar-tab-open-item {\\n\\tposition: relative;\\n}\\n\\n.tc-sidebar-tab-open .tc-btn-invisible.tc-btn-mini svg {\\n\\tfont-size: 0.7em;\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n/*\\n** Plugin reload warning\\n*/\\n\\n.tc-plugin-reload-warning {\\n\\tz-index: 1000;\\n\\tdisplay: block;\\n\\tposition: fixed;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbackground: <<colour alert-background>>;\\n\\ttext-align: center;\\n}\\n\\n/*\\n** Buttons\\n*/\\n\\nbutton svg, button img, label svg, label img {\\n\\tvertical-align: middle;\\n}\\n\\n.tc-btn-invisible {\\n\\tpadding: 0;\\n\\tmargin: 0;\\n\\tbackground: none;\\n\\tborder: none;\\n\\tcursor: pointer;\\n\\tcolor: <<colour foreground>>;\\n\\tfill: <<colour foreground>>;\\n}\\n\\nbutton:disabled.tc-btn-invisible  {\\n\\tcursor: default;\\n\\tcolor: <<colour muted-foreground>>;\\n}\\n\\n.tc-btn-boxed {\\n\\tfont-size: 0.6em;\\n\\tpadding: 0.2em;\\n\\tmargin: 1px;\\n\\tbackground: none;\\n\\tborder: 1px solid <<colour tiddler-controls-foreground>>;\\n\\tborder-radius: 0.25em;\\n}\\n\\nhtml body.tc-body .tc-btn-boxed svg {\\n\\tfont-size: 1.6666em;\\n}\\n\\n.tc-btn-boxed:hover {\\n\\tbackground: <<colour muted-foreground>>;\\n\\tcolor: <<colour background>>;\\n}\\n\\nhtml body.tc-body .tc-btn-boxed:hover svg {\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-btn-rounded {\\n\\tfont-size: 0.5em;\\n\\tline-height: 2;\\n\\tpadding: 0em 0.3em 0.2em 0.4em;\\n\\tmargin: 1px;\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tbackground: <<colour muted-foreground>>;\\n\\tcolor: <<colour background>>;\\n\\tborder-radius: 2em;\\n}\\n\\nhtml body.tc-body .tc-btn-rounded svg {\\n\\tfont-size: 1.6666em;\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-btn-rounded:hover {\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tbackground: <<colour background>>;\\n\\tcolor: <<colour muted-foreground>>;\\n}\\n\\nhtml body.tc-body .tc-btn-rounded:hover svg {\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n.tc-btn-icon svg {\\n\\theight: 1em;\\n\\twidth: 1em;\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n\\n.tc-btn-text {\\n\\tmargin-left: 7px;\\n}\\n\\n/* used for documentation \\\"fake\\\" buttons */\\n.tc-btn-standard {\\n\\tline-height: 1.8;\\n\\tcolor: #667;\\n\\tbackground-color: #e0e0e0;\\n\\tborder: 1px solid #888;\\n\\tpadding: 2px 1px 2px 1px;\\n\\tmargin: 1px 4px 1px 4px;\\n}\\n\\n.tc-btn-big-green {\\n\\tdisplay: inline-block;\\n\\tpadding: 8px;\\n\\tmargin: 4px 8px 4px 8px;\\n\\tbackground: <<colour download-background>>;\\n\\tcolor: <<colour download-foreground>>;\\n\\tfill: <<colour download-foreground>>;\\n\\tborder: none;\\n\\tborder-radius: 2px;\\n\\tfont-size: 1.2em;\\n\\tline-height: 1.4em;\\n\\ttext-decoration: none;\\n}\\n\\n.tc-btn-big-green svg,\\n.tc-btn-big-green img {\\n\\theight: 2em;\\n\\twidth: 2em;\\n\\tvertical-align: middle;\\n\\tfill: <<colour download-foreground>>;\\n}\\n\\n.tc-primary-btn {\\n\\tbackground: <<colour primary>>;\\n}\\n\\n.tc-sidebar-lists input {\\n\\tcolor: <<colour foreground>>;\\n}\\n\\n.tc-sidebar-lists button {\\n\\tcolor: <<colour sidebar-button-foreground>>;\\n\\tfill: <<colour sidebar-button-foreground>>;\\n}\\n\\n.tc-sidebar-lists button.tc-btn-mini {\\n\\tcolor: <<colour sidebar-muted-foreground>>;\\n}\\n\\n.tc-sidebar-lists button.tc-btn-mini:hover {\\n\\tcolor: <<colour sidebar-muted-foreground-hover>>;\\n}\\n\\n.tc-sidebar-lists button small {\\n\\tcolor: <<colour foreground>>;\\n}\\n\\nbutton svg.tc-image-button, button .tc-image-button img {\\n\\theight: 1em;\\n\\twidth: 1em;\\n}\\n\\n.tc-unfold-banner {\\n\\tposition: absolute;\\n\\tpadding: 0;\\n\\tmargin: 0;\\n\\tbackground: none;\\n\\tborder: none;\\n\\twidth: 100%;\\n\\twidth: calc(100% + 2px);\\n\\tmargin-left: -43px;\\n\\ttext-align: center;\\n\\tborder-top: 2px solid <<colour tiddler-info-background>>;\\n\\tmargin-top: 4px;\\n}\\n\\n.tc-unfold-banner:hover {\\n\\tbackground: <<colour tiddler-info-background>>;\\n\\tborder-top: 2px solid <<colour tiddler-info-border>>;\\n}\\n\\n.tc-unfold-banner svg, .tc-fold-banner svg {\\n\\theight: 0.75em;\\n\\tfill: <<colour tiddler-controls-foreground>>;\\n}\\n\\n.tc-unfold-banner:hover svg, .tc-fold-banner:hover svg {\\n\\tfill: <<colour tiddler-controls-foreground-hover>>;\\n}\\n\\n.tc-fold-banner {\\n\\tposition: absolute;\\n\\tpadding: 0;\\n\\tmargin: 0;\\n\\tbackground: none;\\n\\tborder: none;\\n\\twidth: 23px;\\n\\ttext-align: center;\\n\\tmargin-left: -35px;\\n\\ttop: 6px;\\n\\tbottom: 6px;\\n}\\n\\n.tc-fold-banner:hover {\\n\\tbackground: <<colour tiddler-info-background>>;\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\n\\t.tc-unfold-banner {\\n\\t\\tposition: static;\\n\\t\\twidth: calc(100% + 59px);\\n\\t}\\n\\n\\t.tc-fold-banner {\\n\\t\\twidth: 16px;\\n\\t\\tmargin-left: -16px;\\n\\t\\tfont-size: 0.75em;\\n\\t}\\n\\n}\\n\\n/*\\n** Tags and missing tiddlers\\n*/\\n\\n.tc-tag-list-item {\\n\\tposition: relative;\\n\\tdisplay: inline-block;\\n}\\n\\n.tc-tags-wrapper {\\n\\tmargin: 4px 0 14px 0;\\n}\\n\\n.tc-tags-wrapper .tc-tag-list-item {\\n\\tmargin-right: 7px;\\n}\\n\\n.tc-missing-tiddler-label {\\n\\tfont-style: italic;\\n\\tfont-weight: normal;\\n\\tdisplay: inline-block;\\n\\tfont-size: 11.844px;\\n\\tline-height: 14px;\\n\\twhite-space: nowrap;\\n\\tvertical-align: baseline;\\n}\\n\\n.tc-block-tags-dropdown > .tc-btn-invisible:hover {\\n\\tbackground-color: <<colour primary>>;\\n}\\n\\nbutton.tc-tag-label, span.tc-tag-label {\\n\\tdisplay: inline-block;\\n\\tpadding: 0.16em 0.7em;\\n\\tfont-size: 0.9em;\\n\\tfont-weight: normal;\\n\\tline-height: 1.2em;\\n\\tcolor: <<colour tag-foreground>>;\\n\\twhite-space: break-spaces;\\n\\tvertical-align: baseline;\\n\\tbackground-color: <<colour tag-background>>;\\n\\tborder-radius: 1em;\\n}\\n\\n.tc-sidebar-scrollable .tc-tag-label {\\n\\ttext-shadow: none;\\n}\\n\\n.tc-untagged-separator {\\n\\tborder: 0;\\n\\theight: 1px;\\n\\tbackground: <<colour tab-divider>>;\\n}\\n\\nbutton.tc-untagged-label {\\n\\tbackground-color: <<colour untagged-background>>;\\n}\\n\\n.tc-tag-label svg, .tc-tag-label img {\\n\\theight: 1em;\\n\\twidth: 1em;\\n\\tmargin-right: 3px;\\n\\tmargin-bottom: 1px;\\n\\tvertical-align: bottom;\\n}\\n\\n.tc-edit-tags button.tc-remove-tag-button svg {\\n\\tfont-size: 0.7em;\\n\\tvertical-align: middle;\\n}\\n\\n.tc-tag-manager-table .tc-tag-label {\\n}\\n\\n.tc-tag-manager-tag {\\n\\twidth: 100%;\\n}\\n\\nbutton.tc-btn-invisible.tc-remove-tag-button {\\n\\toutline: none;\\n}\\n\\n.tc-tag-button-selected,\\n.tc-list-item-selected a.tc-tiddlylink, a.tc-list-item-selected {\\n\\tbackground-color: <<colour primary>>;\\n\\tcolor: <<colour tiddler-background>>;\\n}\\n\\n/*\\n** Page layout\\n*/\\n\\n.tc-topbar {\\n\\tposition: fixed;\\n\\tz-index: 1200;\\n}\\n\\n.tc-topbar-left {\\n\\tleft: 29px;\\n\\ttop: 5px;\\n}\\n\\n.tc-topbar-right {\\n\\ttop: 5px;\\n\\tright: 29px;\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\n\\t.tc-topbar-right {\\n\\t\\tright: 10px;\\n\\t}\\n\\n}\\n\\n.tc-topbar button {\\n\\tpadding: 8px;\\n}\\n\\n.tc-topbar svg {\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n.tc-topbar button:hover svg {\\n\\tfill: <<colour foreground>>;\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\n\\t.tc-show-sidebar-btn svg.tc-image-chevron-left, .tc-hide-sidebar-btn svg.tc-image-chevron-right {\\n\\t\\ttransform: rotate(-90deg);\\n\\t}\\n\\n}\\n\\n.tc-sidebar-header {\\n\\tcolor: <<colour sidebar-foreground>>;\\n\\tfill: <<colour sidebar-foreground>>;\\n}\\n\\n.tc-sidebar-header .tc-title a.tc-tiddlylink-resolves {\\n\\tfont-weight: normal;\\n}\\n\\n.tc-sidebar-header .tc-sidebar-lists p {\\n\\tmargin-top: 3px;\\n\\tmargin-bottom: 3px;\\n}\\n\\n.tc-sidebar-header .tc-missing-tiddler-label {\\n\\tcolor: <<colour sidebar-foreground>>;\\n}\\n\\n.tc-advanced-search input {\\n\\twidth: 60%;\\n}\\n\\n.tc-search a svg {\\n\\twidth: 1.2em;\\n\\theight: 1.2em;\\n\\tvertical-align: middle;\\n}\\n\\n.tc-page-controls {\\n\\tmargin-top: 14px;\\n\\tmargin-bottom: 14px;\\n\\tfont-size: 1.5em;\\n}\\n\\n.tc-page-controls .tc-drop-down {\\n\\tfont-size: 1rem;\\n}\\n\\n.tc-page-controls button {\\n\\tmargin-right: 0.5em;\\n}\\n\\n.tc-page-controls a.tc-tiddlylink:hover {\\n\\ttext-decoration: none;\\n}\\n\\n.tc-page-controls img {\\n\\twidth: 1em;\\n}\\n\\n.tc-page-controls svg {\\n\\tfill: <<colour sidebar-controls-foreground>>;\\n}\\n\\n.tc-page-controls button:hover svg, .tc-page-controls a:hover svg {\\n\\tfill: <<colour sidebar-controls-foreground-hover>>;\\n}\\n\\n.tc-sidebar-lists .tc-menu-list-item {\\n\\twhite-space: nowrap;\\n}\\n\\n.tc-menu-list-count {\\n\\tfont-weight: bold;\\n}\\n\\n.tc-menu-list-subitem {\\n\\tpadding-left: 7px;\\n}\\n\\n.tc-story-river {\\n\\tposition: relative;\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\n\\t.tc-sidebar-header {\\n\\t\\tpadding: 14px;\\n\\t\\tmin-height: 32px;\\n\\t\\tmargin-top: {{$:/themes/tiddlywiki/vanilla/metrics/storytop}};\\n\\t\\ttransition:  min-height {{$:/config/AnimationDuration}}ms ease-in-out, padding-top {{$:/config/AnimationDuration}}ms ease-in-out, padding-bottom {{$:/config/AnimationDuration}}ms ease-in-out;\\n\\t}\\n\\n\\t<<if-no-sidebar \\\"\\\"\\\"\\n\\n\\t\\t.tc-sidebar-header {\\n\\t\\t\\tmin-height: 0;\\n\\t\\t\\tpadding-top: 0;\\n\\t\\t\\tpadding-bottom: 0;\\n\\t\\t}\\n\\n\\t\\\"\\\"\\\">>\\n\\n\\t.tc-story-river {\\n\\t\\tposition: relative;\\n\\t\\tpadding: 0;\\n\\t}\\n}\\n\\n@media (min-width: <<sidebarbreakpoint>>) {\\n\\n\\t.tc-message-box {\\n\\t\\tmargin: 21px -21px 21px -21px;\\n\\t}\\n\\n\\t.tc-sidebar-scrollable {\\n\\t\\tposition: fixed;\\n\\t\\ttop: {{$:/themes/tiddlywiki/vanilla/metrics/storytop}};\\n\\t\\tleft: {{$:/themes/tiddlywiki/vanilla/metrics/storyright}};\\n\\t\\tbottom: 0;\\n\\t\\tright: 0;\\n\\t\\toverflow-y: auto;\\n\\t\\toverflow-x: auto;\\n\\t\\t-webkit-overflow-scrolling: touch;\\n\\t\\tmargin: 0 0 0 -42px;\\n\\t\\tpadding: 71px 0 28px 42px;\\n\\t}\\n\\n\\thtml[dir=\\\"rtl\\\"] .tc-sidebar-scrollable {\\n\\t\\tleft: auto;\\n\\t\\tright: {{$:/themes/tiddlywiki/vanilla/metrics/storyright}};\\n\\t}\\n\\n\\t.tc-story-river {\\n\\t\\tposition: relative;\\n\\t\\tleft: {{$:/themes/tiddlywiki/vanilla/metrics/storyleft}};\\n\\t\\ttop: {{$:/themes/tiddlywiki/vanilla/metrics/storytop}};\\n\\t\\twidth: {{$:/themes/tiddlywiki/vanilla/metrics/storywidth}};\\n\\t\\tpadding: 42px 42px 42px 42px;\\n\\t}\\n\\n<<if-no-sidebar \\\"\\n\\n\\t.tc-story-river {\\n\\t\\twidth: calc(100% - {{$:/themes/tiddlywiki/vanilla/metrics/storyleft}});\\n\\t}\\n\\n\\\">>\\n\\n\\t.tc-story-river.tc-static-story-river {\\n\\t\\tmargin-right: 0;\\n\\t\\tpadding-right: 42px;\\n\\t}\\n\\n}\\n\\n@media print {\\n\\n\\tbody.tc-body {\\n\\t\\tbackground-color: transparent;\\n\\t}\\n\\n\\t.tc-sidebar-header, .tc-topbar {\\n\\t\\tdisplay: none;\\n\\t}\\n\\n\\t.tc-story-river {\\n\\t\\tmargin: 0;\\n\\t\\tpadding: 0;\\n\\t}\\n\\n\\t.tc-story-river .tc-tiddler-frame {\\n\\t\\tmargin: 0;\\n\\t\\tborder: none;\\n\\t\\tpadding: 0;\\n\\t}\\n}\\n\\n/*\\n** Tiddler styles\\n*/\\n\\n.tc-tiddler-frame {\\n\\tposition: relative;\\n\\tmargin-bottom: 28px;\\n\\tbackground-color: <<colour tiddler-background>>;\\n\\tborder: 1px solid <<colour tiddler-border>>;\\n}\\n\\n{{$:/themes/tiddlywiki/vanilla/sticky}}\\n\\n.tc-tiddler-info {\\n\\toverflow: hidden;\\n\\tpadding: 14px 42px 14px 42px;\\n\\tbackground-color: <<colour tiddler-info-background>>;\\n\\tborder-top: 1px solid <<colour tiddler-info-border>>;\\n\\tborder-bottom: 1px solid <<colour tiddler-info-border>>;\\n}\\n\\n.tc-tiddler-info p {\\n\\tmargin-top: 3px;\\n\\tmargin-bottom: 3px;\\n}\\n\\n.tc-tiddler-info .tc-tab-buttons button.tc-tab-selected {\\n\\tbackground-color: <<colour tiddler-info-tab-background>>;\\n\\tborder-bottom: 1px solid <<colour tiddler-info-tab-background>>;\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\n\\t.tc-tiddler-info {\\n\\t\\tpadding: 14px 14px 14px 14px;\\n\\t}\\n\\n}\\n\\n.tc-view-field-table {\\n\\twidth: 100%;\\n}\\n\\n.tc-view-field-name {\\n\\twidth: 1%; /* Makes this column be as narrow as possible */\\n\\twhite-space: nowrap;\\n\\tvertical-align: top;\\n\\ttext-align: right;\\n\\tfont-style: italic;\\n\\tfont-weight: normal;\\n}\\n\\n.tc-view-field-value {\\n\\tword-break: break-all;\\n}\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\t.tc-tiddler-frame {\\n\\t\\tpadding: 14px 14px 14px 14px;\\n\\t\\tmargin-bottom: .5em;\\n\\t}\\n\\n\\t.tc-tiddler-info {\\n\\t\\tmargin: 0 -14px 0 -14px;\\n\\t}\\n}\\n\\n@media (min-width: <<sidebarbreakpoint>>) {\\n\\t.tc-tiddler-frame {\\n\\t\\tpadding: 28px 42px 42px 42px;\\n\\t\\twidth: {{$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth}};\\n\\t\\tborder-radius: 2px;\\n\\t}\\n\\n<<if-no-sidebar \\\"\\n\\n\\t.tc-tiddler-frame {\\n\\t\\twidth: 100%;\\n\\t}\\n\\n\\\">>\\n\\n\\t.tc-tiddler-info {\\n\\t\\tmargin: 0 -42px 0 -42px;\\n\\t}\\n}\\n\\n.tc-site-title,\\n.tc-titlebar {\\n\\tfont-weight: normal;\\n\\tfont-size: 2.35em;\\n\\tline-height: 1.35em;\\n\\tcolor: <<colour tiddler-title-foreground>>;\\n\\tmargin: 0;\\n}\\n\\n.tc-site-title {\\n\\tcolor: <<colour site-title-foreground>>;\\n}\\n\\n.tc-tiddler-title-icon {\\n\\tvertical-align: middle;\\n\\tmargin-right: .1em;\\n}\\n\\n.tc-tiddler-title-icon svg {\\n\\twidth: 0.9em;\\n\\theight: 0.9em;\\n}\\n\\n.tc-system-title-prefix {\\n\\tcolor: <<colour muted-foreground>>;\\n}\\n\\n.tc-titlebar h2 {\\n\\tfont-size: 1em;\\n\\tdisplay: inline;\\n}\\n\\n.tc-titlebar img {\\n\\theight: 1em;\\n}\\n\\n.tc-subtitle {\\n\\tfont-size: 0.9em;\\n\\tcolor: <<colour tiddler-subtitle-foreground>>;\\n\\tfont-weight: normal;\\n}\\n\\n.tc-subtitle .tc-tiddlylink {\\n\\tmargin-right: .3em;\\n}\\n\\n.tc-tiddler-missing .tc-title {\\n\\tfont-style: italic;\\n\\tfont-weight: normal;\\n}\\n\\n.tc-tiddler-frame .tc-tiddler-controls {\\n\\tfloat: right;\\n\\tpadding: 3px; /* make space for outline */\\n}\\n\\n.tc-tiddler-controls .tc-drop-down {\\n\\tfont-size: 0.6em;\\n}\\n\\n.tc-tiddler-controls .tc-drop-down .tc-drop-down {\\n\\tfont-size: 1em;\\n}\\n\\n.tc-tiddler-controls > span > button,\\n.tc-tiddler-controls > span > span > button,\\n.tc-tiddler-controls > span > span > span > button {\\n\\tvertical-align: baseline;\\n\\tmargin-left:5px;\\n}\\n\\n.tc-tiddler-controls button svg, .tc-tiddler-controls button img,\\n.tc-search button svg, .tc-search a svg {\\n\\tfill: <<colour tiddler-controls-foreground>>;\\n}\\n\\n.tc-tiddler-controls button svg, .tc-tiddler-controls button img {\\n\\theight: 0.75em;\\n}\\n\\n.tc-search button svg, .tc-search a svg {\\n\\theight: 1.2em;\\n\\twidth: 1.2em;\\n\\tmargin: 0 0.25em;\\n}\\n\\n.tc-tiddler-controls button.tc-selected svg,\\n.tc-page-controls button.tc-selected svg  {\\n\\tfill: <<colour tiddler-controls-foreground-selected>>;\\n}\\n\\n.tc-tiddler-controls button.tc-btn-invisible:hover svg,\\n.tc-search button:hover svg, .tc-search a:hover svg {\\n\\tfill: <<colour tiddler-controls-foreground-hover>>;\\n}\\n\\n@media print {\\n\\t.tc-tiddler-controls {\\n\\t\\tdisplay: none;\\n\\t}\\n}\\n\\n.tc-tiddler-help { /* Help prompts within tiddler template */\\n\\tcolor: <<colour muted-foreground>>;\\n\\tmargin-top: 14px;\\n}\\n\\n.tc-tiddler-help a.tc-tiddlylink {\\n\\tcolor: <<colour very-muted-foreground>>;\\n}\\n\\n.tc-tiddler-frame .tc-edit-texteditor {\\n\\twidth: 100%;\\n\\tmargin: 4px 0 4px 0;\\n}\\n\\n.tc-tiddler-frame input.tc-edit-texteditor,\\n.tc-tiddler-frame textarea.tc-edit-texteditor,\\n.tc-tiddler-frame iframe.tc-edit-texteditor,\\n.tc-tiddler-frame select.tc-edit-texteditor {\\n\\tpadding: 3px 3px 3px 3px;\\n\\tborder: 1px solid <<colour tiddler-editor-border>>;\\n\\tline-height: 1.3em;\\n\\tfont-family: {{$:/themes/tiddlywiki/vanilla/settings/editorfontfamily}};\\n}\\n\\n.tc-tiddler-frame input.tc-edit-texteditor,\\n.tc-tiddler-frame textarea.tc-edit-texteditor,\\n.tc-tiddler-frame iframe.tc-edit-texteditor {\\n\\t-webkit-appearance: none;\\n}\\n\\n.tc-tiddler-frame input.tc-edit-texteditor,\\n.tc-tiddler-frame select.tc-edit-texteditor,\\n.tc-tiddler-frame textarea.tc-edit-texteditor {\\n\\tbackground-color: <<colour tiddler-editor-background>>;\\n}\\n\\n.tc-tiddler-frame iframe.tc-edit-texteditor {\\n\\tbackground-color: <<colour tiddler-background>>;\\n}\\n\\n.tc-tiddler-frame .tc-edit-fields input.tc-edit-fieldeditor,\\n.tc-tiddler-frame .tc-edit-fields select.tc-edit-fieldeditor,\\n.tc-tiddler-frame .tc-edit-fields textarea.tc-edit-fieldeditor {\\n\\tmargin: 0;\\n\\tpadding: 2px 3px;\\n}\\n\\n.tc-tiddler-frame .tc-binary-warning {\\n\\twidth: 100%;\\n\\theight: 5em;\\n\\ttext-align: center;\\n\\tpadding: 3em 3em 6em 3em;\\n\\tbackground: <<colour alert-background>>;\\n\\tborder: 1px solid <<colour alert-border>>;\\n}\\n\\ncanvas.tc-edit-bitmapeditor  {\\n\\tborder: 6px solid <<colour tiddler-editor-border-image>>;\\n\\tcursor: crosshair;\\n\\t-moz-user-select: none;\\n\\t-webkit-user-select: none;\\n\\t-ms-user-select: none;\\n\\tmargin-top: 6px;\\n\\tmargin-bottom: 6px;\\n}\\n\\n.tc-edit-bitmapeditor-width {\\n\\tdisplay: block;\\n}\\n\\n.tc-edit-bitmapeditor-height {\\n\\tdisplay: block;\\n}\\n\\n.tc-tiddler-body {\\n\\tclear: both;\\n}\\n\\n.tc-single-tiddler-window .tc-tiddler-body,\\n.tc-tiddler-frame .tc-tiddler-body {\\n\\tfont-size: {{$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize}};\\n\\tline-height: {{$:/themes/tiddlywiki/vanilla/metrics/bodylineheight}};\\n}\\n\\n.tc-titlebar, .tc-tiddler-edit-title {\\n\\toverflow: hidden; /* https://github.com/Jermolene/TiddlyWiki5/issues/282 */\\n}\\n\\n/*\\n* Tiddler in a new window.\\n* Also see: .tc-single-tiddler-window .tc-tiddler-body, above\\n*/\\n\\nhtml body.tc-body.tc-single-tiddler-window {\\n\\tmargin: 1em;\\n\\tbackground: <<colour tiddler-background>>;\\n}\\n\\n.tc-single-tiddler-window img,\\n.tc-single-tiddler-window svg,\\n.tc-single-tiddler-window canvas,\\n.tc-single-tiddler-window embed,\\n.tc-single-tiddler-window iframe {\\n\\tmax-width: 100%;\\n}\\n\\n/*\\n** Editor\\n*/\\n\\n.tc-editor-toolbar {\\n\\tmargin-top: 8px;\\n}\\n\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview .tc-editor-toolbar,\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview-hidden .tc-editor-toolbar {\\n\\tgrid-area: toolbar;\\n}\\n\\n.tc-editor-toolbar button {\\n\\tvertical-align: middle;\\n\\tbackground-color: <<colour tiddler-controls-foreground>>;\\n\\tcolor: <<colour tiddler-controls-foreground-selected>>;\\n\\tfill: <<colour tiddler-controls-foreground-selected>>;\\n\\tborder-radius: 4px;\\n\\tpadding: 3px;\\n\\tmargin: 2px 0 2px 4px;\\n}\\n\\n.tc-editor-toolbar button.tc-text-editor-toolbar-item-adjunct {\\n\\tmargin-left: 1px;\\n\\twidth: 1em;\\n\\tborder-radius: 8px;\\n}\\n\\n.tc-editor-toolbar button.tc-text-editor-toolbar-item-start-group {\\n\\tmargin-left: 11px;\\n}\\n\\n.tc-editor-toolbar button.tc-selected {\\n\\tbackground-color: <<colour primary>>;\\n}\\n\\n.tc-editor-toolbar button svg {\\n\\twidth: 1.6em;\\n\\theight: 1.2em;\\n}\\n\\n.tc-editor-toolbar .tc-drop-down button.tc-btn-mini {\\n\\tpadding: 2px 4px;\\n}\\n\\n.tc-editor-toolbar button:hover {\\n\\tbackground-color: <<colour tiddler-controls-foreground-selected>>;\\n\\tfill: <<colour background>>;\\n\\tcolor: <<colour background>>;\\n}\\n\\n.tc-editor-toolbar .tc-text-editor-toolbar-more {\\n\\twhite-space: normal;\\n}\\n\\n.tc-editor-toolbar .tc-text-editor-toolbar-more button {\\n\\tdisplay: inline-block;\\n\\tpadding: 3px;\\n\\twidth: auto;\\n}\\n\\n.tc-editor-toolbar .tc-search-results {\\n\\tpadding: 0;\\n}\\n\\n.tc-editor-toolbar button.tc-editortoolbar-stamp-button + .tc-popup .tc-drop-down > p {\\n\\tmargin: 0;\\n\\tpadding: 0;\\n}\\n\\n.tc-editor-toolbar button.tc-editortoolbar-stamp-button + .tc-popup .tc-drop-down a.tc-tiddlylink {\\n\\tfont-weight: normal;\\n}\\n\\n/*\\n** Adjustments for fluid-fixed mode\\n*/\\n\\n@media (min-width: <<sidebarbreakpoint>>) {\\n\\n<<if-fluid-fixed text:\\\"\\\"\\\"\\n\\n\\t.tc-story-river {\\n\\t\\tpadding-right: 0;\\n\\t\\tposition: relative;\\n\\t\\twidth: auto;\\n\\t\\tleft: 0;\\n\\t\\tmargin-left: {{$:/themes/tiddlywiki/vanilla/metrics/storyleft}};\\n\\t\\tmargin-right: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth}};\\n\\t}\\n\\n\\t.tc-tiddler-frame {\\n\\t\\twidth: 100%;\\n\\t}\\n\\n\\t.tc-sidebar-scrollable {\\n\\t\\tleft: auto;\\n\\t\\tbottom: 0;\\n\\t\\tright: 0;\\n\\t\\twidth: {{$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth}};\\n\\t}\\n\\n\\tbody.tc-body .tc-page-container.tc-page-view-zoomin .tc-tiddler-frame {\\n\\t\\twidth: 100%;\\n\\t\\twidth: calc(100% - 42px);\\n\\t}\\n\\n\\\"\\\"\\\" hiddenSidebarText:\\\"\\\"\\\"\\n\\n\\t.tc-story-river {\\n\\t\\tpadding-right: 3em;\\n\\t\\tmargin-right: 0;\\n\\t}\\n\\n\\tbody.tc-body .tc-page-container.tc-page-view-zoomin .tc-tiddler-frame {\\n\\t\\twidth: 100%;\\n\\t\\twidth: calc(100% - 84px);\\n\\t}\\n\\n\\\"\\\"\\\">>\\n\\n}\\n\\n/*\\n** Toolbar buttons\\n*/\\n\\n.tc-page-controls svg.tc-image-new-button {\\n\\tfill: <<colour toolbar-new-button>>;\\n}\\n\\n.tc-page-controls svg.tc-image-options-button {\\n\\tfill: <<colour toolbar-options-button>>;\\n}\\n\\n.tc-page-controls svg.tc-image-save-button {\\n\\tfill: <<colour toolbar-save-button>>;\\n}\\n\\n.tc-tiddler-controls button svg.tc-image-info-button {\\n\\tfill: <<colour toolbar-info-button>>;\\n}\\n\\n.tc-tiddler-controls button svg.tc-image-edit-button {\\n\\tfill: <<colour toolbar-edit-button>>;\\n}\\n\\n.tc-tiddler-controls button svg.tc-image-close-button {\\n\\tfill: <<colour toolbar-close-button>>;\\n}\\n\\n.tc-tiddler-controls button svg.tc-image-delete-button {\\n\\tfill: <<colour toolbar-delete-button>>;\\n}\\n\\n.tc-tiddler-controls button svg.tc-image-cancel-button {\\n\\tfill: <<colour toolbar-cancel-button>>;\\n}\\n\\n.tc-tiddler-controls button svg.tc-image-done-button {\\n\\tfill: <<colour toolbar-done-button>>;\\n}\\n\\n.tc-page-controls svg.tc-image-layout-button {\\n\\tfill: <<colour toolbar-options-button>>;\\n}\\n\\n/*\\n** Tiddler edit mode\\n*/\\n\\n.tc-tiddler-edit-frame em.tc-edit {\\n\\tcolor: <<colour muted-foreground>>;\\n\\tfont-style: normal;\\n}\\n\\n.tc-edit-type-dropdown a.tc-tiddlylink-missing {\\n\\tfont-style: normal;\\n}\\n\\n.tc-type-selector .tc-edit-typeeditor {\\n\\twidth: auto;\\n}\\n\\n.tc-type-selector-dropdown-wrapper {\\n\\tdisplay: inline-block;\\n}\\n\\n<<set-type-selector-min-width>>\\n\\n.tc-edit-tags {\\n\\tborder: 1px solid <<colour tiddler-editor-border>>;\\n\\tpadding: 4px 8px 4px 8px;\\n}\\n\\n.tc-edit-add-tag {\\n\\tdisplay: inline-block;\\n}\\n\\n.tc-edit-add-tag .tc-add-tag-name input {\\n\\twidth: 50%;\\n}\\n\\n.tc-edit-add-tag .tc-keyboard {\\n\\tdisplay:inline;\\n}\\n\\n.tc-edit-tags .tc-tag-label {\\n\\tdisplay: inline-block;\\n}\\n\\n.tc-edit-tags-list {\\n\\tmargin: 14px 0 14px 0;\\n}\\n\\n.tc-remove-tag-button {\\n\\tpadding-left: 4px;\\n}\\n\\n.tc-tiddler-editor {\\n\\tdisplay: grid;\\n}\\n\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview {\\n\\tgrid-template-areas:\\n\\t\\t\\\"toolbar toolbar\\\"\\n\\t\\t\\\"editor preview\\\";\\n\\tgrid-template-columns: repeat(2, minmax(0px, 1fr));\\n\\tgrid-template-rows: auto 1fr;\\n}\\n\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview-hidden {\\n\\tgrid-template-areas:\\n\\t\\t\\\"toolbar\\\"\\n\\t\\t\\\"editor\\\";\\n\\tgrid-template-columns: 1fr;\\n\\tgrid-template-rows: auto 1fr;\\n}\\n\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview .tc-tiddler-preview-preview {\\n\\tgrid-area: preview;\\n\\toverflow-wrap: anywhere;\\n\\tword-break: normal;\\n\\tborder: 1px solid <<colour tiddler-editor-border>>;\\n\\tmargin: 4px 0 3px 3px;\\n\\tpadding: 3px 3px 3px 3px;\\n}\\n\\n<<if-editor-height-fixed then:\\\"\\\"\\\"\\n\\n.tc-tiddler-preview-preview {\\n\\toverflow-y: scroll;\\n\\theight: {{$:/config/TextEditor/EditorHeight/Height}};\\n}\\n\\n\\\"\\\"\\\">>\\n\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview .tc-edit-texteditor,\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview-hidden .tc-edit-texteditor {\\n\\tgrid-area: editor;\\n}\\n\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview canvas.tc-edit-bitmapeditor,\\n.tc-tiddler-frame .tc-tiddler-editor.tc-tiddler-preview-hidden canvas.tc-edit-bitmapeditor {\\n\\tgrid-area: editor;\\n\\tmax-width: 100%;\\n}\\n\\n.tc-edit-fields {\\n\\twidth: 100%;\\n}\\n\\n.tc-edit-fields.tc-edit-fields-small {\\n\\tmargin-top: 0;\\n\\tmargin-bottom: 0;\\n}\\n\\n.tc-edit-fields table, .tc-edit-fields tr, .tc-edit-fields td {\\n\\tborder: none;\\n\\tpadding: 4px;\\n}\\n\\n.tc-edit-fields > tbody > .tc-edit-field:nth-child(odd) {\\n\\tbackground-color: <<colour tiddler-editor-fields-odd>>;\\n}\\n\\n.tc-edit-fields > tbody > .tc-edit-field:nth-child(even) {\\n\\tbackground-color: <<colour tiddler-editor-fields-even>>;\\n}\\n\\n.tc-edit-field-name {\\n\\ttext-align: right;\\n}\\n\\n.tc-edit-field-value input {\\n\\twidth: 100%;\\n}\\n\\n.tc-edit-field-remove {\\n}\\n\\n.tc-edit-field-remove svg {\\n\\theight: 1em;\\n\\twidth: 1em;\\n\\tfill: <<colour muted-foreground>>;\\n\\tvertical-align: middle;\\n}\\n\\n.tc-edit-field-add-name-wrapper input.tc-edit-texteditor {\\n\\twidth: auto;\\n}\\n\\n.tc-edit-field-add-name-wrapper {\\n\\tdisplay: inline-block;\\n}\\n\\n.tc-edit-field-add-value {\\n\\tdisplay: inline-block;\\n}\\n\\n@media (min-width: <<sidebarbreakpoint>>) {\\n\\n\\t.tc-edit-field-add-value {\\n\\t\\twidth: 35%;\\n\\t}\\n\\n}\\n\\n.tc-edit-field-add-button {\\n\\tdisplay: inline-block;\\n\\twidth: 10%;\\n}\\n\\n\\n/*\\n** Tiddler editor dropzone\\n*/\\n\\n.tc-dropzone-editor {\\n\\tposition:relative;\\n}\\n\\n.tc-dropzone-editor.tc-dragover .tc-editor-toolbar::after{\\n\\tz-index: 10000;\\n\\ttop:0;\\n\\tleft:0;\\n\\tright:0;\\n\\theight: 100%;\\n\\tbackground: <<colour dropzone-background>>;\\n\\tcontent: \\\"<<lingo DropMessage>>\\\";\\n\\tpointer-events: none;\\n\\tposition: absolute;\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n\\tbackground-color: <<color background>>;\\n\\tborder: 4px dashed <<color modal-border>>;\\n\\tfont-weight: bold;\\n\\tfont-size: 150%;\\n\\topacity: 0.8;\\n\\tcolor: <<color foreground>>;\\n}\\n\\n.tc-editor-importpopup {\\n\\twidth: 100%;\\n\\theight: 100%;\\n}\\n\\n.tc-editor-import {\\n\\tposition: absolute;\\n\\ttop: 50%;\\n\\tleft: 50%;\\n\\ttransform: translate(-50%, -50%);\\n\\tbackground: <<color pre-background>>;\\n\\tbox-shadow: 2px 2px 10px <<colour foreground>>;\\n\\tpadding: 10px;\\n\\twidth: 96%;\\n\\tborder: 1px solid <<color tiddler-controls-foreground>>;\\n\\ttext-align:center;\\n}\\n\\n.tc-editor-import img {\\n\\tmax-height: 500px;\\n}\\n\\n/*\\n** Storyview Classes\\n*/\\n\\n.tc-viewswitcher .tc-image-button {\\n\\tmargin-right: .3em;\\n}\\n\\n.tc-page-container.tc-page-view-zoomin .tc-tiddler-frame {\\n\\tposition: absolute;\\n\\tdisplay: block;\\n\\twidth: 100%;\\n}\\n\\n@media (min-width: <<sidebarbreakpoint>>) {\\n\\n\\t.tc-page-container.tc-page-view-zoomin .tc-tiddler-frame {\\n\\t\\twidth: calc(100% - 84px);\\n\\t}\\n\\n}\\n\\n/*\\n** Dropdowns\\n*/\\n\\n.tc-btn-dropdown {\\n\\ttext-align: left;\\n}\\n\\n.tc-btn-dropdown svg, .tc-btn-dropdown img {\\n\\theight: 1em;\\n\\twidth: 1em;\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n.tc-drop-down-wrapper {\\n\\tposition: relative;\\n}\\n\\n.tc-drop-down {\\n\\tmin-width: 380px;\\n\\tborder: 1px solid <<colour dropdown-border>>;\\n\\tbackground-color: <<colour dropdown-background>>;\\n\\tpadding: 7px 0 7px 0;\\n\\tmargin: 4px 0 0 0;\\n\\twhite-space: nowrap;\\n\\ttext-shadow: none;\\n\\tline-height: 1.4;\\n}\\n\\n.tc-drop-down .tc-drop-down {\\n\\tmargin-left: 14px;\\n}\\n\\n.tc-drop-down button svg, .tc-drop-down a svg  {\\n\\tfill: <<colour foreground>>;\\n}\\n\\n.tc-drop-down button:disabled svg {\\n\\tfill: <<colour muted-foreground>>;\\n}\\n\\n.tc-drop-down button.tc-btn-invisible:hover svg {\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-drop-down .tc-drop-down-info {\\n\\tpadding-left: 14px;\\n}\\n\\n.tc-drop-down p {\\n\\tpadding: 0 14px 0 14px;\\n}\\n\\n.tc-drop-down svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n}\\n\\n.tc-drop-down img {\\n\\twidth: 1em;\\n}\\n\\n.tc-drop-down a, .tc-drop-down button {\\n\\tdisplay: block;\\n\\tpadding: 0 14px 0 14px;\\n\\twidth: 100%;\\n\\ttext-align: left;\\n\\tcolor: <<colour foreground>>;\\n\\tline-height: 1.4;\\n}\\n\\n.tc-drop-down .tc-tab-set .tc-tab-buttons button {\\n\\tdisplay: inline-block;\\n\\twidth: auto;\\n\\tmargin-bottom: 0px;\\n\\tborder-bottom-left-radius: 0;\\n\\tborder-bottom-right-radius: 0;\\n}\\n\\n.tc-drop-down .tc-prompt {\\n\\tpadding: 0 14px;\\n}\\n\\n.tc-drop-down .tc-chooser {\\n\\tborder: none;\\n}\\n\\n.tc-drop-down .tc-chooser .tc-swatches-horiz {\\n\\tfont-size: 0.4em;\\n\\tpadding-left: 1.2em;\\n}\\n\\n.tc-drop-down .tc-file-input-wrapper {\\n\\twidth: 100%;\\n}\\n\\n.tc-drop-down .tc-file-input-wrapper button {\\n\\tcolor: <<colour foreground>>;\\n}\\n\\n.tc-drop-down a:hover, .tc-drop-down button:hover, .tc-drop-down .tc-file-input-wrapper:hover button {\\n\\tcolor: <<colour tiddler-link-background>>;\\n\\tbackground-color: <<colour tiddler-link-foreground>>;\\n\\ttext-decoration: none;\\n}\\n\\n.tc-drop-down .tc-tab-buttons button {\\n\\tbackground-color: <<colour dropdown-tab-background>>;\\n}\\n\\n.tc-drop-down .tc-tab-buttons button.tc-tab-selected {\\n\\tbackground-color: <<colour dropdown-tab-background-selected>>;\\n\\tborder-bottom: 1px solid <<colour dropdown-tab-background-selected>>;\\n}\\n\\n.tc-drop-down-bullet {\\n\\tdisplay: inline-block;\\n\\twidth: 0.5em;\\n}\\n\\n.tc-drop-down .tc-tab-contents a {\\n\\tpadding: 0 0.5em 0 0.5em;\\n}\\n\\n.tc-block-dropdown-wrapper {\\n\\tposition: relative;\\n}\\n\\n.tc-block-dropdown {\\n\\tposition: absolute;\\n\\tmin-width: 220px;\\n\\tborder: 1px solid <<colour dropdown-border>>;\\n\\tbackground-color: <<colour dropdown-background>>;\\n\\tpadding: 7px 0;\\n\\tmargin: 4px 0 0 0;\\n\\twhite-space: nowrap;\\n\\tz-index: 1000;\\n\\ttext-shadow: none;\\n}\\n\\n.tc-block-dropdown.tc-search-drop-down {\\n\\tmargin-left: -12px;\\n}\\n\\n.tc-block-dropdown a {\\n\\tdisplay: block;\\n\\tpadding: 4px 14px 4px 14px;\\n}\\n\\n.tc-block-dropdown.tc-search-drop-down a {\\n\\tdisplay: block;\\n\\tpadding: 0px 10px 0px 10px;\\n}\\n\\n.tc-drop-down .tc-dropdown-item-plain,\\n.tc-block-dropdown .tc-dropdown-item-plain {\\n\\tpadding: 4px 14px 4px 7px;\\n}\\n\\n.tc-drop-down .tc-dropdown-item,\\n.tc-block-dropdown .tc-dropdown-item {\\n\\tpadding: 4px 14px 4px 7px;\\n\\tcolor: <<colour muted-foreground>>;\\n}\\n\\n.tc-block-dropdown a.tc-tiddlylink:hover {\\n\\tcolor: <<colour tiddler-link-background>>;\\n\\tbackground-color: <<colour tiddler-link-foreground>>;\\n\\ttext-decoration: none;\\n}\\n\\n.tc-search-results {\\n\\tpadding: 0 7px 0 7px;\\n}\\n\\n.tc-image-chooser, .tc-colour-chooser {\\n\\twhite-space: normal;\\n}\\n\\n.tc-image-chooser a,\\n.tc-colour-chooser a {\\n\\tdisplay: inline-block;\\n\\tvertical-align: top;\\n\\ttext-align: center;\\n\\tposition: relative;\\n}\\n\\n.tc-image-chooser a {\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tpadding: 2px;\\n\\tmargin: 2px;\\n\\twidth: 4em;\\n\\theight: 4em;\\n}\\n\\n.tc-colour-chooser a {\\n\\tpadding: 3px;\\n\\twidth: 2em;\\n\\theight: 2em;\\n\\tvertical-align: middle;\\n}\\n\\n.tc-image-chooser a:hover,\\n.tc-colour-chooser a:hover {\\n\\tbackground: <<colour primary>>;\\n\\tpadding: 0px;\\n\\tborder: 3px solid <<colour primary>>;\\n}\\n\\n.tc-image-chooser a svg,\\n.tc-image-chooser a img {\\n\\tdisplay: inline-block;\\n\\twidth: auto;\\n\\theight: auto;\\n\\tmax-width: 3.5em;\\n\\tmax-height: 3.5em;\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tbottom: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tmargin: auto;\\n}\\n\\n/* Make search dropdown visible on small screens. issue #7003 */\\n@media (max-width: <<sidebarbreakpoint>>) {\\n\\n\\t.tc-sidebar-search .tc-block-dropdown-wrapper {\\n\\t\\tposition: initial;\\n\\t}\\n\\n}\\n\\n/*\\n** Modals\\n*/\\n\\n.tc-modal-wrapper {\\n\\tposition: fixed;\\n\\toverflow: auto;\\n\\toverflow-y: scroll;\\n\\ttop: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n\\tleft: 0;\\n\\tz-index: 900;\\n}\\n\\n.tc-modal-backdrop {\\n\\tposition: fixed;\\n\\ttop: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n\\tleft: 0;\\n\\tz-index: 1000;\\n\\tbackground-color: <<colour modal-backdrop>>;\\n}\\n\\n.tc-modal {\\n\\tz-index: 1100;\\n\\tbackground-color: <<colour modal-background>>;\\n\\tborder: 1px solid <<colour modal-border>>;\\n}\\n\\n@media (max-width: 55em) {\\n\\t.tc-modal {\\n\\t\\tposition: fixed;\\n\\t\\ttop: 1em;\\n\\t\\tleft: 1em;\\n\\t\\tright: 1em;\\n\\t}\\n\\n\\t.tc-modal-body {\\n\\t\\toverflow-y: auto;\\n\\t\\tmax-height: 400px;\\n\\t\\tmax-height: 60vh;\\n\\t}\\n}\\n\\n@media (min-width: 55em) {\\n\\t.tc-modal {\\n\\t\\tposition: fixed;\\n\\t\\ttop: 2em;\\n\\t\\tleft: 25%;\\n\\t\\twidth: 50%;\\n\\t}\\n\\n\\t.tc-modal-body {\\n\\t\\toverflow-y: auto;\\n\\t\\tmax-height: 400px;\\n\\t\\tmax-height: 60vh;\\n\\t}\\n}\\n\\n.tc-modal-header {\\n\\tpadding: 9px 15px;\\n\\tborder-bottom: 1px solid <<colour modal-header-border>>;\\n}\\n\\n.tc-modal-header h3 {\\n\\tmargin: 0;\\n\\tline-height: 30px;\\n}\\n\\n.tc-modal-header img, .tc-modal-header svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n}\\n\\n.tc-modal-body {\\n\\tpadding: 15px;\\n}\\n\\n.tc-modal-footer {\\n\\tpadding: 14px 15px 15px;\\n\\tmargin-bottom: 0;\\n\\ttext-align: right;\\n\\tbackground-color: <<colour modal-footer-background>>;\\n\\tborder-top: 1px solid <<colour modal-footer-border>>;\\n}\\n\\n.tc-modal-prevent-scroll {\\n\\toverflow: hidden;\\n}\\n\\n/*\\n** Centered modals\\n*/\\n.tc-modal-centered .tc-modal {\\n\\twidth: auto;\\n\\ttop: 50%;\\n\\tleft: 50%;\\n\\ttransform: translate(-50%, -50%) !important;\\n}\\n\\n/*\\n** Notifications\\n*/\\n\\n.tc-notification {\\n\\tposition: fixed;\\n\\ttop: 14px;\\n\\tright: 42px;\\n\\tz-index: 1300;\\n\\tmax-width: 280px;\\n\\tpadding: 0 14px 0 14px;\\n\\tbackground-color: <<colour notification-background>>;\\n\\tborder: 1px solid <<colour notification-border>>;\\n}\\n\\n/*\\n** Tabs\\n*/\\n\\n.tc-tab-set.tc-vertical {\\n\\tdisplay: -webkit-flex;\\n\\tdisplay: flex;\\n}\\n\\n.tc-tab-buttons {\\n\\tfont-size: 0.85em;\\n\\tpadding-top: 1em;\\n\\tmargin-bottom: -2px;\\n}\\n\\n.tc-tab-buttons.tc-vertical  {\\n\\tz-index: 100;\\n\\tdisplay: block;\\n\\tpadding-top: 14px;\\n\\tvertical-align: top;\\n\\ttext-align: right;\\n\\tmargin-bottom: inherit;\\n\\tmargin-right: -1px;\\n\\tmax-width: 33%;\\n\\t-webkit-flex: 0 0 auto;\\n\\tflex: 0 0 auto;\\n}\\n\\n.tc-tab-buttons button.tc-tab-selected {\\n\\tcolor: <<colour tab-foreground-selected>>;\\n\\tbackground-color: <<colour tab-background-selected>>;\\n\\tborder-left: 1px solid <<colour tab-border-selected>>;\\n\\tborder-top: 1px solid <<colour tab-border-selected>>;\\n\\tborder-right: 1px solid <<colour tab-border-selected>>;\\n}\\n\\n.tc-tab-buttons button {\\n\\tcolor: <<colour tab-foreground>>;\\n\\tpadding: 3px 5px 3px 5px;\\n\\tmargin-right: 0.3em;\\n\\tfont-weight: normal;\\n\\tborder: none;\\n\\tbackground: inherit;\\n\\tbackground-color: <<colour tab-background>>;\\n\\tborder-left: 1px solid <<colour tab-border>>;\\n\\tborder-top: 1px solid <<colour tab-border>>;\\n\\tborder-right: 1px solid <<colour tab-border>>;\\n\\tborder-top-left-radius: 2px;\\n\\tborder-top-right-radius: 2px;\\n\\tborder-bottom-left-radius: 0;\\n\\tborder-bottom-right-radius: 0;\\n}\\n\\n.tc-tab-buttons.tc-vertical button {\\n\\tdisplay: block;\\n\\twidth: 100%;\\n\\tmargin-top: 3px;\\n\\tmargin-right: 0;\\n\\ttext-align: right;\\n\\tbackground-color: <<colour tab-background>>;\\n\\tborder-left: 1px solid <<colour tab-border>>;\\n\\tborder-bottom: 1px solid <<colour tab-border>>;\\n\\tborder-right: none;\\n\\tborder-top-left-radius: 2px;\\n\\tborder-bottom-left-radius: 2px;\\n\\tborder-top-right-radius: 0;\\n\\tborder-bottom-right-radius: 0;\\n}\\n\\n.tc-tab-buttons.tc-vertical button.tc-tab-selected {\\n\\tbackground-color: <<colour tab-background-selected>>;\\n\\tborder-right: 1px solid <<colour tab-background-selected>>;\\n}\\n\\n.tc-tab-divider {\\n\\tborder-top: 1px solid <<colour tab-divider>>;\\n}\\n\\n.tc-tab-divider.tc-vertical  {\\n\\tdisplay: none;\\n}\\n\\n.tc-tab-content {\\n\\tmargin-top: 14px;\\n}\\n\\n.tc-tab-content.tc-vertical  {\\n\\tdisplay: inline-block;\\n\\tvertical-align: top;\\n\\tpadding-top: 0;\\n\\tpadding-left: 14px;\\n\\tborder-left: 1px solid <<colour tab-border>>;\\n\\t-webkit-flex: 1 0 70%;\\n\\tflex: 1 0 70%;\\n\\toverflow: auto;\\n}\\n\\n.tc-sidebar-lists .tc-tab-buttons {\\n\\tmargin-bottom: -1px;\\n}\\n\\n.tc-sidebar-lists .tc-tab-buttons button.tc-tab-selected {\\n\\tbackground-color: <<colour sidebar-tab-background-selected>>;\\n\\tcolor: <<colour sidebar-tab-foreground-selected>>;\\n\\tborder-left: 1px solid <<colour sidebar-tab-border-selected>>;\\n\\tborder-top: 1px solid <<colour sidebar-tab-border-selected>>;\\n\\tborder-right: 1px solid <<colour sidebar-tab-border-selected>>;\\n}\\n\\n.tc-sidebar-lists .tc-tab-buttons button {\\n\\tbackground-color: <<colour sidebar-tab-background>>;\\n\\tcolor: <<colour sidebar-tab-foreground>>;\\n\\tborder-left: 1px solid <<colour sidebar-tab-border>>;\\n\\tborder-top: 1px solid <<colour sidebar-tab-border>>;\\n\\tborder-right: 1px solid <<colour sidebar-tab-border>>;\\n}\\n\\n.tc-sidebar-lists .tc-tab-divider {\\n\\tborder-top: 1px solid <<colour sidebar-tab-divider>>;\\n}\\n\\n.tc-more-sidebar > .tc-tab-set > .tc-tab-buttons > button {\\n\\tdisplay: block;\\n\\twidth: 100%;\\n\\tbackground-color: <<colour sidebar-tab-background>>;\\n\\tborder-top: none;\\n\\tborder-left: none;\\n\\tborder-bottom: none;\\n\\tborder-right: 1px solid #ccc;\\n\\tmargin-bottom: inherit;\\n}\\n\\n.tc-more-sidebar > .tc-tab-set > .tc-tab-buttons > button.tc-tab-selected {\\n\\tbackground-color: <<colour sidebar-tab-background-selected>>;\\n\\tborder: none;\\n}\\n\\n/*\\n** Manager\\n*/\\n\\n.tc-manager-wrapper {\\n\\n}\\n\\n.tc-manager-controls {\\n\\n}\\n\\n.tc-manager-control {\\n\\tmargin: 0.5em 0;\\n}\\n\\n.tc-manager-control select {\\n\\tmax-width: 100%;\\n}\\n\\n.tc-manager-list {\\n\\twidth: 100%;\\n\\tborder-top: 1px solid <<colour muted-foreground>>;\\n\\tborder-left: 1px solid <<colour muted-foreground>>;\\n\\tborder-right: 1px solid <<colour muted-foreground>>;\\n}\\n\\n.tc-manager-list-item {\\n\\n}\\n\\n.tc-manager-list-item-heading {\\n\\tdisplay: block;\\n\\twidth: 100%;\\n\\ttext-align: left;\\n\\tborder-bottom: 1px solid <<colour muted-foreground>>;\\n\\tpadding: 3px;\\n}\\n\\n.tc-manager-list-item-heading-selected {\\n\\tfont-weight: bold;\\n\\tcolor: <<colour background>>;\\n\\tfill: <<colour background>>;\\n\\tbackground-color: <<colour foreground>>;\\n}\\n\\n.tc-manager-list-item-heading:hover {\\n\\tbackground: <<colour primary>>;\\n\\tcolor: <<colour background>>;\\n}\\n\\n.tc-manager-list-item-content {\\n\\tdisplay: flex;\\n}\\n\\n.tc-manager-list-item-content-sidebar {\\n\\tflex: 1 0;\\n\\tbackground: <<colour tiddler-editor-background>>;\\n\\tborder-right: 0.5em solid <<colour muted-foreground>>;\\n\\tborder-bottom: 0.5em solid <<colour muted-foreground>>;\\n\\twhite-space: nowrap;\\n}\\n\\n.tc-manager-list-item-content-item-heading {\\n\\tdisplay: block;\\n\\twidth: 100%;\\n\\ttext-align: left;\\n\\tbackground: <<colour muted-foreground>>;\\n\\ttext-transform: uppercase;\\n\\tfont-size: 0.6em;\\n\\tfont-weight: bold;\\n\\tpadding: 0.5em 0 0.5em 0;\\n}\\n\\n.tc-manager-list-item-content-item-body {\\n\\tpadding: 0 0.5em 0 0.5em;\\n}\\n\\n.tc-manager-list-item-content-item-body > pre {\\n\\tmargin: 0.5em 0 0.5em 0;\\n\\tborder: none;\\n\\tbackground: inherit;\\n}\\n\\n.tc-manager-list-item-content-tiddler {\\n\\tflex: 3 1;\\n\\tborder-left: 0.5em solid <<colour muted-foreground>>;\\n\\tborder-right: 0.5em solid <<colour muted-foreground>>;\\n\\tborder-bottom: 0.5em solid <<colour muted-foreground>>;\\n}\\n\\n.tc-manager-list-item-content-item-body > table {\\n\\tborder: none;\\n\\tpadding: 0;\\n\\tmargin: 0;\\n}\\n\\n.tc-manager-list-item-content-item-body > table td {\\n\\tborder: none;\\n}\\n\\n.tc-manager-icon-editor > button {\\n\\twidth: 100%;\\n}\\n\\n.tc-manager-icon-editor > button > svg,\\n.tc-manager-icon-editor > button > button {\\n\\twidth: 100%;\\n\\theight: auto;\\n}\\n\\n/*\\n** Import table\\n*/\\n\\n.tc-import-table {\\n\\twidth: 100%;\\n}\\n\\n.tc-import-table svg.tc-image-edit-button {\\n\\tmax-width: unset;\\n}\\n\\n.tc-import-table th:first-of-type {\\n\\twidth: 10%;\\n}\\n\\n.tc-import-table th:last-of-type {\\n\\twidth: 30%;\\n}\\n\\n.tc-import-table .tc-row-disabled {\\n\\tbackground: <<colour very-muted-foreground>>10;\\n\\topacity: 0.8;\\n}\\n\\n.tc-import-table .tc-row-warning {\\n\\tbackground: <<colour diff-delete-background>>50;\\n}\\n\\n/*\\n** Alerts\\n*/\\n\\n.tc-alerts {\\n\\tposition: fixed;\\n\\ttop: 28px;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tmax-width: 50%;\\n\\tz-index: 20000;\\n}\\n\\n.tc-alert {\\n\\tposition: relative;\\n\\tmargin: 14px;\\n\\tpadding: 7px;\\n\\tborder: 1px solid <<colour alert-border>>;\\n\\tbackground-color: <<colour alert-background>>;\\n}\\n\\n.tc-alert-toolbar {\\n\\tposition: absolute;\\n\\ttop: 7px;\\n\\tright: 7px;\\n\\tline-height: 0;\\n}\\n\\n.tc-alert-toolbar svg {\\n\\tfill: <<colour alert-muted-foreground>>;\\n}\\n\\n.tc-alert-subtitle {\\n\\tcolor: <<colour alert-muted-foreground>>;\\n\\tfont-weight: bold;\\n\\tfont-size: 0.8em;\\n\\tmargin-bottom: 0.5em;\\n}\\n\\n.tc-alert-body > p {\\n\\tmargin: 0;\\n}\\n\\n.tc-alert-highlight {\\n\\tcolor: <<colour alert-highlight>>;\\n}\\n\\n@media (min-width: <<sidebarbreakpoint>>) {\\n\\n\\t.tc-static-alert {\\n\\t\\tposition: relative;\\n\\t}\\n\\n\\t.tc-static-alert-inner {\\n\\t\\tposition: absolute;\\n\\t\\tz-index: 100;\\n\\t}\\n\\n}\\n\\n.tc-static-alert-inner {\\n\\tpadding: 0 2px 2px 42px;\\n\\tcolor: <<colour static-alert-foreground>>;\\n}\\n\\n/*\\n** Floating drafts list\\n*/\\n\\n.tc-drafts-list {\\n\\tz-index: 2000;\\n\\tposition: fixed;\\n\\tfont-size: 0.8em;\\n\\tleft: 0;\\n\\tbottom: 0;\\n}\\n\\n.tc-drafts-list a {\\n\\tmargin: 0 0.5em;\\n\\tpadding: 4px 4px;\\n\\tborder-top-left-radius: 4px;\\n\\tborder-top-right-radius: 4px;\\n\\tborder: 1px solid <<colour background>>;\\n\\tborder-bottom: none;\\n\\tbackground: <<colour dirty-indicator>>;\\n\\tcolor: <<colour background>>;\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-drafts-list a:hover {\\n\\ttext-decoration: none;\\n\\tbackground: <<colour foreground>>;\\n\\tcolor: <<colour background>>;\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-drafts-list a svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n\\tvertical-align: text-bottom;\\n}\\n\\n/*\\n** Control panel\\n*/\\n\\n.tc-control-panel td {\\n\\tpadding: 4px;\\n}\\n\\n.tc-control-panel table, .tc-control-panel table input, .tc-control-panel table textarea {\\n\\twidth: 100%;\\n}\\n\\n.tc-control-panel-setting {\\n\\tborder-top: 1px solid <<colour blockquote-bar>>;\\n}\\n\\n.tc-plugin-info {\\n\\tdisplay: flex;\\n\\ttext-shadow: none;\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tfill: <<colour muted-foreground>>;\\n\\tbackground-color: <<colour background>>;\\n\\tmargin: 0.5em 0 0.5em 0;\\n\\tpadding: 4px;\\n\\talign-items: center;\\n}\\n\\n.tc-sidebar-lists a.tc-tiddlylink.tc-plugin-info {\\n\\tcolor: <<colour tiddler-link-foreground>>;\\n}\\n\\n\\n.tc-plugin-info-sub-plugins .tc-plugin-info {\\n\\tmargin: 0.5em;\\n\\tbackground: <<colour background>>;\\n}\\n\\n.tc-plugin-info-sub-plugin-indicator {\\n\\tmargin: -16px 1em 0 2em;\\n}\\n\\n.tc-plugin-info-sub-plugin-indicator button {\\n\\tcolor: <<colour background>>;\\n\\tbackground: <<colour foreground>>;\\n\\tborder-radius: 8px;\\n\\tpadding: 2px 7px;\\n\\tfont-size: 0.75em;\\n}\\n\\n.tc-plugin-info-sub-plugins .tc-plugin-info-dropdown {\\n\\tmargin-left: 1em;\\n\\tmargin-right: 1em;\\n}\\n\\n.tc-plugin-info-disabled {\\n\\tbackground: -webkit-repeating-linear-gradient(45deg, #ff0, #ff0 10px, #eee 10px, #eee 20px);\\n\\tbackground: repeating-linear-gradient(45deg, #ff0, #ff0 10px, #eee 10px, #eee 20px);\\n}\\n\\n.tc-plugin-info-disabled:hover {\\n\\tbackground: -webkit-repeating-linear-gradient(45deg, #aa0, #aa0 10px, #888 10px, #888 20px);\\n\\tbackground: repeating-linear-gradient(45deg, #aa0, #aa0 10px, #888 10px, #888 20px);\\n}\\n\\na.tc-tiddlylink.tc-plugin-info:hover {\\n\\ttext-decoration: none;\\n\\tbackground-color: <<colour primary>>;\\n\\tcolor: <<colour background>>;\\n\\tfill: <<colour foreground>>;\\n}\\n\\na.tc-tiddlylink.tc-plugin-info:hover > .tc-plugin-info-chunk > svg {\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-plugin-info-chunk {\\n\\tmargin: 2px;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-toggle {\\n\\tflex-grow: 0;\\n\\tflex-shrink: 0;\\n\\tline-height: 1;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-icon {\\n\\tflex-grow: 0;\\n\\tflex-shrink: 0;\\n\\tline-height: 1;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-description {\\n\\tflex-grow: 1;\\n}\\n\\n.tc-plugin-info-chunk .tc-plugin-info-stability {\\n\\tmargin-right: 4px;\\n\\tpadding: 1px 3px;\\n\\tfont-size: 0.8em;\\n\\tborder-radius: 4px;\\n\\tfont-weight: bold;\\n}\\n\\n.tc-plugin-info-chunk .tc-plugin-info-stability-stable {\\n\\tborder: 1px solid <<colour stability-stable>>;\\n\\tcolor: <<colour stability-stable>>;\\n}\\n\\n.tc-plugin-info-chunk .tc-plugin-info-stability-experimental {\\n\\tborder: 1px solid <<colour stability-experimental>>;\\n\\tcolor: <<colour stability-experimental>>;\\n}\\n\\n.tc-plugin-info-chunk .tc-plugin-info-stability-deprecated {\\n\\tborder: 1px solid <<colour stability-deprecated>>;\\n\\tcolor: <<colour stability-deprecated>>;\\n}\\n\\n.tc-plugin-info-chunk .tc-plugin-info-stability-legacy {\\n\\tborder: 1px solid <<colour stability-legacy>>;\\n\\tcolor: <<colour stability-legacy>>;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-buttons {\\n\\tfont-size: 0.8em;\\n\\tline-height: 1.2;\\n\\tflex-grow: 0;\\n\\tflex-shrink: 0;\\n\\ttext-align: right;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-description h1 {\\n\\tfont-size: 1em;\\n\\tline-height: 1.2;\\n\\tmargin: 2px 0 2px 0;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-description h2 {\\n\\tfont-size: 0.8em;\\n\\tline-height: 1.2;\\n\\tmargin: 2px 0 2px 0;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-description div {\\n\\tfont-size: 0.8em;\\n\\tline-height: 1.2;\\n\\tmargin: 2px 0 2px 0;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-toggle img, .tc-plugin-info-chunk.tc-plugin-info-toggle svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n}\\n\\n.tc-plugin-info-chunk.tc-plugin-info-icon img, .tc-plugin-info-chunk.tc-plugin-info-icon svg {\\n\\twidth: 2em;\\n\\theight: 2em;\\n}\\n\\n.tc-plugin-info-dropdown {\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tbackground: <<colour background>>;\\n\\tmargin-top: -8px;\\n}\\n\\n.tc-plugin-info-dropdown-message {\\n\\tbackground: <<colour message-background>>;\\n\\tpadding: 0.5em 1em 0.5em 1em;\\n\\tfont-weight: bold;\\n\\tfont-size: 0.8em;\\n}\\n\\n.tc-plugin-info-dropdown-body {\\n\\tpadding: 1em 1em 0 1em;\\n\\tbackground: <<colour background>>;\\n}\\n\\n.tc-plugin-info-sub-plugins {\\n\\tpadding: 0.5em;\\n\\tmargin: 0 1em 1em 1em;\\n\\tbackground: <<colour notification-background>>;\\n}\\n\\n.tc-install-plugin {\\n\\tfont-weight: bold;\\n\\tbackground: green;\\n\\tcolor: white;\\n\\tfill: white;\\n\\tborder-radius: 4px;\\n\\tpadding: 3px;\\n}\\n\\n.tc-install-plugin.tc-reinstall-downgrade {\\n\\tbackground: red;\\n}\\n\\n.tc-install-plugin.tc-reinstall {\\n\\tbackground: blue;\\n}\\n\\n.tc-install-plugin.tc-reinstall-upgrade {\\n\\tbackground: orange;\\n}\\n\\n.tc-check-list {\\n\\tline-height: 2em;\\n}\\n\\n.tc-check-list .tc-image-button {\\n\\theight: 1.5em;\\n}\\n\\n/*\\n** Message boxes\\n*/\\n\\n.tc-message-box {\\n\\tborder: 1px solid <<colour message-border>>;\\n\\tbackground: <<colour message-background>>;\\n\\tpadding: 0px 21px 0px 21px;\\n\\tfont-size: 12px;\\n\\tline-height: 18px;\\n\\tcolor: <<colour message-foreground>>;\\n}\\n\\n.tc-message-box svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n\\tvertical-align: text-bottom;\\n}\\n\\n/*\\n** Pictures\\n*/\\n\\n.tc-bordered-image {\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tpadding: 5px;\\n\\tmargin: 5px;\\n}\\n\\n/*\\n** Floats\\n*/\\n\\n.tc-float-right {\\n\\tfloat: right;\\n}\\n\\n/*\\n** Chooser\\n*/\\n\\n.tc-chooser {\\n\\tborder-right: 1px solid <<colour table-header-background>>;\\n\\tborder-left: 1px solid <<colour table-header-background>>;\\n}\\n\\n\\n.tc-chooser-item {\\n\\tborder-bottom: 1px solid <<colour table-header-background>>;\\n\\tborder-top: 1px solid <<colour table-header-background>>;\\n\\tpadding: 2px 4px 2px 14px;\\n}\\n\\n.tc-drop-down .tc-chooser-item {\\n\\tpadding: 2px;\\n}\\n\\n.tc-chosen,\\n.tc-chooser-item:hover {\\n\\tbackground-color: <<colour table-header-background>>;\\n\\tborder-color: <<colour table-footer-background>>;\\n}\\n\\n.tc-chosen .tc-tiddlylink {\\n\\tcursor:default;\\n}\\n\\n.tc-chooser-item .tc-tiddlylink {\\n\\tdisplay: block;\\n\\ttext-decoration: none;\\n\\tbackground-color: transparent;\\n}\\n\\n.tc-chooser-item:hover .tc-tiddlylink:hover {\\n\\ttext-decoration: none;\\n}\\n\\n.tc-drop-down .tc-chosen .tc-tiddlylink,\\n.tc-drop-down .tc-chooser-item .tc-tiddlylink:hover {\\n\\tcolor: <<colour foreground>>;\\n}\\n\\n.tc-chosen > .tc-tiddlylink:before {\\n\\tmargin-left: -10px;\\n\\tposition: relative;\\n\\tcontent: \\\"» \\\";\\n}\\n\\n.tc-chooser-item svg,\\n.tc-chooser-item img{\\n\\twidth: 1em;\\n\\theight: 1em;\\n\\tvertical-align: middle;\\n}\\n\\n.tc-language-chooser .tc-image-button img {\\n\\twidth: 2em;\\n\\tvertical-align: -0.15em;\\n}\\n\\n/*\\n** Palette swatches\\n*/\\n\\n.tc-swatches-horiz {\\n}\\n\\n.tc-swatches-horiz .tc-swatch {\\n\\tdisplay: inline-block;\\n}\\n\\n.tc-swatch {\\n\\twidth: 2em;\\n\\theight: 2em;\\n\\tmargin: 0.4em;\\n\\tborder: 1px solid #888;\\n}\\n\\ninput.tc-palette-manager-colour-input {\\n\\twidth: 100%;\\n\\tpadding: 0;\\n}\\n\\n/*\\n** Table of contents\\n*/\\n\\n.tc-sidebar-lists .tc-table-of-contents {\\n\\twhite-space: nowrap;\\n}\\n\\n.tc-table-of-contents button,\\n.tc-table-of-contents .toc-item-muted {\\n\\tcolor: <<colour sidebar-foreground>>;\\n}\\n\\n.tc-table-of-contents svg {\\n\\twidth: 0.7em;\\n\\theight: 0.7em;\\n\\tvertical-align: middle;\\n\\tfill: <<colour sidebar-foreground>>;\\n}\\n\\n.tc-table-of-contents ol {\\n\\tlist-style-type: none;\\n\\tpadding-left: 0;\\n}\\n\\n.tc-table-of-contents ol ol {\\n\\tpadding-left: 1em;\\n}\\n\\n.tc-table-of-contents li {\\n\\tfont-size: 1.0em;\\n\\tfont-weight: bold;\\n}\\n\\n.tc-table-of-contents li a {\\n\\tfont-weight: bold;\\n}\\n\\n.tc-table-of-contents li li {\\n\\tfont-size: 0.95em;\\n\\tfont-weight: normal;\\n\\tline-height: 1.4;\\n}\\n\\n.tc-table-of-contents li li a {\\n\\tfont-weight: normal;\\n}\\n\\n.tc-table-of-contents li li li {\\n\\tfont-size: 0.95em;\\n\\tfont-weight: normal;\\n\\tline-height: 1.5;\\n}\\n\\n.tc-table-of-contents li li li li {\\n\\tfont-size: 0.95em;\\n\\tfont-weight: normal;\\n}\\n\\n.tc-tabbed-table-of-contents {\\n\\tdisplay: -webkit-flex;\\n\\tdisplay: flex;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-table-of-contents {\\n\\tz-index: 100;\\n\\tdisplay: inline-block;\\n\\tpadding-left: 1em;\\n\\tmax-width: 50%;\\n\\t-webkit-flex: 0 0 auto;\\n\\tflex: 0 0 auto;\\n\\tbackground: <<colour tab-background>>;\\n\\tborder-left: 1px solid <<colour tab-border>>;\\n\\tborder-top: 1px solid <<colour tab-border>>;\\n\\tborder-bottom: 1px solid <<colour tab-border>>;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item > a,\\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item-selected > a {\\n\\tdisplay: block;\\n\\tpadding: 0.12em 1em 0.12em 0.25em;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item > a {\\n\\tborder-top: 1px solid <<colour tab-background>>;\\n\\tborder-left: 1px solid <<colour tab-background>>;\\n\\tborder-bottom: 1px solid <<colour tab-background>>;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item > a:hover {\\n\\ttext-decoration: none;\\n\\tborder-top: 1px solid <<colour tab-border>>;\\n\\tborder-left: 1px solid <<colour tab-border>>;\\n\\tborder-bottom: 1px solid <<colour tab-border>>;\\n\\tbackground: <<colour tab-border>>;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item-selected > a {\\n\\tborder-top: 1px solid <<colour tab-border>>;\\n\\tborder-left: 1px solid <<colour tab-border>>;\\n\\tborder-bottom: 1px solid <<colour tab-border>>;\\n\\tbackground: <<colour background>>;\\n\\tmargin-right: -1px;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-table-of-contents .toc-item-selected > a:hover {\\n\\ttext-decoration: none;\\n}\\n\\n.tc-tabbed-table-of-contents .tc-tabbed-table-of-contents-content {\\n\\tdisplay: inline-block;\\n\\tvertical-align: top;\\n\\tpadding-left: 1.5em;\\n\\tpadding-right: 1.5em;\\n\\tborder: 1px solid <<colour tab-border>>;\\n\\t-webkit-flex: 1 0 50%;\\n\\tflex: 1 0 50%;\\n}\\n\\n/*\\n** Dirty indicator\\n*/\\n\\nhtml body svg.tc-image-save-button-dynamic .tc-image-save-button-dynamic-clean {\\n\\tvisibility: visible;\\n}\\n\\nhtml body svg.tc-image-save-button-dynamic .tc-image-save-button-dynamic-dirty {\\n\\tvisibility: hidden;\\n}\\n\\nhtml body.tc-dirty svg.tc-image-save-button-dynamic .tc-image-save-button-dynamic-clean {\\n\\tvisibility: hidden;\\n}\\n\\nhtml body.tc-dirty svg.tc-image-save-button-dynamic .tc-image-save-button-dynamic-dirty {\\n\\tvisibility: visible;\\n}\\n\\nhtml body.tc-dirty span.tc-dirty-indicator, html body.tc-dirty span.tc-dirty-indicator svg {\\n\\tfill: <<colour dirty-indicator>>;\\n\\tcolor: <<colour dirty-indicator>>;\\n}\\n\\n/*\\n** File inputs\\n*/\\n\\n.tc-file-input-wrapper {\\n\\tposition: relative;\\n\\toverflow: hidden;\\n\\tdisplay: inline-block;\\n\\tvertical-align: middle;\\n}\\n\\n.tc-file-input-wrapper input[type=file] {\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n\\tfont-size: 999px;\\n\\tmax-width: 100%;\\n\\tmax-height: 100%;\\n\\tfilter: alpha(opacity=0);\\n\\topacity: 0;\\n\\toutline: none;\\n\\tbackground: white;\\n\\tcursor: pointer;\\n\\tdisplay: inline-block;\\n}\\n\\n::-webkit-file-upload-button {\\n\\tcursor:pointer;\\n}\\n\\n/*\\n** Thumbnail macros\\n*/\\n\\n.tc-thumbnail-wrapper {\\n\\tposition: relative;\\n\\tdisplay: inline-block;\\n\\tmargin: 6px;\\n\\tvertical-align: top;\\n}\\n\\n.tc-thumbnail-right-wrapper {\\n\\tfloat:right;\\n\\tmargin: 0.5em 0 0.5em 0.5em;\\n}\\n\\n.tc-thumbnail-image {\\n\\ttext-align: center;\\n\\toverflow: hidden;\\n\\tborder-radius: 3px;\\n}\\n\\n.tc-thumbnail-image svg,\\n.tc-thumbnail-image img {\\n\\tfilter: alpha(opacity=1);\\n\\topacity: 1;\\n\\tmin-width: 100%;\\n\\tmin-height: 100%;\\n\\tmax-width: 100%;\\n}\\n\\n.tc-thumbnail-wrapper:hover .tc-thumbnail-image svg,\\n.tc-thumbnail-wrapper:hover .tc-thumbnail-image img {\\n\\tfilter: alpha(opacity=0.8);\\n\\topacity: 0.8;\\n}\\n\\n.tc-thumbnail-background {\\n\\tposition: absolute;\\n\\tborder-radius: 3px;\\n}\\n\\n.tc-thumbnail-icon svg,\\n.tc-thumbnail-icon img {\\n\\twidth: 3em;\\n\\theight: 3em;\\n\\t<<filter \\\"drop-shadow(2px 2px 4px rgba(0,0,0,0.3))\\\">>\\n}\\n\\n.tc-thumbnail-wrapper:hover .tc-thumbnail-icon svg,\\n.tc-thumbnail-wrapper:hover .tc-thumbnail-icon img {\\n\\tfill: #fff;\\n\\t<<filter \\\"drop-shadow(3px 3px 4px rgba(0,0,0,0.6))\\\">>\\n}\\n\\n.tc-thumbnail-icon {\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tleft: 0;\\n\\tright: 0;\\n\\tbottom: 0;\\n\\tdisplay: -webkit-flex;\\n\\t-webkit-align-items: center;\\n\\t-webkit-justify-content: center;\\n\\tdisplay: flex;\\n\\talign-items: center;\\n\\tjustify-content: center;\\n}\\n\\n.tc-thumbnail-caption {\\n\\tposition: absolute;\\n\\tbackground-color: #777;\\n\\tcolor: #fff;\\n\\ttext-align: center;\\n\\tbottom: 0;\\n\\twidth: 100%;\\n\\tfilter: alpha(opacity=0.9);\\n\\topacity: 0.9;\\n\\tline-height: 1.4;\\n\\tborder-bottom-left-radius: 3px;\\n\\tborder-bottom-right-radius: 3px;\\n}\\n\\n.tc-thumbnail-wrapper:hover .tc-thumbnail-caption {\\n\\tfilter: alpha(opacity=1);\\n\\topacity: 1;\\n}\\n\\n/*\\n** Diffs\\n*/\\n\\n.tc-diff-equal {\\n\\tbackground-color: <<colour diff-equal-background>>;\\n\\tcolor: <<colour diff-equal-foreground>>;\\n}\\n\\n.tc-diff-insert {\\n\\tbackground-color: <<colour diff-insert-background>>;\\n\\tcolor: <<colour diff-insert-foreground>>;\\n}\\n\\n.tc-diff-delete {\\n\\tbackground-color: <<colour diff-delete-background>>;\\n\\tcolor: <<colour diff-delete-foreground>>;\\n}\\n\\n.tc-diff-invisible {\\n\\tbackground-color: <<colour diff-invisible-background>>;\\n\\tcolor: <<colour diff-invisible-foreground>>;\\n}\\n\\n.tc-diff-tiddlers th {\\n\\ttext-align: right;\\n\\tbackground: <<colour background>>;\\n\\tfont-weight: normal;\\n\\tfont-style: italic;\\n}\\n\\n.tc-diff-tiddlers pre {\\n\\tmargin: 0;\\n\\tpadding: 0;\\n\\tborder: none;\\n\\tbackground: none;\\n}\\n\\n/*\\n** Errors\\n*/\\n\\n.tc-error {\\n\\tbackground: #f00;\\n\\tcolor: #fff;\\n}\\n\\n/*\\n** Tree macro\\n*/\\n\\n.tc-tree div {\\n\\tpadding-left: 14px;\\n}\\n\\n.tc-tree ol {\\n\\tlist-style-type: none;\\n\\tpadding-left: 0;\\n\\tmargin-top: 0;\\n}\\n\\n.tc-tree ol ol {\\n\\tpadding-left: 1em;\\n}\\n\\n.tc-tree button {\\n\\tcolor: #acacac;\\n}\\n\\n.tc-tree svg {\\n\\tfill: #acacac;\\n}\\n\\n.tc-tree span svg {\\n\\twidth: 1em;\\n\\theight: 1em;\\n\\tvertical-align: baseline;\\n}\\n\\n.tc-tree li span {\\n\\tcolor: lightgray;\\n}\\n\\nselect {\\n\\tcolor: <<colour select-tag-foreground>>;\\n\\tbackground: <<colour select-tag-background>>;\\n}\\n\\n/*\\n** Translink macro\\n*/\\n\\n.tc-translink {\\n\\tbackground-color: <<colour pre-background>>;\\n\\tborder: 1px solid <<colour pre-border>>;\\n\\tpadding: 0 3px;\\n\\tborder-radius: 3px;\\n}\\n\\ndiv.tc-translink > div {\\n\\tmargin: 1em;\\n}\\n\\ndiv.tc-translink > div > a:first-child > h1 {\\n\\tfont-size: 1.2em;\\n\\tfont-weight: bold;\\n}\\n\\nspan.tc-translink > a:first-child {\\n\\tfont-weight: bold;\\n}\\n\\n/*\\n** Classes for displaying globals\\n*/\\n\\n.tc-global-tiddler-body {\\n\\tpadding: 0.25em;\\n\\tborder: 1px solid <<colour foreground>>;\\n\\tbackground-color: <<colour muted-foreground>>;\\n\\tborder-radius: 3px;\\n}\\n\\n.tc-global-tiddler-body-heading {\\n\\tmargin: 0 0 0.25em 0;\\n\\tfont-weight: normal;\\n}\\n\\n.tc-global-tiddler-body-type {\\n\\tmargin: 0 0 0.25em 0;\\n\\tborder-bottom: 1px solid <<colour foreground>>;\\n}\\n\\n.tc-global-tiddler-body-details {\\n\\tbackground-color: <<colour background>>;\\n}\\n\\n.tc-global-tiddler-body pre {\\n\\tmargin: 0;\\n\\tborder: 1px solid <<colour foreground>>;\\n}\\n\\n/*\\n** Utility classes for SVG icons\\n*/\\n\\n.tc-fill-background {\\n\\tfill: <<colour background>>;\\n}\\n\\n.tc-network-activity-background {\\n\\tfill: <<colour network-activity-foreground>>;\\n}\\n\\n/*\\n** Test Cases\\n*/\\n\\n.tc-test-case-wrapper {\\n\\tborder: 1px solid <<colour foreground>>;\\n\\tbackground-color: <<colour muted-foreground>>;\\n\\tborder-radius: 6px;\\n}\\n\\n.tc-test-case-wrapper {\\n\\tbackground-color: <<colour testcase-accent-level-1>>;\\n}\\n\\n.tc-test-case-wrapper .tc-test-case-wrapper {\\n\\tbackground-color: <<colour testcase-accent-level-2>>;\\n}\\n\\n.tc-test-case-wrapper .tc-test-case-wrapper .tc-test-case-wrapper {\\n\\tbackground-color: <<colour testcase-accent-level-3>>;\\n}\\n\\n.tc-test-case-header {\\n\\tfont-weight: normal;\\n\\tmargin: 0.5em 0;\\n\\tpadding: 0 0.5em;\\n}\\n\\n.tc-test-case-divider {\\n\\tx-background-color: <<colour muted-foreground>>;\\n}\\n\\n.tc-test-case-result-icon {\\n\\tfill: #fff;\\n\\tpadding: 0.25em;\\n\\tdisplay: inline-block;\\n\\tline-height: 0;\\n\\tborder-radius: 1em;\\n\\tvertical-align: text-bottom;\\n\\tmargin-right: 0.25em;\\n}\\n\\n.tc-test-case-result-icon-pass {\\n\\tbackground-color: green;\\n}\\n\\n.tc-test-case-result-icon-fail {\\n\\tbackground-color: red;\\n}\\n\\n.tc-test-case-result-icon svg {\\n\\twidth: 0.5em;\\n\\theight: 0.5em;\\n}\\n\\n.tc-test-case-header > h2 {\\n\\tbackground: <<colour background>>;\\n\\tborder-radius: 4px;\\n\\tpadding: 0.25em;\\n}\\n\\n.tc-test-case-header > h2,\\n.tc-test-case-source > pre {\\n\\tmargin: 0;\\n}\\n\\n.tc-test-case-header > h2 a.tc-tiddlylink-missing {\\n\\tfont-style: normal;\\n}\\n\\n.tc-test-case-toolbar {\\n\\tfloat: right;\\n}\\n\\n.tc-test-case-toolbar svg {\\n\\tfill: <<colour tiddler-controls-foreground>>;\\n}\\n\\n.tc-test-case-toolbar .tc-drop-down {\\n\\tfont-size: 0.8em;\\n}\\n\\n.tc-test-case-result-fail {\\n\\tborder: 1px solid <<colour foreground>>;\\n\\tbackground-color: <<colour background>>;\\n\\tborder-radius: 4px;\\n\\tmargin: 0 0.5em;\\n\\tpadding: 0;\\n}\\n\\n.tc-test-case-result-fail-header {\\n\\tbackground: <<colour diff-delete-background>>;\\n\\tcolor: <<colour diff-delete-foreground>>;\\n\\tborder-top-left-radius: 4px;\\n\\tborder-top-right-radius: 4px;\\n\\tpadding: 4px;\\n}\\n\\n.tc-test-case-result-fail-body {\\n\\tpadding: 4px;\\n}\\n\\n.tc-test-case-source > pre {\\n\\theight: 100%;\\n}\\n\\n.tc-test-case-narrative {\\n\\tpadding: 0.5em;\\n}\\n\\n.tc-test-case-panes {\\n\\tdisplay: flex;\\n\\talign-items: stretch;\\n\\tflex-wrap: wrap;\\n\\tpadding: 0.5em;\\n\\tborder-bottom-left-radius: 6px;\\n\\tborder-bottom-right-radius: 6px;\\n}\\n\\n.tc-test-case-source {\\n\\tflex: 1 0 49%;\\n\\tmin-width: 250px;\\n}\\n\\n.tc-test-case-source .tc-tab-content {\\n\\tbackground: inherit;\\n\\tmargin: 0;\\n}\\n\\n.tc-test-case-source .tc-tab-content .tc-field-table {\\n\\tbackground: <<colour background>>;\\n}\\n\\n.tc-test-case-source .tc-field-table {\\n\\twidth: 100%;\\n}\\n\\n.tc-test-case-source table.tc-field-table {\\n\\tmargin: 0;\\n}\\n\\n.tc-test-case-source .tc-tiddler-frame .tc-edit-texteditor {\\n\\tmargin: 0;\\n}\\n\\n.tc-test-case-divider {\\n\\tflex: 0 0 1.5%;\\n}\\n\\n.tc-test-case-source .tc-tab-buttons {\\n\\tpadding-top: 0;\\n}\\n\\n.tc-test-case-footer-toolbar {\\n\\tdisplay: flex;\\n\\tjustify-content: flex-end;\\n}\\n\\n.tc-test-case-output {\\n\\tbox-shadow: inset 2px 2px 10px 0px <<colour muted-foreground>>;\\n\\tbackground: <<colour background>>;\\n\\tborder-radius: 4px;\\n\\tborder: 1px solid <<colour muted-foreground>>;\\n\\tflex: 1 0 49%;\\n\\tmin-width: 250px;\\n\\tpadding: 0.25em 1em;\\n}\\n\\n/*\\n** Flexbox utility classes\\n*/\\n\\n.tc-flex {\\n\\tdisplay: -webkit-flex;\\n\\tdisplay: flex;\\n}\\n\\n.tc-flex-column {\\n\\tflex-direction: column;\\n}\\n\\n.tc-flex-row {\\n\\tflex-direction: row;\\n}\\n\\n.tc-flex-grow-1 {\\n\\tflex-grow: 1;\\n}\\n\\n.tc-flex-grow-2 {\\n\\tflex-grow: 2;\\n}\\n\\n/*\\n** Other utility classes\\n*/\\n\\n/* Horizontal gaps */\\n\\n.tc-tiny-gap {\\n\\tmargin-left: .25em;\\n\\tmargin-right: .25em;\\n}\\n\\n.tc-tiny-gap-left {\\n\\tmargin-left: .25em;\\n}\\n\\n.tc-tiny-gap-right {\\n\\tmargin-right: .25em;\\n}\\n\\n.tc-small-gap {\\n\\tmargin-left: .5em;\\n\\tmargin-right: .5em;\\n}\\n\\n.tc-small-gap-left {\\n\\tmargin-left: .5em;\\n}\\n\\n.tc-small-gap-right {\\n\\tmargin-right: .5em;\\n}\\n\\n.tc-big-gap {\\n\\tmargin-left: 1em;\\n\\tmargin-right: 1em;\\n}\\n\\n.tc-big-gap-left {\\n\\tmargin-left: 1em;\\n}\\n\\n.tc-big-gap-right {\\n\\tmargin-right: 1em;\\n}\\n\\n.tc-word-break {\\n\\tword-break: break-all;\\n}\\n\\n/* Vertical gaps */\\n\\n.tc-tiny-v-gap-bottom {\\n\\tmargin-bottom: 3px;\\n}\\n\"},\"$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/bodyfontsize\",\"text\":\"15px\"},\"$:/themes/tiddlywiki/vanilla/metrics/bodylineheight\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/bodylineheight\",\"text\":\"22px\"},\"$:/themes/tiddlywiki/vanilla/metrics/fontsize\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/fontsize\",\"text\":\"14px\"},\"$:/themes/tiddlywiki/vanilla/metrics/lineheight\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/lineheight\",\"text\":\"20px\"},\"$:/themes/tiddlywiki/vanilla/metrics/storyleft\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/storyleft\",\"text\":\"0px\"},\"$:/themes/tiddlywiki/vanilla/metrics/storytop\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/storytop\",\"text\":\"0px\"},\"$:/themes/tiddlywiki/vanilla/metrics/storyright\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/storyright\",\"text\":\"770px\"},\"$:/themes/tiddlywiki/vanilla/metrics/storywidth\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/storywidth\",\"text\":\"770px\"},\"$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/tiddlerwidth\",\"text\":\"686px\"},\"$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint\",\"text\":\"960px\"},\"$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth\":{\"title\":\"$:/themes/tiddlywiki/vanilla/metrics/sidebarwidth\",\"text\":\"350px\"},\"$:/themes/tiddlywiki/vanilla/options/stickytitles\":{\"title\":\"$:/themes/tiddlywiki/vanilla/options/stickytitles\",\"text\":\"no\"},\"$:/themes/tiddlywiki/vanilla/options/sidebarlayout\":{\"title\":\"$:/themes/tiddlywiki/vanilla/options/sidebarlayout\",\"text\":\"fixed-fluid\"},\"$:/themes/tiddlywiki/vanilla/options/codewrapping\":{\"title\":\"$:/themes/tiddlywiki/vanilla/options/codewrapping\",\"text\":\"pre-wrap\"},\"$:/themes/tiddlywiki/vanilla/reset\":{\"title\":\"$:/themes/tiddlywiki/vanilla/reset\",\"type\":\"text/css\",\"text\":\"/*! modern-normalize v2.0.0 | MIT License | https://github.com/sindresorhus/modern-normalize */\\n\\n/*\\nDocument\\n========\\n*/\\n\\n/**\\nUse a better box model (opinionated).\\n*/\\n\\n*,\\n::before,\\n::after {\\n\\tbox-sizing: border-box;\\n}\\n\\nhtml {\\n\\t/* Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3) */\\n\\tfont-family:\\n\\t\\tsystem-ui,\\n\\t\\t'Segoe UI',\\n\\t\\tRoboto,\\n\\t\\tHelvetica,\\n\\t\\tArial,\\n\\t\\tsans-serif,\\n\\t\\t'Apple Color Emoji',\\n\\t\\t'Segoe UI Emoji';\\n\\tline-height: 1.15; /* 1. Correct the line height in all browsers. */\\n\\t-webkit-text-size-adjust: 100%; /* 2. Prevent adjustments of font size after orientation changes in iOS. */\\n\\t-moz-tab-size: 4; /* 3. Use a more readable tab size (opinionated). */\\n\\ttab-size: 4; /* 3 */\\n}\\n\\n/*\\nSections\\n========\\n*/\\n\\nbody {\\n\\tmargin: 0; /* Remove the margin in all browsers. */\\n}\\n\\n/*\\nGrouping content\\n================\\n*/\\n\\n/**\\n1. Add the correct height in Firefox.\\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\\n*/\\n\\nhr {\\n\\theight: 0; /* 1 */\\n\\tcolor: inherit; /* 2 */\\n}\\n\\n/*\\nText-level semantics\\n====================\\n*/\\n\\n/**\\nAdd the correct text decoration in Chrome, Edge, and Safari.\\n*/\\n\\nabbr[title] {\\n\\ttext-decoration: underline dotted;\\n}\\n\\n/**\\nAdd the correct font weight in Edge and Safari.\\n*/\\n\\nb,\\nstrong {\\n\\tfont-weight: bolder;\\n}\\n\\n/**\\n1. Improve consistency of default fonts in all browsers. (https://github.com/sindresorhus/modern-normalize/issues/3)\\n2. Correct the odd 'em' font sizing in all browsers.\\n*/\\n\\ncode,\\nkbd,\\nsamp,\\npre {\\n\\tfont-family:\\n\\t\\tui-monospace,\\n\\t\\tSFMono-Regular,\\n\\t\\tConsolas,\\n\\t\\t'Liberation Mono',\\n\\t\\tMenlo,\\n\\t\\tmonospace; /* 1 */\\n\\tfont-size: 1em; /* 2 */\\n}\\n\\n/**\\nAdd the correct font size in all browsers.\\n*/\\n\\nsmall {\\n\\tfont-size: 80%;\\n}\\n\\n/**\\nPrevent 'sub' and 'sup' elements from affecting the line height in all browsers.\\n*/\\n\\nsub,\\nsup {\\n\\tfont-size: 75%;\\n\\tline-height: 0;\\n\\tposition: relative;\\n\\tvertical-align: baseline;\\n}\\n\\nsub {\\n\\tbottom: -0.25em;\\n}\\n\\nsup {\\n\\ttop: -0.5em;\\n}\\n\\n/*\\nTabular data\\n============\\n*/\\n\\n/**\\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\\n2. Correct table border color inheritance in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\\n*/\\n\\ntable {\\n\\ttext-indent: 0; /* 1 */\\n\\tborder-color: inherit; /* 2 */\\n}\\n\\n/*\\nForms\\n=====\\n*/\\n\\n/**\\n1. Change the font styles in all browsers.\\n2. Remove the margin in Firefox and Safari.\\n*/\\n\\nbutton,\\ninput,\\noptgroup,\\nselect,\\ntextarea {\\n\\tfont-family: inherit; /* 1 */\\n\\tfont-size: 100%; /* 1 */\\n\\tline-height: 1.15; /* 1 */\\n\\tmargin: 0; /* 2 */\\n}\\n\\n/**\\nRemove the inheritance of text transform in Edge and Firefox.\\n*/\\n\\nbutton,\\nselect {\\n\\ttext-transform: none;\\n}\\n\\n/**\\nCorrect the inability to style clickable types in iOS and Safari.\\n*/\\n\\nbutton,\\n[type='button'],\\n[type='reset'],\\n[type='submit'] {\\n\\t-webkit-appearance: button;\\n}\\n\\n/**\\nRemove the inner border and padding in Firefox.\\n*/\\n\\n::-moz-focus-inner {\\n\\tborder-style: none;\\n\\tpadding: 0;\\n}\\n\\n/**\\nRestore the focus styles unset by the previous rule.\\n*/\\n\\n:-moz-focusring {\\n\\toutline: 1px dotted ButtonText;\\n}\\n\\n/**\\nRemove the additional ':invalid' styles in Firefox.\\nSee: https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737\\n*/\\n\\n:-moz-ui-invalid {\\n\\tbox-shadow: none;\\n}\\n\\n/**\\nRemove the padding so developers are not caught out when they zero out 'fieldset' elements in all browsers.\\n*/\\n\\nlegend {\\n\\tpadding: 0;\\n}\\n\\n/**\\nAdd the correct vertical alignment in Chrome and Firefox.\\n*/\\n\\nprogress {\\n\\tvertical-align: baseline;\\n}\\n\\n/**\\nCorrect the cursor style of increment and decrement buttons in Safari.\\n*/\\n\\n::-webkit-inner-spin-button,\\n::-webkit-outer-spin-button {\\n\\theight: auto;\\n}\\n\\n/**\\n1. Correct the odd appearance in Chrome and Safari.\\n2. Correct the outline style in Safari.\\n*/\\n\\n[type='search'] {\\n\\t-webkit-appearance: textfield; /* 1 */\\n\\toutline-offset: -2px; /* 2 */\\n}\\n\\n/**\\nRemove the inner padding in Chrome and Safari on macOS.\\n*/\\n\\n::-webkit-search-decoration {\\n\\t-webkit-appearance: none;\\n}\\n\\n/**\\n1. Correct the inability to style clickable types in iOS and Safari.\\n2. Change font properties to 'inherit' in Safari.\\n*/\\n\\n::-webkit-file-upload-button {\\n\\t-webkit-appearance: button; /* 1 */\\n\\tfont: inherit; /* 2 */\\n}\\n\\n/*\\nInteractive\\n===========\\n*/\\n\\n/*\\nAdd the correct display in Chrome and Safari.\\n*/\\n\\nsummary {\\n\\tdisplay: list-item;\\n}\\n\"},\"$:/themes/tiddlywiki/vanilla/settings/fontfamily\":{\"title\":\"$:/themes/tiddlywiki/vanilla/settings/fontfamily\",\"text\":\"-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji\"},\"$:/themes/tiddlywiki/vanilla/settings/codefontfamily\":{\"title\":\"$:/themes/tiddlywiki/vanilla/settings/codefontfamily\",\"text\":\"\\\"SFMono-Regular\\\",Consolas,\\\"Liberation Mono\\\",Menlo,Courier,monospace\"},\"$:/themes/tiddlywiki/vanilla/settings/backgroundimageattachment\":{\"title\":\"$:/themes/tiddlywiki/vanilla/settings/backgroundimageattachment\",\"text\":\"fixed\"},\"$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize\":{\"title\":\"$:/themes/tiddlywiki/vanilla/settings/backgroundimagesize\",\"text\":\"auto\"},\"$:/themes/tiddlywiki/vanilla/sticky\":{\"title\":\"$:/themes/tiddlywiki/vanilla/sticky\",\"code-body\":\"yes\",\"text\":\"<$reveal state=\\\"$:/themes/tiddlywiki/vanilla/options/stickytitles\\\" type=\\\"match\\\" text=\\\"yes\\\">\\n``\\n.tc-tiddler-title {\\n\\tposition: -webkit-sticky;\\n\\tposition: -moz-sticky;\\n\\tposition: -o-sticky;\\n\\tposition: -ms-sticky;\\n\\tposition: sticky;\\n\\ttop: 0px;\\n\\tbackground: ``<<colour tiddler-background>>``;\\n\\tz-index: 500;\\n}\\n\\n``\\n<$list filter=\\\"[range[100]]\\\">\\n`.tc-story-river .tc-tiddler-frame:nth-child(100n+`<$text text=<<currentTiddler>>/>`) {\\nz-index: `<$text text={{{ [[200]subtract<currentTiddler>] }}}/>`;\\n}\\n`\\n</$list>\\n</$reveal>\\n\"}}}"
  }
]);
    return $tw;
})(window.$tw);

